!function(global){var babelHelpers=global.babelHelpers={};babelHelpers.typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol?"symbol":typeof obj},babelHelpers.jsx=function(){var REACT_ELEMENT_TYPE="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103;return function(type,props,key,children){var defaultProps=type&&type.defaultProps,childrenLength=arguments.length-3;if(props||0===childrenLength||(props={}),props&&defaultProps)for(var propName in defaultProps)void 0===props[propName]&&(props[propName]=defaultProps[propName]);else props||(props=defaultProps||{});if(1===childrenLength)props.children=children;else if(childrenLength>1){for(var childArray=Array(childrenLength),i=0;i<childrenLength;i++)childArray[i]=arguments[i+3];props.children=childArray}return{$$typeof:REACT_ELEMENT_TYPE,type:type,key:void 0===key?null:""+key,ref:null,props:props,_owner:null}}}(),babelHelpers.asyncToGenerator=function(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}return info.done?void resolve(value):Promise.resolve(value).then(function(value){return step("next",value)},function(err){return step("throw",err)})}return step("next")})}},babelHelpers.classCallCheck=function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")},babelHelpers.createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),babelHelpers.defineEnumerableProperties=function(obj,descs){for(var key in descs){var desc=descs[key];desc.configurable=desc.enumerable=!0,"value"in desc&&(desc.writable=!0),Object.defineProperty(obj,key,desc)}return obj},babelHelpers.defaults=function(obj,defaults){for(var keys=Object.getOwnPropertyNames(defaults),i=0;i<keys.length;i++){var key=keys[i],value=Object.getOwnPropertyDescriptor(defaults,key);value&&value.configurable&&void 0===obj[key]&&Object.defineProperty(obj,key,value)}return obj},babelHelpers.defineProperty=function(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj},babelHelpers.extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},babelHelpers.get=function get(object,property,receiver){null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0===desc){var parent=Object.getPrototypeOf(object);return null===parent?void 0:get(parent,property,receiver)}if("value"in desc)return desc.value;var getter=desc.get;if(void 0!==getter)return getter.call(receiver)},babelHelpers.inherits=function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)},babelHelpers.instanceof=function(left,right){return null!=right&&"undefined"!=typeof Symbol&&right[Symbol.hasInstance]?right[Symbol.hasInstance](left):left instanceof right},babelHelpers.interopRequireDefault=function(obj){return obj&&obj.__esModule?obj:{default:obj}},babelHelpers.interopRequireWildcard=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj},babelHelpers.newArrowCheck=function(innerThis,boundThis){if(innerThis!==boundThis)throw new TypeError("Cannot instantiate an arrow function")},babelHelpers.objectDestructuringEmpty=function(obj){if(null==obj)throw new TypeError("Cannot destructure undefined")},babelHelpers.objectWithoutProperties=function(obj,keys){var target={};for(var i in obj)keys.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(obj,i)&&(target[i]=obj[i]);return target},babelHelpers.possibleConstructorReturn=function(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call},babelHelpers.selfGlobal="undefined"==typeof global?self:global,babelHelpers.set=function set(object,property,value,receiver){var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0===desc){var parent=Object.getPrototypeOf(object);null!==parent&&set(parent,property,value,receiver)}else if("value"in desc&&desc.writable)desc.value=value;else{var setter=desc.set;void 0!==setter&&setter.call(receiver,value)}return value},babelHelpers.slicedToArray=function(){function sliceIterator(arr,i){var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{!_n&&_i.return&&_i.return()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr))return arr;if(Symbol.iterator in Object(arr))return sliceIterator(arr,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),babelHelpers.slicedToArrayLoose=function(arr,i){if(Array.isArray(arr))return arr;if(Symbol.iterator in Object(arr)){for(var _step,_arr=[],_iterator=arr[Symbol.iterator]();!(_step=_iterator.next()).done&&(_arr.push(_step.value),!i||_arr.length!==i););return _arr}throw new TypeError("Invalid attempt to destructure non-iterable instance")},babelHelpers.taggedTemplateLiteral=function(strings,raw){return Object.freeze(Object.defineProperties(strings,{raw:{value:Object.freeze(raw)}}))},babelHelpers.taggedTemplateLiteralLoose=function(strings,raw){return strings.raw=raw,strings},babelHelpers.temporalRef=function(val,name,undef){if(val===undef)throw new ReferenceError(name+" is not defined - temporal dead zone");return val},babelHelpers.temporalUndefined={},babelHelpers.toArray=function(arr){return Array.isArray(arr)?arr:Array.from(arr)},babelHelpers.toConsumableArray=function(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return Array.from(arr)}}("undefined"==typeof global?self:global),function(exports){"use strict";function normalizeName(child,parentBase){if("/"===child.charAt(0)&&(child=child.slice(1)),"."!==child.charAt(0))return child;for(var parts=child.split("/");"."===parts[0]||".."===parts[0];)".."===parts.shift()&&parentBase.pop();return parentBase.concat(parts).join("/")}function ensuredExecute(name){var mod=internalRegistry[name];return mod&&!seen[name]&&(seen[name]=!0,mod.execute()),mod&&mod.proxy}function set(name,values){externalRegistry[name]=values}function get(name){return externalRegistry[name]||ensuredExecute(name)}function has(name){return!!externalRegistry[name]||!!internalRegistry[name]}function createScriptNode(src,callback){var node=document.createElement("script");node.async&&(node.async=!1),ie?node.onreadystatechange=function(){/loaded|complete/.test(this.readyState)&&(this.onreadystatechange=null,callback())}:node.onload=node.onerror=callback,node.setAttribute("src",src),headEl.appendChild(node)}function load(name){return new Promise(function(resolve,reject){createScriptNode((System.baseURL||"/")+name+".js",function(err){anonymousEntry&&(System.register(name,anonymousEntry[0],anonymousEntry[1]),anonymousEntry=void 0);var mod=internalRegistry[name];return mod?void Promise.all(mod.deps.map(function(dep){return externalRegistry[dep]||internalRegistry[dep]?Promise.resolve():load(dep)})).then(resolve,reject):void reject(new Error("Error loading module "+name))})})}var anonymousEntry,headEl=document.getElementsByTagName("head")[0],ie=/MSIE/.test(navigator.userAgent),seen=Object.create(null),internalRegistry=Object.create(null),externalRegistry=Object.create(null),System={set:set,get:get,has:has,import:function(name){return new Promise(function(resolve,reject){var normalizedName=normalizeName(name,[]),mod=get(normalizedName);return mod?resolve(mod):load(name).then(function(){return get(normalizedName)})})},register:function(name,deps,wrapper){if(Array.isArray(name))return anonymousEntry=[],void anonymousEntry.push.apply(anonymousEntry,arguments);var mod,meta,proxy=Object.create(null),values=Object.create(null);internalRegistry[name]=mod={proxy:proxy,values:values,deps:deps.map(function(dep){return normalizeName(dep,name.split("/").slice(0,-1))}),dependants:[],update:function(moduleName,moduleObj){meta.setters[mod.deps.indexOf(moduleName)](moduleObj)},execute:function(){mod.deps.map(function(dep){var imports=externalRegistry[dep];imports?mod.update(dep,imports):(imports=get(dep)&&internalRegistry[dep].values,imports&&(internalRegistry[dep].dependants.push(name),mod.update(dep,imports)))}),meta.execute()}},meta=wrapper(function(identifier,value){return values[identifier]=value,mod.lock=!0,mod.dependants.forEach(function(moduleName){internalRegistry[moduleName]&&!internalRegistry[moduleName].lock&&internalRegistry[moduleName].update(name,values)}),mod.lock=!1,Object.getOwnPropertyDescriptor(proxy,identifier)||Object.defineProperty(proxy,identifier,{enumerable:!0,get:function(){return values[identifier]}}),value})}};exports.System=System}(window),function(global,factory){"use strict";var m=factory(global);"object"==typeof module&&null!=module&&module.exports?module.exports=m:"function"==typeof define&&define.amd?define(function(){return m}):global.m=m}("undefined"!=typeof window?window:{},function(global,undefined){"use strict";function isFunction(object){return"function"==typeof object}function isObject(object){return"[object Object]"===type.call(object)}function isString(object){return"[object String]"===type.call(object)}function noop(){}function initialize(mock){$document=mock.document,$location=mock.location,$cancelAnimationFrame=mock.cancelAnimationFrame||mock.clearTimeout,$requestAnimationFrame=mock.requestAnimationFrame||mock.setTimeout}function parseTagAttrs(cell,tag){for(var match,classes=[],parser=/(?:(^|#|\.)([^#\.\[\]]+))|(\[.+?\])/g;match=parser.exec(tag);)if(""===match[1]&&match[2])cell.tag=match[2];else if("#"===match[1])cell.attrs.id=match[2];else if("."===match[1])classes.push(match[2]);else if("["===match[3][0]){var pair=/\[(.+?)(?:=("|'|)(.*?)\2)?\]/.exec(match[3]);cell.attrs[pair[1]]=pair[3]||!pair[2]||""}return classes}function getVirtualChildren(args,hasAttrs){var children=hasAttrs?args.slice(1):args;return 1===children.length&&isArray(children[0])?children[0]:children}function assignAttrs(target,attrs,classes){var classAttr="class"in attrs?"class":"className";for(var attrName in attrs)hasOwn.call(attrs,attrName)&&(attrName===classAttr&&null!=attrs[attrName]&&""!==attrs[attrName]?(classes.push(attrs[attrName]),target[attrName]=""):target[attrName]=attrs[attrName]);classes.length&&(target[classAttr]=classes.join(" "))}function m(tag,pairs){var args=[].slice.call(arguments,1);if(isObject(tag))return parameterize(tag,args);if(!isString(tag))throw new Error("selector in m(selector, attrs, children) should be a string");var hasAttrs=null!=pairs&&isObject(pairs)&&!("tag"in pairs||"view"in pairs||"subtree"in pairs),attrs=hasAttrs?pairs:{},cell={tag:"div",attrs:{},children:getVirtualChildren(args,hasAttrs)};return assignAttrs(cell.attrs,attrs,parseTagAttrs(cell,tag)),cell}function forEach(list,f){for(var i=0;i<list.length&&!f(list[i],i++););}function forKeys(list,f){forEach(list,function(attrs,i){return(attrs=attrs&&attrs.attrs)&&null!=attrs.key&&f(attrs,i)})}function dataToString(data){try{if(null!=data&&null!=data.toString())return data}catch(e){}return""}function injectTextNode(parentElement,first,index,data){try{insertNode(parentElement,first,index),first.nodeValue=data}catch(e){}}function flatten(list){for(var i=0;i<list.length;i++)isArray(list[i])&&(list=list.concat.apply([],list),i--);return list}function insertNode(parentElement,node,index){parentElement.insertBefore(node,parentElement.childNodes[index]||null)}function handleKeysDiffer(data,existing,cached,parentElement){forKeys(data,function(key,i){existing[key=key.key]=existing[key]?{action:MOVE,index:i,from:existing[key].index,element:cached.nodes[existing[key].index]||$document.createElement("div")}:{action:INSERTION,index:i}});var actions=[];for(var prop in existing)hasOwn.call(existing,prop)&&actions.push(existing[prop]);var changes=actions.sort(sortChanges),newCached=new Array(cached.length);return newCached.nodes=cached.nodes.slice(),forEach(changes,function(change){var index=change.index;if(change.action===DELETION&&(clear(cached[index].nodes,cached[index]),newCached.splice(index,1)),change.action===INSERTION){var dummy=$document.createElement("div");dummy.key=data[index].attrs.key,insertNode(parentElement,dummy,index),newCached.splice(index,0,{attrs:{key:data[index].attrs.key},nodes:[dummy]}),newCached.nodes[index]=dummy}if(change.action===MOVE){var changeElement=change.element,maybeChanged=parentElement.childNodes[index];maybeChanged!==changeElement&&null!==changeElement&&parentElement.insertBefore(changeElement,maybeChanged||null),newCached[index]=cached[change.from],newCached.nodes[index]=changeElement}}),newCached}function diffKeys(data,cached,existing,parentElement){var keysDiffer=data.length!==cached.length;return keysDiffer||forKeys(data,function(attrs,i){var cachedCell=cached[i];return keysDiffer=cachedCell&&cachedCell.attrs&&cachedCell.attrs.key!==attrs.key}),keysDiffer?handleKeysDiffer(data,existing,cached,parentElement):cached}function diffArray(data,cached,nodes){forEach(data,function(_,i){null!=cached[i]&&nodes.push.apply(nodes,cached[i].nodes)}),forEach(cached.nodes,function(node,i){null!=node.parentNode&&nodes.indexOf(node)<0&&clear([node],[cached[i]])}),data.length<cached.length&&(cached.length=data.length),cached.nodes=nodes}function buildArrayKeys(data){var guid=0;forKeys(data,function(){return forEach(data,function(attrs){(attrs=attrs&&attrs.attrs)&&null==attrs.key&&(attrs.key="__mithril__"+guid++)}),1})}function isDifferentEnough(data,cached,dataAttrKeys){return data.tag!==cached.tag||(dataAttrKeys.sort().join()!==Object.keys(cached.attrs).sort().join()||(data.attrs.id!==cached.attrs.id||(data.attrs.key!==cached.attrs.key||("all"===m.redraw.strategy()?!cached.configContext||cached.configContext.retain!==!0:"diff"===m.redraw.strategy()&&(cached.configContext&&cached.configContext.retain===!1)))))}function maybeRecreateObject(data,cached,dataAttrKeys){isDifferentEnough(data,cached,dataAttrKeys)&&(cached.nodes.length&&clear(cached.nodes),cached.configContext&&isFunction(cached.configContext.onunload)&&cached.configContext.onunload(),cached.controllers&&forEach(cached.controllers,function(controller){controller.onunload&&controller.onunload({preventDefault:noop})}))}function getObjectNamespace(data,namespace){return data.attrs.xmlns?data.attrs.xmlns:"svg"===data.tag?"http://www.w3.org/2000/svg":"math"===data.tag?"http://www.w3.org/1998/Math/MathML":namespace}function unloadCachedControllers(cached,views,controllers){controllers.length&&(cached.views=views,cached.controllers=controllers,forEach(controllers,function(controller){if(controller.onunload&&controller.onunload.$old&&(controller.onunload=controller.onunload.$old),pendingRequests&&controller.onunload){var onunload=controller.onunload;controller.onunload=noop,controller.onunload.$old=onunload}}))}function scheduleConfigsToBeCalled(configs,data,node,isNew,cached){if(isFunction(data.attrs.config)){var context=cached.configContext=cached.configContext||{};configs.push(function(){return data.attrs.config.call(data,node,!isNew,context,cached)})}}function buildUpdatedNode(cached,data,editable,hasKeys,namespace,views,configs,controllers){var node=cached.nodes[0];return hasKeys&&setAttributes(node,data.tag,data.attrs,cached.attrs,namespace),cached.children=build(node,data.tag,undefined,undefined,data.children,cached.children,!1,0,data.attrs.contenteditable?node:editable,namespace,configs),cached.nodes.intact=!0,controllers.length&&(cached.views=views,cached.controllers=controllers),node}function handleNonexistentNodes(data,parentElement,index){var nodes;data.$trusted?nodes=injectHTML(parentElement,index,data):(nodes=[$document.createTextNode(data)],parentElement.nodeName in voidElements||insertNode(parentElement,nodes[0],index));var cached;return cached="string"==typeof data||"number"==typeof data||"boolean"==typeof data?new data.constructor(data):data,cached.nodes=nodes,cached}function reattachNodes(data,cached,parentElement,editable,index,parentTag){var nodes=cached.nodes;return editable&&editable===$document.activeElement||(data.$trusted?(clear(nodes,cached),nodes=injectHTML(parentElement,index,data)):"textarea"===parentTag?parentElement.value=data:editable?editable.innerHTML=data:((1===nodes[0].nodeType||nodes.length>1||nodes[0].nodeValue.trim&&!nodes[0].nodeValue.trim())&&(clear(cached.nodes,cached),nodes=[$document.createTextNode(data)]),injectTextNode(parentElement,nodes[0],index,data))),cached=new data.constructor(data),cached.nodes=nodes,cached}function handleTextNode(cached,data,index,parentElement,shouldReattach,editable,parentTag){return cached.nodes.length?cached.valueOf()!==data.valueOf()||shouldReattach?reattachNodes(data,cached,parentElement,editable,index,parentTag):(cached.nodes.intact=!0,cached):handleNonexistentNodes(data,parentElement,index)}function getSubArrayCount(item){if(item.$trusted){var match=item.match(/<[^\/]|\>\s*[^<]/g);if(null!=match)return match.length}else if(isArray(item))return item.length;return 1}function buildArray(data,cached,parentElement,index,parentTag,shouldReattach,editable,namespace,configs){data=flatten(data);var nodes=[],intact=cached.length===data.length,subArrayCount=0,existing={},shouldMaintainIdentities=!1;forKeys(cached,function(attrs,i){shouldMaintainIdentities=!0,existing[cached[i].attrs.key]={action:DELETION,index:i}}),buildArrayKeys(data),shouldMaintainIdentities&&(cached=diffKeys(data,cached,existing,parentElement));for(var cacheCount=0,i=0,len=data.length;i<len;i++){var item=build(parentElement,parentTag,cached,index,data[i],cached[cacheCount],shouldReattach,index+subArrayCount||subArrayCount,editable,namespace,configs);item!==undefined&&(intact=intact&&item.nodes.intact,subArrayCount+=getSubArrayCount(item),cached[cacheCount++]=item)}return intact||diffArray(data,cached,nodes),cached}function makeCache(data,cached,index,parentIndex,parentCache){if(null!=cached){if(type.call(cached)===type.call(data))return cached;if(parentCache&&parentCache.nodes){var offset=index-parentIndex,end=offset+(isArray(data)?data:cached.nodes).length;clear(parentCache.nodes.slice(offset,end),parentCache.slice(offset,end))}else cached.nodes&&clear(cached.nodes,cached)}return cached=new data.constructor,cached.tag&&(cached={}),cached.nodes=[],cached}function constructNode(data,namespace){return data.attrs.is?null==namespace?$document.createElement(data.tag,data.attrs.is):$document.createElementNS(namespace,data.tag,data.attrs.is):null==namespace?$document.createElement(data.tag):$document.createElementNS(namespace,data.tag)}function constructAttrs(data,node,namespace,hasKeys){return hasKeys?setAttributes(node,data.tag,data.attrs,{},namespace):data.attrs}function constructChildren(data,node,cached,editable,namespace,configs){return null!=data.children&&data.children.length>0?build(node,data.tag,undefined,undefined,data.children,cached.children,!0,0,data.attrs.contenteditable?node:editable,namespace,configs):data.children}function reconstructCached(data,attrs,children,node,namespace,views,controllers){var cached={tag:data.tag,attrs:attrs,children:children,nodes:[node]};return unloadCachedControllers(cached,views,controllers),cached.children&&!cached.children.nodes&&(cached.children.nodes=[]),"select"===data.tag&&"value"in data.attrs&&setAttributes(node,data.tag,{value:data.attrs.value},{},namespace),cached}function getController(views,view,cachedControllers,controller){var controllerIndex;return controllerIndex="diff"===m.redraw.strategy()&&views?views.indexOf(view):-1,controllerIndex>-1?cachedControllers[controllerIndex]:isFunction(controller)?new controller:{}}function updateLists(views,controllers,view,controller){null!=controller.onunload&&unloaders.map(function(u){return u.handler}).indexOf(controller.onunload)<0&&unloaders.push({controller:controller,handler:controller.onunload}),views.push(view),controllers.push(controller)}function checkView(data,view,cached,cachedControllers,controllers,views){var controller=getController(cached.views,view,cachedControllers,data.controller),key=data&&data.attrs&&data.attrs.key;return data=0===pendingRequests||forcing||cachedControllers&&cachedControllers.indexOf(controller)>-1?data.view(controller):{tag:"placeholder"},"retain"===data.subtree?data:(data.attrs=data.attrs||{},data.attrs.key=key,updateLists(views,controllers,view,controller),data)}function markViews(data,cached,views,controllers){for(var cachedControllers=cached&&cached.controllers;null!=data.view;)data=checkView(data,data.view.$original||data.view,cached,cachedControllers,controllers,views);return data}function buildObject(data,cached,editable,parentElement,index,shouldReattach,namespace,configs){var views=[],controllers=[];if(data=markViews(data,cached,views,controllers),"retain"===data.subtree)return cached;if(!data.tag&&controllers.length)throw new Error("Component template must return a virtual element, not an array, string, etc.");data.attrs=data.attrs||{},cached.attrs=cached.attrs||{};var dataAttrKeys=Object.keys(data.attrs),hasKeys=dataAttrKeys.length>("key"in data.attrs?1:0);if(maybeRecreateObject(data,cached,dataAttrKeys),isString(data.tag)){var isNew=0===cached.nodes.length;namespace=getObjectNamespace(data,namespace);var node;if(isNew){node=constructNode(data,namespace);var attrs=constructAttrs(data,node,namespace,hasKeys),children=constructChildren(data,node,cached,editable,namespace,configs);cached=reconstructCached(data,attrs,children,node,namespace,views,controllers)}else node=buildUpdatedNode(cached,data,editable,hasKeys,namespace,views,configs,controllers);return(isNew||shouldReattach===!0&&null!=node)&&insertNode(parentElement,node,index),scheduleConfigsToBeCalled(configs,data,node,isNew,cached),cached}}function build(parentElement,parentTag,parentCache,parentIndex,data,cached,shouldReattach,index,editable,namespace,configs){return data=dataToString(data),"retain"===data.subtree?cached:(cached=makeCache(data,cached,index,parentIndex,parentCache),isArray(data)?buildArray(data,cached,parentElement,index,parentTag,shouldReattach,editable,namespace,configs):null!=data&&isObject(data)?buildObject(data,cached,editable,parentElement,index,shouldReattach,namespace,configs):isFunction(data)?cached:handleTextNode(cached,data,index,parentElement,shouldReattach,editable,parentTag))}function sortChanges(a,b){return a.action-b.action||a.index-b.index}function copyStyleAttrs(node,dataAttr,cachedAttr){for(var rule in dataAttr)hasOwn.call(dataAttr,rule)&&(null!=cachedAttr&&cachedAttr[rule]===dataAttr[rule]||(node.style[rule]=dataAttr[rule]));for(rule in cachedAttr)hasOwn.call(cachedAttr,rule)&&(hasOwn.call(dataAttr,rule)||(node.style[rule]=""))}function setSingleAttr(node,attrName,dataAttr,cachedAttr,tag,namespace){if("config"===attrName||"key"===attrName)return!0;if(isFunction(dataAttr)&&"on"===attrName.slice(0,2))node[attrName]=autoredraw(dataAttr,node);else if("style"===attrName&&null!=dataAttr&&isObject(dataAttr))copyStyleAttrs(node,dataAttr,cachedAttr);else if(null!=namespace)"href"===attrName?node.setAttributeNS("http://www.w3.org/1999/xlink","href",dataAttr):node.setAttribute("className"===attrName?"class":attrName,dataAttr);else if(attrName in node&&!shouldUseSetAttribute[attrName])try{"input"===tag&&node[attrName]===dataAttr||(node[attrName]=dataAttr)}catch(e){node.setAttribute(attrName,dataAttr)}else node.setAttribute(attrName,dataAttr)}function trySetAttr(node,attrName,dataAttr,cachedAttr,cachedAttrs,tag,namespace){if(attrName in cachedAttrs&&cachedAttr===dataAttr)"value"===attrName&&"input"===tag&&node.value!==dataAttr&&(node.value=dataAttr);else{cachedAttrs[attrName]=dataAttr;try{return setSingleAttr(node,attrName,dataAttr,cachedAttr,tag,namespace)}catch(e){if(e.message.indexOf("Invalid argument")<0)throw e}}}function setAttributes(node,tag,dataAttrs,cachedAttrs,namespace){for(var attrName in dataAttrs)if(hasOwn.call(dataAttrs,attrName)&&trySetAttr(node,attrName,dataAttrs[attrName],cachedAttrs[attrName],cachedAttrs,tag,namespace))continue;return cachedAttrs}function clear(nodes,cached){for(var i=nodes.length-1;i>-1;i--)if(nodes[i]&&nodes[i].parentNode){try{nodes[i].parentNode.removeChild(nodes[i])}catch(e){}cached=[].concat(cached),cached[i]&&unload(cached[i])}nodes.length&&(nodes.length=0)}function unload(cached){cached.configContext&&isFunction(cached.configContext.onunload)&&(cached.configContext.onunload(),cached.configContext.onunload=null),cached.controllers&&forEach(cached.controllers,function(controller){isFunction(controller.onunload)&&controller.onunload({preventDefault:noop})}),cached.children&&(isArray(cached.children)?forEach(cached.children,unload):cached.children.tag&&unload(cached.children))}function appendTextFragment(parentElement,data){try{parentElement.appendChild($document.createRange().createContextualFragment(data))}catch(e){parentElement.insertAdjacentHTML("beforeend",data)}}function injectHTML(parentElement,index,data){var nextSibling=parentElement.childNodes[index];if(nextSibling){var isElement=1!==nextSibling.nodeType,placeholder=$document.createElement("span");isElement?(parentElement.insertBefore(placeholder,nextSibling||null),placeholder.insertAdjacentHTML("beforebegin",data),parentElement.removeChild(placeholder)):nextSibling.insertAdjacentHTML("beforebegin",data)}else appendTextFragment(parentElement,data);for(var nodes=[];parentElement.childNodes[index]!==nextSibling;)nodes.push(parentElement.childNodes[index]),index++;return nodes}function autoredraw(callback,object){return function(e){e=e||event,m.redraw.strategy("diff"),m.startComputation();try{return callback.call(object,e)}finally{endFirstComputation()}}}function getCellCacheKey(element){var index=nodeCache.indexOf(element);return index<0?nodeCache.push(element)-1:index}function gettersetter(store){function prop(){return arguments.length&&(store=arguments[0]),store}return prop.toJSON=function(){return store},prop}function parameterize(component,args){function controller(){return(component.controller||noop).apply(this,args)||this}function view(ctrl){for(var currentArgs=[ctrl].concat(args),i=1;i<arguments.length;i++)currentArgs.push(arguments[i]);return component.view.apply(component,currentArgs)}component.controller&&(controller.prototype=component.controller.prototype),view.$original=component.view;var output={controller:controller,view:view};return args[0]&&null!=args[0].key&&(output.attrs={key:args[0].key}),output}function checkPrevented(component,root,index,isPrevented){if(!isPrevented){m.redraw.strategy("all"),m.startComputation(),roots[index]=root;var currentComponent;currentComponent=topComponent=component?component:component={controller:noop};var controller=new(component.controller||noop);return currentComponent===topComponent&&(controllers[index]=controller,components[index]=component),endFirstComputation(),null===component&&removeRootElement(root,index),controllers[index]}null==component&&removeRootElement(root,index)}function removeRootElement(root,index){roots.splice(index,1),controllers.splice(index,1),components.splice(index,1),reset(root),nodeCache.splice(getCellCacheKey(root),1)}function redraw(){computePreRedrawHook&&(computePreRedrawHook(),computePreRedrawHook=null),forEach(roots,function(root,i){var component=components[i];if(controllers[i]){var args=[controllers[i]];m.render(root,component.view?component.view(controllers[i],args):"")}}),computePostRedrawHook&&(computePostRedrawHook(),computePostRedrawHook=null),lastRedrawId=null,lastRedrawCallTime=new Date,m.redraw.strategy("diff")}function endFirstComputation(){"none"===m.redraw.strategy()?(pendingRequests--,m.redraw.strategy("diff")):m.endComputation()}function normalizeRoute(route){return route.slice(modes[m.route.mode].length)}function routeByValue(root,router,path){routeParams={};var queryStart=path.indexOf("?");queryStart!==-1&&(routeParams=parseQueryString(path.substr(queryStart+1,path.length)),path=path.substr(0,queryStart));var keys=Object.keys(router),index=keys.indexOf(path);if(index!==-1)return m.mount(root,router[keys[index]]),!0;for(var route in router)if(hasOwn.call(router,route)){if(route===path)return m.mount(root,router[route]),!0;var matcher=new RegExp("^"+route.replace(/:[^\/]+?\.{3}/g,"(.*?)").replace(/:[^\/]+/g,"([^\\/]+)")+"/?$");if(matcher.test(path))return path.replace(matcher,function(){var keys=route.match(/:[^\/]+/g)||[],values=[].slice.call(arguments,1,-2);forEach(keys,function(key,i){routeParams[key.replace(/:|\./g,"")]=decodeURIComponent(values[i])}),m.mount(root,router[route])}),!0}}function routeUnobtrusive(e){if(e=e||event,!(e.ctrlKey||e.metaKey||e.shiftKey||2===e.which)){e.preventDefault?e.preventDefault():e.returnValue=!1;var args,currentTarget=e.currentTarget||e.srcElement;for(args="pathname"===m.route.mode&&currentTarget.search?parseQueryString(currentTarget.search.slice(1)):{};currentTarget&&!/a/i.test(currentTarget.nodeName);)currentTarget=currentTarget.parentNode;pendingRequests=0,m.route(currentTarget[m.route.mode].slice(modes[m.route.mode].length),args)}}function setScroll(){"hash"!==m.route.mode&&$location.hash?$location.hash=$location.hash:global.scrollTo(0,0)}function buildQueryString(object,prefix){var duplicates={},str=[];for(var prop in object)if(hasOwn.call(object,prop)){var key=prefix?prefix+"["+prop+"]":prop,value=object[prop];if(null===value)str.push(encodeURIComponent(key));else if(isObject(value))str.push(buildQueryString(value,key));else if(isArray(value)){var keys=[];duplicates[key]=duplicates[key]||{},forEach(value,function(item){duplicates[key][item]||(duplicates[key][item]=!0,keys.push(encodeURIComponent(key)+"="+encodeURIComponent(item)))}),str.push(keys.join("&"))}else value!==undefined&&str.push(encodeURIComponent(key)+"="+encodeURIComponent(value))}return str.join("&")}function parseQueryString(str){if(""===str||null==str)return{};"?"===str.charAt(0)&&(str=str.slice(1));var pairs=str.split("&"),params={};return forEach(pairs,function(string){var pair=string.split("="),key=decodeURIComponent(pair[0]),value=2===pair.length?decodeURIComponent(pair[1]):null;null!=params[key]?(isArray(params[key])||(params[key]=[params[key]]),params[key].push(value)):params[key]=value}),params}function reset(root){var cacheKey=getCellCacheKey(root);clear(root.childNodes,cellCache[cacheKey]),cellCache[cacheKey]=undefined}function propify(promise,initialValue){var prop=m.prop(initialValue);return promise.then(prop),prop.then=function(resolve,reject){return propify(promise.then(resolve,reject),initialValue)},prop.catch=prop.then.bind(null,null),prop}function Deferred(onSuccess,onFailure){function finish(type){state=type||REJECTED,next.map(function(deferred){state===RESOLVED?deferred.resolve(promiseValue):deferred.reject(promiseValue);
})}function thennable(then,success,failure,notThennable){if((null!=promiseValue&&isObject(promiseValue)||isFunction(promiseValue))&&isFunction(then))try{var count=0;then.call(promiseValue,function(value){count++||(promiseValue=value,success())},function(value){count++||(promiseValue=value,failure())})}catch(e){m.deferred.onerror(e),promiseValue=e,failure()}else notThennable()}function fire(){var then;try{then=promiseValue&&promiseValue.then}catch(e){return m.deferred.onerror(e),promiseValue=e,state=REJECTING,fire()}state===REJECTING&&m.deferred.onerror(promiseValue),thennable(then,function(){state=RESOLVING,fire()},function(){state=REJECTING,fire()},function(){try{state===RESOLVING&&isFunction(onSuccess)?promiseValue=onSuccess(promiseValue):state===REJECTING&&isFunction(onFailure)&&(promiseValue=onFailure(promiseValue),state=RESOLVING)}catch(e){return m.deferred.onerror(e),promiseValue=e,finish()}promiseValue===self?(promiseValue=TypeError(),finish()):thennable(then,function(){finish(RESOLVED)},finish,function(){finish(state===RESOLVING&&RESOLVED)})})}var self=this,state=0,promiseValue=0,next=[];self.promise={},self.resolve=function(value){return state||(promiseValue=value,state=RESOLVING,fire()),self},self.reject=function(value){return state||(promiseValue=value,state=REJECTING,fire()),self},self.promise.then=function(onSuccess,onFailure){var deferred=new Deferred(onSuccess,onFailure);return state===RESOLVED?deferred.resolve(promiseValue):state===REJECTED?deferred.reject(promiseValue):next.push(deferred),deferred.promise}}function identity(value){return value}function handleJsonp(options){var callbackKey="mithril_callback_"+(new Date).getTime()+"_"+Math.round(1e16*Math.random()).toString(36),script=$document.createElement("script");global[callbackKey]=function(resp){script.parentNode.removeChild(script),options.onload({type:"load",target:{responseText:resp}}),global[callbackKey]=undefined},script.onerror=function(){return script.parentNode.removeChild(script),options.onerror({type:"error",target:{status:500,responseText:JSON.stringify({error:"Error making jsonp request"})}}),global[callbackKey]=undefined,!1},script.onload=function(){return!1},script.src=options.url+(options.url.indexOf("?")>0?"&":"?")+(options.callbackKey?options.callbackKey:"callback")+"="+callbackKey+"&"+buildQueryString(options.data||{}),$document.body.appendChild(script)}function createXhr(options){var xhr=new global.XMLHttpRequest;if(xhr.open(options.method,options.url,!0,options.user,options.password),xhr.onreadystatechange=function(){4===xhr.readyState&&(xhr.status>=200&&xhr.status<300?options.onload({type:"load",target:xhr}):options.onerror({type:"error",target:xhr}))},options.serialize===JSON.stringify&&options.data&&"GET"!==options.method&&xhr.setRequestHeader("Content-Type","application/json; charset=utf-8"),options.deserialize===JSON.parse&&xhr.setRequestHeader("Accept","application/json, text/*"),isFunction(options.config)){var maybeXhr=options.config(xhr,options);null!=maybeXhr&&(xhr=maybeXhr)}var data="GET"!==options.method&&options.data?options.data:"";if(data&&!isString(data)&&data.constructor!==global.FormData)throw new Error("Request data should be either be a string or FormData. Check the `serialize` option in `m.request`");return xhr.send(data),xhr}function ajax(options){return options.dataType&&"jsonp"===options.dataType.toLowerCase()?handleJsonp(options):createXhr(options)}function bindData(options,data,serialize){if("GET"===options.method&&"jsonp"!==options.dataType){var prefix=options.url.indexOf("?")<0?"?":"&",querystring=buildQueryString(data);options.url+=querystring?prefix+querystring:""}else options.data=serialize(data)}function parameterizeUrl(url,data){return data&&(url=url.replace(/:[a-z]\w+/gi,function(token){var key=token.slice(1),value=data[key];return delete data[key],value})),url}m.version=function(){return"v0.2.3"};var $document,$location,$requestAnimationFrame,$cancelAnimationFrame,hasOwn={}.hasOwnProperty,type={}.toString,isArray=Array.isArray||function(object){return"[object Array]"===type.call(object)},voidElements={AREA:1,BASE:1,BR:1,COL:1,COMMAND:1,EMBED:1,HR:1,IMG:1,INPUT:1,KEYGEN:1,LINK:1,META:1,PARAM:1,SOURCE:1,TRACK:1,WBR:1};m.deps=function(mock){return initialize(global=mock||window),global},m.deps(global);var DELETION=1,INSERTION=2,MOVE=3,pendingRequests=0;m.startComputation=function(){pendingRequests++},m.endComputation=function(){pendingRequests>1?pendingRequests--:(pendingRequests=0,m.redraw())};var html,unloaders=[],forcing=!1,shouldUseSetAttribute={list:1,style:1,form:1,type:1,width:1,height:1},documentNode={appendChild:function(node){html===undefined&&(html=$document.createElement("html")),$document.documentElement&&$document.documentElement!==node?$document.replaceChild(node,$document.documentElement):$document.appendChild(node),this.childNodes=$document.childNodes},insertBefore:function(node){this.appendChild(node)},childNodes:[]},nodeCache=[],cellCache={};m.render=function(root,cell,forceRecreation){if(!root)throw new Error("Ensure the DOM element being passed to m.route/m.mount/m.render is not undefined.");var node,configs=[],id=getCellCacheKey(root),isDocumentRoot=root===$document;node=isDocumentRoot||root===$document.documentElement?documentNode:root,isDocumentRoot&&"html"!==cell.tag&&(cell={tag:"html",attrs:{},children:cell}),cellCache[id]===undefined&&clear(node.childNodes),forceRecreation===!0&&reset(root),cellCache[id]=build(node,null,undefined,undefined,cell,cellCache[id],!1,0,null,undefined,configs),forEach(configs,function(config){config()})},m.trust=function(value){return value=new String(value),value.$trusted=!0,value},m.prop=function(store){return(null!=store&&isObject(store)||isFunction(store))&&isFunction(store.then)?propify(store):gettersetter(store)};var topComponent,roots=[],components=[],controllers=[],lastRedrawId=null,lastRedrawCallTime=0,computePreRedrawHook=null,computePostRedrawHook=null,FRAME_BUDGET=16;m.component=function(component){var args=[].slice.call(arguments,1);return parameterize(component,args)},m.mount=m.module=function(root,component){if(!root)throw new Error("Please ensure the DOM element exists before rendering a template into it.");var index=roots.indexOf(root);index<0&&(index=roots.length);var isPrevented=!1,event={preventDefault:function(){isPrevented=!0,computePreRedrawHook=computePostRedrawHook=null}};return forEach(unloaders,function(unloader){unloader.handler.call(unloader.controller,event),unloader.controller.onunload=null}),isPrevented?forEach(unloaders,function(unloader){unloader.controller.onunload=unloader.handler}):unloaders=[],controllers[index]&&isFunction(controllers[index].onunload)&&controllers[index].onunload(event),checkPrevented(component,root,index,isPrevented)};var redrawing=!1;m.redraw=function(force){if(!redrawing){redrawing=!0,force&&(forcing=!0);try{lastRedrawId&&!force?($requestAnimationFrame===global.requestAnimationFrame||new Date-lastRedrawCallTime>FRAME_BUDGET)&&(lastRedrawId>0&&$cancelAnimationFrame(lastRedrawId),lastRedrawId=$requestAnimationFrame(redraw,FRAME_BUDGET)):(redraw(),lastRedrawId=$requestAnimationFrame(function(){lastRedrawId=null},FRAME_BUDGET))}finally{redrawing=forcing=!1}}},m.redraw.strategy=m.prop(),m.withAttr=function(prop,withAttrCallback,callbackThis){return function(e){e=e||event;var currentTarget=e.currentTarget||this,_this=callbackThis||this,target=prop in currentTarget?currentTarget[prop]:currentTarget.getAttribute(prop);withAttrCallback.call(_this,target)}};var routeParams,currentRoute,modes={pathname:"",hash:"#",search:"?"},redirect=noop,isDefaultRoute=!1;m.route=function(root,arg1,arg2,vdom){if(0===arguments.length)return currentRoute;if(3===arguments.length&&isString(arg1)){redirect=function(source){var path=currentRoute=normalizeRoute(source);if(!routeByValue(root,arg2,path)){if(isDefaultRoute)throw new Error("Ensure the default route matches one of the routes defined in m.route");isDefaultRoute=!0,m.route(arg1,!0),isDefaultRoute=!1}};var listener="hash"===m.route.mode?"onhashchange":"onpopstate";return global[listener]=function(){var path=$location[m.route.mode];"pathname"===m.route.mode&&(path+=$location.search),currentRoute!==normalizeRoute(path)&&redirect(path)},computePreRedrawHook=setScroll,void global[listener]()}if(root.addEventListener||root.attachEvent){var base="pathname"!==m.route.mode?$location.pathname:"";return root.href=base+modes[m.route.mode]+vdom.attrs.href,void(root.addEventListener?(root.removeEventListener("click",routeUnobtrusive),root.addEventListener("click",routeUnobtrusive)):(root.detachEvent("onclick",routeUnobtrusive),root.attachEvent("onclick",routeUnobtrusive)))}if(isString(root)){var oldRoute=currentRoute;currentRoute=root;var params,args=arg1||{},queryIndex=currentRoute.indexOf("?");params=queryIndex>-1?parseQueryString(currentRoute.slice(queryIndex+1)):{};for(var i in args)hasOwn.call(args,i)&&(params[i]=args[i]);var currentPath,querystring=buildQueryString(params);currentPath=queryIndex>-1?currentRoute.slice(0,queryIndex):currentRoute,querystring&&(currentRoute=currentPath+(currentPath.indexOf("?")===-1?"?":"&")+querystring);var replaceHistory=(3===arguments.length?arg2:arg1)===!0||oldRoute===root;if(global.history.pushState){var method=replaceHistory?"replaceState":"pushState";computePreRedrawHook=setScroll,computePostRedrawHook=function(){global.history[method](null,$document.title,modes[m.route.mode]+currentRoute)},redirect(modes[m.route.mode]+currentRoute)}else $location[m.route.mode]=currentRoute,redirect(modes[m.route.mode]+currentRoute)}},m.route.param=function(key){if(!routeParams)throw new Error("You must call m.route(element, defaultRoute, routes) before calling m.route.param()");return key?routeParams[key]:routeParams},m.route.mode="search",m.route.buildQueryString=buildQueryString,m.route.parseQueryString=parseQueryString,m.deferred=function(){var deferred=new Deferred;return deferred.promise=propify(deferred.promise),deferred};var RESOLVING=1,REJECTING=2,RESOLVED=3,REJECTED=4;return m.deferred.onerror=function(e){if("[object Error]"===type.call(e)&&!/ Error/.test(e.constructor.toString()))throw pendingRequests=0,e},m.sync=function(args){function synchronizer(pos,resolved){return function(value){return results[pos]=value,resolved||(method="reject"),0===--outstanding&&(deferred.promise(results),deferred[method](results)),value}}var deferred=m.deferred(),outstanding=args.length,results=new Array(outstanding),method="resolve";return args.length>0?forEach(args,function(arg,i){arg.then(synchronizer(i,!0),synchronizer(i,!1))}):deferred.resolve([]),deferred.promise},m.request=function(options){options.background!==!0&&m.startComputation();var serialize,deserialize,extract,deferred=new Deferred,isJSONP=options.dataType&&"jsonp"===options.dataType.toLowerCase();return isJSONP?(serialize=options.serialize=deserialize=options.deserialize=identity,extract=function(jsonp){return jsonp.responseText}):(serialize=options.serialize=options.serialize||JSON.stringify,deserialize=options.deserialize=options.deserialize||JSON.parse,extract=options.extract||function(xhr){return xhr.responseText.length||deserialize!==JSON.parse?xhr.responseText:null}),options.method=(options.method||"GET").toUpperCase(),options.url=parameterizeUrl(options.url,options.data),bindData(options,options.data,serialize),options.onload=options.onerror=function(ev){try{ev=ev||event;var response=deserialize(extract(ev.target,options));"load"===ev.type?(options.unwrapSuccess&&(response=options.unwrapSuccess(response,ev.target)),isArray(response)&&options.type?forEach(response,function(res,i){response[i]=new options.type(res)}):options.type&&(response=new options.type(response)),deferred.resolve(response)):(options.unwrapError&&(response=options.unwrapError(response,ev.target)),deferred.reject(response))}catch(e){deferred.reject(e)}finally{options.background!==!0&&m.endComputation()}},ajax(options),deferred.promise=propify(deferred.promise,options.initialValue),deferred.promise},m}),function(factory){"function"==typeof define&&define.amd?define(["mithril"],factory):"object"==typeof exports?module.exports=factory(require("mithril")):factory(m)}(function(m){function bidi(node,prop){var type="select"===node.tag?node.attrs.multi?"multi":"select":node.attrs.type;return"multi"===type?node.attrs.onchange=function(){prop([].slice.call(this.selectedOptions,function(x){return x.value}))}:"select"===type?node.attrs.onchange=function(e){prop(this.selectedOptions[0].value)}:"checkbox"===type?node.attrs.onchange=function(e){prop(this.checked)}:node.attrs.onchange=node.attrs.oninput=function(e){prop(this.value)},"select"===node.tag?node.children.forEach(function(option){option.attrs.value!==prop()&&option.children[0]!==prop()||(option.attrs.selected=!0)}):"checkbox"===type?node.attrs.checked=prop():"radio"===type?node.attrs.checked=prop()===node.attrs.value:node.attrs.value=prop(),node}return bidi.view=function(ctrl,node,prop){return bidi(node,node.attrs.bidi)},m.attrs&&(m.attrs.bidi=bidi),m.bidi=bidi,bidi}),function(global,factory){"object"==typeof module&&"object"==typeof module.exports?module.exports=global.document?factory(global,!0):function(w){if(!w.document)throw new Error("jQuery requires a window with a document");return factory(w)}:factory(global)}("undefined"!=typeof window?window:this,function(window,noGlobal){function isArraylike(obj){var length="length"in obj&&obj.length,type=jQuery.type(obj);return"function"!==type&&!jQuery.isWindow(obj)&&(!(1!==obj.nodeType||!length)||("array"===type||0===length||"number"==typeof length&&length>0&&length-1 in obj))}function winnow(elements,qualifier,not){if(jQuery.isFunction(qualifier))return jQuery.grep(elements,function(elem,i){return!!qualifier.call(elem,i,elem)!==not});if(qualifier.nodeType)return jQuery.grep(elements,function(elem){return elem===qualifier!==not});if("string"==typeof qualifier){if(risSimple.test(qualifier))return jQuery.filter(qualifier,elements,not);qualifier=jQuery.filter(qualifier,elements)}return jQuery.grep(elements,function(elem){return indexOf.call(qualifier,elem)>=0!==not})}function sibling(cur,dir){for(;(cur=cur[dir])&&1!==cur.nodeType;);return cur}function createOptions(options){var object=optionsCache[options]={};return jQuery.each(options.match(rnotwhite)||[],function(_,flag){object[flag]=!0}),object}function completed(){document.removeEventListener("DOMContentLoaded",completed,!1),window.removeEventListener("load",completed,!1),jQuery.ready()}function Data(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=jQuery.expando+Data.uid++}function dataAttr(elem,key,data){var name;if(void 0===data&&1===elem.nodeType)if(name="data-"+key.replace(rmultiDash,"-$1").toLowerCase(),data=elem.getAttribute(name),"string"==typeof data){try{data="true"===data||"false"!==data&&("null"===data?null:+data+""===data?+data:rbrace.test(data)?jQuery.parseJSON(data):data)}catch(e){}data_user.set(elem,key,data)}else data=void 0;return data}function returnTrue(){return!0}function returnFalse(){return!1}function safeActiveElement(){try{return document.activeElement}catch(err){}}function manipulationTarget(elem,content){return jQuery.nodeName(elem,"table")&&jQuery.nodeName(11!==content.nodeType?content:content.firstChild,"tr")?elem.getElementsByTagName("tbody")[0]||elem.appendChild(elem.ownerDocument.createElement("tbody")):elem}function disableScript(elem){return elem.type=(null!==elem.getAttribute("type"))+"/"+elem.type,elem}function restoreScript(elem){var match=rscriptTypeMasked.exec(elem.type);return match?elem.type=match[1]:elem.removeAttribute("type"),elem}function setGlobalEval(elems,refElements){for(var i=0,l=elems.length;i<l;i++)data_priv.set(elems[i],"globalEval",!refElements||data_priv.get(refElements[i],"globalEval"))}function cloneCopyEvent(src,dest){var i,l,type,pdataOld,pdataCur,udataOld,udataCur,events;if(1===dest.nodeType){if(data_priv.hasData(src)&&(pdataOld=data_priv.access(src),pdataCur=data_priv.set(dest,pdataOld),events=pdataOld.events)){delete pdataCur.handle,pdataCur.events={};for(type in events)for(i=0,l=events[type].length;i<l;i++)jQuery.event.add(dest,type,events[type][i])}data_user.hasData(src)&&(udataOld=data_user.access(src),udataCur=jQuery.extend({},udataOld),data_user.set(dest,udataCur))}}function getAll(context,tag){var ret=context.getElementsByTagName?context.getElementsByTagName(tag||"*"):context.querySelectorAll?context.querySelectorAll(tag||"*"):[];return void 0===tag||tag&&jQuery.nodeName(context,tag)?jQuery.merge([context],ret):ret}function fixInput(src,dest){var nodeName=dest.nodeName.toLowerCase();"input"===nodeName&&rcheckableType.test(src.type)?dest.checked=src.checked:"input"!==nodeName&&"textarea"!==nodeName||(dest.defaultValue=src.defaultValue)}function actualDisplay(name,doc){var style,elem=jQuery(doc.createElement(name)).appendTo(doc.body),display=window.getDefaultComputedStyle&&(style=window.getDefaultComputedStyle(elem[0]))?style.display:jQuery.css(elem[0],"display");return elem.detach(),display}function defaultDisplay(nodeName){var doc=document,display=elemdisplay[nodeName];return display||(display=actualDisplay(nodeName,doc),"none"!==display&&display||(iframe=(iframe||jQuery("<iframe frameborder='0' width='0' height='0'/>")).appendTo(doc.documentElement),doc=iframe[0].contentDocument,doc.write(),doc.close(),display=actualDisplay(nodeName,doc),iframe.detach()),elemdisplay[nodeName]=display),display}function curCSS(elem,name,computed){var width,minWidth,maxWidth,ret,style=elem.style;return computed=computed||getStyles(elem),computed&&(ret=computed.getPropertyValue(name)||computed[name]),computed&&(""!==ret||jQuery.contains(elem.ownerDocument,elem)||(ret=jQuery.style(elem,name)),rnumnonpx.test(ret)&&rmargin.test(name)&&(width=style.width,minWidth=style.minWidth,maxWidth=style.maxWidth,style.minWidth=style.maxWidth=style.width=ret,ret=computed.width,style.width=width,style.minWidth=minWidth,style.maxWidth=maxWidth)),void 0!==ret?ret+"":ret}function addGetHookIf(conditionFn,hookFn){return{get:function(){return conditionFn()?void delete this.get:(this.get=hookFn).apply(this,arguments)}}}function vendorPropName(style,name){if(name in style)return name;for(var capName=name[0].toUpperCase()+name.slice(1),origName=name,i=cssPrefixes.length;i--;)if(name=cssPrefixes[i]+capName,name in style)return name;return origName}function setPositiveNumber(elem,value,subtract){var matches=rnumsplit.exec(value);return matches?Math.max(0,matches[1]-(subtract||0))+(matches[2]||"px"):value}function augmentWidthOrHeight(elem,name,extra,isBorderBox,styles){for(var i=extra===(isBorderBox?"border":"content")?4:"width"===name?1:0,val=0;i<4;i+=2)"margin"===extra&&(val+=jQuery.css(elem,extra+cssExpand[i],!0,styles)),isBorderBox?("content"===extra&&(val-=jQuery.css(elem,"padding"+cssExpand[i],!0,styles)),"margin"!==extra&&(val-=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles))):(val+=jQuery.css(elem,"padding"+cssExpand[i],!0,styles),"padding"!==extra&&(val+=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles)));return val}function getWidthOrHeight(elem,name,extra){var valueIsBorderBox=!0,val="width"===name?elem.offsetWidth:elem.offsetHeight,styles=getStyles(elem),isBorderBox="border-box"===jQuery.css(elem,"boxSizing",!1,styles);if(val<=0||null==val){if(val=curCSS(elem,name,styles),(val<0||null==val)&&(val=elem.style[name]),rnumnonpx.test(val))return val;valueIsBorderBox=isBorderBox&&(support.boxSizingReliable()||val===elem.style[name]),val=parseFloat(val)||0}return val+augmentWidthOrHeight(elem,name,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles)+"px"}function showHide(elements,show){for(var display,elem,hidden,values=[],index=0,length=elements.length;index<length;index++)elem=elements[index],elem.style&&(values[index]=data_priv.get(elem,"olddisplay"),display=elem.style.display,show?(values[index]||"none"!==display||(elem.style.display=""),""===elem.style.display&&isHidden(elem)&&(values[index]=data_priv.access(elem,"olddisplay",defaultDisplay(elem.nodeName)))):(hidden=isHidden(elem),"none"===display&&hidden||data_priv.set(elem,"olddisplay",hidden?display:jQuery.css(elem,"display"))));for(index=0;index<length;index++)elem=elements[index],elem.style&&(show&&"none"!==elem.style.display&&""!==elem.style.display||(elem.style.display=show?values[index]||"":"none"));return elements}function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing)}function createFxNow(){return setTimeout(function(){fxNow=void 0}),fxNow=jQuery.now()}function genFx(type,includeWidth){var which,i=0,attrs={height:type};for(includeWidth=includeWidth?1:0;i<4;i+=2-includeWidth)which=cssExpand[i],attrs["margin"+which]=attrs["padding"+which]=type;return includeWidth&&(attrs.opacity=attrs.width=type),attrs}function createTween(value,prop,animation){for(var tween,collection=(tweeners[prop]||[]).concat(tweeners["*"]),index=0,length=collection.length;index<length;index++)if(tween=collection[index].call(animation,prop,value))return tween}function defaultPrefilter(elem,props,opts){var prop,value,toggle,tween,hooks,oldfire,display,checkDisplay,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHidden(elem),dataShow=data_priv.get(elem,"fxshow");opts.queue||(hooks=jQuery._queueHooks(elem,"fx"),null==hooks.unqueued&&(hooks.unqueued=0,oldfire=hooks.empty.fire,hooks.empty.fire=function(){hooks.unqueued||oldfire()}),hooks.unqueued++,anim.always(function(){anim.always(function(){hooks.unqueued--,jQuery.queue(elem,"fx").length||hooks.empty.fire()})})),1===elem.nodeType&&("height"in props||"width"in props)&&(opts.overflow=[style.overflow,style.overflowX,style.overflowY],display=jQuery.css(elem,"display"),checkDisplay="none"===display?data_priv.get(elem,"olddisplay")||defaultDisplay(elem.nodeName):display,"inline"===checkDisplay&&"none"===jQuery.css(elem,"float")&&(style.display="inline-block")),opts.overflow&&(style.overflow="hidden",anim.always(function(){style.overflow=opts.overflow[0],style.overflowX=opts.overflow[1],style.overflowY=opts.overflow[2]}));for(prop in props)if(value=props[prop],rfxtypes.exec(value)){if(delete props[prop],toggle=toggle||"toggle"===value,value===(hidden?"hide":"show")){if("show"!==value||!dataShow||void 0===dataShow[prop])continue;hidden=!0}orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop)}else display=void 0;if(jQuery.isEmptyObject(orig))"inline"===("none"===display?defaultDisplay(elem.nodeName):display)&&(style.display=display);else{dataShow?"hidden"in dataShow&&(hidden=dataShow.hidden):dataShow=data_priv.access(elem,"fxshow",{}),toggle&&(dataShow.hidden=!hidden),hidden?jQuery(elem).show():anim.done(function(){jQuery(elem).hide()}),anim.done(function(){var prop;data_priv.remove(elem,"fxshow");for(prop in orig)jQuery.style(elem,prop,orig[prop])});for(prop in orig)tween=createTween(hidden?dataShow[prop]:0,prop,anim),prop in dataShow||(dataShow[prop]=tween.start,hidden&&(tween.end=tween.start,tween.start="width"===prop||"height"===prop?1:0))}}function propFilter(props,specialEasing){var index,name,easing,value,hooks;for(index in props)if(name=jQuery.camelCase(index),easing=specialEasing[name],value=props[index],jQuery.isArray(value)&&(easing=value[1],value=props[index]=value[0]),index!==name&&(props[name]=value,delete props[index]),hooks=jQuery.cssHooks[name],hooks&&"expand"in hooks){value=hooks.expand(value),delete props[name];for(index in value)index in props||(props[index]=value[index],specialEasing[index]=easing)}else specialEasing[name]=easing}function Animation(elem,properties,options){var result,stopped,index=0,length=animationPrefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem}),tick=function(){if(stopped)return!1;for(var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),temp=remaining/animation.duration||0,percent=1-temp,index=0,length=animation.tweens.length;index<length;index++)animation.tweens[index].run(percent);return deferred.notifyWith(elem,[animation,percent,remaining]),percent<1&&length?remaining:(deferred.resolveWith(elem,[animation]),!1)},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(!0,{specialEasing:{}},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);return animation.tweens.push(tween),tween},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped)return this;for(stopped=!0;index<length;index++)animation.tweens[index].run(1);return gotoEnd?deferred.resolveWith(elem,[animation,gotoEnd]):deferred.rejectWith(elem,[animation,gotoEnd]),this}}),props=animation.props;for(propFilter(props,animation.opts.specialEasing);index<length;index++)if(result=animationPrefilters[index].call(animation,elem,props,animation.opts))return result;return jQuery.map(props,createTween,animation),jQuery.isFunction(animation.opts.start)&&animation.opts.start.call(elem,animation),jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue})),animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always)}function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){"string"!=typeof dataTypeExpression&&(func=dataTypeExpression,dataTypeExpression="*");var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(rnotwhite)||[];if(jQuery.isFunction(func))for(;dataType=dataTypes[i++];)"+"===dataType[0]?(dataType=dataType.slice(1)||"*",(structure[dataType]=structure[dataType]||[]).unshift(func)):(structure[dataType]=structure[dataType]||[]).push(func)}}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){function inspect(dataType){var selected;return inspected[dataType]=!0,jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);return"string"!=typeof dataTypeOrTransport||seekingTransport||inspected[dataTypeOrTransport]?seekingTransport?!(selected=dataTypeOrTransport):void 0:(options.dataTypes.unshift(dataTypeOrTransport),inspect(dataTypeOrTransport),!1)}),selected}var inspected={},seekingTransport=structure===transports;return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*")}function ajaxExtend(target,src){var key,deep,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src)void 0!==src[key]&&((flatOptions[key]?target:deep||(deep={}))[key]=src[key]);return deep&&jQuery.extend(!0,target,deep),target}function ajaxHandleResponses(s,jqXHR,responses){for(var ct,type,finalDataType,firstDataType,contents=s.contents,dataTypes=s.dataTypes;"*"===dataTypes[0];)dataTypes.shift(),void 0===ct&&(ct=s.mimeType||jqXHR.getResponseHeader("Content-Type"));if(ct)for(type in contents)if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break}if(dataTypes[0]in responses)finalDataType=dataTypes[0];else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}firstDataType||(firstDataType=type)}finalDataType=finalDataType||firstDataType}if(finalDataType)return finalDataType!==dataTypes[0]&&dataTypes.unshift(finalDataType),responses[finalDataType]}function ajaxConvert(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters={},dataTypes=s.dataTypes.slice();if(dataTypes[1])for(conv in s.converters)converters[conv.toLowerCase()]=s.converters[conv];for(current=dataTypes.shift();current;)if(s.responseFields[current]&&(jqXHR[s.responseFields[current]]=response),!prev&&isSuccess&&s.dataFilter&&(response=s.dataFilter(response,s.dataType)),prev=current,current=dataTypes.shift())if("*"===current)current=prev;else if("*"!==prev&&prev!==current){if(conv=converters[prev+" "+current]||converters["* "+current],!conv)for(conv2 in converters)if(tmp=conv2.split(" "),tmp[1]===current&&(conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]])){conv===!0?conv=converters[conv2]:converters[conv2]!==!0&&(current=tmp[0],dataTypes.unshift(tmp[1]));break}if(conv!==!0)if(conv&&s.throws)response=conv(response);else try{response=conv(response)}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current}}}return{state:"success",data:response}}function buildParams(prefix,obj,traditional,add){var name;if(jQuery.isArray(obj))jQuery.each(obj,function(i,v){traditional||rbracket.test(prefix)?add(prefix,v):buildParams(prefix+"["+("object"==typeof v?i:"")+"]",v,traditional,add)});else if(traditional||"object"!==jQuery.type(obj))add(prefix,obj);else for(name in obj)buildParams(prefix+"["+name+"]",obj[name],traditional,add)}function getWindow(elem){return jQuery.isWindow(elem)?elem:9===elem.nodeType&&elem.defaultView}var arr=[],slice=arr.slice,concat=arr.concat,push=arr.push,indexOf=arr.indexOf,class2type={},toString=class2type.toString,hasOwn=class2type.hasOwnProperty,support={},document=window.document,version="2.1.4",jQuery=function(selector,context){return new jQuery.fn.init(selector,context)},rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rmsPrefix=/^-ms-/,rdashAlpha=/-([\da-z])/gi,fcamelCase=function(all,letter){return letter.toUpperCase()};jQuery.fn=jQuery.prototype={jquery:version,constructor:jQuery,selector:"",length:0,toArray:function(){return slice.call(this)},get:function(num){return null!=num?num<0?this[num+this.length]:this[num]:slice.call(this)},pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);return ret.prevObject=this,ret.context=this.context,ret},each:function(callback,args){return jQuery.each(this,callback,args)},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},slice:function(){return this.pushStack(slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(i){var len=this.length,j=+i+(i<0?len:0);return this.pushStack(j>=0&&j<len?[this[j]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:push,sort:arr.sort,splice:arr.splice},jQuery.extend=jQuery.fn.extend=function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=!1;for("boolean"==typeof target&&(deep=target,target=arguments[i]||{},i++),"object"==typeof target||jQuery.isFunction(target)||(target={}),i===length&&(target=this,i--);i<length;i++)if(null!=(options=arguments[i]))for(name in options)src=target[name],copy=options[name],target!==copy&&(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))?(copyIsArray?(copyIsArray=!1,clone=src&&jQuery.isArray(src)?src:[]):clone=src&&jQuery.isPlainObject(src)?src:{},target[name]=jQuery.extend(deep,clone,copy)):void 0!==copy&&(target[name]=copy));return target},jQuery.extend({expando:"jQuery"+(version+Math.random()).replace(/\D/g,""),isReady:!0,error:function(msg){throw new Error(msg)},noop:function(){},isFunction:function(obj){return"function"===jQuery.type(obj)},isArray:Array.isArray,isWindow:function(obj){return null!=obj&&obj===obj.window},isNumeric:function(obj){return!jQuery.isArray(obj)&&obj-parseFloat(obj)+1>=0},isPlainObject:function(obj){return"object"===jQuery.type(obj)&&!obj.nodeType&&!jQuery.isWindow(obj)&&!(obj.constructor&&!hasOwn.call(obj.constructor.prototype,"isPrototypeOf"))},isEmptyObject:function(obj){var name;for(name in obj)return!1;return!0},type:function(obj){return null==obj?obj+"":"object"==typeof obj||"function"==typeof obj?class2type[toString.call(obj)]||"object":typeof obj},globalEval:function(code){var script,indirect=eval;code=jQuery.trim(code),code&&(1===code.indexOf("use strict")?(script=document.createElement("script"),script.text=code,document.head.appendChild(script).parentNode.removeChild(script)):indirect(code));
},camelCase:function(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)},nodeName:function(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase()},each:function(obj,callback,args){var value,i=0,length=obj.length,isArray=isArraylike(obj);if(args){if(isArray)for(;i<length&&(value=callback.apply(obj[i],args),value!==!1);i++);else for(i in obj)if(value=callback.apply(obj[i],args),value===!1)break}else if(isArray)for(;i<length&&(value=callback.call(obj[i],i,obj[i]),value!==!1);i++);else for(i in obj)if(value=callback.call(obj[i],i,obj[i]),value===!1)break;return obj},trim:function(text){return null==text?"":(text+"").replace(rtrim,"")},makeArray:function(arr,results){var ret=results||[];return null!=arr&&(isArraylike(Object(arr))?jQuery.merge(ret,"string"==typeof arr?[arr]:arr):push.call(ret,arr)),ret},inArray:function(elem,arr,i){return null==arr?-1:indexOf.call(arr,elem,i)},merge:function(first,second){for(var len=+second.length,j=0,i=first.length;j<len;j++)first[i++]=second[j];return first.length=i,first},grep:function(elems,callback,invert){for(var callbackInverse,matches=[],i=0,length=elems.length,callbackExpect=!invert;i<length;i++)callbackInverse=!callback(elems[i],i),callbackInverse!==callbackExpect&&matches.push(elems[i]);return matches},map:function(elems,callback,arg){var value,i=0,length=elems.length,isArray=isArraylike(elems),ret=[];if(isArray)for(;i<length;i++)value=callback(elems[i],i,arg),null!=value&&ret.push(value);else for(i in elems)value=callback(elems[i],i,arg),null!=value&&ret.push(value);return concat.apply([],ret)},guid:1,proxy:function(fn,context){var tmp,args,proxy;if("string"==typeof context&&(tmp=fn[context],context=fn,fn=tmp),jQuery.isFunction(fn))return args=slice.call(arguments,2),proxy=function(){return fn.apply(context||this,args.concat(slice.call(arguments)))},proxy.guid=fn.guid=fn.guid||jQuery.guid++,proxy},now:Date.now,support:support}),jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()});var Sizzle=function(window){function Sizzle(selector,context,results,seed){var match,elem,m,nodeType,i,groups,old,nid,newContext,newSelector;if((context?context.ownerDocument||context:preferredDoc)!==document&&setDocument(context),context=context||document,results=results||[],nodeType=context.nodeType,"string"!=typeof selector||!selector||1!==nodeType&&9!==nodeType&&11!==nodeType)return results;if(!seed&&documentIsHTML){if(11!==nodeType&&(match=rquickExpr.exec(selector)))if(m=match[1]){if(9===nodeType){if(elem=context.getElementById(m),!elem||!elem.parentNode)return results;if(elem.id===m)return results.push(elem),results}else if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&contains(context,elem)&&elem.id===m)return results.push(elem),results}else{if(match[2])return push.apply(results,context.getElementsByTagName(selector)),results;if((m=match[3])&&support.getElementsByClassName)return push.apply(results,context.getElementsByClassName(m)),results}if(support.qsa&&(!rbuggyQSA||!rbuggyQSA.test(selector))){if(nid=old=expando,newContext=context,newSelector=1!==nodeType&&selector,1===nodeType&&"object"!==context.nodeName.toLowerCase()){for(groups=tokenize(selector),(old=context.getAttribute("id"))?nid=old.replace(rescape,"\\$&"):context.setAttribute("id",nid),nid="[id='"+nid+"'] ",i=groups.length;i--;)groups[i]=nid+toSelector(groups[i]);newContext=rsibling.test(selector)&&testContext(context.parentNode)||context,newSelector=groups.join(",")}if(newSelector)try{return push.apply(results,newContext.querySelectorAll(newSelector)),results}catch(qsaError){}finally{old||context.removeAttribute("id")}}}return select(selector.replace(rtrim,"$1"),context,results,seed)}function createCache(){function cache(key,value){return keys.push(key+" ")>Expr.cacheLength&&delete cache[keys.shift()],cache[key+" "]=value}var keys=[];return cache}function markFunction(fn){return fn[expando]=!0,fn}function assert(fn){var div=document.createElement("div");try{return!!fn(div)}catch(e){return!1}finally{div.parentNode&&div.parentNode.removeChild(div),div=null}}function addHandle(attrs,handler){for(var arr=attrs.split("|"),i=attrs.length;i--;)Expr.attrHandle[arr[i]]=handler}function siblingCheck(a,b){var cur=b&&a,diff=cur&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||MAX_NEGATIVE)-(~a.sourceIndex||MAX_NEGATIVE);if(diff)return diff;if(cur)for(;cur=cur.nextSibling;)if(cur===b)return-1;return a?1:-1}function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&elem.type===type}}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return("input"===name||"button"===name)&&elem.type===type}}function createPositionalPseudo(fn){return markFunction(function(argument){return argument=+argument,markFunction(function(seed,matches){for(var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;i--;)seed[j=matchIndexes[i]]&&(seed[j]=!(matches[j]=seed[j]))})})}function testContext(context){return context&&"undefined"!=typeof context.getElementsByTagName&&context}function setFilters(){}function toSelector(tokens){for(var i=0,len=tokens.length,selector="";i<len;i++)selector+=tokens[i].value;return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,checkNonElements=base&&"parentNode"===dir,doneName=done++;return combinator.first?function(elem,context,xml){for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)return matcher(elem,context,xml)}:function(elem,context,xml){var oldCache,outerCache,newCache=[dirruns,doneName];if(xml){for(;elem=elem[dir];)if((1===elem.nodeType||checkNonElements)&&matcher(elem,context,xml))return!0}else for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements){if(outerCache=elem[expando]||(elem[expando]={}),(oldCache=outerCache[dir])&&oldCache[0]===dirruns&&oldCache[1]===doneName)return newCache[2]=oldCache[2];if(outerCache[dir]=newCache,newCache[2]=matcher(elem,context,xml))return!0}}}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){for(var i=matchers.length;i--;)if(!matchers[i](elem,context,xml))return!1;return!0}:matchers[0]}function multipleContexts(selector,contexts,results){for(var i=0,len=contexts.length;i<len;i++)Sizzle(selector,contexts[i],results);return results}function condense(unmatched,map,filter,context,xml){for(var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=null!=map;i<len;i++)(elem=unmatched[i])&&(filter&&!filter(elem,context,xml)||(newUnmatched.push(elem),mapped&&map.push(i)));return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){return postFilter&&!postFilter[expando]&&(postFilter=setMatcher(postFilter)),postFinder&&!postFinder[expando]&&(postFinder=setMatcher(postFinder,postSelector)),markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=!preFilter||!seed&&selector?elems:condense(elems,preMap,preFilter,context,xml),matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher&&matcher(matcherIn,matcherOut,context,xml),postFilter)for(temp=condense(matcherOut,postMap),postFilter(temp,[],context,xml),i=temp.length;i--;)(elem=temp[i])&&(matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem));if(seed){if(postFinder||preFilter){if(postFinder){for(temp=[],i=matcherOut.length;i--;)(elem=matcherOut[i])&&temp.push(matcherIn[i]=elem);postFinder(null,matcherOut=[],temp,xml)}for(i=matcherOut.length;i--;)(elem=matcherOut[i])&&(temp=postFinder?indexOf(seed,elem):preMap[i])>-1&&(seed[temp]=!(results[temp]=elem))}}else matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut),postFinder?postFinder(null,results,matcherOut,xml):push.apply(results,matcherOut)})}function matcherFromTokens(tokens){for(var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,!0),matchAnyContext=addCombinator(function(elem){return indexOf(checkContext,elem)>-1},implicitRelative,!0),matchers=[function(elem,context,xml){var ret=!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml));return checkContext=null,ret}];i<len;i++)if(matcher=Expr.relative[tokens[i].type])matchers=[addCombinator(elementMatcher(matchers),matcher)];else{if(matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches),matcher[expando]){for(j=++i;j<len&&!Expr.relative[tokens[j].type];j++);return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:" "===tokens[i-2].type?"*":""})).replace(rtrim,"$1"),matcher,i<j&&matcherFromTokens(tokens.slice(i,j)),j<len&&matcherFromTokens(tokens=tokens.slice(j)),j<len&&toSelector(tokens))}matchers.push(matcher)}return elementMatcher(matchers)}function matcherFromGroupMatchers(elementMatchers,setMatchers){var bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find.TAG("*",outermost),dirrunsUnique=dirruns+=null==contextBackup?1:Math.random()||.1,len=elems.length;for(outermost&&(outermostContext=context!==document&&context);i!==len&&null!=(elem=elems[i]);i++){if(byElement&&elem){for(j=0;matcher=elementMatchers[j++];)if(matcher(elem,context,xml)){results.push(elem);break}outermost&&(dirruns=dirrunsUnique)}bySet&&((elem=!matcher&&elem)&&matchedCount--,seed&&unmatched.push(elem))}if(matchedCount+=i,bySet&&i!==matchedCount){for(j=0;matcher=setMatchers[j++];)matcher(unmatched,setMatched,context,xml);if(seed){if(matchedCount>0)for(;i--;)unmatched[i]||setMatched[i]||(setMatched[i]=pop.call(results));setMatched=condense(setMatched)}push.apply(results,setMatched),outermost&&!seed&&setMatched.length>0&&matchedCount+setMatchers.length>1&&Sizzle.uniqueSort(results)}return outermost&&(dirruns=dirrunsUnique,outermostContext=contextBackup),unmatched};return bySet?markFunction(superMatcher):superMatcher}var i,support,Expr,getText,isXML,tokenize,compile,select,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+1*new Date,preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),sortOrder=function(a,b){return a===b&&(hasDuplicate=!0),0},MAX_NEGATIVE=1<<31,hasOwn={}.hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=function(list,elem){for(var i=0,len=list.length;i<len;i++)if(list[i]===elem)return i;return-1},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",characterEncoding="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",identifier=characterEncoding.replace("w","w#"),attributes="\\["+whitespace+"*("+characterEncoding+")(?:"+whitespace+"*([*^$|!~]?=)"+whitespace+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+identifier+"))|)"+whitespace+"*\\]",pseudos=":("+characterEncoding+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+attributes+")*)|.*)\\)|)",rwhitespace=new RegExp(whitespace+"+","g"),rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*?)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={ID:new RegExp("^#("+characterEncoding+")"),CLASS:new RegExp("^\\.("+characterEncoding+")"),TAG:new RegExp("^("+characterEncoding.replace("w","w*")+")"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),bool:new RegExp("^(?:"+booleans+")$","i"),needsContext:new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,rescape=/'|\\/g,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-65536;return high!==high||escapedWhitespace?escaped:high<0?String.fromCharCode(high+65536):String.fromCharCode(high>>10|55296,1023&high|56320)},unloadHandler=function(){setDocument()};try{push.apply(arr=slice.call(preferredDoc.childNodes),preferredDoc.childNodes),arr[preferredDoc.childNodes.length].nodeType}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els))}:function(target,els){for(var j=target.length,i=0;target[j++]=els[i++];);target.length=j-1}}}support=Sizzle.support={},isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return!!documentElement&&"HTML"!==documentElement.nodeName},setDocument=Sizzle.setDocument=function(node){var hasCompare,parent,doc=node?node.ownerDocument||node:preferredDoc;return doc!==document&&9===doc.nodeType&&doc.documentElement?(document=doc,docElem=doc.documentElement,parent=doc.defaultView,parent&&parent!==parent.top&&(parent.addEventListener?parent.addEventListener("unload",unloadHandler,!1):parent.attachEvent&&parent.attachEvent("onunload",unloadHandler)),documentIsHTML=!isXML(doc),support.attributes=assert(function(div){return div.className="i",!div.getAttribute("className")}),support.getElementsByTagName=assert(function(div){return div.appendChild(doc.createComment("")),!div.getElementsByTagName("*").length}),support.getElementsByClassName=rnative.test(doc.getElementsByClassName),support.getById=assert(function(div){return docElem.appendChild(div).id=expando,!doc.getElementsByName||!doc.getElementsByName(expando).length}),support.getById?(Expr.find.ID=function(id,context){if("undefined"!=typeof context.getElementById&&documentIsHTML){var m=context.getElementById(id);return m&&m.parentNode?[m]:[]}},Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}}):(delete Expr.find.ID,Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node="undefined"!=typeof elem.getAttributeNode&&elem.getAttributeNode("id");return node&&node.value===attrId}}),Expr.find.TAG=support.getElementsByTagName?function(tag,context){return"undefined"!=typeof context.getElementsByTagName?context.getElementsByTagName(tag):support.qsa?context.querySelectorAll(tag):void 0}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if("*"===tag){for(;elem=results[i++];)1===elem.nodeType&&tmp.push(elem);return tmp}return results},Expr.find.CLASS=support.getElementsByClassName&&function(className,context){if(documentIsHTML)return context.getElementsByClassName(className)},rbuggyMatches=[],rbuggyQSA=[],(support.qsa=rnative.test(doc.querySelectorAll))&&(assert(function(div){docElem.appendChild(div).innerHTML="<a id='"+expando+"'></a><select id='"+expando+"-\f]' msallowcapture=''><option selected=''></option></select>",div.querySelectorAll("[msallowcapture^='']").length&&rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")"),div.querySelectorAll("[selected]").length||rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")"),div.querySelectorAll("[id~="+expando+"-]").length||rbuggyQSA.push("~="),div.querySelectorAll(":checked").length||rbuggyQSA.push(":checked"),div.querySelectorAll("a#"+expando+"+*").length||rbuggyQSA.push(".#.+[+~]")}),assert(function(div){var input=doc.createElement("input");input.setAttribute("type","hidden"),div.appendChild(input).setAttribute("name","D"),div.querySelectorAll("[name=d]").length&&rbuggyQSA.push("name"+whitespace+"*[*^$|!~]?="),div.querySelectorAll(":enabled").length||rbuggyQSA.push(":enabled",":disabled"),div.querySelectorAll("*,:x"),rbuggyQSA.push(",.*:")})),(support.matchesSelector=rnative.test(matches=docElem.matches||docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector))&&assert(function(div){support.disconnectedMatch=matches.call(div,"div"),matches.call(div,"[s!='']:x"),rbuggyMatches.push("!=",pseudos)}),rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|")),rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|")),hasCompare=rnative.test(docElem.compareDocumentPosition),contains=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=9===a.nodeType?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!(!bup||1!==bup.nodeType||!(adown.contains?adown.contains(bup):a.compareDocumentPosition&&16&a.compareDocumentPosition(bup)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},sortOrder=hasCompare?function(a,b){if(a===b)return hasDuplicate=!0,0;var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;return compare?compare:(compare=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&compare||!support.sortDetached&&b.compareDocumentPosition(a)===compare?a===doc||a.ownerDocument===preferredDoc&&contains(preferredDoc,a)?-1:b===doc||b.ownerDocument===preferredDoc&&contains(preferredDoc,b)?1:sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0:4&compare?-1:1)}:function(a,b){if(a===b)return hasDuplicate=!0,0;var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!aup||!bup)return a===doc?-1:b===doc?1:aup?-1:bup?1:sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0;if(aup===bup)return siblingCheck(a,b);for(cur=a;cur=cur.parentNode;)ap.unshift(cur);for(cur=b;cur=cur.parentNode;)bp.unshift(cur);for(;ap[i]===bp[i];)i++;return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0},doc):document},Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)},Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document&&setDocument(elem),expr=expr.replace(rattributeQuotes,"='$1']"),support.matchesSelector&&documentIsHTML&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr)))try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&11!==elem.document.nodeType)return ret}catch(e){}return Sizzle(expr,document,null,[elem]).length>0},Sizzle.contains=function(context,elem){return(context.ownerDocument||context)!==document&&setDocument(context),contains(context,elem)},Sizzle.attr=function(elem,name){(elem.ownerDocument||elem)!==document&&setDocument(elem);var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):void 0;return void 0!==val?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null},Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)},Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;if(hasDuplicate=!support.detectDuplicates,sortInput=!support.sortStable&&results.slice(0),results.sort(sortOrder),hasDuplicate){for(;elem=results[i++];)elem===results[i]&&(j=duplicates.push(i));for(;j--;)results.splice(duplicates[j],1)}return sortInput=null,results},getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(nodeType){if(1===nodeType||9===nodeType||11===nodeType){if("string"==typeof elem.textContent)return elem.textContent;for(elem=elem.firstChild;elem;elem=elem.nextSibling)ret+=getText(elem)}else if(3===nodeType||4===nodeType)return elem.nodeValue}else for(;node=elem[i++];)ret+=getText(node);return ret},Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){return match[1]=match[1].replace(runescape,funescape),match[3]=(match[3]||match[4]||match[5]||"").replace(runescape,funescape),"~="===match[2]&&(match[3]=" "+match[3]+" "),match.slice(0,4)},CHILD:function(match){return match[1]=match[1].toLowerCase(),"nth"===match[1].slice(0,3)?(match[3]||Sizzle.error(match[0]),match[4]=+(match[4]?match[5]+(match[6]||1):2*("even"===match[3]||"odd"===match[3])),match[5]=+(match[7]+match[8]||"odd"===match[3])):match[3]&&Sizzle.error(match[0]),match},PSEUDO:function(match){var excess,unquoted=!match[6]&&match[2];return matchExpr.CHILD.test(match[0])?null:(match[3]?match[2]=match[4]||match[5]||"":unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,!0))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)&&(match[0]=match[0].slice(0,excess),match[2]=unquoted.slice(0,excess)),match.slice(0,3))}},filter:{TAG:function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return"*"===nodeNameSelector?function(){return!0}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},CLASS:function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test("string"==typeof elem.className&&elem.className||"undefined"!=typeof elem.getAttribute&&elem.getAttribute("class")||"")})},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);return null==result?"!="===operator:!operator||(result+="","="===operator?result===check:"!="===operator?result!==check:"^="===operator?check&&0===result.indexOf(check):"*="===operator?check&&result.indexOf(check)>-1:"$="===operator?check&&result.slice(-check.length)===check:"~="===operator?(" "+result.replace(rwhitespace," ")+" ").indexOf(check)>-1:"|="===operator&&(result===check||result.slice(0,check.length+1)===check+"-"))}},CHILD:function(type,what,argument,first,last){var simple="nth"!==type.slice(0,3),forward="last"!==type.slice(-4),ofType="of-type"===what;return 1===first&&0===last?function(elem){return!!elem.parentNode}:function(elem,context,xml){var cache,outerCache,node,diff,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType;if(parent){if(simple){for(;dir;){for(node=elem;node=node[dir];)if(ofType?node.nodeName.toLowerCase()===name:1===node.nodeType)return!1;start=dir="only"===type&&!start&&"nextSibling"}return!0}if(start=[forward?parent.firstChild:parent.lastChild],forward&&useCache){for(outerCache=parent[expando]||(parent[expando]={}),cache=outerCache[type]||[],nodeIndex=cache[0]===dirruns&&cache[1],diff=cache[0]===dirruns&&cache[2],node=nodeIndex&&parent.childNodes[nodeIndex];node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop();)if(1===node.nodeType&&++diff&&node===elem){outerCache[type]=[dirruns,nodeIndex,diff];break}}else if(useCache&&(cache=(elem[expando]||(elem[expando]={}))[type])&&cache[0]===dirruns)diff=cache[1];else for(;(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())&&((ofType?node.nodeName.toLowerCase()!==name:1!==node.nodeType)||!++diff||(useCache&&((node[expando]||(node[expando]={}))[type]=[dirruns,diff]),node!==elem)););return diff-=last,diff===first||diff%first===0&&diff/first>=0}}},PSEUDO:function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);return fn[expando]?fn(argument):fn.length>1?(args=[pseudo,pseudo,"",argument],Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){for(var idx,matched=fn(seed,argument),i=matched.length;i--;)idx=indexOf(seed,matched[i]),seed[idx]=!(matches[idx]=matched[i])}):function(elem){return fn(elem,0,args)}):fn}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){for(var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;i--;)(elem=unmatched[i])&&(seed[i]=!(matches[i]=elem))}):function(elem,context,xml){return input[0]=elem,matcher(input,null,xml,results),input[0]=null,!results.pop()}}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),contains:markFunction(function(text){return text=text.replace(runescape,funescape),function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1}}),lang:markFunction(function(lang){return ridentifier.test(lang||"")||Sizzle.error("unsupported lang: "+lang),lang=lang.replace(runescape,funescape).toLowerCase(),function(elem){var elemLang;do if(elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang"))return elemLang=elemLang.toLowerCase(),elemLang===lang||0===elemLang.indexOf(lang+"-");while((elem=elem.parentNode)&&1===elem.nodeType);return!1}}),target:function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id},root:function(elem){return elem===docElem},focus:function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},enabled:function(elem){return elem.disabled===!1},disabled:function(elem){return elem.disabled===!0},checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return"input"===nodeName&&!!elem.checked||"option"===nodeName&&!!elem.selected},selected:function(elem){return elem.parentNode&&elem.parentNode.selectedIndex,elem.selected===!0},empty:function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling)if(elem.nodeType<6)return!1;return!0},parent:function(elem){return!Expr.pseudos.empty(elem)},header:function(elem){return rheader.test(elem.nodeName)},input:function(elem){return rinputs.test(elem.nodeName)},button:function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&"button"===elem.type||"button"===name},text:function(elem){var attr;return"input"===elem.nodeName.toLowerCase()&&"text"===elem.type&&(null==(attr=elem.getAttribute("type"))||"text"===attr.toLowerCase())},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1]}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[argument<0?argument+length:argument]}),even:createPositionalPseudo(function(matchIndexes,length){for(var i=0;i<length;i+=2)matchIndexes.push(i);return matchIndexes}),odd:createPositionalPseudo(function(matchIndexes,length){for(var i=1;i<length;i+=2)matchIndexes.push(i);return matchIndexes}),lt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=argument<0?argument+length:argument;--i>=0;)matchIndexes.push(i);return matchIndexes}),gt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=argument<0?argument+length:argument;++i<length;)matchIndexes.push(i);return matchIndexes})}},Expr.pseudos.nth=Expr.pseudos.eq;for(i in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Expr.pseudos[i]=createInputPseudo(i);for(i in{submit:!0,reset:!0})Expr.pseudos[i]=createButtonPseudo(i);return setFilters.prototype=Expr.filters=Expr.pseudos,Expr.setFilters=new setFilters,tokenize=Sizzle.tokenize=function(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached)return parseOnly?0:cached.slice(0);for(soFar=selector,groups=[],preFilters=Expr.preFilter;soFar;){matched&&!(match=rcomma.exec(soFar))||(match&&(soFar=soFar.slice(match[0].length)||soFar),groups.push(tokens=[])),matched=!1,(match=rcombinators.exec(soFar))&&(matched=match.shift(),tokens.push({value:matched,type:match[0].replace(rtrim," ")}),soFar=soFar.slice(matched.length));for(type in Expr.filter)!(match=matchExpr[type].exec(soFar))||preFilters[type]&&!(match=preFilters[type](match))||(matched=match.shift(),tokens.push({value:matched,type:type,matches:match}),soFar=soFar.slice(matched.length));if(!matched)break}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)},compile=Sizzle.compile=function(selector,match){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){for(match||(match=tokenize(selector)),i=match.length;i--;)cached=matcherFromTokens(match[i]),cached[expando]?setMatchers.push(cached):elementMatchers.push(cached);cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers)),cached.selector=selector}return cached},select=Sizzle.select=function(selector,context,results,seed){var i,tokens,token,type,find,compiled="function"==typeof selector&&selector,match=!seed&&tokenize(selector=compiled.selector||selector);if(results=results||[],1===match.length){if(tokens=match[0]=match[0].slice(0),tokens.length>2&&"ID"===(token=tokens[0]).type&&support.getById&&9===context.nodeType&&documentIsHTML&&Expr.relative[tokens[1].type]){if(context=(Expr.find.ID(token.matches[0].replace(runescape,funescape),context)||[])[0],!context)return results;compiled&&(context=context.parentNode),selector=selector.slice(tokens.shift().value.length)}for(i=matchExpr.needsContext.test(selector)?0:tokens.length;i--&&(token=tokens[i],!Expr.relative[type=token.type]);)if((find=Expr.find[type])&&(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context))){if(tokens.splice(i,1),selector=seed.length&&toSelector(tokens),!selector)return push.apply(results,seed),results;break}}return(compiled||compile(selector,match))(seed,context,!documentIsHTML,results,rsibling.test(selector)&&testContext(context.parentNode)||context),results},support.sortStable=expando.split("").sort(sortOrder).join("")===expando,support.detectDuplicates=!!hasDuplicate,setDocument(),support.sortDetached=assert(function(div1){return 1&div1.compareDocumentPosition(document.createElement("div"))}),assert(function(div){return div.innerHTML="<a href='#'></a>","#"===div.firstChild.getAttribute("href")})||addHandle("type|href|height|width",function(elem,name,isXML){if(!isXML)return elem.getAttribute(name,"type"===name.toLowerCase()?1:2)}),support.attributes&&assert(function(div){return div.innerHTML="<input/>",div.firstChild.setAttribute("value",""),""===div.firstChild.getAttribute("value")})||addHandle("value",function(elem,name,isXML){if(!isXML&&"input"===elem.nodeName.toLowerCase())return elem.defaultValue}),assert(function(div){return null==div.getAttribute("disabled")})||addHandle(booleans,function(elem,name,isXML){var val;if(!isXML)return elem[name]===!0?name.toLowerCase():(val=elem.getAttributeNode(name))&&val.specified?val.value:null}),Sizzle}(window);jQuery.find=Sizzle,jQuery.expr=Sizzle.selectors,jQuery.expr[":"]=jQuery.expr.pseudos,jQuery.unique=Sizzle.uniqueSort,jQuery.text=Sizzle.getText,jQuery.isXMLDoc=Sizzle.isXML,jQuery.contains=Sizzle.contains;var rneedsContext=jQuery.expr.match.needsContext,rsingleTag=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,risSimple=/^.[^:#\[\.,]*$/;jQuery.filter=function(expr,elems,not){var elem=elems[0];return not&&(expr=":not("+expr+")"),1===elems.length&&1===elem.nodeType?jQuery.find.matchesSelector(elem,expr)?[elem]:[]:jQuery.find.matches(expr,jQuery.grep(elems,function(elem){
return 1===elem.nodeType}))},jQuery.fn.extend({find:function(selector){var i,len=this.length,ret=[],self=this;if("string"!=typeof selector)return this.pushStack(jQuery(selector).filter(function(){for(i=0;i<len;i++)if(jQuery.contains(self[i],this))return!0}));for(i=0;i<len;i++)jQuery.find(selector,self[i],ret);return ret=this.pushStack(len>1?jQuery.unique(ret):ret),ret.selector=this.selector?this.selector+" "+selector:selector,ret},filter:function(selector){return this.pushStack(winnow(this,selector||[],!1))},not:function(selector){return this.pushStack(winnow(this,selector||[],!0))},is:function(selector){return!!winnow(this,"string"==typeof selector&&rneedsContext.test(selector)?jQuery(selector):selector||[],!1).length}});var rootjQuery,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,init=jQuery.fn.init=function(selector,context){var match,elem;if(!selector)return this;if("string"==typeof selector){if(match="<"===selector[0]&&">"===selector[selector.length-1]&&selector.length>=3?[null,selector,null]:rquickExpr.exec(selector),!match||!match[1]&&context)return!context||context.jquery?(context||rootjQuery).find(selector):this.constructor(context).find(selector);if(match[1]){if(context=context instanceof jQuery?context[0]:context,jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,!0)),rsingleTag.test(match[1])&&jQuery.isPlainObject(context))for(match in context)jQuery.isFunction(this[match])?this[match](context[match]):this.attr(match,context[match]);return this}return elem=document.getElementById(match[2]),elem&&elem.parentNode&&(this.length=1,this[0]=elem),this.context=document,this.selector=selector,this}return selector.nodeType?(this.context=this[0]=selector,this.length=1,this):jQuery.isFunction(selector)?"undefined"!=typeof rootjQuery.ready?rootjQuery.ready(selector):selector(jQuery):(void 0!==selector.selector&&(this.selector=selector.selector,this.context=selector.context),jQuery.makeArray(selector,this))};init.prototype=jQuery.fn,rootjQuery=jQuery(document);var rparentsprev=/^(?:parents|prev(?:Until|All))/,guaranteedUnique={children:!0,contents:!0,next:!0,prev:!0};jQuery.extend({dir:function(elem,dir,until){for(var matched=[],truncate=void 0!==until;(elem=elem[dir])&&9!==elem.nodeType;)if(1===elem.nodeType){if(truncate&&jQuery(elem).is(until))break;matched.push(elem)}return matched},sibling:function(n,elem){for(var matched=[];n;n=n.nextSibling)1===n.nodeType&&n!==elem&&matched.push(n);return matched}}),jQuery.fn.extend({has:function(target){var targets=jQuery(target,this),l=targets.length;return this.filter(function(){for(var i=0;i<l;i++)if(jQuery.contains(this,targets[i]))return!0})},closest:function(selectors,context){for(var cur,i=0,l=this.length,matched=[],pos=rneedsContext.test(selectors)||"string"!=typeof selectors?jQuery(selectors,context||this.context):0;i<l;i++)for(cur=this[i];cur&&cur!==context;cur=cur.parentNode)if(cur.nodeType<11&&(pos?pos.index(cur)>-1:1===cur.nodeType&&jQuery.find.matchesSelector(cur,selectors))){matched.push(cur);break}return this.pushStack(matched.length>1?jQuery.unique(matched):matched)},index:function(elem){return elem?"string"==typeof elem?indexOf.call(jQuery(elem),this[0]):indexOf.call(this,elem.jquery?elem[0]:elem):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(selector,context){return this.pushStack(jQuery.unique(jQuery.merge(this.get(),jQuery(selector,context))))},addBack:function(selector){return this.add(null==selector?this.prevObject:this.prevObject.filter(selector))}}),jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&11!==parent.nodeType?parent:null},parents:function(elem){return jQuery.dir(elem,"parentNode")},parentsUntil:function(elem,i,until){return jQuery.dir(elem,"parentNode",until)},next:function(elem){return sibling(elem,"nextSibling")},prev:function(elem){return sibling(elem,"previousSibling")},nextAll:function(elem){return jQuery.dir(elem,"nextSibling")},prevAll:function(elem){return jQuery.dir(elem,"previousSibling")},nextUntil:function(elem,i,until){return jQuery.dir(elem,"nextSibling",until)},prevUntil:function(elem,i,until){return jQuery.dir(elem,"previousSibling",until)},siblings:function(elem){return jQuery.sibling((elem.parentNode||{}).firstChild,elem)},children:function(elem){return jQuery.sibling(elem.firstChild)},contents:function(elem){return elem.contentDocument||jQuery.merge([],elem.childNodes)}},function(name,fn){jQuery.fn[name]=function(until,selector){var matched=jQuery.map(this,fn,until);return"Until"!==name.slice(-5)&&(selector=until),selector&&"string"==typeof selector&&(matched=jQuery.filter(selector,matched)),this.length>1&&(guaranteedUnique[name]||jQuery.unique(matched),rparentsprev.test(name)&&matched.reverse()),this.pushStack(matched)}});var rnotwhite=/\S+/g,optionsCache={};jQuery.Callbacks=function(options){options="string"==typeof options?optionsCache[options]||createOptions(options):jQuery.extend({},options);var memory,fired,firing,firingStart,firingLength,firingIndex,list=[],stack=!options.once&&[],fire=function(data){for(memory=options.memory&&data,fired=!0,firingIndex=firingStart||0,firingStart=0,firingLength=list.length,firing=!0;list&&firingIndex<firingLength;firingIndex++)if(list[firingIndex].apply(data[0],data[1])===!1&&options.stopOnFalse){memory=!1;break}firing=!1,list&&(stack?stack.length&&fire(stack.shift()):memory?list=[]:self.disable())},self={add:function(){if(list){var start=list.length;!function add(args){jQuery.each(args,function(_,arg){var type=jQuery.type(arg);"function"===type?options.unique&&self.has(arg)||list.push(arg):arg&&arg.length&&"string"!==type&&add(arg)})}(arguments),firing?firingLength=list.length:memory&&(firingStart=start,fire(memory))}return this},remove:function(){return list&&jQuery.each(arguments,function(_,arg){for(var index;(index=jQuery.inArray(arg,list,index))>-1;)list.splice(index,1),firing&&(index<=firingLength&&firingLength--,index<=firingIndex&&firingIndex--)}),this},has:function(fn){return fn?jQuery.inArray(fn,list)>-1:!(!list||!list.length)},empty:function(){return list=[],firingLength=0,this},disable:function(){return list=stack=memory=void 0,this},disabled:function(){return!list},lock:function(){return stack=void 0,memory||self.disable(),this},locked:function(){return!stack},fireWith:function(context,args){return!list||fired&&!stack||(args=args||[],args=[context,args.slice?args.slice():args],firing?stack.push(args):fire(args)),this},fire:function(){return self.fireWith(this,arguments),this},fired:function(){return!!fired}};return self},jQuery.extend({Deferred:function(func){var tuples=[["resolve","done",jQuery.Callbacks("once memory"),"resolved"],["reject","fail",jQuery.Callbacks("once memory"),"rejected"],["notify","progress",jQuery.Callbacks("memory")]],state="pending",promise={state:function(){return state},always:function(){return deferred.done(arguments).fail(arguments),this},then:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(i,tuple){var fn=jQuery.isFunction(fns[i])&&fns[i];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);returned&&jQuery.isFunction(returned.promise)?returned.promise().done(newDefer.resolve).fail(newDefer.reject).progress(newDefer.notify):newDefer[tuple[0]+"With"](this===promise?newDefer.promise():this,fn?[returned]:arguments)})}),fns=null}).promise()},promise:function(obj){return null!=obj?jQuery.extend(obj,promise):promise}},deferred={};return promise.pipe=promise.then,jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[3];promise[tuple[1]]=list.add,stateString&&list.add(function(){state=stateString},tuples[1^i][2].disable,tuples[2][2].lock),deferred[tuple[0]]=function(){return deferred[tuple[0]+"With"](this===deferred?promise:this,arguments),this},deferred[tuple[0]+"With"]=list.fireWith}),promise.promise(deferred),func&&func.call(deferred,deferred),deferred},when:function(subordinate){var progressValues,progressContexts,resolveContexts,i=0,resolveValues=slice.call(arguments),length=resolveValues.length,remaining=1!==length||subordinate&&jQuery.isFunction(subordinate.promise)?length:0,deferred=1===remaining?subordinate:jQuery.Deferred(),updateFunc=function(i,contexts,values){return function(value){contexts[i]=this,values[i]=arguments.length>1?slice.call(arguments):value,values===progressValues?deferred.notifyWith(contexts,values):--remaining||deferred.resolveWith(contexts,values)}};if(length>1)for(progressValues=new Array(length),progressContexts=new Array(length),resolveContexts=new Array(length);i<length;i++)resolveValues[i]&&jQuery.isFunction(resolveValues[i].promise)?resolveValues[i].promise().done(updateFunc(i,resolveContexts,resolveValues)).fail(deferred.reject).progress(updateFunc(i,progressContexts,progressValues)):--remaining;return remaining||deferred.resolveWith(resolveContexts,resolveValues),deferred.promise()}});var readyList;jQuery.fn.ready=function(fn){return jQuery.ready.promise().done(fn),this},jQuery.extend({isReady:!1,readyWait:1,holdReady:function(hold){hold?jQuery.readyWait++:jQuery.ready(!0)},ready:function(wait){(wait===!0?--jQuery.readyWait:jQuery.isReady)||(jQuery.isReady=!0,wait!==!0&&--jQuery.readyWait>0||(readyList.resolveWith(document,[jQuery]),jQuery.fn.triggerHandler&&(jQuery(document).triggerHandler("ready"),jQuery(document).off("ready"))))}}),jQuery.ready.promise=function(obj){return readyList||(readyList=jQuery.Deferred(),"complete"===document.readyState?setTimeout(jQuery.ready):(document.addEventListener("DOMContentLoaded",completed,!1),window.addEventListener("load",completed,!1))),readyList.promise(obj)},jQuery.ready.promise();var access=jQuery.access=function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,len=elems.length,bulk=null==key;if("object"===jQuery.type(key)){chainable=!0;for(i in key)jQuery.access(elems,fn,i,key[i],!0,emptyGet,raw)}else if(void 0!==value&&(chainable=!0,jQuery.isFunction(value)||(raw=!0),bulk&&(raw?(fn.call(elems,value),fn=null):(bulk=fn,fn=function(elem,key,value){return bulk.call(jQuery(elem),value)})),fn))for(;i<len;i++)fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)));return chainable?elems:bulk?fn.call(elems):len?fn(elems[0],key):emptyGet};jQuery.acceptData=function(owner){return 1===owner.nodeType||9===owner.nodeType||!+owner.nodeType},Data.uid=1,Data.accepts=jQuery.acceptData,Data.prototype={key:function(owner){if(!Data.accepts(owner))return 0;var descriptor={},unlock=owner[this.expando];if(!unlock){unlock=Data.uid++;try{descriptor[this.expando]={value:unlock},Object.defineProperties(owner,descriptor)}catch(e){descriptor[this.expando]=unlock,jQuery.extend(owner,descriptor)}}return this.cache[unlock]||(this.cache[unlock]={}),unlock},set:function(owner,data,value){var prop,unlock=this.key(owner),cache=this.cache[unlock];if("string"==typeof data)cache[data]=value;else if(jQuery.isEmptyObject(cache))jQuery.extend(this.cache[unlock],data);else for(prop in data)cache[prop]=data[prop];return cache},get:function(owner,key){var cache=this.cache[this.key(owner)];return void 0===key?cache:cache[key]},access:function(owner,key,value){var stored;return void 0===key||key&&"string"==typeof key&&void 0===value?(stored=this.get(owner,key),void 0!==stored?stored:this.get(owner,jQuery.camelCase(key))):(this.set(owner,key,value),void 0!==value?value:key)},remove:function(owner,key){var i,name,camel,unlock=this.key(owner),cache=this.cache[unlock];if(void 0===key)this.cache[unlock]={};else{jQuery.isArray(key)?name=key.concat(key.map(jQuery.camelCase)):(camel=jQuery.camelCase(key),key in cache?name=[key,camel]:(name=camel,name=name in cache?[name]:name.match(rnotwhite)||[])),i=name.length;for(;i--;)delete cache[name[i]]}},hasData:function(owner){return!jQuery.isEmptyObject(this.cache[owner[this.expando]]||{})},discard:function(owner){owner[this.expando]&&delete this.cache[owner[this.expando]]}};var data_priv=new Data,data_user=new Data,rbrace=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,rmultiDash=/([A-Z])/g;jQuery.extend({hasData:function(elem){return data_user.hasData(elem)||data_priv.hasData(elem)},data:function(elem,name,data){return data_user.access(elem,name,data)},removeData:function(elem,name){data_user.remove(elem,name)},_data:function(elem,name,data){return data_priv.access(elem,name,data)},_removeData:function(elem,name){data_priv.remove(elem,name)}}),jQuery.fn.extend({data:function(key,value){var i,name,data,elem=this[0],attrs=elem&&elem.attributes;if(void 0===key){if(this.length&&(data=data_user.get(elem),1===elem.nodeType&&!data_priv.get(elem,"hasDataAttrs"))){for(i=attrs.length;i--;)attrs[i]&&(name=attrs[i].name,0===name.indexOf("data-")&&(name=jQuery.camelCase(name.slice(5)),dataAttr(elem,name,data[name])));data_priv.set(elem,"hasDataAttrs",!0)}return data}return"object"==typeof key?this.each(function(){data_user.set(this,key)}):access(this,function(value){var data,camelKey=jQuery.camelCase(key);if(elem&&void 0===value){if(data=data_user.get(elem,key),void 0!==data)return data;if(data=data_user.get(elem,camelKey),void 0!==data)return data;if(data=dataAttr(elem,camelKey,void 0),void 0!==data)return data}else this.each(function(){var data=data_user.get(this,camelKey);data_user.set(this,camelKey,value),key.indexOf("-")!==-1&&void 0!==data&&data_user.set(this,key,value)})},null,value,arguments.length>1,null,!0)},removeData:function(key){return this.each(function(){data_user.remove(this,key)})}}),jQuery.extend({queue:function(elem,type,data){var queue;if(elem)return type=(type||"fx")+"queue",queue=data_priv.get(elem,type),data&&(!queue||jQuery.isArray(data)?queue=data_priv.access(elem,type,jQuery.makeArray(data)):queue.push(data)),queue||[]},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function(){jQuery.dequeue(elem,type)};"inprogress"===fn&&(fn=queue.shift(),startLength--),fn&&("fx"===type&&queue.unshift("inprogress"),delete hooks.stop,fn.call(elem,next,hooks)),!startLength&&hooks&&hooks.empty.fire()},_queueHooks:function(elem,type){var key=type+"queueHooks";return data_priv.get(elem,key)||data_priv.access(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){data_priv.remove(elem,[type+"queue",key])})})}}),jQuery.fn.extend({queue:function(type,data){var setter=2;return"string"!=typeof type&&(data=type,type="fx",setter--),arguments.length<setter?jQuery.queue(this[0],type):void 0===data?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type),"fx"===type&&"inprogress"!==queue[0]&&jQuery.dequeue(this,type)})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},clearQueue:function(type){return this.queue(type||"fx",[])},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){--count||defer.resolveWith(elements,[elements])};for("string"!=typeof type&&(obj=type,type=void 0),type=type||"fx";i--;)tmp=data_priv.get(elements[i],type+"queueHooks"),tmp&&tmp.empty&&(count++,tmp.empty.add(resolve));return resolve(),defer.promise(obj)}});var pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,cssExpand=["Top","Right","Bottom","Left"],isHidden=function(elem,el){return elem=el||elem,"none"===jQuery.css(elem,"display")||!jQuery.contains(elem.ownerDocument,elem)},rcheckableType=/^(?:checkbox|radio)$/i;!function(){var fragment=document.createDocumentFragment(),div=fragment.appendChild(document.createElement("div")),input=document.createElement("input");input.setAttribute("type","radio"),input.setAttribute("checked","checked"),input.setAttribute("name","t"),div.appendChild(input),support.checkClone=div.cloneNode(!0).cloneNode(!0).lastChild.checked,div.innerHTML="<textarea>x</textarea>",support.noCloneChecked=!!div.cloneNode(!0).lastChild.defaultValue}();var strundefined="undefined";support.focusinBubbles="onfocusin"in window;var rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|pointer|contextmenu)|click/,rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,rtypenamespace=/^([^.]*)(?:\.(.+)|)$/;jQuery.event={global:{},add:function(elem,types,handler,data,selector){var handleObjIn,eventHandle,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=data_priv.get(elem);if(elemData)for(handler.handler&&(handleObjIn=handler,handler=handleObjIn.handler,selector=handleObjIn.selector),handler.guid||(handler.guid=jQuery.guid++),(events=elemData.events)||(events=elemData.events={}),(eventHandle=elemData.handle)||(eventHandle=elemData.handle=function(e){return typeof jQuery!==strundefined&&jQuery.event.triggered!==e.type?jQuery.event.dispatch.apply(elem,arguments):void 0}),types=(types||"").match(rnotwhite)||[""],t=types.length;t--;)tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),type&&(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,special=jQuery.event.special[type]||{},handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn),(handlers=events[type])||(handlers=events[type]=[],handlers.delegateCount=0,special.setup&&special.setup.call(elem,data,namespaces,eventHandle)!==!1||elem.addEventListener&&elem.addEventListener(type,eventHandle,!1)),special.add&&(special.add.call(elem,handleObj),handleObj.handler.guid||(handleObj.handler.guid=handler.guid)),selector?handlers.splice(handlers.delegateCount++,0,handleObj):handlers.push(handleObj),jQuery.event.global[type]=!0)},remove:function(elem,types,handler,selector,mappedTypes){var j,origCount,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=data_priv.hasData(elem)&&data_priv.get(elem);if(elemData&&(events=elemData.events)){for(types=(types||"").match(rnotwhite)||[""],t=types.length;t--;)if(tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),type){for(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,handlers=events[type]||[],tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"),origCount=j=handlers.length;j--;)handleObj=handlers[j],!mappedTypes&&origType!==handleObj.origType||handler&&handler.guid!==handleObj.guid||tmp&&!tmp.test(handleObj.namespace)||selector&&selector!==handleObj.selector&&("**"!==selector||!handleObj.selector)||(handlers.splice(j,1),handleObj.selector&&handlers.delegateCount--,special.remove&&special.remove.call(elem,handleObj));origCount&&!handlers.length&&(special.teardown&&special.teardown.call(elem,namespaces,elemData.handle)!==!1||jQuery.removeEvent(elem,type,elemData.handle),delete events[type])}else for(type in events)jQuery.event.remove(elem,type+types[t],handler,selector,!0);jQuery.isEmptyObject(events)&&(delete elemData.handle,data_priv.remove(elem,"events"))}},trigger:function(event,data,elem,onlyHandlers){var i,cur,tmp,bubbleType,ontype,handle,special,eventPath=[elem||document],type=hasOwn.call(event,"type")?event.type:event,namespaces=hasOwn.call(event,"namespace")?event.namespace.split("."):[];if(cur=tmp=elem=elem||document,3!==elem.nodeType&&8!==elem.nodeType&&!rfocusMorph.test(type+jQuery.event.triggered)&&(type.indexOf(".")>=0&&(namespaces=type.split("."),type=namespaces.shift(),namespaces.sort()),ontype=type.indexOf(":")<0&&"on"+type,event=event[jQuery.expando]?event:new jQuery.Event(type,"object"==typeof event&&event),event.isTrigger=onlyHandlers?2:3,event.namespace=namespaces.join("."),event.namespace_re=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,event.result=void 0,event.target||(event.target=elem),data=null==data?[event]:jQuery.makeArray(data,[event]),special=jQuery.event.special[type]||{},onlyHandlers||!special.trigger||special.trigger.apply(elem,data)!==!1)){if(!onlyHandlers&&!special.noBubble&&!jQuery.isWindow(elem)){for(bubbleType=special.delegateType||type,rfocusMorph.test(bubbleType+type)||(cur=cur.parentNode);cur;cur=cur.parentNode)eventPath.push(cur),tmp=cur;tmp===(elem.ownerDocument||document)&&eventPath.push(tmp.defaultView||tmp.parentWindow||window)}for(i=0;(cur=eventPath[i++])&&!event.isPropagationStopped();)event.type=i>1?bubbleType:special.bindType||type,handle=(data_priv.get(cur,"events")||{})[event.type]&&data_priv.get(cur,"handle"),handle&&handle.apply(cur,data),handle=ontype&&cur[ontype],handle&&handle.apply&&jQuery.acceptData(cur)&&(event.result=handle.apply(cur,data),event.result===!1&&event.preventDefault());return event.type=type,onlyHandlers||event.isDefaultPrevented()||special._default&&special._default.apply(eventPath.pop(),data)!==!1||!jQuery.acceptData(elem)||ontype&&jQuery.isFunction(elem[type])&&!jQuery.isWindow(elem)&&(tmp=elem[ontype],tmp&&(elem[ontype]=null),jQuery.event.triggered=type,elem[type](),jQuery.event.triggered=void 0,tmp&&(elem[ontype]=tmp)),event.result}},dispatch:function(event){event=jQuery.event.fix(event);var i,j,ret,matched,handleObj,handlerQueue=[],args=slice.call(arguments),handlers=(data_priv.get(this,"events")||{})[event.type]||[],special=jQuery.event.special[event.type]||{};if(args[0]=event,event.delegateTarget=this,!special.preDispatch||special.preDispatch.call(this,event)!==!1){for(handlerQueue=jQuery.event.handlers.call(this,event,handlers),i=0;(matched=handlerQueue[i++])&&!event.isPropagationStopped();)for(event.currentTarget=matched.elem,j=0;(handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped();)event.namespace_re&&!event.namespace_re.test(handleObj.namespace)||(event.handleObj=handleObj,event.data=handleObj.data,ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args),void 0!==ret&&(event.result=ret)===!1&&(event.preventDefault(),event.stopPropagation()));return special.postDispatch&&special.postDispatch.call(this,event),event.result}},handlers:function(event,handlers){var i,matches,sel,handleObj,handlerQueue=[],delegateCount=handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&(!event.button||"click"!==event.type))for(;cur!==this;cur=cur.parentNode||this)if(cur.disabled!==!0||"click"!==event.type){for(matches=[],i=0;i<delegateCount;i++)handleObj=handlers[i],sel=handleObj.selector+" ",void 0===matches[sel]&&(matches[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>=0:jQuery.find(sel,this,null,[cur]).length),matches[sel]&&matches.push(handleObj);matches.length&&handlerQueue.push({elem:cur,handlers:matches})}return delegateCount<handlers.length&&handlerQueue.push({elem:this,handlers:handlers.slice(delegateCount)}),handlerQueue},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(event,original){return null==event.which&&(event.which=null!=original.charCode?original.charCode:original.keyCode),event}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(event,original){var eventDoc,doc,body,button=original.button;return null==event.pageX&&null!=original.clientX&&(eventDoc=event.target.ownerDocument||document,doc=eventDoc.documentElement,body=eventDoc.body,event.pageX=original.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0),event.pageY=original.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)),event.which||void 0===button||(event.which=1&button?1:2&button?3:4&button?2:0),event}},fix:function(event){if(event[jQuery.expando])return event;var i,prop,copy,type=event.type,originalEvent=event,fixHook=this.fixHooks[type];for(fixHook||(this.fixHooks[type]=fixHook=rmouseEvent.test(type)?this.mouseHooks:rkeyEvent.test(type)?this.keyHooks:{}),copy=fixHook.props?this.props.concat(fixHook.props):this.props,event=new jQuery.Event(originalEvent),i=copy.length;i--;)prop=copy[i],event[prop]=originalEvent[prop];return event.target||(event.target=document),3===event.target.nodeType&&(event.target=event.target.parentNode),fixHook.filter?fixHook.filter(event,originalEvent):event},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==safeActiveElement()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===safeActiveElement()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&jQuery.nodeName(this,"input"))return this.click(),!1},_default:function(event){return jQuery.nodeName(event.target,"a")}},beforeunload:{postDispatch:function(event){void 0!==event.result&&event.originalEvent&&(event.originalEvent.returnValue=event.result)}}},simulate:function(type,elem,event,bubble){var e=jQuery.extend(new jQuery.Event,event,{type:type,isSimulated:!0,originalEvent:{}});bubble?jQuery.event.trigger(e,null,elem):jQuery.event.dispatch.call(elem,e),e.isDefaultPrevented()&&event.preventDefault()}},jQuery.removeEvent=function(elem,type,handle){elem.removeEventListener&&elem.removeEventListener(type,handle,!1)},jQuery.Event=function(src,props){return this instanceof jQuery.Event?(src&&src.type?(this.originalEvent=src,this.type=src.type,this.isDefaultPrevented=src.defaultPrevented||void 0===src.defaultPrevented&&src.returnValue===!1?returnTrue:returnFalse):this.type=src,props&&jQuery.extend(this,props),this.timeStamp=src&&src.timeStamp||jQuery.now(),void(this[jQuery.expando]=!0)):new jQuery.Event(src,props)},jQuery.Event.prototype={isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=returnTrue,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj;return related&&(related===target||jQuery.contains(target,related))||(event.type=handleObj.origType,ret=handleObj.handler.apply(this,arguments),event.type=fix),ret}}}),support.focusinBubbles||jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event),!0)};jQuery.event.special[fix]={setup:function(){var doc=this.ownerDocument||this,attaches=data_priv.access(doc,fix);attaches||doc.addEventListener(orig,handler,!0),data_priv.access(doc,fix,(attaches||0)+1)},teardown:function(){var doc=this.ownerDocument||this,attaches=data_priv.access(doc,fix)-1;attaches?data_priv.access(doc,fix,attaches):(doc.removeEventListener(orig,handler,!0),data_priv.remove(doc,fix))}}}),jQuery.fn.extend({on:function(types,selector,data,fn,one){var origFn,type;if("object"==typeof types){"string"!=typeof selector&&(data=data||selector,selector=void 0);for(type in types)this.on(type,selector,data,types[type],one);return this}if(null==data&&null==fn?(fn=selector,data=selector=void 0):null==fn&&("string"==typeof selector?(fn=data,data=void 0):(fn=data,data=selector,selector=void 0)),fn===!1)fn=returnFalse;else if(!fn)return this;return 1===one&&(origFn=fn,fn=function(event){return jQuery().off(event),origFn.apply(this,arguments)},fn.guid=origFn.guid||(origFn.guid=jQuery.guid++)),this.each(function(){jQuery.event.add(this,types,fn,data,selector)})},one:function(types,selector,data,fn){return this.on(types,selector,data,fn,1)},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj)return handleObj=types.handleObj,jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler),this;if("object"==typeof types){for(type in types)this.off(type,selector,types[type]);return this}return selector!==!1&&"function"!=typeof selector||(fn=selector,selector=void 0),fn===!1&&(fn=returnFalse),this.each(function(){jQuery.event.remove(this,types,fn,selector)})},trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)})},triggerHandler:function(type,data){var elem=this[0];if(elem)return jQuery.event.trigger(type,data,elem,!0)}});var rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rtagName=/<([\w:]+)/,rhtml=/<|&#?\w+;/,rnoInnerhtml=/<(?:script|style|link)/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/^$|\/(?:java|ecma)script/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td,jQuery.extend({clone:function(elem,dataAndEvents,deepDataAndEvents){var i,l,srcElements,destElements,clone=elem.cloneNode(!0),inPage=jQuery.contains(elem.ownerDocument,elem);if(!(support.noCloneChecked||1!==elem.nodeType&&11!==elem.nodeType||jQuery.isXMLDoc(elem)))for(destElements=getAll(clone),srcElements=getAll(elem),i=0,l=srcElements.length;i<l;i++)fixInput(srcElements[i],destElements[i]);if(dataAndEvents)if(deepDataAndEvents)for(srcElements=srcElements||getAll(elem),destElements=destElements||getAll(clone),i=0,l=srcElements.length;i<l;i++)cloneCopyEvent(srcElements[i],destElements[i]);else cloneCopyEvent(elem,clone);return destElements=getAll(clone,"script"),destElements.length>0&&setGlobalEval(destElements,!inPage&&getAll(elem,"script")),clone},buildFragment:function(elems,context,scripts,selection){for(var elem,tmp,tag,wrap,contains,j,fragment=context.createDocumentFragment(),nodes=[],i=0,l=elems.length;i<l;i++)if(elem=elems[i],elem||0===elem)if("object"===jQuery.type(elem))jQuery.merge(nodes,elem.nodeType?[elem]:elem);else if(rhtml.test(elem)){for(tmp=tmp||fragment.appendChild(context.createElement("div")),tag=(rtagName.exec(elem)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,tmp.innerHTML=wrap[1]+elem.replace(rxhtmlTag,"<$1></$2>")+wrap[2],j=wrap[0];j--;)tmp=tmp.lastChild;jQuery.merge(nodes,tmp.childNodes),tmp=fragment.firstChild,tmp.textContent=""}else nodes.push(context.createTextNode(elem));for(fragment.textContent="",i=0;elem=nodes[i++];)if((!selection||jQuery.inArray(elem,selection)===-1)&&(contains=jQuery.contains(elem.ownerDocument,elem),tmp=getAll(fragment.appendChild(elem),"script"),contains&&setGlobalEval(tmp),scripts))for(j=0;elem=tmp[j++];)rscriptType.test(elem.type||"")&&scripts.push(elem);return fragment},cleanData:function(elems){for(var data,elem,type,key,special=jQuery.event.special,i=0;void 0!==(elem=elems[i]);i++){if(jQuery.acceptData(elem)&&(key=elem[data_priv.expando],key&&(data=data_priv.cache[key]))){if(data.events)for(type in data.events)special[type]?jQuery.event.remove(elem,type):jQuery.removeEvent(elem,type,data.handle);data_priv.cache[key]&&delete data_priv.cache[key]}delete data_user.cache[elem[data_user.expando]]}}}),jQuery.fn.extend({text:function(value){return access(this,function(value){return void 0===value?jQuery.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=value);
})},null,value,arguments.length)},append:function(){return this.domManip(arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var target=manipulationTarget(this,elem);target.appendChild(elem)}})},prepend:function(){return this.domManip(arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var target=manipulationTarget(this,elem);target.insertBefore(elem,target.firstChild)}})},before:function(){return this.domManip(arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this)})},after:function(){return this.domManip(arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this.nextSibling)})},remove:function(selector,keepData){for(var elem,elems=selector?jQuery.filter(selector,this):this,i=0;null!=(elem=elems[i]);i++)keepData||1!==elem.nodeType||jQuery.cleanData(getAll(elem)),elem.parentNode&&(keepData&&jQuery.contains(elem.ownerDocument,elem)&&setGlobalEval(getAll(elem,"script")),elem.parentNode.removeChild(elem));return this},empty:function(){for(var elem,i=0;null!=(elem=this[i]);i++)1===elem.nodeType&&(jQuery.cleanData(getAll(elem,!1)),elem.textContent="");return this},clone:function(dataAndEvents,deepDataAndEvents){return dataAndEvents=null!=dataAndEvents&&dataAndEvents,deepDataAndEvents=null==deepDataAndEvents?dataAndEvents:deepDataAndEvents,this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},html:function(value){return access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(void 0===value&&1===elem.nodeType)return elem.innerHTML;if("string"==typeof value&&!rnoInnerhtml.test(value)&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=value.replace(rxhtmlTag,"<$1></$2>");try{for(;i<l;i++)elem=this[i]||{},1===elem.nodeType&&(jQuery.cleanData(getAll(elem,!1)),elem.innerHTML=value);elem=0}catch(e){}}elem&&this.empty().append(value)},null,value,arguments.length)},replaceWith:function(){var arg=arguments[0];return this.domManip(arguments,function(elem){arg=this.parentNode,jQuery.cleanData(getAll(this)),arg&&arg.replaceChild(elem,this)}),arg&&(arg.length||arg.nodeType)?this:this.remove()},detach:function(selector){return this.remove(selector,!0)},domManip:function(args,callback){args=concat.apply([],args);var fragment,first,scripts,hasScripts,node,doc,i=0,l=this.length,set=this,iNoClone=l-1,value=args[0],isFunction=jQuery.isFunction(value);if(isFunction||l>1&&"string"==typeof value&&!support.checkClone&&rchecked.test(value))return this.each(function(index){var self=set.eq(index);isFunction&&(args[0]=value.call(this,index,self.html())),self.domManip(args,callback)});if(l&&(fragment=jQuery.buildFragment(args,this[0].ownerDocument,!1,this),first=fragment.firstChild,1===fragment.childNodes.length&&(fragment=first),first)){for(scripts=jQuery.map(getAll(fragment,"script"),disableScript),hasScripts=scripts.length;i<l;i++)node=fragment,i!==iNoClone&&(node=jQuery.clone(node,!0,!0),hasScripts&&jQuery.merge(scripts,getAll(node,"script"))),callback.call(this[i],node,i);if(hasScripts)for(doc=scripts[scripts.length-1].ownerDocument,jQuery.map(scripts,restoreScript),i=0;i<hasScripts;i++)node=scripts[i],rscriptType.test(node.type||"")&&!data_priv.access(node,"globalEval")&&jQuery.contains(doc,node)&&(node.src?jQuery._evalUrl&&jQuery._evalUrl(node.src):jQuery.globalEval(node.textContent.replace(rcleanScript,"")))}return this}}),jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){for(var elems,ret=[],insert=jQuery(selector),last=insert.length-1,i=0;i<=last;i++)elems=i===last?this:this.clone(!0),jQuery(insert[i])[original](elems),push.apply(ret,elems.get());return this.pushStack(ret)}});var iframe,elemdisplay={},rmargin=/^margin/,rnumnonpx=new RegExp("^("+pnum+")(?!px)[a-z%]+$","i"),getStyles=function(elem){return elem.ownerDocument.defaultView.opener?elem.ownerDocument.defaultView.getComputedStyle(elem,null):window.getComputedStyle(elem,null)};!function(){function computePixelPositionAndBoxSizingReliable(){div.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",div.innerHTML="",docElem.appendChild(container);var divStyle=window.getComputedStyle(div,null);pixelPositionVal="1%"!==divStyle.top,boxSizingReliableVal="4px"===divStyle.width,docElem.removeChild(container)}var pixelPositionVal,boxSizingReliableVal,docElem=document.documentElement,container=document.createElement("div"),div=document.createElement("div");div.style&&(div.style.backgroundClip="content-box",div.cloneNode(!0).style.backgroundClip="",support.clearCloneStyle="content-box"===div.style.backgroundClip,container.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",container.appendChild(div),window.getComputedStyle&&jQuery.extend(support,{pixelPosition:function(){return computePixelPositionAndBoxSizingReliable(),pixelPositionVal},boxSizingReliable:function(){return null==boxSizingReliableVal&&computePixelPositionAndBoxSizingReliable(),boxSizingReliableVal},reliableMarginRight:function(){var ret,marginDiv=div.appendChild(document.createElement("div"));return marginDiv.style.cssText=div.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",marginDiv.style.marginRight=marginDiv.style.width="0",div.style.width="1px",docElem.appendChild(container),ret=!parseFloat(window.getComputedStyle(marginDiv,null).marginRight),docElem.removeChild(container),div.removeChild(marginDiv),ret}}))}(),jQuery.swap=function(elem,options,callback,args){var ret,name,old={};for(name in options)old[name]=elem.style[name],elem.style[name]=options[name];ret=callback.apply(elem,args||[]);for(name in options)elem.style[name]=old[name];return ret};var rdisplayswap=/^(none|table(?!-c[ea]).+)/,rnumsplit=new RegExp("^("+pnum+")(.*)$","i"),rrelNum=new RegExp("^([+-])=("+pnum+")","i"),cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:"0",fontWeight:"400"},cssPrefixes=["Webkit","O","Moz","ms"];jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return""===ret?"1":ret}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(elem,name,value,extra){if(elem&&3!==elem.nodeType&&8!==elem.nodeType&&elem.style){var ret,type,hooks,origName=jQuery.camelCase(name),style=elem.style;return name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(style,origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],void 0===value?hooks&&"get"in hooks&&void 0!==(ret=hooks.get(elem,!1,extra))?ret:style[name]:(type=typeof value,"string"===type&&(ret=rrelNum.exec(value))&&(value=(ret[1]+1)*ret[2]+parseFloat(jQuery.css(elem,name)),type="number"),null!=value&&value===value&&("number"!==type||jQuery.cssNumber[origName]||(value+="px"),support.clearCloneStyle||""!==value||0!==name.indexOf("background")||(style[name]="inherit"),hooks&&"set"in hooks&&void 0===(value=hooks.set(elem,value,extra))||(style[name]=value)),void 0)}},css:function(elem,name,extra,styles){var val,num,hooks,origName=jQuery.camelCase(name);return name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(elem.style,origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],hooks&&"get"in hooks&&(val=hooks.get(elem,!0,extra)),void 0===val&&(val=curCSS(elem,name,styles)),"normal"===val&&name in cssNormalTransform&&(val=cssNormalTransform[name]),""===extra||extra?(num=parseFloat(val),extra===!0||jQuery.isNumeric(num)?num||0:val):val}}),jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){if(computed)return rdisplayswap.test(jQuery.css(elem,"display"))&&0===elem.offsetWidth?jQuery.swap(elem,cssShow,function(){return getWidthOrHeight(elem,name,extra)}):getWidthOrHeight(elem,name,extra)},set:function(elem,value,extra){var styles=extra&&getStyles(elem);return setPositiveNumber(elem,value,extra?augmentWidthOrHeight(elem,name,extra,"border-box"===jQuery.css(elem,"boxSizing",!1,styles),styles):0)}}}),jQuery.cssHooks.marginRight=addGetHookIf(support.reliableMarginRight,function(elem,computed){if(computed)return jQuery.swap(elem,{display:"inline-block"},curCSS,[elem,"marginRight"])}),jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){for(var i=0,expanded={},parts="string"==typeof value?value.split(" "):[value];i<4;i++)expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0];return expanded}},rmargin.test(prefix)||(jQuery.cssHooks[prefix+suffix].set=setPositiveNumber)}),jQuery.fn.extend({css:function(name,value){return access(this,function(elem,name,value){var styles,len,map={},i=0;if(jQuery.isArray(name)){for(styles=getStyles(elem),len=name.length;i<len;i++)map[name[i]]=jQuery.css(elem,name[i],!1,styles);return map}return void 0!==value?jQuery.style(elem,name,value):jQuery.css(elem,name)},name,value,arguments.length>1)},show:function(){return showHide(this,!0)},hide:function(){return showHide(this)},toggle:function(state){return"boolean"==typeof state?state?this.show():this.hide():this.each(function(){isHidden(this)?jQuery(this).show():jQuery(this).hide()})}}),jQuery.Tween=Tween,Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem,this.prop=prop,this.easing=easing||"swing",this.options=options,this.start=this.now=this.cur(),this.end=end,this.unit=unit||(jQuery.cssNumber[prop]?"":"px")},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this)},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];return this.options.duration?this.pos=eased=jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration):this.pos=eased=percent,this.now=(this.end-this.start)*eased+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),hooks&&hooks.set?hooks.set(this):Tween.propHooks._default.set(this),this}},Tween.prototype.init.prototype=Tween.prototype,Tween.propHooks={_default:{get:function(tween){var result;return null==tween.elem[tween.prop]||tween.elem.style&&null!=tween.elem.style[tween.prop]?(result=jQuery.css(tween.elem,tween.prop,""),result&&"auto"!==result?result:0):tween.elem[tween.prop]},set:function(tween){jQuery.fx.step[tween.prop]?jQuery.fx.step[tween.prop](tween):tween.elem.style&&(null!=tween.elem.style[jQuery.cssProps[tween.prop]]||jQuery.cssHooks[tween.prop])?jQuery.style(tween.elem,tween.prop,tween.now+tween.unit):tween.elem[tween.prop]=tween.now}}},Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){tween.elem.nodeType&&tween.elem.parentNode&&(tween.elem[tween.prop]=tween.now)}},jQuery.easing={linear:function(p){return p},swing:function(p){return.5-Math.cos(p*Math.PI)/2}},jQuery.fx=Tween.prototype.init,jQuery.fx.step={};var fxNow,timerId,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=new RegExp("^(?:([+-])=|)("+pnum+")([a-z%]*)$","i"),rrun=/queueHooks$/,animationPrefilters=[defaultPrefilter],tweeners={"*":[function(prop,value){var tween=this.createTween(prop,value),target=tween.cur(),parts=rfxnum.exec(value),unit=parts&&parts[3]||(jQuery.cssNumber[prop]?"":"px"),start=(jQuery.cssNumber[prop]||"px"!==unit&&+target)&&rfxnum.exec(jQuery.css(tween.elem,prop)),scale=1,maxIterations=20;if(start&&start[3]!==unit){unit=unit||start[3],parts=parts||[],start=+target||1;do scale=scale||".5",start/=scale,jQuery.style(tween.elem,prop,start+unit);while(scale!==(scale=tween.cur()/target)&&1!==scale&&--maxIterations)}return parts&&(start=tween.start=+start||+target||0,tween.unit=unit,tween.end=parts[1]?start+(parts[1]+1)*parts[2]:+parts[2]),tween}]};jQuery.Animation=jQuery.extend(Animation,{tweener:function(props,callback){jQuery.isFunction(props)?(callback=props,props=["*"]):props=props.split(" ");for(var prop,index=0,length=props.length;index<length;index++)prop=props[index],tweeners[prop]=tweeners[prop]||[],tweeners[prop].unshift(callback)},prefilter:function(callback,prepend){prepend?animationPrefilters.unshift(callback):animationPrefilters.push(callback)}}),jQuery.speed=function(speed,easing,fn){var opt=speed&&"object"==typeof speed?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};return opt.duration=jQuery.fx.off?0:"number"==typeof opt.duration?opt.duration:opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default,null!=opt.queue&&opt.queue!==!0||(opt.queue="fx"),opt.old=opt.complete,opt.complete=function(){jQuery.isFunction(opt.old)&&opt.old.call(this),opt.queue&&jQuery.dequeue(this,opt.queue)},opt},jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHidden).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){var anim=Animation(this,jQuery.extend({},prop),optall);(empty||data_priv.get(this,"finish"))&&anim.stop(!0)};return doAnimation.finish=doAnimation,empty||optall.queue===!1?this.each(doAnimation):this.queue(optall.queue,doAnimation)},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop,stop(gotoEnd)};return"string"!=typeof type&&(gotoEnd=clearQueue,clearQueue=type,type=void 0),clearQueue&&type!==!1&&this.queue(type||"fx",[]),this.each(function(){var dequeue=!0,index=null!=type&&type+"queueHooks",timers=jQuery.timers,data=data_priv.get(this);if(index)data[index]&&data[index].stop&&stopQueue(data[index]);else for(index in data)data[index]&&data[index].stop&&rrun.test(index)&&stopQueue(data[index]);for(index=timers.length;index--;)timers[index].elem!==this||null!=type&&timers[index].queue!==type||(timers[index].anim.stop(gotoEnd),dequeue=!1,timers.splice(index,1));!dequeue&&gotoEnd||jQuery.dequeue(this,type)})},finish:function(type){return type!==!1&&(type=type||"fx"),this.each(function(){var index,data=data_priv.get(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;for(data.finish=!0,jQuery.queue(this,type,[]),hooks&&hooks.stop&&hooks.stop.call(this,!0),index=timers.length;index--;)timers[index].elem===this&&timers[index].queue===type&&(timers[index].anim.stop(!0),timers.splice(index,1));for(index=0;index<length;index++)queue[index]&&queue[index].finish&&queue[index].finish.call(this);delete data.finish})}}),jQuery.each(["toggle","show","hide"],function(i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return null==speed||"boolean"==typeof speed?cssFn.apply(this,arguments):this.animate(genFx(name,!0),speed,easing,callback)}}),jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}}),jQuery.timers=[],jQuery.fx.tick=function(){var timer,i=0,timers=jQuery.timers;for(fxNow=jQuery.now();i<timers.length;i++)timer=timers[i],timer()||timers[i]!==timer||timers.splice(i--,1);timers.length||jQuery.fx.stop(),fxNow=void 0},jQuery.fx.timer=function(timer){jQuery.timers.push(timer),timer()?jQuery.fx.start():jQuery.timers.pop()},jQuery.fx.interval=13,jQuery.fx.start=function(){timerId||(timerId=setInterval(jQuery.fx.tick,jQuery.fx.interval))},jQuery.fx.stop=function(){clearInterval(timerId),timerId=null},jQuery.fx.speeds={slow:600,fast:200,_default:400},jQuery.fn.delay=function(time,type){return time=jQuery.fx?jQuery.fx.speeds[time]||time:time,type=type||"fx",this.queue(type,function(next,hooks){var timeout=setTimeout(next,time);hooks.stop=function(){clearTimeout(timeout)}})},function(){var input=document.createElement("input"),select=document.createElement("select"),opt=select.appendChild(document.createElement("option"));input.type="checkbox",support.checkOn=""!==input.value,support.optSelected=opt.selected,select.disabled=!0,support.optDisabled=!opt.disabled,input=document.createElement("input"),input.value="t",input.type="radio",support.radioValue="t"===input.value}();var nodeHook,boolHook,attrHandle=jQuery.expr.attrHandle;jQuery.fn.extend({attr:function(name,value){return access(this,jQuery.attr,name,value,arguments.length>1)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})}}),jQuery.extend({attr:function(elem,name,value){var hooks,ret,nType=elem.nodeType;if(elem&&3!==nType&&8!==nType&&2!==nType)return typeof elem.getAttribute===strundefined?jQuery.prop(elem,name,value):(1===nType&&jQuery.isXMLDoc(elem)||(name=name.toLowerCase(),hooks=jQuery.attrHooks[name]||(jQuery.expr.match.bool.test(name)?boolHook:nodeHook)),void 0===value?hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:(ret=jQuery.find.attr(elem,name),null==ret?void 0:ret):null!==value?hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name))?ret:(elem.setAttribute(name,value+""),value):void jQuery.removeAttr(elem,name))},removeAttr:function(elem,value){var name,propName,i=0,attrNames=value&&value.match(rnotwhite);if(attrNames&&1===elem.nodeType)for(;name=attrNames[i++];)propName=jQuery.propFix[name]||name,jQuery.expr.match.bool.test(name)&&(elem[propName]=!1),elem.removeAttribute(name)},attrHooks:{type:{set:function(elem,value){if(!support.radioValue&&"radio"===value&&jQuery.nodeName(elem,"input")){var val=elem.value;return elem.setAttribute("type",value),val&&(elem.value=val),value}}}}}),boolHook={set:function(elem,value,name){return value===!1?jQuery.removeAttr(elem,name):elem.setAttribute(name,name),name}},jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(i,name){var getter=attrHandle[name]||jQuery.find.attr;attrHandle[name]=function(elem,name,isXML){var ret,handle;return isXML||(handle=attrHandle[name],attrHandle[name]=ret,ret=null!=getter(elem,name,isXML)?name.toLowerCase():null,attrHandle[name]=handle),ret}});var rfocusable=/^(?:input|select|textarea|button)$/i;jQuery.fn.extend({prop:function(name,value){return access(this,jQuery.prop,name,value,arguments.length>1)},removeProp:function(name){return this.each(function(){delete this[jQuery.propFix[name]||name]})}}),jQuery.extend({propFix:{for:"htmlFor",class:"className"},prop:function(elem,name,value){var ret,hooks,notxml,nType=elem.nodeType;if(elem&&3!==nType&&8!==nType&&2!==nType)return notxml=1!==nType||!jQuery.isXMLDoc(elem),notxml&&(name=jQuery.propFix[name]||name,hooks=jQuery.propHooks[name]),void 0!==value?hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name))?ret:elem[name]=value:hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:elem[name]},propHooks:{tabIndex:{get:function(elem){return elem.hasAttribute("tabindex")||rfocusable.test(elem.nodeName)||elem.href?elem.tabIndex:-1}}}}),support.optSelected||(jQuery.propHooks.selected={get:function(elem){var parent=elem.parentNode;return parent&&parent.parentNode&&parent.parentNode.selectedIndex,null}}),jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this});var rclass=/[\t\r\n\f]/g;jQuery.fn.extend({addClass:function(value){var classes,elem,cur,clazz,j,finalValue,proceed="string"==typeof value&&value,i=0,len=this.length;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).addClass(value.call(this,j,this.className))});if(proceed)for(classes=(value||"").match(rnotwhite)||[];i<len;i++)if(elem=this[i],cur=1===elem.nodeType&&(elem.className?(" "+elem.className+" ").replace(rclass," "):" ")){for(j=0;clazz=classes[j++];)cur.indexOf(" "+clazz+" ")<0&&(cur+=clazz+" ");finalValue=jQuery.trim(cur),elem.className!==finalValue&&(elem.className=finalValue)}return this},removeClass:function(value){var classes,elem,cur,clazz,j,finalValue,proceed=0===arguments.length||"string"==typeof value&&value,i=0,len=this.length;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).removeClass(value.call(this,j,this.className))});if(proceed)for(classes=(value||"").match(rnotwhite)||[];i<len;i++)if(elem=this[i],cur=1===elem.nodeType&&(elem.className?(" "+elem.className+" ").replace(rclass," "):"")){for(j=0;clazz=classes[j++];)for(;cur.indexOf(" "+clazz+" ")>=0;)cur=cur.replace(" "+clazz+" "," ");finalValue=value?jQuery.trim(cur):"",elem.className!==finalValue&&(elem.className=finalValue)}return this},toggleClass:function(value,stateVal){var type=typeof value;return"boolean"==typeof stateVal&&"string"===type?stateVal?this.addClass(value):this.removeClass(value):jQuery.isFunction(value)?this.each(function(i){jQuery(this).toggleClass(value.call(this,i,this.className,stateVal),stateVal)}):this.each(function(){if("string"===type)for(var className,i=0,self=jQuery(this),classNames=value.match(rnotwhite)||[];className=classNames[i++];)self.hasClass(className)?self.removeClass(className):self.addClass(className);else type!==strundefined&&"boolean"!==type||(this.className&&data_priv.set(this,"__className__",this.className),this.className=this.className||value===!1?"":data_priv.get(this,"__className__")||"")})},hasClass:function(selector){for(var className=" "+selector+" ",i=0,l=this.length;i<l;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(rclass," ").indexOf(className)>=0)return!0;return!1}});var rreturn=/\r/g;jQuery.fn.extend({val:function(value){var hooks,ret,isFunction,elem=this[0];{if(arguments.length)return isFunction=jQuery.isFunction(value),this.each(function(i){var val;1===this.nodeType&&(val=isFunction?value.call(this,i,jQuery(this).val()):value,null==val?val="":"number"==typeof val?val+="":jQuery.isArray(val)&&(val=jQuery.map(val,function(value){return null==value?"":value+""})),hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()],hooks&&"set"in hooks&&void 0!==hooks.set(this,val,"value")||(this.value=val))});if(elem)return hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()],hooks&&"get"in hooks&&void 0!==(ret=hooks.get(elem,"value"))?ret:(ret=elem.value,"string"==typeof ret?ret.replace(rreturn,""):null==ret?"":ret)}}}),jQuery.extend({valHooks:{option:{get:function(elem){var val=jQuery.find.attr(elem,"value");return null!=val?val:jQuery.trim(jQuery.text(elem))}},select:{get:function(elem){for(var value,option,options=elem.options,index=elem.selectedIndex,one="select-one"===elem.type||index<0,values=one?null:[],max=one?index+1:options.length,i=index<0?max:one?index:0;i<max;i++)if(option=options[i],(option.selected||i===index)&&(support.optDisabled?!option.disabled:null===option.getAttribute("disabled"))&&(!option.parentNode.disabled||!jQuery.nodeName(option.parentNode,"optgroup"))){if(value=jQuery(option).val(),one)return value;values.push(value)}return values},set:function(elem,value){for(var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;i--;)option=options[i],(option.selected=jQuery.inArray(option.value,values)>=0)&&(optionSet=!0);return optionSet||(elem.selectedIndex=-1),values}}}}),jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(elem,value){if(jQuery.isArray(value))return elem.checked=jQuery.inArray(jQuery(elem).val(),value)>=0}},support.checkOn||(jQuery.valHooks[this].get=function(elem){return null===elem.getAttribute("value")?"on":elem.value})}),jQuery.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name)}}),jQuery.fn.extend({hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)},bind:function(types,data,fn){return this.on(types,null,data,fn)},unbind:function(types,fn){return this.off(types,null,fn)},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn)},undelegate:function(selector,types,fn){return 1===arguments.length?this.off(selector,"**"):this.off(types,selector||"**",fn)}});var nonce=jQuery.now(),rquery=/\?/;jQuery.parseJSON=function(data){return JSON.parse(data+"")},jQuery.parseXML=function(data){var xml,tmp;if(!data||"string"!=typeof data)return null;try{tmp=new DOMParser,xml=tmp.parseFromString(data,"text/xml")}catch(e){xml=void 0}return xml&&!xml.getElementsByTagName("parsererror").length||jQuery.error("Invalid XML: "+data),xml};var rhash=/#.*$/,rts=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)$/gm,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rurl=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,prefilters={},transports={},allTypes="*/".concat("*"),ajaxLocation=window.location.href,ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[];jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ajaxLocation,type:"GET",isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;2!==state&&(state=2,timeoutTimer&&clearTimeout(timeoutTimer),transport=void 0,responseHeadersString=headers||"",jqXHR.readyState=status>0?4:0,isSuccess=status>=200&&status<300||304===status,responses&&(response=ajaxHandleResponses(s,jqXHR,responses)),response=ajaxConvert(s,response,jqXHR,isSuccess),isSuccess?(s.ifModified&&(modified=jqXHR.getResponseHeader("Last-Modified"),modified&&(jQuery.lastModified[cacheURL]=modified),modified=jqXHR.getResponseHeader("etag"),modified&&(jQuery.etag[cacheURL]=modified)),204===status||"HEAD"===s.type?statusText="nocontent":304===status?statusText="notmodified":(statusText=response.state,success=response.data,error=response.error,isSuccess=!error)):(error=statusText,!status&&statusText||(statusText="error",status<0&&(status=0))),jqXHR.status=status,jqXHR.statusText=(nativeStatusText||statusText)+"",isSuccess?deferred.resolveWith(callbackContext,[success,statusText,jqXHR]):deferred.rejectWith(callbackContext,[jqXHR,statusText,error]),jqXHR.statusCode(statusCode),statusCode=void 0,fireGlobals&&globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error]),completeDeferred.fireWith(callbackContext,[jqXHR,statusText]),fireGlobals&&(globalEventContext.trigger("ajaxComplete",[jqXHR,s]),--jQuery.active||jQuery.event.trigger("ajaxStop")))}"object"==typeof url&&(options=url,url=void 0),options=options||{};var transport,cacheURL,responseHeadersString,responseHeaders,timeoutTimer,parts,fireGlobals,i,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},state=0,strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){var match;if(2===state){if(!responseHeaders)for(responseHeaders={};match=rheaders.exec(responseHeadersString);)responseHeaders[match[1].toLowerCase()]=match[2];match=responseHeaders[key.toLowerCase()]}return null==match?null:match},getAllResponseHeaders:function(){return 2===state?responseHeadersString:null},setRequestHeader:function(name,value){var lname=name.toLowerCase();return state||(name=requestHeadersNames[lname]=requestHeadersNames[lname]||name,requestHeaders[name]=value),this},overrideMimeType:function(type){return state||(s.mimeType=type),this},statusCode:function(map){var code;if(map)if(state<2)for(code in map)statusCode[code]=[statusCode[code],map[code]];else jqXHR.always(map[jqXHR.status]);return this},abort:function(statusText){var finalText=statusText||strAbort;return transport&&transport.abort(finalText),done(0,finalText),this}};if(deferred.promise(jqXHR).complete=completeDeferred.add,jqXHR.success=jqXHR.done,jqXHR.error=jqXHR.fail,s.url=((url||s.url||ajaxLocation)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//"),s.type=options.method||options.type||s.method||s.type,s.dataTypes=jQuery.trim(s.dataType||"*").toLowerCase().match(rnotwhite)||[""],null==s.crossDomain&&(parts=rurl.exec(s.url.toLowerCase()),s.crossDomain=!(!parts||parts[1]===ajaxLocParts[1]&&parts[2]===ajaxLocParts[2]&&(parts[3]||("http:"===parts[1]?"80":"443"))===(ajaxLocParts[3]||("http:"===ajaxLocParts[1]?"80":"443")))),s.data&&s.processData&&"string"!=typeof s.data&&(s.data=jQuery.param(s.data,s.traditional)),inspectPrefiltersOrTransports(prefilters,s,options,jqXHR),2===state)return jqXHR;fireGlobals=jQuery.event&&s.global,fireGlobals&&0===jQuery.active++&&jQuery.event.trigger("ajaxStart"),s.type=s.type.toUpperCase(),s.hasContent=!rnoContent.test(s.type),cacheURL=s.url,s.hasContent||(s.data&&(cacheURL=s.url+=(rquery.test(cacheURL)?"&":"?")+s.data,delete s.data),s.cache===!1&&(s.url=rts.test(cacheURL)?cacheURL.replace(rts,"$1_="+nonce++):cacheURL+(rquery.test(cacheURL)?"&":"?")+"_="+nonce++)),s.ifModified&&(jQuery.lastModified[cacheURL]&&jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL]),jQuery.etag[cacheURL]&&jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL])),(s.data&&s.hasContent&&s.contentType!==!1||options.contentType)&&jqXHR.setRequestHeader("Content-Type",s.contentType),jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+("*"!==s.dataTypes[0]?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers)jqXHR.setRequestHeader(i,s.headers[i]);if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===!1||2===state))return jqXHR.abort();strAbort="abort";for(i in{success:1,error:1,complete:1})jqXHR[i](s[i]);if(transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR)){jqXHR.readyState=1,fireGlobals&&globalEventContext.trigger("ajaxSend",[jqXHR,s]),s.async&&s.timeout>0&&(timeoutTimer=setTimeout(function(){jqXHR.abort("timeout")},s.timeout));try{state=1,transport.send(requestHeaders,done)}catch(e){if(!(state<2))throw e;done(-1,e)}}else done(-1,"No Transport");return jqXHR},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")},getScript:function(url,callback){return jQuery.get(url,void 0,callback,"script")}}),jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){return jQuery.isFunction(data)&&(type=type||callback,callback=data,data=void 0),jQuery.ajax({url:url,type:method,dataType:type,data:data,
success:callback})}}),jQuery._evalUrl=function(url){return jQuery.ajax({url:url,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},jQuery.fn.extend({wrapAll:function(html){var wrap;return jQuery.isFunction(html)?this.each(function(i){jQuery(this).wrapAll(html.call(this,i))}):(this[0]&&(wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&wrap.insertBefore(this[0]),wrap.map(function(){for(var elem=this;elem.firstElementChild;)elem=elem.firstElementChild;return elem}).append(this)),this)},wrapInner:function(html){return jQuery.isFunction(html)?this.each(function(i){jQuery(this).wrapInner(html.call(this,i))}):this.each(function(){var self=jQuery(this),contents=self.contents();contents.length?contents.wrapAll(html):self.append(html)})},wrap:function(html){var isFunction=jQuery.isFunction(html);return this.each(function(i){jQuery(this).wrapAll(isFunction?html.call(this,i):html)})},unwrap:function(){return this.parent().each(function(){jQuery.nodeName(this,"body")||jQuery(this).replaceWith(this.childNodes)}).end()}}),jQuery.expr.filters.hidden=function(elem){return elem.offsetWidth<=0&&elem.offsetHeight<=0},jQuery.expr.filters.visible=function(elem){return!jQuery.expr.filters.hidden(elem)};var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,value){value=jQuery.isFunction(value)?value():null==value?"":value,s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value)};if(void 0===traditional&&(traditional=jQuery.ajaxSettings&&jQuery.ajaxSettings.traditional),jQuery.isArray(a)||a.jquery&&!jQuery.isPlainObject(a))jQuery.each(a,function(){add(this.name,this.value)});else for(prefix in a)buildParams(prefix,a[prefix],traditional,add);return s.join("&").replace(r20,"+")},jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!rcheckableType.test(type))}).map(function(i,elem){var val=jQuery(this).val();return null==val?null:jQuery.isArray(val)?jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}}):{name:elem.name,value:val.replace(rCRLF,"\r\n")}}).get()}}),jQuery.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var xhrId=0,xhrCallbacks={},xhrSuccessStatus={0:200,1223:204},xhrSupported=jQuery.ajaxSettings.xhr();window.attachEvent&&window.attachEvent("onunload",function(){for(var key in xhrCallbacks)xhrCallbacks[key]()}),support.cors=!!xhrSupported&&"withCredentials"in xhrSupported,support.ajax=xhrSupported=!!xhrSupported,jQuery.ajaxTransport(function(options){var callback;if(support.cors||xhrSupported&&!options.crossDomain)return{send:function(headers,complete){var i,xhr=options.xhr(),id=++xhrId;if(xhr.open(options.type,options.url,options.async,options.username,options.password),options.xhrFields)for(i in options.xhrFields)xhr[i]=options.xhrFields[i];options.mimeType&&xhr.overrideMimeType&&xhr.overrideMimeType(options.mimeType),options.crossDomain||headers["X-Requested-With"]||(headers["X-Requested-With"]="XMLHttpRequest");for(i in headers)xhr.setRequestHeader(i,headers[i]);callback=function(type){return function(){callback&&(delete xhrCallbacks[id],callback=xhr.onload=xhr.onerror=null,"abort"===type?xhr.abort():"error"===type?complete(xhr.status,xhr.statusText):complete(xhrSuccessStatus[xhr.status]||xhr.status,xhr.statusText,"string"==typeof xhr.responseText?{text:xhr.responseText}:void 0,xhr.getAllResponseHeaders()))}},xhr.onload=callback(),xhr.onerror=callback("error"),callback=xhrCallbacks[id]=callback("abort");try{xhr.send(options.hasContent&&options.data||null)}catch(e){if(callback)throw e}},abort:function(){callback&&callback()}}}),jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(text){return jQuery.globalEval(text),text}}}),jQuery.ajaxPrefilter("script",function(s){void 0===s.cache&&(s.cache=!1),s.crossDomain&&(s.type="GET")}),jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,callback;return{send:function(_,complete){script=jQuery("<script>").prop({async:!0,charset:s.scriptCharset,src:s.url}).on("load error",callback=function(evt){script.remove(),callback=null,evt&&complete("error"===evt.type?404:200,evt.type)}),document.head.appendChild(script[0])},abort:function(){callback&&callback()}}}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||jQuery.expando+"_"+nonce++;return this[callback]=!0,callback}}),jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=s.jsonp!==!1&&(rjsonp.test(s.url)?"url":"string"==typeof s.data&&!(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(s.data)&&"data");if(jsonProp||"jsonp"===s.dataTypes[0])return callbackName=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback,jsonProp?s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName):s.jsonp!==!1&&(s.url+=(rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName),s.converters["script json"]=function(){return responseContainer||jQuery.error(callbackName+" was not called"),responseContainer[0]},s.dataTypes[0]="json",overwritten=window[callbackName],window[callbackName]=function(){responseContainer=arguments},jqXHR.always(function(){window[callbackName]=overwritten,s[callbackName]&&(s.jsonpCallback=originalSettings.jsonpCallback,oldCallbacks.push(callbackName)),responseContainer&&jQuery.isFunction(overwritten)&&overwritten(responseContainer[0]),responseContainer=overwritten=void 0}),"script"}),jQuery.parseHTML=function(data,context,keepScripts){if(!data||"string"!=typeof data)return null;"boolean"==typeof context&&(keepScripts=context,context=!1),context=context||document;var parsed=rsingleTag.exec(data),scripts=!keepScripts&&[];return parsed?[context.createElement(parsed[1])]:(parsed=jQuery.buildFragment([data],context,scripts),scripts&&scripts.length&&jQuery(scripts).remove(),jQuery.merge([],parsed.childNodes))};var _load=jQuery.fn.load;jQuery.fn.load=function(url,params,callback){if("string"!=typeof url&&_load)return _load.apply(this,arguments);var selector,type,response,self=this,off=url.indexOf(" ");return off>=0&&(selector=jQuery.trim(url.slice(off)),url=url.slice(0,off)),jQuery.isFunction(params)?(callback=params,params=void 0):params&&"object"==typeof params&&(type="POST"),self.length>0&&jQuery.ajax({url:url,type:type,dataType:"html",data:params}).done(function(responseText){response=arguments,self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText)}).complete(callback&&function(jqXHR,status){self.each(callback,response||[jqXHR.responseText,status,jqXHR])}),this},jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(i,type){jQuery.fn[type]=function(fn){return this.on(type,fn)}}),jQuery.expr.filters.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length};var docElem=window.document.documentElement;jQuery.offset={setOffset:function(elem,options,i){var curPosition,curLeft,curCSSTop,curTop,curOffset,curCSSLeft,calculatePosition,position=jQuery.css(elem,"position"),curElem=jQuery(elem),props={};"static"===position&&(elem.style.position="relative"),curOffset=curElem.offset(),curCSSTop=jQuery.css(elem,"top"),curCSSLeft=jQuery.css(elem,"left"),calculatePosition=("absolute"===position||"fixed"===position)&&(curCSSTop+curCSSLeft).indexOf("auto")>-1,calculatePosition?(curPosition=curElem.position(),curTop=curPosition.top,curLeft=curPosition.left):(curTop=parseFloat(curCSSTop)||0,curLeft=parseFloat(curCSSLeft)||0),jQuery.isFunction(options)&&(options=options.call(elem,i,curOffset)),null!=options.top&&(props.top=options.top-curOffset.top+curTop),null!=options.left&&(props.left=options.left-curOffset.left+curLeft),"using"in options?options.using.call(elem,props):curElem.css(props)}},jQuery.fn.extend({offset:function(options){if(arguments.length)return void 0===options?this:this.each(function(i){jQuery.offset.setOffset(this,options,i)});var docElem,win,elem=this[0],box={top:0,left:0},doc=elem&&elem.ownerDocument;if(doc)return docElem=doc.documentElement,jQuery.contains(docElem,elem)?(typeof elem.getBoundingClientRect!==strundefined&&(box=elem.getBoundingClientRect()),win=getWindow(doc),{top:box.top+win.pageYOffset-docElem.clientTop,left:box.left+win.pageXOffset-docElem.clientLeft}):box},position:function(){if(this[0]){var offsetParent,offset,elem=this[0],parentOffset={top:0,left:0};return"fixed"===jQuery.css(elem,"position")?offset=elem.getBoundingClientRect():(offsetParent=this.offsetParent(),offset=this.offset(),jQuery.nodeName(offsetParent[0],"html")||(parentOffset=offsetParent.offset()),parentOffset.top+=jQuery.css(offsetParent[0],"borderTopWidth",!0),parentOffset.left+=jQuery.css(offsetParent[0],"borderLeftWidth",!0)),{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",!0),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var offsetParent=this.offsetParent||docElem;offsetParent&&!jQuery.nodeName(offsetParent,"html")&&"static"===jQuery.css(offsetParent,"position");)offsetParent=offsetParent.offsetParent;return offsetParent||docElem})}}),jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top="pageYOffset"===prop;jQuery.fn[method]=function(val){return access(this,function(elem,method,val){var win=getWindow(elem);return void 0===val?win?win[prop]:elem[method]:void(win?win.scrollTo(top?window.pageXOffset:val,top?val:window.pageYOffset):elem[method]=val)},method,val,arguments.length,null)}}),jQuery.each(["top","left"],function(i,prop){jQuery.cssHooks[prop]=addGetHookIf(support.pixelPosition,function(elem,computed){if(computed)return computed=curCSS(elem,prop),rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed})}),jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||"boolean"!=typeof margin),extra=defaultExtra||(margin===!0||value===!0?"margin":"border");return access(this,function(elem,type,value){var doc;return jQuery.isWindow(elem)?elem.document.documentElement["client"+name]:9===elem.nodeType?(doc=elem.documentElement,Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name])):void 0===value?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra)},type,chainable?margin:void 0,chainable,null)}})}),jQuery.fn.size=function(){return this.length},jQuery.fn.andSelf=jQuery.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return jQuery});var _jQuery=window.jQuery,_$=window.$;return jQuery.noConflict=function(deep){return window.$===jQuery&&(window.$=_$),deep&&window.jQuery===jQuery&&(window.jQuery=_jQuery),jQuery},typeof noGlobal===strundefined&&(window.jQuery=window.$=jQuery),jQuery}),function(jQuery){function keyHandler(handleObj){if("string"==typeof handleObj.data&&(handleObj.data={keys:handleObj.data}),handleObj.data&&handleObj.data.keys&&"string"==typeof handleObj.data.keys){var origHandler=handleObj.handler,keys=handleObj.data.keys.toLowerCase().split(" ");handleObj.handler=function(event){if(this===event.target||!(/textarea|select/i.test(event.target.nodeName)||jQuery.hotkeys.options.filterTextInputs&&jQuery.inArray(event.target.type,jQuery.hotkeys.textAcceptingInputTypes)>-1)){var special="keypress"!==event.type&&jQuery.hotkeys.specialKeys[event.which],character=String.fromCharCode(event.which).toLowerCase(),modif="",possible={};jQuery.each(["alt","ctrl","shift"],function(index,specialKey){event[specialKey+"Key"]&&special!==specialKey&&(modif+=specialKey+"+")}),event.metaKey&&!event.ctrlKey&&"meta"!==special&&(modif+="meta+"),event.metaKey&&"meta"!==special&&modif.indexOf("alt+ctrl+shift+")>-1&&(modif=modif.replace("alt+ctrl+shift+","hyper+")),special?possible[modif+special]=!0:(possible[modif+character]=!0,possible[modif+jQuery.hotkeys.shiftNums[character]]=!0,"shift+"===modif&&(possible[jQuery.hotkeys.shiftNums[character]]=!0));for(var i=0,l=keys.length;i<l;i++)if(possible[keys[i]])return origHandler.apply(this,arguments)}}}}jQuery.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",10:"return",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",59:";",61:"=",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},shiftNums:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"},textAcceptingInputTypes:["text","password","number","email","url","range","date","month","week","time","datetime","datetime-local","search","color","tel"],options:{filterTextInputs:!0}},jQuery.each(["keydown","keyup","keypress"],function(){jQuery.event.special[this]={add:keyHandler}})}(jQuery||this.jQuery||window.jQuery);var CanvasImage=function(image){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),document.body.appendChild(this.canvas),this.width=this.canvas.width=image.width,this.height=this.canvas.height=image.height,this.context.drawImage(image,0,0,this.width,this.height)};CanvasImage.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},CanvasImage.prototype.update=function(imageData){this.context.putImageData(imageData,0,0)},CanvasImage.prototype.getPixelCount=function(){return this.width*this.height},CanvasImage.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)},CanvasImage.prototype.removeCanvas=function(){this.canvas.parentNode.removeChild(this.canvas)};var ColorThief=function(){};if(ColorThief.prototype.getColor=function(sourceImage,quality){var palette=this.getPalette(sourceImage,5,quality),dominantColor=palette[0];return dominantColor},ColorThief.prototype.getPalette=function(sourceImage,colorCount,quality){"undefined"==typeof colorCount&&(colorCount=10),("undefined"==typeof quality||quality<1)&&(quality=10);for(var offset,r,g,b,a,image=new CanvasImage(sourceImage),imageData=image.getImageData(),pixels=imageData.data,pixelCount=image.getPixelCount(),pixelArray=[],i=0;i<pixelCount;i+=quality)offset=4*i,r=pixels[offset+0],g=pixels[offset+1],b=pixels[offset+2],a=pixels[offset+3],a>=125&&(r>250&&g>250&&b>250||pixelArray.push([r,g,b]));var cmap=MMCQ.quantize(pixelArray,colorCount),palette=cmap?cmap.palette():null;return image.removeCanvas(),palette},!pv)var pv={map:function(array,f){var o={};return f?array.map(function(d,i){return o.index=i,f.call(o,d)}):array.slice()},naturalOrder:function(a,b){return a<b?-1:a>b?1:0},sum:function(array,f){var o={};return array.reduce(f?function(p,d,i){return o.index=i,p+f.call(o,d)}:function(p,d){return p+d},0)},max:function(array,f){return Math.max.apply(null,f?pv.map(array,f):array)}};var MMCQ=function(){function getColorIndex(r,g,b){return(r<<2*sigbits)+(g<<sigbits)+b}function PQueue(comparator){function sort(){contents.sort(comparator),sorted=!0}var contents=[],sorted=!1;return{push:function(o){contents.push(o),sorted=!1},peek:function(index){return sorted||sort(),void 0===index&&(index=contents.length-1),contents[index]},pop:function(){return sorted||sort(),contents.pop()},size:function(){return contents.length},map:function(f){return contents.map(f)},debug:function(){return sorted||sort(),contents}}}function VBox(r1,r2,g1,g2,b1,b2,histo){var vbox=this;vbox.r1=r1,vbox.r2=r2,vbox.g1=g1,vbox.g2=g2,vbox.b1=b1,vbox.b2=b2,vbox.histo=histo}function CMap(){this.vboxes=new PQueue(function(a,b){return pv.naturalOrder(a.vbox.count()*a.vbox.volume(),b.vbox.count()*b.vbox.volume())})}function getHisto(pixels){var index,rval,gval,bval,histosize=1<<3*sigbits,histo=new Array(histosize);return pixels.forEach(function(pixel){rval=pixel[0]>>rshift,gval=pixel[1]>>rshift,bval=pixel[2]>>rshift,index=getColorIndex(rval,gval,bval),histo[index]=(histo[index]||0)+1}),histo}function vboxFromPixels(pixels,histo){var rval,gval,bval,rmin=1e6,rmax=0,gmin=1e6,gmax=0,bmin=1e6,bmax=0;return pixels.forEach(function(pixel){rval=pixel[0]>>rshift,gval=pixel[1]>>rshift,bval=pixel[2]>>rshift,rval<rmin?rmin=rval:rval>rmax&&(rmax=rval),gval<gmin?gmin=gval:gval>gmax&&(gmax=gval),bval<bmin?bmin=bval:bval>bmax&&(bmax=bval)}),new VBox(rmin,rmax,gmin,gmax,bmin,bmax,histo)}function medianCutApply(histo,vbox){function doCut(color){var left,right,vbox1,vbox2,d2,dim1=color+"1",dim2=color+"2",count2=0;for(i=vbox[dim1];i<=vbox[dim2];i++)if(partialsum[i]>total/2){for(vbox1=vbox.copy(),vbox2=vbox.copy(),left=i-vbox[dim1],right=vbox[dim2]-i,d2=left<=right?Math.min(vbox[dim2]-1,~~(i+right/2)):Math.max(vbox[dim1],~~(i-1-left/2));!partialsum[d2];)d2++;for(count2=lookaheadsum[d2];!count2&&partialsum[d2-1];)count2=lookaheadsum[--d2];return vbox1[dim2]=d2,vbox2[dim1]=vbox1[dim2]+1,[vbox1,vbox2]}}if(vbox.count()){var rw=vbox.r2-vbox.r1+1,gw=vbox.g2-vbox.g1+1,bw=vbox.b2-vbox.b1+1,maxw=pv.max([rw,gw,bw]);if(1==vbox.count())return[vbox.copy()];var i,j,k,sum,index,total=0,partialsum=[],lookaheadsum=[];if(maxw==rw)for(i=vbox.r1;i<=vbox.r2;i++){for(sum=0,j=vbox.g1;j<=vbox.g2;j++)for(k=vbox.b1;k<=vbox.b2;k++)index=getColorIndex(i,j,k),sum+=histo[index]||0;total+=sum,partialsum[i]=total}else if(maxw==gw)for(i=vbox.g1;i<=vbox.g2;i++){for(sum=0,j=vbox.r1;j<=vbox.r2;j++)for(k=vbox.b1;k<=vbox.b2;k++)index=getColorIndex(j,i,k),sum+=histo[index]||0;total+=sum,partialsum[i]=total}else for(i=vbox.b1;i<=vbox.b2;i++){for(sum=0,j=vbox.r1;j<=vbox.r2;j++)for(k=vbox.g1;k<=vbox.g2;k++)index=getColorIndex(j,k,i),sum+=histo[index]||0;total+=sum,partialsum[i]=total}return partialsum.forEach(function(d,i){lookaheadsum[i]=total-d}),doCut(maxw==rw?"r":maxw==gw?"g":"b")}}function quantize(pixels,maxcolors){function iter(lh,target){for(var vbox,ncolors=1,niters=0;niters<maxIterations;)if(vbox=lh.pop(),vbox.count()){var vboxes=medianCutApply(histo,vbox),vbox1=vboxes[0],vbox2=vboxes[1];if(!vbox1)return;if(lh.push(vbox1),vbox2&&(lh.push(vbox2),ncolors++),ncolors>=target)return;if(niters++>maxIterations)return}else lh.push(vbox),niters++}if(!pixels.length||maxcolors<2||maxcolors>256)return!1;var histo=getHisto(pixels),nColors=0;histo.forEach(function(){nColors++});var vbox=vboxFromPixels(pixels,histo),pq=new PQueue(function(a,b){return pv.naturalOrder(a.count(),b.count())});pq.push(vbox),iter(pq,fractByPopulations*maxcolors);for(var pq2=new PQueue(function(a,b){return pv.naturalOrder(a.count()*a.volume(),b.count()*b.volume())});pq.size();)pq2.push(pq.pop());iter(pq2,maxcolors-pq2.size());for(var cmap=new CMap;pq2.size();)cmap.push(pq2.pop());return cmap}var sigbits=5,rshift=8-sigbits,maxIterations=1e3,fractByPopulations=.75;return VBox.prototype={volume:function(force){var vbox=this;return vbox._volume&&!force||(vbox._volume=(vbox.r2-vbox.r1+1)*(vbox.g2-vbox.g1+1)*(vbox.b2-vbox.b1+1)),vbox._volume},count:function(force){var vbox=this,histo=vbox.histo;if(!vbox._count_set||force){var i,j,k,npix=0;for(i=vbox.r1;i<=vbox.r2;i++)for(j=vbox.g1;j<=vbox.g2;j++)for(k=vbox.b1;k<=vbox.b2;k++)index=getColorIndex(i,j,k),npix+=histo[index]||0;vbox._count=npix,vbox._count_set=!0}return vbox._count},copy:function(){var vbox=this;return new VBox(vbox.r1,vbox.r2,vbox.g1,vbox.g2,vbox.b1,vbox.b2,vbox.histo)},avg:function(force){var vbox=this,histo=vbox.histo;if(!vbox._avg||force){var hval,i,j,k,histoindex,ntot=0,mult=1<<8-sigbits,rsum=0,gsum=0,bsum=0;for(i=vbox.r1;i<=vbox.r2;i++)for(j=vbox.g1;j<=vbox.g2;j++)for(k=vbox.b1;k<=vbox.b2;k++)histoindex=getColorIndex(i,j,k),hval=histo[histoindex]||0,ntot+=hval,rsum+=hval*(i+.5)*mult,gsum+=hval*(j+.5)*mult,bsum+=hval*(k+.5)*mult;ntot?vbox._avg=[~~(rsum/ntot),~~(gsum/ntot),~~(bsum/ntot)]:vbox._avg=[~~(mult*(vbox.r1+vbox.r2+1)/2),~~(mult*(vbox.g1+vbox.g2+1)/2),~~(mult*(vbox.b1+vbox.b2+1)/2)]}return vbox._avg},contains:function(pixel){var vbox=this,rval=pixel[0]>>rshift;return gval=pixel[1]>>rshift,bval=pixel[2]>>rshift,rval>=vbox.r1&&rval<=vbox.r2&&gval>=vbox.g1&&gval<=vbox.g2&&bval>=vbox.b1&&bval<=vbox.b2}},CMap.prototype={push:function(vbox){this.vboxes.push({vbox:vbox,color:vbox.avg()})},palette:function(){return this.vboxes.map(function(vb){return vb.color})},size:function(){return this.vboxes.size()},map:function(color){for(var vboxes=this.vboxes,i=0;i<vboxes.size();i++)if(vboxes.peek(i).vbox.contains(color))return vboxes.peek(i).color;return this.nearest(color)},nearest:function(color){for(var d1,d2,pColor,vboxes=this.vboxes,i=0;i<vboxes.size();i++)d2=Math.sqrt(Math.pow(color[0]-vboxes.peek(i).color[0],2)+Math.pow(color[1]-vboxes.peek(i).color[1],2)+Math.pow(color[2]-vboxes.peek(i).color[2],2)),(d2<d1||void 0===d1)&&(d1=d2,pColor=vboxes.peek(i).color);return pColor},forcebw:function(){var vboxes=this.vboxes;vboxes.sort(function(a,b){return pv.naturalOrder(pv.sum(a.color),pv.sum(b.color))});var lowest=vboxes[0].color;lowest[0]<5&&lowest[1]<5&&lowest[2]<5&&(vboxes[0].color=[0,0,0]);var idx=vboxes.length-1,highest=vboxes[idx].color;highest[0]>251&&highest[1]>251&&highest[2]>251&&(vboxes[idx].color=[255,255,255])}},{quantize:quantize}}();(function(undefined){function dfl(a,b,c){switch(arguments.length){case 2:return null!=a?a:b;case 3:return null!=a?a:null!=b?b:c;default:throw new Error("Implement me")}}function hasOwnProp(a,b){return hasOwnProperty.call(a,b)}function defaultParsingFlags(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function printMsg(msg){moment.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+msg)}function deprecate(msg,fn){var firstTime=!0;return extend(function(){return firstTime&&(printMsg(msg),firstTime=!1),fn.apply(this,arguments)},fn)}function deprecateSimple(name,msg){deprecations[name]||(printMsg(msg),deprecations[name]=!0)}function padToken(func,count){return function(a){return leftZeroFill(func.call(this,a),count)}}function ordinalizeToken(func,period){return function(a){return this.localeData().ordinal(func.call(this,a),period)}}function Locale(){}function Moment(config,skipOverflow){skipOverflow!==!1&&checkOverflow(config),copyConfig(this,config),this._d=new Date(+config._d)}function Duration(duration){var normalizedInput=normalizeObjectUnits(duration),years=normalizedInput.year||0,quarters=normalizedInput.quarter||0,months=normalizedInput.month||0,weeks=normalizedInput.week||0,days=normalizedInput.day||0,hours=normalizedInput.hour||0,minutes=normalizedInput.minute||0,seconds=normalizedInput.second||0,milliseconds=normalizedInput.millisecond||0;this._milliseconds=+milliseconds+1e3*seconds+6e4*minutes+36e5*hours,this._days=+days+7*weeks,this._months=+months+3*quarters+12*years,this._data={},this._locale=moment.localeData(),this._bubble()}function extend(a,b){for(var i in b)hasOwnProp(b,i)&&(a[i]=b[i]);return hasOwnProp(b,"toString")&&(a.toString=b.toString),hasOwnProp(b,"valueOf")&&(a.valueOf=b.valueOf),a}function copyConfig(to,from){var i,prop,val;if("undefined"!=typeof from._isAMomentObject&&(to._isAMomentObject=from._isAMomentObject),"undefined"!=typeof from._i&&(to._i=from._i),"undefined"!=typeof from._f&&(to._f=from._f),"undefined"!=typeof from._l&&(to._l=from._l),"undefined"!=typeof from._strict&&(to._strict=from._strict),"undefined"!=typeof from._tzm&&(to._tzm=from._tzm),"undefined"!=typeof from._isUTC&&(to._isUTC=from._isUTC),"undefined"!=typeof from._offset&&(to._offset=from._offset),"undefined"!=typeof from._pf&&(to._pf=from._pf),"undefined"!=typeof from._locale&&(to._locale=from._locale),momentProperties.length>0)for(i in momentProperties)prop=momentProperties[i],val=from[prop],"undefined"!=typeof val&&(to[prop]=val);return to}function absRound(number){return number<0?Math.ceil(number):Math.floor(number)}function leftZeroFill(number,targetLength,forceSign){for(var output=""+Math.abs(number),sign=number>=0;output.length<targetLength;)output="0"+output;return(sign?forceSign?"+":"":"-")+output}function positiveMomentsDifference(base,other){var res={milliseconds:0,months:0};return res.months=other.month()-base.month()+12*(other.year()-base.year()),base.clone().add(res.months,"M").isAfter(other)&&--res.months,res.milliseconds=+other-+base.clone().add(res.months,"M"),res}function momentsDifference(base,other){var res;return other=makeAs(other,base),base.isBefore(other)?res=positiveMomentsDifference(base,other):(res=positiveMomentsDifference(other,base),res.milliseconds=-res.milliseconds,res.months=-res.months),res}function createAdder(direction,name){return function(val,period){var dur,tmp;return null===period||isNaN(+period)||(deprecateSimple(name,"moment()."+name+"(period, number) is deprecated. Please use moment()."+name+"(number, period)."),tmp=val,val=period,period=tmp),val="string"==typeof val?+val:val,dur=moment.duration(val,period),addOrSubtractDurationFromMoment(this,dur,direction),this}}function addOrSubtractDurationFromMoment(mom,duration,isAdding,updateOffset){var milliseconds=duration._milliseconds,days=duration._days,months=duration._months;updateOffset=null==updateOffset||updateOffset,milliseconds&&mom._d.setTime(+mom._d+milliseconds*isAdding),days&&rawSetter(mom,"Date",rawGetter(mom,"Date")+days*isAdding),months&&rawMonthSetter(mom,rawGetter(mom,"Month")+months*isAdding),updateOffset&&moment.updateOffset(mom,days||months)}function isArray(input){return"[object Array]"===Object.prototype.toString.call(input)}function isDate(input){return"[object Date]"===Object.prototype.toString.call(input)||input instanceof Date}function compareArrays(array1,array2,dontConvert){var i,len=Math.min(array1.length,array2.length),lengthDiff=Math.abs(array1.length-array2.length),diffs=0;for(i=0;i<len;i++)(dontConvert&&array1[i]!==array2[i]||!dontConvert&&toInt(array1[i])!==toInt(array2[i]))&&diffs++;return diffs+lengthDiff}function normalizeUnits(units){if(units){var lowered=units.toLowerCase().replace(/(.)s$/,"$1");units=unitAliases[units]||camelFunctions[lowered]||lowered}return units}function normalizeObjectUnits(inputObject){var normalizedProp,prop,normalizedInput={};for(prop in inputObject)hasOwnProp(inputObject,prop)&&(normalizedProp=normalizeUnits(prop),normalizedProp&&(normalizedInput[normalizedProp]=inputObject[prop]));return normalizedInput}function makeList(field){var count,setter;if(0===field.indexOf("week"))count=7,setter="day";else{if(0!==field.indexOf("month"))return;count=12,setter="month"}moment[field]=function(format,index){var i,getter,method=moment._locale[field],results=[];if("number"==typeof format&&(index=format,format=undefined),getter=function(i){var m=moment().utc().set(setter,i);return method.call(moment._locale,m,format||"")},null!=index)return getter(index);for(i=0;i<count;i++)results.push(getter(i));return results}}function toInt(argumentForCoercion){var coercedNumber=+argumentForCoercion,value=0;return 0!==coercedNumber&&isFinite(coercedNumber)&&(value=coercedNumber>=0?Math.floor(coercedNumber):Math.ceil(coercedNumber)),value}function daysInMonth(year,month){return new Date(Date.UTC(year,month+1,0)).getUTCDate()}function weeksInYear(year,dow,doy){return weekOfYear(moment([year,11,31+dow-doy]),dow,doy).week}function daysInYear(year){return isLeapYear(year)?366:365}function isLeapYear(year){return year%4===0&&year%100!==0||year%400===0}function checkOverflow(m){var overflow;m._a&&m._pf.overflow===-2&&(overflow=m._a[MONTH]<0||m._a[MONTH]>11?MONTH:m._a[DATE]<1||m._a[DATE]>daysInMonth(m._a[YEAR],m._a[MONTH])?DATE:m._a[HOUR]<0||m._a[HOUR]>24||24===m._a[HOUR]&&(0!==m._a[MINUTE]||0!==m._a[SECOND]||0!==m._a[MILLISECOND])?HOUR:m._a[MINUTE]<0||m._a[MINUTE]>59?MINUTE:m._a[SECOND]<0||m._a[SECOND]>59?SECOND:m._a[MILLISECOND]<0||m._a[MILLISECOND]>999?MILLISECOND:-1,m._pf._overflowDayOfYear&&(overflow<YEAR||overflow>DATE)&&(overflow=DATE),m._pf.overflow=overflow)}function isValid(m){return null==m._isValid&&(m._isValid=!isNaN(m._d.getTime())&&m._pf.overflow<0&&!m._pf.empty&&!m._pf.invalidMonth&&!m._pf.nullInput&&!m._pf.invalidFormat&&!m._pf.userInvalidated,m._strict&&(m._isValid=m._isValid&&0===m._pf.charsLeftOver&&0===m._pf.unusedTokens.length&&m._pf.bigHour===undefined)),m._isValid}function normalizeLocale(key){return key?key.toLowerCase().replace("_","-"):key}function chooseLocale(names){for(var j,next,locale,split,i=0;i<names.length;){for(split=normalizeLocale(names[i]).split("-"),j=split.length,next=normalizeLocale(names[i+1]),next=next?next.split("-"):null;j>0;){if(locale=loadLocale(split.slice(0,j).join("-")))return locale;if(next&&next.length>=j&&compareArrays(split,next,!0)>=j-1)break;j--}i++}return null}function loadLocale(name){var oldLocale=null;if(!locales[name]&&hasModule)try{oldLocale=moment.locale(),require("./locale/"+name),moment.locale(oldLocale)}catch(e){}return locales[name]}function makeAs(input,model){var res,diff;return model._isUTC?(res=model.clone(),diff=(moment.isMoment(input)||isDate(input)?+input:+moment(input))-+res,res._d.setTime(+res._d+diff),moment.updateOffset(res,!1),res):moment(input).local()}function removeFormattingTokens(input){return input.match(/\[[\s\S]/)?input.replace(/^\[|\]$/g,""):input.replace(/\\/g,"")}function makeFormatFunction(format){var i,length,array=format.match(formattingTokens);for(i=0,length=array.length;i<length;i++)formatTokenFunctions[array[i]]?array[i]=formatTokenFunctions[array[i]]:array[i]=removeFormattingTokens(array[i]);return function(mom){var output="";for(i=0;i<length;i++)output+=array[i]instanceof Function?array[i].call(mom,format):array[i];return output}}function formatMoment(m,format){return m.isValid()?(format=expandFormat(format,m.localeData()),formatFunctions[format]||(formatFunctions[format]=makeFormatFunction(format)),formatFunctions[format](m)):m.localeData().invalidDate()}function expandFormat(format,locale){function replaceLongDateFormatTokens(input){return locale.longDateFormat(input)||input}var i=5;for(localFormattingTokens.lastIndex=0;i>=0&&localFormattingTokens.test(format);)format=format.replace(localFormattingTokens,replaceLongDateFormatTokens),localFormattingTokens.lastIndex=0,i-=1;return format}function getParseRegexForToken(token,config){var a,strict=config._strict;switch(token){case"Q":return parseTokenOneDigit;case"DDDD":return parseTokenThreeDigits;case"YYYY":case"GGGG":case"gggg":return strict?parseTokenFourDigits:parseTokenOneToFourDigits;case"Y":case"G":case"g":return parseTokenSignedNumber;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return strict?parseTokenSixDigits:parseTokenOneToSixDigits;case"S":if(strict)return parseTokenOneDigit;case"SS":if(strict)return parseTokenTwoDigits;case"SSS":if(strict)return parseTokenThreeDigits;case"DDD":return parseTokenOneToThreeDigits;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return parseTokenWord;case"a":case"A":return config._locale._meridiemParse;case"x":return parseTokenOffsetMs;
case"X":return parseTokenTimestampMs;case"Z":case"ZZ":return parseTokenTimezone;case"T":return parseTokenT;case"SSSS":return parseTokenDigits;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return strict?parseTokenTwoDigits:parseTokenOneOrTwoDigits;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return parseTokenOneOrTwoDigits;case"Do":return strict?config._locale._ordinalParse:config._locale._ordinalParseLenient;default:return a=new RegExp(regexpEscape(unescapeFormat(token.replace("\\","")),"i"))}}function timezoneMinutesFromString(string){string=string||"";var possibleTzMatches=string.match(parseTokenTimezone)||[],tzChunk=possibleTzMatches[possibleTzMatches.length-1]||[],parts=(tzChunk+"").match(parseTimezoneChunker)||["-",0,0],minutes=+(60*parts[1])+toInt(parts[2]);return"+"===parts[0]?-minutes:minutes}function addTimeToArrayFromToken(token,input,config){var a,datePartArray=config._a;switch(token){case"Q":null!=input&&(datePartArray[MONTH]=3*(toInt(input)-1));break;case"M":case"MM":null!=input&&(datePartArray[MONTH]=toInt(input)-1);break;case"MMM":case"MMMM":a=config._locale.monthsParse(input,token,config._strict),null!=a?datePartArray[MONTH]=a:config._pf.invalidMonth=input;break;case"D":case"DD":null!=input&&(datePartArray[DATE]=toInt(input));break;case"Do":null!=input&&(datePartArray[DATE]=toInt(parseInt(input.match(/\d{1,2}/)[0],10)));break;case"DDD":case"DDDD":null!=input&&(config._dayOfYear=toInt(input));break;case"YY":datePartArray[YEAR]=moment.parseTwoDigitYear(input);break;case"YYYY":case"YYYYY":case"YYYYYY":datePartArray[YEAR]=toInt(input);break;case"a":case"A":config._isPm=config._locale.isPM(input);break;case"h":case"hh":config._pf.bigHour=!0;case"H":case"HH":datePartArray[HOUR]=toInt(input);break;case"m":case"mm":datePartArray[MINUTE]=toInt(input);break;case"s":case"ss":datePartArray[SECOND]=toInt(input);break;case"S":case"SS":case"SSS":case"SSSS":datePartArray[MILLISECOND]=toInt(1e3*("0."+input));break;case"x":config._d=new Date(toInt(input));break;case"X":config._d=new Date(1e3*parseFloat(input));break;case"Z":case"ZZ":config._useUTC=!0,config._tzm=timezoneMinutesFromString(input);break;case"dd":case"ddd":case"dddd":a=config._locale.weekdaysParse(input),null!=a?(config._w=config._w||{},config._w.d=a):config._pf.invalidWeekday=input;break;case"w":case"ww":case"W":case"WW":case"d":case"e":case"E":token=token.substr(0,1);case"gggg":case"GGGG":case"GGGGG":token=token.substr(0,2),input&&(config._w=config._w||{},config._w[token]=toInt(input));break;case"gg":case"GG":config._w=config._w||{},config._w[token]=moment.parseTwoDigitYear(input)}}function dayOfYearFromWeekInfo(config){var w,weekYear,week,weekday,dow,doy,temp;w=config._w,null!=w.GG||null!=w.W||null!=w.E?(dow=1,doy=4,weekYear=dfl(w.GG,config._a[YEAR],weekOfYear(moment(),1,4).year),week=dfl(w.W,1),weekday=dfl(w.E,1)):(dow=config._locale._week.dow,doy=config._locale._week.doy,weekYear=dfl(w.gg,config._a[YEAR],weekOfYear(moment(),dow,doy).year),week=dfl(w.w,1),null!=w.d?(weekday=w.d,weekday<dow&&++week):weekday=null!=w.e?w.e+dow:dow),temp=dayOfYearFromWeeks(weekYear,week,weekday,doy,dow),config._a[YEAR]=temp.year,config._dayOfYear=temp.dayOfYear}function dateFromConfig(config){var i,date,currentDate,yearToUse,input=[];if(!config._d){for(currentDate=currentDateArray(config),config._w&&null==config._a[DATE]&&null==config._a[MONTH]&&dayOfYearFromWeekInfo(config),config._dayOfYear&&(yearToUse=dfl(config._a[YEAR],currentDate[YEAR]),config._dayOfYear>daysInYear(yearToUse)&&(config._pf._overflowDayOfYear=!0),date=makeUTCDate(yearToUse,0,config._dayOfYear),config._a[MONTH]=date.getUTCMonth(),config._a[DATE]=date.getUTCDate()),i=0;i<3&&null==config._a[i];++i)config._a[i]=input[i]=currentDate[i];for(;i<7;i++)config._a[i]=input[i]=null==config._a[i]?2===i?1:0:config._a[i];24===config._a[HOUR]&&0===config._a[MINUTE]&&0===config._a[SECOND]&&0===config._a[MILLISECOND]&&(config._nextDay=!0,config._a[HOUR]=0),config._d=(config._useUTC?makeUTCDate:makeDate).apply(null,input),null!=config._tzm&&config._d.setUTCMinutes(config._d.getUTCMinutes()+config._tzm),config._nextDay&&(config._a[HOUR]=24)}}function dateFromObject(config){var normalizedInput;config._d||(normalizedInput=normalizeObjectUnits(config._i),config._a=[normalizedInput.year,normalizedInput.month,normalizedInput.day||normalizedInput.date,normalizedInput.hour,normalizedInput.minute,normalizedInput.second,normalizedInput.millisecond],dateFromConfig(config))}function currentDateArray(config){var now=new Date;return config._useUTC?[now.getUTCFullYear(),now.getUTCMonth(),now.getUTCDate()]:[now.getFullYear(),now.getMonth(),now.getDate()]}function makeDateFromStringAndFormat(config){if(config._f===moment.ISO_8601)return void parseISO(config);config._a=[],config._pf.empty=!0;var i,parsedInput,tokens,token,skipped,string=""+config._i,stringLength=string.length,totalParsedInputLength=0;for(tokens=expandFormat(config._f,config._locale).match(formattingTokens)||[],i=0;i<tokens.length;i++)token=tokens[i],parsedInput=(string.match(getParseRegexForToken(token,config))||[])[0],parsedInput&&(skipped=string.substr(0,string.indexOf(parsedInput)),skipped.length>0&&config._pf.unusedInput.push(skipped),string=string.slice(string.indexOf(parsedInput)+parsedInput.length),totalParsedInputLength+=parsedInput.length),formatTokenFunctions[token]?(parsedInput?config._pf.empty=!1:config._pf.unusedTokens.push(token),addTimeToArrayFromToken(token,parsedInput,config)):config._strict&&!parsedInput&&config._pf.unusedTokens.push(token);config._pf.charsLeftOver=stringLength-totalParsedInputLength,string.length>0&&config._pf.unusedInput.push(string),config._pf.bigHour===!0&&config._a[HOUR]<=12&&(config._pf.bigHour=undefined),config._isPm&&config._a[HOUR]<12&&(config._a[HOUR]+=12),config._isPm===!1&&12===config._a[HOUR]&&(config._a[HOUR]=0),dateFromConfig(config),checkOverflow(config)}function unescapeFormat(s){return s.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(matched,p1,p2,p3,p4){return p1||p2||p3||p4})}function regexpEscape(s){return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function makeDateFromStringAndArray(config){var tempConfig,bestMoment,scoreToBeat,i,currentScore;if(0===config._f.length)return config._pf.invalidFormat=!0,void(config._d=new Date(NaN));for(i=0;i<config._f.length;i++)currentScore=0,tempConfig=copyConfig({},config),null!=config._useUTC&&(tempConfig._useUTC=config._useUTC),tempConfig._pf=defaultParsingFlags(),tempConfig._f=config._f[i],makeDateFromStringAndFormat(tempConfig),isValid(tempConfig)&&(currentScore+=tempConfig._pf.charsLeftOver,currentScore+=10*tempConfig._pf.unusedTokens.length,tempConfig._pf.score=currentScore,(null==scoreToBeat||currentScore<scoreToBeat)&&(scoreToBeat=currentScore,bestMoment=tempConfig));extend(config,bestMoment||tempConfig)}function parseISO(config){var i,l,string=config._i,match=isoRegex.exec(string);if(match){for(config._pf.iso=!0,i=0,l=isoDates.length;i<l;i++)if(isoDates[i][1].exec(string)){config._f=isoDates[i][0]+(match[6]||" ");break}for(i=0,l=isoTimes.length;i<l;i++)if(isoTimes[i][1].exec(string)){config._f+=isoTimes[i][0];break}string.match(parseTokenTimezone)&&(config._f+="Z"),makeDateFromStringAndFormat(config)}else config._isValid=!1}function makeDateFromString(config){parseISO(config),config._isValid===!1&&(delete config._isValid,moment.createFromInputFallback(config))}function map(arr,fn){var i,res=[];for(i=0;i<arr.length;++i)res.push(fn(arr[i],i));return res}function makeDateFromInput(config){var matched,input=config._i;input===undefined?config._d=new Date:isDate(input)?config._d=new Date(+input):null!==(matched=aspNetJsonRegex.exec(input))?config._d=new Date(+matched[1]):"string"==typeof input?makeDateFromString(config):isArray(input)?(config._a=map(input.slice(0),function(obj){return parseInt(obj,10)}),dateFromConfig(config)):"object"==typeof input?dateFromObject(config):"number"==typeof input?config._d=new Date(input):moment.createFromInputFallback(config)}function makeDate(y,m,d,h,M,s,ms){var date=new Date(y,m,d,h,M,s,ms);return y<1970&&date.setFullYear(y),date}function makeUTCDate(y){var date=new Date(Date.UTC.apply(null,arguments));return y<1970&&date.setUTCFullYear(y),date}function parseWeekday(input,locale){if("string"==typeof input)if(isNaN(input)){if(input=locale.weekdaysParse(input),"number"!=typeof input)return null}else input=parseInt(input,10);return input}function substituteTimeAgo(string,number,withoutSuffix,isFuture,locale){return locale.relativeTime(number||1,!!withoutSuffix,string,isFuture)}function relativeTime(posNegDuration,withoutSuffix,locale){var duration=moment.duration(posNegDuration).abs(),seconds=round(duration.as("s")),minutes=round(duration.as("m")),hours=round(duration.as("h")),days=round(duration.as("d")),months=round(duration.as("M")),years=round(duration.as("y")),args=seconds<relativeTimeThresholds.s&&["s",seconds]||1===minutes&&["m"]||minutes<relativeTimeThresholds.m&&["mm",minutes]||1===hours&&["h"]||hours<relativeTimeThresholds.h&&["hh",hours]||1===days&&["d"]||days<relativeTimeThresholds.d&&["dd",days]||1===months&&["M"]||months<relativeTimeThresholds.M&&["MM",months]||1===years&&["y"]||["yy",years];return args[2]=withoutSuffix,args[3]=+posNegDuration>0,args[4]=locale,substituteTimeAgo.apply({},args)}function weekOfYear(mom,firstDayOfWeek,firstDayOfWeekOfYear){var adjustedMoment,end=firstDayOfWeekOfYear-firstDayOfWeek,daysToDayOfWeek=firstDayOfWeekOfYear-mom.day();return daysToDayOfWeek>end&&(daysToDayOfWeek-=7),daysToDayOfWeek<end-7&&(daysToDayOfWeek+=7),adjustedMoment=moment(mom).add(daysToDayOfWeek,"d"),{week:Math.ceil(adjustedMoment.dayOfYear()/7),year:adjustedMoment.year()}}function dayOfYearFromWeeks(year,week,weekday,firstDayOfWeekOfYear,firstDayOfWeek){var daysToAdd,dayOfYear,d=makeUTCDate(year,0,1).getUTCDay();return d=0===d?7:d,weekday=null!=weekday?weekday:firstDayOfWeek,daysToAdd=firstDayOfWeek-d+(d>firstDayOfWeekOfYear?7:0)-(d<firstDayOfWeek?7:0),dayOfYear=7*(week-1)+(weekday-firstDayOfWeek)+daysToAdd+1,{year:dayOfYear>0?year:year-1,dayOfYear:dayOfYear>0?dayOfYear:daysInYear(year-1)+dayOfYear}}function makeMoment(config){var res,input=config._i,format=config._f;return config._locale=config._locale||moment.localeData(config._l),null===input||format===undefined&&""===input?moment.invalid({nullInput:!0}):("string"==typeof input&&(config._i=input=config._locale.preparse(input)),moment.isMoment(input)?new Moment(input,!0):(format?isArray(format)?makeDateFromStringAndArray(config):makeDateFromStringAndFormat(config):makeDateFromInput(config),res=new Moment(config),res._nextDay&&(res.add(1,"d"),res._nextDay=undefined),res))}function pickBy(fn,moments){var res,i;if(1===moments.length&&isArray(moments[0])&&(moments=moments[0]),!moments.length)return moment();for(res=moments[0],i=1;i<moments.length;++i)moments[i][fn](res)&&(res=moments[i]);return res}function rawMonthSetter(mom,value){var dayOfMonth;return"string"==typeof value&&(value=mom.localeData().monthsParse(value),"number"!=typeof value)?mom:(dayOfMonth=Math.min(mom.date(),daysInMonth(mom.year(),value)),mom._d["set"+(mom._isUTC?"UTC":"")+"Month"](value,dayOfMonth),mom)}function rawGetter(mom,unit){return mom._d["get"+(mom._isUTC?"UTC":"")+unit]()}function rawSetter(mom,unit,value){return"Month"===unit?rawMonthSetter(mom,value):mom._d["set"+(mom._isUTC?"UTC":"")+unit](value)}function makeAccessor(unit,keepTime){return function(value){return null!=value?(rawSetter(this,unit,value),moment.updateOffset(this,keepTime),this):rawGetter(this,unit)}}function daysToYears(days){return 400*days/146097}function yearsToDays(years){return 146097*years/400}function makeDurationGetter(name){moment.duration.fn[name]=function(){return this._data[name]}}function makeGlobal(shouldDeprecate){"undefined"==typeof ender&&(oldGlobalMoment=globalScope.moment,shouldDeprecate?globalScope.moment=deprecate("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.",moment):globalScope.moment=moment)}for(var moment,oldGlobalMoment,i,VERSION="2.8.4",globalScope="undefined"!=typeof global?global:this,round=Math.round,hasOwnProperty=Object.prototype.hasOwnProperty,YEAR=0,MONTH=1,DATE=2,HOUR=3,MINUTE=4,SECOND=5,MILLISECOND=6,locales={},momentProperties=[],hasModule="undefined"!=typeof module&&module&&module.exports,aspNetJsonRegex=/^\/?Date\((\-?\d+)/i,aspNetTimeSpanJsonRegex=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,isoDurationRegex=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,formattingTokens=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|x|X|zz?|ZZ?|.)/g,localFormattingTokens=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,parseTokenOneOrTwoDigits=/\d\d?/,parseTokenOneToThreeDigits=/\d{1,3}/,parseTokenOneToFourDigits=/\d{1,4}/,parseTokenOneToSixDigits=/[+\-]?\d{1,6}/,parseTokenDigits=/\d+/,parseTokenWord=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,parseTokenTimezone=/Z|[\+\-]\d\d:?\d\d/gi,parseTokenT=/T/i,parseTokenOffsetMs=/[\+\-]?\d+/,parseTokenTimestampMs=/[\+\-]?\d+(\.\d{1,3})?/,parseTokenOneDigit=/\d/,parseTokenTwoDigits=/\d\d/,parseTokenThreeDigits=/\d{3}/,parseTokenFourDigits=/\d{4}/,parseTokenSixDigits=/[+-]?\d{6}/,parseTokenSignedNumber=/[+-]?\d+/,isoRegex=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,isoFormat="YYYY-MM-DDTHH:mm:ssZ",isoDates=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],isoTimes=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],parseTimezoneChunker=/([\+\-]|\d\d)/gi,unitMillisecondFactors=("Date|Hours|Minutes|Seconds|Milliseconds".split("|"),{Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6}),unitAliases={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",Q:"quarter",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},camelFunctions={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},formatFunctions={},relativeTimeThresholds={s:45,m:45,h:22,d:26,M:11},ordinalizeTokens="DDD w W M D d".split(" "),paddedTokens="M D H h m s w W".split(" "),formatTokenFunctions={M:function(){return this.month()+1},MMM:function(format){return this.localeData().monthsShort(this,format)},MMMM:function(format){return this.localeData().months(this,format)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(format){return this.localeData().weekdaysMin(this,format)},ddd:function(format){return this.localeData().weekdaysShort(this,format)},dddd:function(format){return this.localeData().weekdays(this,format)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return leftZeroFill(this.year()%100,2)},YYYY:function(){return leftZeroFill(this.year(),4)},YYYYY:function(){return leftZeroFill(this.year(),5)},YYYYYY:function(){var y=this.year(),sign=y>=0?"+":"-";return sign+leftZeroFill(Math.abs(y),6)},gg:function(){return leftZeroFill(this.weekYear()%100,2)},gggg:function(){return leftZeroFill(this.weekYear(),4)},ggggg:function(){return leftZeroFill(this.weekYear(),5)},GG:function(){return leftZeroFill(this.isoWeekYear()%100,2)},GGGG:function(){return leftZeroFill(this.isoWeekYear(),4)},GGGGG:function(){return leftZeroFill(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return toInt(this.milliseconds()/100)},SS:function(){return leftZeroFill(toInt(this.milliseconds()/10),2)},SSS:function(){return leftZeroFill(this.milliseconds(),3)},SSSS:function(){return leftZeroFill(this.milliseconds(),3)},Z:function(){var a=-this.zone(),b="+";return a<0&&(a=-a,b="-"),b+leftZeroFill(toInt(a/60),2)+":"+leftZeroFill(toInt(a)%60,2)},ZZ:function(){var a=-this.zone(),b="+";return a<0&&(a=-a,b="-"),b+leftZeroFill(toInt(a/60),2)+leftZeroFill(toInt(a)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},x:function(){return this.valueOf()},X:function(){return this.unix()},Q:function(){return this.quarter()}},deprecations={},lists=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];ordinalizeTokens.length;)i=ordinalizeTokens.pop(),formatTokenFunctions[i+"o"]=ordinalizeToken(formatTokenFunctions[i],i);for(;paddedTokens.length;)i=paddedTokens.pop(),formatTokenFunctions[i+i]=padToken(formatTokenFunctions[i],2);formatTokenFunctions.DDDD=padToken(formatTokenFunctions.DDD,3),extend(Locale.prototype,{set:function(config){var prop,i;for(i in config)prop=config[i],"function"==typeof prop?this[i]=prop:this["_"+i]=prop;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(m){return this._months[m.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(m){return this._monthsShort[m.month()]},monthsParse:function(monthName,format,strict){var i,mom,regex;for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;i<12;i++){if(mom=moment.utc([2e3,i]),strict&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(mom,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(mom,"").replace(".","")+"$","i")),strict||this._monthsParse[i]||(regex="^"+this.months(mom,"")+"|^"+this.monthsShort(mom,""),this._monthsParse[i]=new RegExp(regex.replace(".",""),"i")),strict&&"MMMM"===format&&this._longMonthsParse[i].test(monthName))return i;if(strict&&"MMM"===format&&this._shortMonthsParse[i].test(monthName))return i;if(!strict&&this._monthsParse[i].test(monthName))return i}},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(m){return this._weekdays[m.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(m){return this._weekdaysShort[m.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(m){return this._weekdaysMin[m.day()]},weekdaysParse:function(weekdayName){var i,mom,regex;for(this._weekdaysParse||(this._weekdaysParse=[]),i=0;i<7;i++)if(this._weekdaysParse[i]||(mom=moment([2e3,1]).day(i),regex="^"+this.weekdays(mom,"")+"|^"+this.weekdaysShort(mom,"")+"|^"+this.weekdaysMin(mom,""),this._weekdaysParse[i]=new RegExp(regex.replace(".",""),"i")),this._weekdaysParse[i].test(weekdayName))return i},_longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY LT",LLLL:"dddd, MMMM D, YYYY LT"},longDateFormat:function(key){var output=this._longDateFormat[key];return!output&&this._longDateFormat[key.toUpperCase()]&&(output=this._longDateFormat[key.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(val){return val.slice(1)}),this._longDateFormat[key]=output),output},isPM:function(input){return"p"===(input+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(hours,minutes,isLower){return hours>11?isLower?"pm":"PM":isLower?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(key,mom,now){var output=this._calendar[key];return"function"==typeof output?output.apply(mom,[now]):output},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(number,withoutSuffix,string,isFuture){var output=this._relativeTime[string];return"function"==typeof output?output(number,withoutSuffix,string,isFuture):output.replace(/%d/i,number)},pastFuture:function(diff,output){var format=this._relativeTime[diff>0?"future":"past"];return"function"==typeof format?format(output):format.replace(/%s/i,output)},ordinal:function(number){return this._ordinal.replace("%d",number)},_ordinal:"%d",_ordinalParse:/\d{1,2}/,preparse:function(string){return string},postformat:function(string){return string},week:function(mom){return weekOfYear(mom,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),moment=function(input,format,locale,strict){var c;return"boolean"==typeof locale&&(strict=locale,locale=undefined),c={},c._isAMomentObject=!0,c._i=input,c._f=format,c._l=locale,c._strict=strict,c._isUTC=!1,c._pf=defaultParsingFlags(),makeMoment(c)},moment.suppressDeprecationWarnings=!1,moment.createFromInputFallback=deprecate("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(config){config._d=new Date(config._i+(config._useUTC?" UTC":""))}),moment.min=function(){var args=[].slice.call(arguments,0);return pickBy("isBefore",args)},moment.max=function(){var args=[].slice.call(arguments,0);return pickBy("isAfter",args)},moment.utc=function(input,format,locale,strict){var c;return"boolean"==typeof locale&&(strict=locale,locale=undefined),c={},c._isAMomentObject=!0,c._useUTC=!0,c._isUTC=!0,c._l=locale,c._i=input,c._f=format,c._strict=strict,c._pf=defaultParsingFlags(),makeMoment(c).utc()},moment.unix=function(input){return moment(1e3*input)},moment.duration=function(input,key){var sign,ret,parseIso,diffRes,duration=input,match=null;return moment.isDuration(input)?duration={ms:input._milliseconds,d:input._days,M:input._months}:"number"==typeof input?(duration={},key?duration[key]=input:duration.milliseconds=input):(match=aspNetTimeSpanJsonRegex.exec(input))?(sign="-"===match[1]?-1:1,duration={y:0,d:toInt(match[DATE])*sign,h:toInt(match[HOUR])*sign,m:toInt(match[MINUTE])*sign,s:toInt(match[SECOND])*sign,ms:toInt(match[MILLISECOND])*sign}):(match=isoDurationRegex.exec(input))?(sign="-"===match[1]?-1:1,parseIso=function(inp){var res=inp&&parseFloat(inp.replace(",","."));return(isNaN(res)?0:res)*sign},duration={y:parseIso(match[2]),M:parseIso(match[3]),d:parseIso(match[4]),h:parseIso(match[5]),m:parseIso(match[6]),s:parseIso(match[7]),w:parseIso(match[8])}):"object"==typeof duration&&("from"in duration||"to"in duration)&&(diffRes=momentsDifference(moment(duration.from),moment(duration.to)),duration={},duration.ms=diffRes.milliseconds,duration.M=diffRes.months),ret=new Duration(duration),moment.isDuration(input)&&hasOwnProp(input,"_locale")&&(ret._locale=input._locale),ret},moment.version=VERSION,moment.defaultFormat=isoFormat,moment.ISO_8601=function(){},moment.momentProperties=momentProperties,moment.updateOffset=function(){},moment.relativeTimeThreshold=function(threshold,limit){return relativeTimeThresholds[threshold]!==undefined&&(limit===undefined?relativeTimeThresholds[threshold]:(relativeTimeThresholds[threshold]=limit,!0))},moment.lang=deprecate("moment.lang is deprecated. Use moment.locale instead.",function(key,value){return moment.locale(key,value)}),moment.locale=function(key,values){var data;return key&&(data="undefined"!=typeof values?moment.defineLocale(key,values):moment.localeData(key),data&&(moment.duration._locale=moment._locale=data)),moment._locale._abbr},moment.defineLocale=function(name,values){return null!==values?(values.abbr=name,locales[name]||(locales[name]=new Locale),locales[name].set(values),moment.locale(name),locales[name]):(delete locales[name],null)},moment.langData=deprecate("moment.langData is deprecated. Use moment.localeData instead.",function(key){return moment.localeData(key)}),moment.localeData=function(key){var locale;if(key&&key._locale&&key._locale._abbr&&(key=key._locale._abbr),!key)return moment._locale;if(!isArray(key)){if(locale=loadLocale(key))return locale;key=[key]}return chooseLocale(key)},moment.isMoment=function(obj){return obj instanceof Moment||null!=obj&&hasOwnProp(obj,"_isAMomentObject")},moment.isDuration=function(obj){return obj instanceof Duration};for(i=lists.length-1;i>=0;--i)makeList(lists[i]);moment.normalizeUnits=function(units){return normalizeUnits(units)},moment.invalid=function(flags){var m=moment.utc(NaN);return null!=flags?extend(m._pf,flags):m._pf.userInvalidated=!0,m},moment.parseZone=function(){return moment.apply(null,arguments).parseZone()},moment.parseTwoDigitYear=function(input){return toInt(input)+(toInt(input)>68?1900:2e3)},extend(moment.fn=Moment.prototype,{clone:function(){return moment(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var m=moment(this).utc();return 0<m.year()&&m.year()<=9999?"function"==typeof Date.prototype.toISOString?this.toDate().toISOString():formatMoment(m,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):formatMoment(m,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var m=this;return[m.year(),m.month(),m.date(),m.hours(),m.minutes(),m.seconds(),m.milliseconds()]},isValid:function(){return isValid(this)},isDSTShifted:function(){return!!this._a&&(this.isValid()&&compareArrays(this._a,(this._isUTC?moment.utc(this._a):moment(this._a)).toArray())>0)},parsingFlags:function(){return extend({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(keepLocalTime){return this.zone(0,keepLocalTime)},local:function(keepLocalTime){return this._isUTC&&(this.zone(0,keepLocalTime),this._isUTC=!1,keepLocalTime&&this.add(this._dateTzOffset(),"m")),this},format:function(inputString){var output=formatMoment(this,inputString||moment.defaultFormat);return this.localeData().postformat(output)},add:createAdder(1,"add"),subtract:createAdder(-1,"subtract"),diff:function(input,units,asFloat){var diff,output,daysAdjust,that=makeAs(input,this),zoneDiff=6e4*(this.zone()-that.zone());return units=normalizeUnits(units),"year"===units||"month"===units?(diff=432e5*(this.daysInMonth()+that.daysInMonth()),output=12*(this.year()-that.year())+(this.month()-that.month()),daysAdjust=this-moment(this).startOf("month")-(that-moment(that).startOf("month")),daysAdjust-=6e4*(this.zone()-moment(this).startOf("month").zone()-(that.zone()-moment(that).startOf("month").zone())),output+=daysAdjust/diff,"year"===units&&(output/=12)):(diff=this-that,output="second"===units?diff/1e3:"minute"===units?diff/6e4:"hour"===units?diff/36e5:"day"===units?(diff-zoneDiff)/864e5:"week"===units?(diff-zoneDiff)/6048e5:diff),asFloat?output:absRound(output)},from:function(time,withoutSuffix){return moment.duration({to:this,from:time}).locale(this.locale()).humanize(!withoutSuffix)},fromNow:function(withoutSuffix){return this.from(moment(),withoutSuffix)},calendar:function(time){var now=time||moment(),sod=makeAs(now,this).startOf("day"),diff=this.diff(sod,"days",!0),format=diff<-6?"sameElse":diff<-1?"lastWeek":diff<0?"lastDay":diff<1?"sameDay":diff<2?"nextDay":diff<7?"nextWeek":"sameElse";return this.format(this.localeData().calendar(format,this,moment(now)))},isLeapYear:function(){return isLeapYear(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(input){var day=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=input?(input=parseWeekday(input,this.localeData()),this.add(input-day,"d")):day},month:makeAccessor("Month",!0),startOf:function(units){switch(units=normalizeUnits(units)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===units?this.weekday(0):"isoWeek"===units&&this.isoWeekday(1),"quarter"===units&&this.month(3*Math.floor(this.month()/3)),this},endOf:function(units){return units=normalizeUnits(units),units===undefined||"millisecond"===units?this:this.startOf(units).add(1,"isoWeek"===units?"week":units).subtract(1,"ms")},isAfter:function(input,units){var inputMs;return units=normalizeUnits("undefined"!=typeof units?units:"millisecond"),"millisecond"===units?(input=moment.isMoment(input)?input:moment(input),+this>+input):(inputMs=moment.isMoment(input)?+input:+moment(input),inputMs<+this.clone().startOf(units))},isBefore:function(input,units){var inputMs;return units=normalizeUnits("undefined"!=typeof units?units:"millisecond"),"millisecond"===units?(input=moment.isMoment(input)?input:moment(input),+this<+input):(inputMs=moment.isMoment(input)?+input:+moment(input),+this.clone().endOf(units)<inputMs)},isSame:function(input,units){var inputMs;return units=normalizeUnits(units||"millisecond"),"millisecond"===units?(input=moment.isMoment(input)?input:moment(input),+this===+input):(inputMs=+moment(input),+this.clone().startOf(units)<=inputMs&&inputMs<=+this.clone().endOf(units))},min:deprecate("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(other){return other=moment.apply(null,arguments),other<this?this:other}),max:deprecate("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(other){return other=moment.apply(null,arguments),other>this?this:other}),zone:function(input,keepLocalTime){var localAdjust,offset=this._offset||0;return null==input?this._isUTC?offset:this._dateTzOffset():("string"==typeof input&&(input=timezoneMinutesFromString(input)),Math.abs(input)<16&&(input=60*input),!this._isUTC&&keepLocalTime&&(localAdjust=this._dateTzOffset()),this._offset=input,this._isUTC=!0,null!=localAdjust&&this.subtract(localAdjust,"m"),offset!==input&&(!keepLocalTime||this._changeInProgress?addOrSubtractDurationFromMoment(this,moment.duration(offset-input,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,moment.updateOffset(this,!0),this._changeInProgress=null)),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.zone(this._tzm):"string"==typeof this._i&&this.zone(this._i),this},hasAlignedHourOffset:function(input){return input=input?moment(input).zone():0,(this.zone()-input)%60===0},daysInMonth:function(){return daysInMonth(this.year(),this.month())},dayOfYear:function(input){var dayOfYear=round((moment(this).startOf("day")-moment(this).startOf("year"))/864e5)+1;return null==input?dayOfYear:this.add(input-dayOfYear,"d")},quarter:function(input){return null==input?Math.ceil((this.month()+1)/3):this.month(3*(input-1)+this.month()%3)},weekYear:function(input){var year=weekOfYear(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return null==input?year:this.add(input-year,"y")},isoWeekYear:function(input){var year=weekOfYear(this,1,4).year;return null==input?year:this.add(input-year,"y")},week:function(input){var week=this.localeData().week(this);return null==input?week:this.add(7*(input-week),"d")},isoWeek:function(input){var week=weekOfYear(this,1,4).week;return null==input?week:this.add(7*(input-week),"d");
},weekday:function(input){var weekday=(this.day()+7-this.localeData()._week.dow)%7;return null==input?weekday:this.add(input-weekday,"d")},isoWeekday:function(input){return null==input?this.day()||7:this.day(this.day()%7?input:input-7)},isoWeeksInYear:function(){return weeksInYear(this.year(),1,4)},weeksInYear:function(){var weekInfo=this.localeData()._week;return weeksInYear(this.year(),weekInfo.dow,weekInfo.doy)},get:function(units){return units=normalizeUnits(units),this[units]()},set:function(units,value){return units=normalizeUnits(units),"function"==typeof this[units]&&this[units](value),this},locale:function(key){var newLocaleData;return key===undefined?this._locale._abbr:(newLocaleData=moment.localeData(key),null!=newLocaleData&&(this._locale=newLocaleData),this)},lang:deprecate("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(key){return key===undefined?this.localeData():this.locale(key)}),localeData:function(){return this._locale},_dateTzOffset:function(){return 15*Math.round(this._d.getTimezoneOffset()/15)}}),moment.fn.millisecond=moment.fn.milliseconds=makeAccessor("Milliseconds",!1),moment.fn.second=moment.fn.seconds=makeAccessor("Seconds",!1),moment.fn.minute=moment.fn.minutes=makeAccessor("Minutes",!1),moment.fn.hour=moment.fn.hours=makeAccessor("Hours",!0),moment.fn.date=makeAccessor("Date",!0),moment.fn.dates=deprecate("dates accessor is deprecated. Use date instead.",makeAccessor("Date",!0)),moment.fn.year=makeAccessor("FullYear",!0),moment.fn.years=deprecate("years accessor is deprecated. Use year instead.",makeAccessor("FullYear",!0)),moment.fn.days=moment.fn.day,moment.fn.months=moment.fn.month,moment.fn.weeks=moment.fn.week,moment.fn.isoWeeks=moment.fn.isoWeek,moment.fn.quarters=moment.fn.quarter,moment.fn.toJSON=moment.fn.toISOString,extend(moment.duration.fn=Duration.prototype,{_bubble:function(){var seconds,minutes,hours,milliseconds=this._milliseconds,days=this._days,months=this._months,data=this._data,years=0;data.milliseconds=milliseconds%1e3,seconds=absRound(milliseconds/1e3),data.seconds=seconds%60,minutes=absRound(seconds/60),data.minutes=minutes%60,hours=absRound(minutes/60),data.hours=hours%24,days+=absRound(hours/24),years=absRound(daysToYears(days)),days-=absRound(yearsToDays(years)),months+=absRound(days/30),days%=30,years+=absRound(months/12),months%=12,data.days=days,data.months=months,data.years=years},abs:function(){return this._milliseconds=Math.abs(this._milliseconds),this._days=Math.abs(this._days),this._months=Math.abs(this._months),this._data.milliseconds=Math.abs(this._data.milliseconds),this._data.seconds=Math.abs(this._data.seconds),this._data.minutes=Math.abs(this._data.minutes),this._data.hours=Math.abs(this._data.hours),this._data.months=Math.abs(this._data.months),this._data.years=Math.abs(this._data.years),this},weeks:function(){return absRound(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*toInt(this._months/12)},humanize:function(withSuffix){var output=relativeTime(this,!withSuffix,this.localeData());return withSuffix&&(output=this.localeData().pastFuture(+this,output)),this.localeData().postformat(output)},add:function(input,val){var dur=moment.duration(input,val);return this._milliseconds+=dur._milliseconds,this._days+=dur._days,this._months+=dur._months,this._bubble(),this},subtract:function(input,val){var dur=moment.duration(input,val);return this._milliseconds-=dur._milliseconds,this._days-=dur._days,this._months-=dur._months,this._bubble(),this},get:function(units){return units=normalizeUnits(units),this[units.toLowerCase()+"s"]()},as:function(units){var days,months;if(units=normalizeUnits(units),"month"===units||"year"===units)return days=this._days+this._milliseconds/864e5,months=this._months+12*daysToYears(days),"month"===units?months:months/12;switch(days=this._days+Math.round(yearsToDays(this._months/12)),units){case"week":return days/7+this._milliseconds/6048e5;case"day":return days+this._milliseconds/864e5;case"hour":return 24*days+this._milliseconds/36e5;case"minute":return 24*days*60+this._milliseconds/6e4;case"second":return 24*days*60*60+this._milliseconds/1e3;case"millisecond":return Math.floor(24*days*60*60*1e3)+this._milliseconds;default:throw new Error("Unknown unit "+units)}},lang:moment.fn.lang,locale:moment.fn.locale,toIsoString:deprecate("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",function(){return this.toISOString()}),toISOString:function(){var years=Math.abs(this.years()),months=Math.abs(this.months()),days=Math.abs(this.days()),hours=Math.abs(this.hours()),minutes=Math.abs(this.minutes()),seconds=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(years?years+"Y":"")+(months?months+"M":"")+(days?days+"D":"")+(hours||minutes||seconds?"T":"")+(hours?hours+"H":"")+(minutes?minutes+"M":"")+(seconds?seconds+"S":""):"P0D"},localeData:function(){return this._locale}}),moment.duration.fn.toString=moment.duration.fn.toISOString;for(i in unitMillisecondFactors)hasOwnProp(unitMillisecondFactors,i)&&makeDurationGetter(i.toLowerCase());moment.duration.fn.asMilliseconds=function(){return this.as("ms")},moment.duration.fn.asSeconds=function(){return this.as("s")},moment.duration.fn.asMinutes=function(){return this.as("m")},moment.duration.fn.asHours=function(){return this.as("h")},moment.duration.fn.asDays=function(){return this.as("d")},moment.duration.fn.asWeeks=function(){return this.as("weeks")},moment.duration.fn.asMonths=function(){return this.as("M")},moment.duration.fn.asYears=function(){return this.as("y")},moment.locale("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(number){var b=number%10,output=1===toInt(number%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return number+output}}),hasModule?module.exports=moment:"function"==typeof define&&define.amd?(define("moment",function(require,exports,module){return module.config&&module.config()&&module.config().noGlobal===!0&&(globalScope.moment=oldGlobalMoment),moment}),makeGlobal(!0)):makeGlobal()}).call(this),function(){var h=[].slice;String.prototype.autoLink=function(){var b,f,d,a,e,g;return a=1<=arguments.length?h.call(arguments,0):[],e=/(^|[\s\n]|<br\/?>)((?:https?|ftp):\/\/[\-A-Z0-9+\u0026\u2019@#\/%?=()~_|!:,.;]*[\-A-Z0-9+\u0026@#\/%=~()_|])/gi,0<a.length?(d=a[0],f=function(){var c;c=[];for(b in d)g=d[b],"callback"!==b&&c.push(" "+b+"='"+g+"'");return c}().join(""),this.replace(e,function(c,b,a){return c=("function"==typeof d.callback?d.callback(a):void 0)||"<a href='"+a+"'"+f+">"+a+"</a>",""+b+c})):this.replace(e,"$1<a href='$2'>$2</a>")}}.call(this),+function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.affix"),options="object"==typeof option&&option;data||$this.data("bs.affix",data=new Affix(this,options)),"string"==typeof option&&data[option]()})}var Affix=function(element,options){this.options=$.extend({},Affix.DEFAULTS,options),this.$target=$(this.options.target).on("scroll.bs.affix.data-api",$.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",$.proxy(this.checkPositionWithEventLoop,this)),this.$element=$(element),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};Affix.VERSION="3.3.6",Affix.RESET="affix affix-top affix-bottom",Affix.DEFAULTS={offset:0,target:window},Affix.prototype.getState=function(scrollHeight,height,offsetTop,offsetBottom){var scrollTop=this.$target.scrollTop(),position=this.$element.offset(),targetHeight=this.$target.height();if(null!=offsetTop&&"top"==this.affixed)return scrollTop<offsetTop&&"top";if("bottom"==this.affixed)return null!=offsetTop?!(scrollTop+this.unpin<=position.top)&&"bottom":!(scrollTop+targetHeight<=scrollHeight-offsetBottom)&&"bottom";var initializing=null==this.affixed,colliderTop=initializing?scrollTop:position.top,colliderHeight=initializing?targetHeight:height;return null!=offsetTop&&scrollTop<=offsetTop?"top":null!=offsetBottom&&colliderTop+colliderHeight>=scrollHeight-offsetBottom&&"bottom"},Affix.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(Affix.RESET).addClass("affix");var scrollTop=this.$target.scrollTop(),position=this.$element.offset();return this.pinnedOffset=position.top-scrollTop},Affix.prototype.checkPositionWithEventLoop=function(){setTimeout($.proxy(this.checkPosition,this),1)},Affix.prototype.checkPosition=function(){if(this.$element.is(":visible")){var height=this.$element.height(),offset=this.options.offset,offsetTop=offset.top,offsetBottom=offset.bottom,scrollHeight=Math.max($(document).height(),$(document.body).height());"object"!=typeof offset&&(offsetBottom=offsetTop=offset),"function"==typeof offsetTop&&(offsetTop=offset.top(this.$element)),"function"==typeof offsetBottom&&(offsetBottom=offset.bottom(this.$element));var affix=this.getState(scrollHeight,height,offsetTop,offsetBottom);if(this.affixed!=affix){null!=this.unpin&&this.$element.css("top","");var affixType="affix"+(affix?"-"+affix:""),e=$.Event(affixType+".bs.affix");if(this.$element.trigger(e),e.isDefaultPrevented())return;this.affixed=affix,this.unpin="bottom"==affix?this.getPinnedOffset():null,this.$element.removeClass(Affix.RESET).addClass(affixType).trigger(affixType.replace("affix","affixed")+".bs.affix")}"bottom"==affix&&this.$element.offset({top:scrollHeight-height-offsetBottom})}};var old=$.fn.affix;$.fn.affix=Plugin,$.fn.affix.Constructor=Affix,$.fn.affix.noConflict=function(){return $.fn.affix=old,this},$(window).on("load",function(){$('[data-spy="affix"]').each(function(){var $spy=$(this),data=$spy.data();data.offset=data.offset||{},null!=data.offsetBottom&&(data.offset.bottom=data.offsetBottom),null!=data.offsetTop&&(data.offset.top=data.offsetTop),Plugin.call($spy,data)})})}(jQuery),+function($){"use strict";function getParent($this){var selector=$this.attr("data-target");selector||(selector=$this.attr("href"),selector=selector&&/#[A-Za-z]/.test(selector)&&selector.replace(/.*(?=#[^\s]*$)/,""));var $parent=selector&&$(selector);return $parent&&$parent.length?$parent:$this.parent()}function clearMenus(e){e&&3===e.which||($(backdrop).remove(),$(toggle).each(function(){var $this=$(this),$parent=getParent($this),relatedTarget={relatedTarget:this};$parent.hasClass("open")&&(e&&"click"==e.type&&/input|textarea/i.test(e.target.tagName)&&$.contains($parent[0],e.target)||($parent.trigger(e=$.Event("hide.bs.dropdown",relatedTarget)),e.isDefaultPrevented()||($this.attr("aria-expanded","false"),$parent.removeClass("open").trigger($.Event("hidden.bs.dropdown",relatedTarget)))))}))}function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.dropdown");data||$this.data("bs.dropdown",data=new Dropdown(this)),"string"==typeof option&&data[option].call($this)})}var backdrop=".dropdown-backdrop",toggle='[data-toggle="dropdown"]',Dropdown=function(element){$(element).on("click.bs.dropdown",this.toggle)};Dropdown.VERSION="3.3.6",Dropdown.prototype.toggle=function(e){var $this=$(this);if(!$this.is(".disabled, :disabled")){var $parent=getParent($this),isActive=$parent.hasClass("open");if(clearMenus(),!isActive){"ontouchstart"in document.documentElement&&!$parent.closest(".navbar-nav").length&&$(document.createElement("div")).addClass("dropdown-backdrop").insertAfter($(this)).on("click",clearMenus);var relatedTarget={relatedTarget:this};if($parent.trigger(e=$.Event("show.bs.dropdown",relatedTarget)),e.isDefaultPrevented())return;$this.trigger("focus").attr("aria-expanded","true"),$parent.toggleClass("open").trigger($.Event("shown.bs.dropdown",relatedTarget))}return!1}},Dropdown.prototype.keydown=function(e){if(/(38|40|27|32)/.test(e.which)&&!/input|textarea/i.test(e.target.tagName)){var $this=$(this);if(e.preventDefault(),e.stopPropagation(),!$this.is(".disabled, :disabled")){var $parent=getParent($this),isActive=$parent.hasClass("open");if(!isActive&&27!=e.which||isActive&&27==e.which)return 27==e.which&&$parent.find(toggle).trigger("focus"),$this.trigger("click");var desc=" li:not(.disabled):visible a",$items=$parent.find(".dropdown-menu"+desc);if($items.length){var index=$items.index(e.target);38==e.which&&index>0&&index--,40==e.which&&index<$items.length-1&&index++,~index||(index=0),$items.eq(index).trigger("focus")}}}};var old=$.fn.dropdown;$.fn.dropdown=Plugin,$.fn.dropdown.Constructor=Dropdown,$.fn.dropdown.noConflict=function(){return $.fn.dropdown=old,this},$(document).on("click.bs.dropdown.data-api",clearMenus).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",toggle,Dropdown.prototype.toggle).on("keydown.bs.dropdown.data-api",toggle,Dropdown.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",Dropdown.prototype.keydown)}(jQuery),+function($){"use strict";function Plugin(option,_relatedTarget){return this.each(function(){var $this=$(this),data=$this.data("bs.modal"),options=$.extend({},Modal.DEFAULTS,$this.data(),"object"==typeof option&&option);data||$this.data("bs.modal",data=new Modal(this,options)),"string"==typeof option?data[option](_relatedTarget):options.show&&data.show(_relatedTarget)})}var Modal=function(element,options){this.options=options,this.$body=$(document.body),this.$element=$(element),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,$.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};Modal.VERSION="3.3.6",Modal.TRANSITION_DURATION=300,Modal.BACKDROP_TRANSITION_DURATION=150,Modal.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},Modal.prototype.toggle=function(_relatedTarget){return this.isShown?this.hide():this.show(_relatedTarget)},Modal.prototype.show=function(_relatedTarget){var that=this,e=$.Event("show.bs.modal",{relatedTarget:_relatedTarget});this.$element.trigger(e),this.isShown||e.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',$.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){that.$element.one("mouseup.dismiss.bs.modal",function(e){$(e.target).is(that.$element)&&(that.ignoreBackdropClick=!0)})}),this.backdrop(function(){var transition=$.support.transition&&that.$element.hasClass("fade");that.$element.parent().length||that.$element.appendTo(that.$body),that.$element.show().scrollTop(0),that.adjustDialog(),transition&&that.$element[0].offsetWidth,that.$element.addClass("in"),that.enforceFocus();var e=$.Event("shown.bs.modal",{relatedTarget:_relatedTarget});transition?that.$dialog.one("bsTransitionEnd",function(){that.$element.trigger("focus").trigger(e)}).emulateTransitionEnd(Modal.TRANSITION_DURATION):that.$element.trigger("focus").trigger(e)}))},Modal.prototype.hide=function(e){e&&e.preventDefault(),e=$.Event("hide.bs.modal"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),$(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),$.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",$.proxy(this.hideModal,this)).emulateTransitionEnd(Modal.TRANSITION_DURATION):this.hideModal())},Modal.prototype.enforceFocus=function(){$(document).off("focusin.bs.modal").on("focusin.bs.modal",$.proxy(function(e){this.$element[0]===e.target||this.$element.has(e.target).length||this.$element.trigger("focus")},this))},Modal.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",$.proxy(function(e){27==e.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},Modal.prototype.resize=function(){this.isShown?$(window).on("resize.bs.modal",$.proxy(this.handleUpdate,this)):$(window).off("resize.bs.modal")},Modal.prototype.hideModal=function(){var that=this;this.$element.hide(),this.backdrop(function(){that.$body.removeClass("modal-open"),that.resetAdjustments(),that.resetScrollbar(),that.$element.trigger("hidden.bs.modal")})},Modal.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},Modal.prototype.backdrop=function(callback){var that=this,animate=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var doAnimate=$.support.transition&&animate;if(this.$backdrop=$(document.createElement("div")).addClass("modal-backdrop "+animate).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",$.proxy(function(e){return this.ignoreBackdropClick?void(this.ignoreBackdropClick=!1):void(e.target===e.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide()))},this)),doAnimate&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!callback)return;doAnimate?this.$backdrop.one("bsTransitionEnd",callback).emulateTransitionEnd(Modal.BACKDROP_TRANSITION_DURATION):callback()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var callbackRemove=function(){that.removeBackdrop(),callback&&callback()};$.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",callbackRemove).emulateTransitionEnd(Modal.BACKDROP_TRANSITION_DURATION):callbackRemove()}else callback&&callback()},Modal.prototype.handleUpdate=function(){this.adjustDialog()},Modal.prototype.adjustDialog=function(){var modalIsOverflowing=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&modalIsOverflowing?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!modalIsOverflowing?this.scrollbarWidth:""})},Modal.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},Modal.prototype.checkScrollbar=function(){var fullWindowWidth=window.innerWidth;if(!fullWindowWidth){var documentElementRect=document.documentElement.getBoundingClientRect();fullWindowWidth=documentElementRect.right-Math.abs(documentElementRect.left)}this.bodyIsOverflowing=document.body.clientWidth<fullWindowWidth,this.scrollbarWidth=this.measureScrollbar()},Modal.prototype.setScrollbar=function(){var bodyPad=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",bodyPad+this.scrollbarWidth)},Modal.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},Modal.prototype.measureScrollbar=function(){var scrollDiv=document.createElement("div");scrollDiv.className="modal-scrollbar-measure",this.$body.append(scrollDiv);var scrollbarWidth=scrollDiv.offsetWidth-scrollDiv.clientWidth;return this.$body[0].removeChild(scrollDiv),scrollbarWidth};var old=$.fn.modal;$.fn.modal=Plugin,$.fn.modal.Constructor=Modal,$.fn.modal.noConflict=function(){return $.fn.modal=old,this},$(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(e){var $this=$(this),href=$this.attr("href"),$target=$($this.attr("data-target")||href&&href.replace(/.*(?=#[^\s]+$)/,"")),option=$target.data("bs.modal")?"toggle":$.extend({remote:!/#/.test(href)&&href},$target.data(),$this.data());$this.is("a")&&e.preventDefault(),$target.one("show.bs.modal",function(showEvent){showEvent.isDefaultPrevented()||$target.one("hidden.bs.modal",function(){$this.is(":visible")&&$this.trigger("focus")})}),Plugin.call($target,option,this)})}(jQuery),+function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.tooltip"),options="object"==typeof option&&option;!data&&/destroy|hide/.test(option)||(data||$this.data("bs.tooltip",data=new Tooltip(this,options)),"string"==typeof option&&data[option]())})}var Tooltip=function(element,options){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",element,options)};Tooltip.VERSION="3.3.6",Tooltip.TRANSITION_DURATION=150,Tooltip.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},Tooltip.prototype.init=function(type,element,options){if(this.enabled=!0,this.type=type,this.$element=$(element),this.options=this.getOptions(options),this.$viewport=this.options.viewport&&$($.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var triggers=this.options.trigger.split(" "),i=triggers.length;i--;){var trigger=triggers[i];if("click"==trigger)this.$element.on("click."+this.type,this.options.selector,$.proxy(this.toggle,this));else if("manual"!=trigger){var eventIn="hover"==trigger?"mouseenter":"focusin",eventOut="hover"==trigger?"mouseleave":"focusout";this.$element.on(eventIn+"."+this.type,this.options.selector,$.proxy(this.enter,this)),this.$element.on(eventOut+"."+this.type,this.options.selector,$.proxy(this.leave,this))}}this.options.selector?this._options=$.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},Tooltip.prototype.getDefaults=function(){return Tooltip.DEFAULTS},Tooltip.prototype.getOptions=function(options){return options=$.extend({},this.getDefaults(),this.$element.data(),options),options.delay&&"number"==typeof options.delay&&(options.delay={show:options.delay,hide:options.delay}),options},Tooltip.prototype.getDelegateOptions=function(){var options={},defaults=this.getDefaults();return this._options&&$.each(this._options,function(key,value){defaults[key]!=value&&(options[key]=value)}),options},Tooltip.prototype.enter=function(obj){var self=obj instanceof this.constructor?obj:$(obj.currentTarget).data("bs."+this.type);return self||(self=new this.constructor(obj.currentTarget,this.getDelegateOptions()),$(obj.currentTarget).data("bs."+this.type,self)),obj instanceof $.Event&&(self.inState["focusin"==obj.type?"focus":"hover"]=!0),self.tip().hasClass("in")||"in"==self.hoverState?void(self.hoverState="in"):(clearTimeout(self.timeout),self.hoverState="in",self.options.delay&&self.options.delay.show?void(self.timeout=setTimeout(function(){"in"==self.hoverState&&self.show()},self.options.delay.show)):self.show())},Tooltip.prototype.isInStateTrue=function(){for(var key in this.inState)if(this.inState[key])return!0;return!1},Tooltip.prototype.leave=function(obj){var self=obj instanceof this.constructor?obj:$(obj.currentTarget).data("bs."+this.type);if(self||(self=new this.constructor(obj.currentTarget,this.getDelegateOptions()),$(obj.currentTarget).data("bs."+this.type,self)),obj instanceof $.Event&&(self.inState["focusout"==obj.type?"focus":"hover"]=!1),!self.isInStateTrue())return clearTimeout(self.timeout),self.hoverState="out",self.options.delay&&self.options.delay.hide?void(self.timeout=setTimeout(function(){"out"==self.hoverState&&self.hide()},self.options.delay.hide)):self.hide()},Tooltip.prototype.show=function(){var e=$.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(e);var inDom=$.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(e.isDefaultPrevented()||!inDom)return;var that=this,$tip=this.tip(),tipId=this.getUID(this.type);this.setContent(),$tip.attr("id",tipId),this.$element.attr("aria-describedby",tipId),this.options.animation&&$tip.addClass("fade");var placement="function"==typeof this.options.placement?this.options.placement.call(this,$tip[0],this.$element[0]):this.options.placement,autoToken=/\s?auto?\s?/i,autoPlace=autoToken.test(placement);autoPlace&&(placement=placement.replace(autoToken,"")||"top"),$tip.detach().css({top:0,left:0,display:"block"}).addClass(placement).data("bs."+this.type,this),this.options.container?$tip.appendTo(this.options.container):$tip.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var pos=this.getPosition(),actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight;if(autoPlace){var orgPlacement=placement,viewportDim=this.getPosition(this.$viewport);placement="bottom"==placement&&pos.bottom+actualHeight>viewportDim.bottom?"top":"top"==placement&&pos.top-actualHeight<viewportDim.top?"bottom":"right"==placement&&pos.right+actualWidth>viewportDim.width?"left":"left"==placement&&pos.left-actualWidth<viewportDim.left?"right":placement,$tip.removeClass(orgPlacement).addClass(placement)}var calculatedOffset=this.getCalculatedOffset(placement,pos,actualWidth,actualHeight);this.applyPlacement(calculatedOffset,placement);var complete=function(){var prevHoverState=that.hoverState;that.$element.trigger("shown.bs."+that.type),that.hoverState=null,"out"==prevHoverState&&that.leave(that)};$.support.transition&&this.$tip.hasClass("fade")?$tip.one("bsTransitionEnd",complete).emulateTransitionEnd(Tooltip.TRANSITION_DURATION):complete()}},Tooltip.prototype.applyPlacement=function(offset,placement){var $tip=this.tip(),width=$tip[0].offsetWidth,height=$tip[0].offsetHeight,marginTop=parseInt($tip.css("margin-top"),10),marginLeft=parseInt($tip.css("margin-left"),10);isNaN(marginTop)&&(marginTop=0),isNaN(marginLeft)&&(marginLeft=0),offset.top+=marginTop,offset.left+=marginLeft,$.offset.setOffset($tip[0],$.extend({using:function(props){$tip.css({top:Math.round(props.top),left:Math.round(props.left)})}},offset),0),$tip.addClass("in");var actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight;"top"==placement&&actualHeight!=height&&(offset.top=offset.top+height-actualHeight);var delta=this.getViewportAdjustedDelta(placement,offset,actualWidth,actualHeight);delta.left?offset.left+=delta.left:offset.top+=delta.top;var isVertical=/top|bottom/.test(placement),arrowDelta=isVertical?2*delta.left-width+actualWidth:2*delta.top-height+actualHeight,arrowOffsetPosition=isVertical?"offsetWidth":"offsetHeight";$tip.offset(offset),this.replaceArrow(arrowDelta,$tip[0][arrowOffsetPosition],isVertical)},Tooltip.prototype.replaceArrow=function(delta,dimension,isVertical){this.arrow().css(isVertical?"left":"top",50*(1-delta/dimension)+"%").css(isVertical?"top":"left","")},Tooltip.prototype.setContent=function(){var $tip=this.tip(),title=this.getTitle();$tip.find(".tooltip-inner")[this.options.html?"html":"text"](title),$tip.removeClass("fade in top bottom left right")},Tooltip.prototype.hide=function(callback){function complete(){"in"!=that.hoverState&&$tip.detach(),that.$element.removeAttr("aria-describedby").trigger("hidden.bs."+that.type),callback&&callback()}var that=this,$tip=$(this.$tip),e=$.Event("hide.bs."+this.type);if(this.$element.trigger(e),!e.isDefaultPrevented())return $tip.removeClass("in"),$.support.transition&&$tip.hasClass("fade")?$tip.one("bsTransitionEnd",complete).emulateTransitionEnd(Tooltip.TRANSITION_DURATION):complete(),this.hoverState=null,this},Tooltip.prototype.fixTitle=function(){var $e=this.$element;($e.attr("title")||"string"!=typeof $e.attr("data-original-title"))&&$e.attr("data-original-title",$e.attr("title")||"").attr("title","")},Tooltip.prototype.hasContent=function(){return this.getTitle()},Tooltip.prototype.getPosition=function($element){$element=$element||this.$element;var el=$element[0],isBody="BODY"==el.tagName,elRect=el.getBoundingClientRect();null==elRect.width&&(elRect=$.extend({},elRect,{width:elRect.right-elRect.left,height:elRect.bottom-elRect.top}));var elOffset=isBody?{top:0,left:0}:$element.offset(),scroll={scroll:isBody?document.documentElement.scrollTop||document.body.scrollTop:$element.scrollTop()},outerDims=isBody?{width:$(window).width(),height:$(window).height()}:null;return $.extend({},elRect,scroll,outerDims,elOffset)},Tooltip.prototype.getCalculatedOffset=function(placement,pos,actualWidth,actualHeight){return"bottom"==placement?{top:pos.top+pos.height,left:pos.left+pos.width/2-actualWidth/2}:"top"==placement?{top:pos.top-actualHeight,left:pos.left+pos.width/2-actualWidth/2}:"left"==placement?{top:pos.top+pos.height/2-actualHeight/2,left:pos.left-actualWidth}:{top:pos.top+pos.height/2-actualHeight/2,left:pos.left+pos.width}},Tooltip.prototype.getViewportAdjustedDelta=function(placement,pos,actualWidth,actualHeight){var delta={top:0,left:0};if(!this.$viewport)return delta;var viewportPadding=this.options.viewport&&this.options.viewport.padding||0,viewportDimensions=this.getPosition(this.$viewport);if(/right|left/.test(placement)){var topEdgeOffset=pos.top-viewportPadding-viewportDimensions.scroll,bottomEdgeOffset=pos.top+viewportPadding-viewportDimensions.scroll+actualHeight;topEdgeOffset<viewportDimensions.top?delta.top=viewportDimensions.top-topEdgeOffset:bottomEdgeOffset>viewportDimensions.top+viewportDimensions.height&&(delta.top=viewportDimensions.top+viewportDimensions.height-bottomEdgeOffset)}else{var leftEdgeOffset=pos.left-viewportPadding,rightEdgeOffset=pos.left+viewportPadding+actualWidth;leftEdgeOffset<viewportDimensions.left?delta.left=viewportDimensions.left-leftEdgeOffset:rightEdgeOffset>viewportDimensions.right&&(delta.left=viewportDimensions.left+viewportDimensions.width-rightEdgeOffset)}return delta},Tooltip.prototype.getTitle=function(){var title,$e=this.$element,o=this.options;return title=$e.attr("data-original-title")||("function"==typeof o.title?o.title.call($e[0]):o.title)},Tooltip.prototype.getUID=function(prefix){do prefix+=~~(1e6*Math.random());while(document.getElementById(prefix));return prefix},Tooltip.prototype.tip=function(){if(!this.$tip&&(this.$tip=$(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},Tooltip.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},Tooltip.prototype.enable=function(){this.enabled=!0},Tooltip.prototype.disable=function(){this.enabled=!1},Tooltip.prototype.toggleEnabled=function(){this.enabled=!this.enabled},Tooltip.prototype.toggle=function(e){var self=this;e&&(self=$(e.currentTarget).data("bs."+this.type),self||(self=new this.constructor(e.currentTarget,this.getDelegateOptions()),$(e.currentTarget).data("bs."+this.type,self))),e?(self.inState.click=!self.inState.click,self.isInStateTrue()?self.enter(self):self.leave(self)):self.tip().hasClass("in")?self.leave(self):self.enter(self)},Tooltip.prototype.destroy=function(){var that=this;clearTimeout(this.timeout),this.hide(function(){that.$element.off("."+that.type).removeData("bs."+that.type),that.$tip&&that.$tip.detach(),that.$tip=null,that.$arrow=null,that.$viewport=null})};var old=$.fn.tooltip;$.fn.tooltip=Plugin,$.fn.tooltip.Constructor=Tooltip,$.fn.tooltip.noConflict=function(){return $.fn.tooltip=old,this}}(jQuery),+function($){"use strict";function transitionEnd(){var el=document.createElement("bootstrap"),transEndEventNames={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var name in transEndEventNames)if(void 0!==el.style[name])return{end:transEndEventNames[name]};return!1}$.fn.emulateTransitionEnd=function(duration){var called=!1,$el=this;$(this).one("bsTransitionEnd",function(){called=!0});var callback=function(){called||$($el).trigger($.support.transition.end)};return setTimeout(callback,duration),
this},$(function(){$.support.transition=transitionEnd(),$.support.transition&&($.event.special.bsTransitionEnd={bindType:$.support.transition.end,delegateType:$.support.transition.end,handle:function(e){if($(e.target).is(this))return e.handleObj.handler.apply(this,arguments)}})})}(jQuery),function(root,factory){"object"==typeof exports?module.exports=factory():"function"==typeof define&&define.amd?define(factory):root.Spinner=factory()}(this,function(){"use strict";function createEl(tag,prop){var n,el=document.createElement(tag||"div");for(n in prop)el[n]=prop[n];return el}function ins(parent){for(var i=1,n=arguments.length;i<n;i++)parent.appendChild(arguments[i]);return parent}function addAnimation(alpha,trail,i,lines){var name=["opacity",trail,~~(100*alpha),i,lines].join("-"),start=.01+i/lines*100,z=Math.max(1-(1-alpha)/trail*(100-start),alpha),prefix=useCssAnimations.substring(0,useCssAnimations.indexOf("Animation")).toLowerCase(),pre=prefix&&"-"+prefix+"-"||"";return animations[name]||(sheet.insertRule("@"+pre+"keyframes "+name+"{0%{opacity:"+z+"}"+start+"%{opacity:"+alpha+"}"+(start+.01)+"%{opacity:1}"+(start+trail)%100+"%{opacity:"+alpha+"}100%{opacity:"+z+"}}",sheet.cssRules.length),animations[name]=1),name}function vendor(el,prop){var pp,i,s=el.style;for(prop=prop.charAt(0).toUpperCase()+prop.slice(1),i=0;i<prefixes.length;i++)if(pp=prefixes[i]+prop,void 0!==s[pp])return pp;if(void 0!==s[prop])return prop}function css(el,prop){for(var n in prop)el.style[vendor(el,n)||n]=prop[n];return el}function merge(obj){for(var i=1;i<arguments.length;i++){var def=arguments[i];for(var n in def)void 0===obj[n]&&(obj[n]=def[n])}return obj}function getColor(color,idx){return"string"==typeof color?color:color[idx%color.length]}function Spinner(o){this.opts=merge(o||{},Spinner.defaults,defaults)}function initVML(){function vml(tag,attr){return createEl("<"+tag+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',attr)}sheet.addRule(".spin-vml","behavior:url(#default#VML)"),Spinner.prototype.lines=function(el,o){function grp(){return css(vml("group",{coordsize:s+" "+s,coordorigin:-r+" "+-r}),{width:s,height:s})}function seg(i,dx,filter){ins(g,ins(css(grp(),{rotation:360/o.lines*i+"deg",left:~~dx}),ins(css(vml("roundrect",{arcsize:o.corners}),{width:r,height:o.width,left:o.radius,top:-o.width>>1,filter:filter}),vml("fill",{color:getColor(o.color,i),opacity:o.opacity}),vml("stroke",{opacity:0}))))}var i,r=o.length+o.width,s=2*r,margin=2*-(o.width+o.length)+"px",g=css(grp(),{position:"absolute",top:margin,left:margin});if(o.shadow)for(i=1;i<=o.lines;i++)seg(i,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(i=1;i<=o.lines;i++)seg(i);return ins(el,g)},Spinner.prototype.opacity=function(el,i,val,o){var c=el.firstChild;o=o.shadow&&o.lines||0,c&&i+o<c.childNodes.length&&(c=c.childNodes[i+o],c=c&&c.firstChild,c=c&&c.firstChild,c&&(c.opacity=val))}}var useCssAnimations,prefixes=["webkit","Moz","ms","O"],animations={},sheet=function(){var el=createEl("style",{type:"text/css"});return ins(document.getElementsByTagName("head")[0],el),el.sheet||el.styleSheet}(),defaults={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:"50%",position:"absolute"};Spinner.defaults={},merge(Spinner.prototype,{spin:function(target){this.stop();var self=this,o=self.opts,el=self.el=css(createEl(0,{className:o.className}),{position:o.position,width:0,zIndex:o.zIndex});if(css(el,{left:o.left,top:o.top}),target&&target.insertBefore(el,target.firstChild||null),el.setAttribute("role","progressbar"),self.lines(el,self.opts),!useCssAnimations){var alpha,i=0,start=(o.lines-1)*(1-o.direction)/2,fps=o.fps,f=fps/o.speed,ostep=(1-o.opacity)/(f*o.trail/100),astep=f/o.lines;!function anim(){i++;for(var j=0;j<o.lines;j++)alpha=Math.max(1-(i+(o.lines-j)*astep)%f*ostep,o.opacity),self.opacity(el,j*o.direction+start,alpha,o);self.timeout=self.el&&setTimeout(anim,~~(1e3/fps))}()}return self},stop:function(){var el=this.el;return el&&(clearTimeout(this.timeout),el.parentNode&&el.parentNode.removeChild(el),this.el=void 0),this},lines:function(el,o){function fill(color,shadow){return css(createEl(),{position:"absolute",width:o.length+o.width+"px",height:o.width+"px",background:color,boxShadow:shadow,transformOrigin:"left",transform:"rotate("+~~(360/o.lines*i+o.rotate)+"deg) translate("+o.radius+"px,0)",borderRadius:(o.corners*o.width>>1)+"px"})}for(var seg,i=0,start=(o.lines-1)*(1-o.direction)/2;i<o.lines;i++)seg=css(createEl(),{position:"absolute",top:1+~(o.width/2)+"px",transform:o.hwaccel?"translate3d(0,0,0)":"",opacity:o.opacity,animation:useCssAnimations&&addAnimation(o.opacity,o.trail,start+i*o.direction,o.lines)+" "+1/o.speed+"s linear infinite"}),o.shadow&&ins(seg,css(fill("#000","0 0 4px #000"),{top:"2px"})),ins(el,ins(seg,fill(getColor(o.color,i),"0 0 1px rgba(0,0,0,.1)")));return el},opacity:function(el,i,val){i<el.childNodes.length&&(el.childNodes[i].style.opacity=val)}});var probe=css(createEl("group"),{behavior:"url(#default#VML)"});return!vendor(probe,"transform")&&probe.adj?initVML():useCssAnimations=vendor(probe,"animation"),Spinner}),function(factory){if("object"==typeof exports)factory(require("jquery"),require("spin.js"));else if("function"==typeof define&&define.amd)define(["jquery","spin"],factory);else{if(!window.Spinner)throw new Error("Spin.js not present");factory(window.jQuery,window.Spinner)}}(function($,Spinner){$.fn.spin=function(opts,color){return this.each(function(){var $this=$(this),data=$this.data();data.spinner&&(data.spinner.stop(),delete data.spinner),opts!==!1&&(opts=$.extend({color:color||$this.css("color")},$.fn.spin.presets[opts]||opts),data.spinner=new Spinner(opts).spin(this))})},$.fn.spin.presets={tiny:{lines:8,length:2,width:2,radius:3},small:{lines:8,length:4,width:3,radius:5},large:{lines:10,length:8,width:4,radius:8}}}),function(){"use strict";function FastClick(layer,options){function bind(method,context){return function(){return method.apply(context,arguments)}}var oldOnClick;if(options=options||{},this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=options.touchBoundary||10,this.layer=layer,this.tapDelay=options.tapDelay||200,this.tapTimeout=options.tapTimeout||700,!FastClick.notNeeded(layer)){for(var methods=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"],context=this,i=0,l=methods.length;i<l;i++)context[methods[i]]=bind(context[methods[i]],context);deviceIsAndroid&&(layer.addEventListener("mouseover",this.onMouse,!0),layer.addEventListener("mousedown",this.onMouse,!0),layer.addEventListener("mouseup",this.onMouse,!0)),layer.addEventListener("click",this.onClick,!0),layer.addEventListener("touchstart",this.onTouchStart,!1),layer.addEventListener("touchmove",this.onTouchMove,!1),layer.addEventListener("touchend",this.onTouchEnd,!1),layer.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(layer.removeEventListener=function(type,callback,capture){var rmv=Node.prototype.removeEventListener;"click"===type?rmv.call(layer,type,callback.hijacked||callback,capture):rmv.call(layer,type,callback,capture)},layer.addEventListener=function(type,callback,capture){var adv=Node.prototype.addEventListener;"click"===type?adv.call(layer,type,callback.hijacked||(callback.hijacked=function(event){event.propagationStopped||callback(event)}),capture):adv.call(layer,type,callback,capture)}),"function"==typeof layer.onclick&&(oldOnClick=layer.onclick,layer.addEventListener("click",function(event){oldOnClick(event)},!1),layer.onclick=null)}}var deviceIsWindowsPhone=navigator.userAgent.indexOf("Windows Phone")>=0,deviceIsAndroid=navigator.userAgent.indexOf("Android")>0&&!deviceIsWindowsPhone,deviceIsIOS=/iP(ad|hone|od)/.test(navigator.userAgent)&&!deviceIsWindowsPhone,deviceIsIOS4=deviceIsIOS&&/OS 4_\d(_\d)?/.test(navigator.userAgent),deviceIsIOSWithBadTarget=deviceIsIOS&&/OS [6-7]_\d/.test(navigator.userAgent),deviceIsBlackBerry10=navigator.userAgent.indexOf("BB10")>0;FastClick.prototype.needsClick=function(target){switch(target.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(target.disabled)return!0;break;case"input":if(deviceIsIOS&&"file"===target.type||target.disabled)return!0;break;case"label":case"iframe":case"video":return!0}return/\bneedsclick\b/.test(target.className)},FastClick.prototype.needsFocus=function(target){switch(target.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!deviceIsAndroid;case"input":switch(target.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!target.disabled&&!target.readOnly;default:return/\bneedsfocus\b/.test(target.className)}},FastClick.prototype.sendClick=function(targetElement,event){var clickEvent,touch;document.activeElement&&document.activeElement!==targetElement&&document.activeElement.blur(),touch=event.changedTouches[0],clickEvent=document.createEvent("MouseEvents"),clickEvent.initMouseEvent(this.determineEventType(targetElement),!0,!0,window,1,touch.screenX,touch.screenY,touch.clientX,touch.clientY,!1,!1,!1,!1,0,null),clickEvent.forwardedTouchEvent=!0,targetElement.dispatchEvent(clickEvent)},FastClick.prototype.determineEventType=function(targetElement){return deviceIsAndroid&&"select"===targetElement.tagName.toLowerCase()?"mousedown":"click"},FastClick.prototype.focus=function(targetElement){var length;deviceIsIOS&&targetElement.setSelectionRange&&0!==targetElement.type.indexOf("date")&&"time"!==targetElement.type&&"month"!==targetElement.type?(length=targetElement.value.length,targetElement.setSelectionRange(length,length)):targetElement.focus()},FastClick.prototype.updateScrollParent=function(targetElement){var scrollParent,parentElement;if(scrollParent=targetElement.fastClickScrollParent,!scrollParent||!scrollParent.contains(targetElement)){parentElement=targetElement;do{if(parentElement.scrollHeight>parentElement.offsetHeight){scrollParent=parentElement,targetElement.fastClickScrollParent=parentElement;break}parentElement=parentElement.parentElement}while(parentElement)}scrollParent&&(scrollParent.fastClickLastScrollTop=scrollParent.scrollTop)},FastClick.prototype.getTargetElementFromEventTarget=function(eventTarget){return eventTarget.nodeType===Node.TEXT_NODE?eventTarget.parentNode:eventTarget},FastClick.prototype.onTouchStart=function(event){var targetElement,touch,selection;if(event.targetTouches.length>1)return!0;if(targetElement=this.getTargetElementFromEventTarget(event.target),touch=event.targetTouches[0],deviceIsIOS){if(selection=window.getSelection(),selection.rangeCount&&!selection.isCollapsed)return!0;if(!deviceIsIOS4){if(touch.identifier&&touch.identifier===this.lastTouchIdentifier)return event.preventDefault(),!1;this.lastTouchIdentifier=touch.identifier,this.updateScrollParent(targetElement)}}return this.trackingClick=!0,this.trackingClickStart=event.timeStamp,this.targetElement=targetElement,this.touchStartX=touch.pageX,this.touchStartY=touch.pageY,event.timeStamp-this.lastClickTime<this.tapDelay&&event.preventDefault(),!0},FastClick.prototype.touchHasMoved=function(event){var touch=event.changedTouches[0],boundary=this.touchBoundary;return Math.abs(touch.pageX-this.touchStartX)>boundary||Math.abs(touch.pageY-this.touchStartY)>boundary},FastClick.prototype.onTouchMove=function(event){return!this.trackingClick||((this.targetElement!==this.getTargetElementFromEventTarget(event.target)||this.touchHasMoved(event))&&(this.trackingClick=!1,this.targetElement=null),!0)},FastClick.prototype.findControl=function(labelElement){return void 0!==labelElement.control?labelElement.control:labelElement.htmlFor?document.getElementById(labelElement.htmlFor):labelElement.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},FastClick.prototype.onTouchEnd=function(event){var forElement,trackingClickStart,targetTagName,scrollParent,touch,targetElement=this.targetElement;if(!this.trackingClick)return!0;if(event.timeStamp-this.lastClickTime<this.tapDelay)return this.cancelNextClick=!0,!0;if(event.timeStamp-this.trackingClickStart>this.tapTimeout)return!0;if(this.cancelNextClick=!1,this.lastClickTime=event.timeStamp,trackingClickStart=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,deviceIsIOSWithBadTarget&&(touch=event.changedTouches[0],targetElement=document.elementFromPoint(touch.pageX-window.pageXOffset,touch.pageY-window.pageYOffset)||targetElement,targetElement.fastClickScrollParent=this.targetElement.fastClickScrollParent),targetTagName=targetElement.tagName.toLowerCase(),"label"===targetTagName){if(forElement=this.findControl(targetElement)){if(this.focus(targetElement),deviceIsAndroid)return!1;targetElement=forElement}}else if(this.needsFocus(targetElement))return event.timeStamp-trackingClickStart>100||deviceIsIOS&&window.top!==window&&"input"===targetTagName?(this.targetElement=null,!1):(this.focus(targetElement),this.sendClick(targetElement,event),deviceIsIOS&&"select"===targetTagName||(this.targetElement=null,event.preventDefault()),!1);return!(!deviceIsIOS||deviceIsIOS4||(scrollParent=targetElement.fastClickScrollParent,!scrollParent||scrollParent.fastClickLastScrollTop===scrollParent.scrollTop))||(this.needsClick(targetElement)||(event.preventDefault(),this.sendClick(targetElement,event)),!1)},FastClick.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},FastClick.prototype.onMouse=function(event){return!this.targetElement||(!!event.forwardedTouchEvent||(!event.cancelable||(!(!this.needsClick(this.targetElement)||this.cancelNextClick)||(event.stopImmediatePropagation?event.stopImmediatePropagation():event.propagationStopped=!0,event.stopPropagation(),event.preventDefault(),!1))))},FastClick.prototype.onClick=function(event){var permitted;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):"submit"===event.target.type&&0===event.detail||(permitted=this.onMouse(event),permitted||(this.targetElement=null),permitted)},FastClick.prototype.destroy=function(){var layer=this.layer;deviceIsAndroid&&(layer.removeEventListener("mouseover",this.onMouse,!0),layer.removeEventListener("mousedown",this.onMouse,!0),layer.removeEventListener("mouseup",this.onMouse,!0)),layer.removeEventListener("click",this.onClick,!0),layer.removeEventListener("touchstart",this.onTouchStart,!1),layer.removeEventListener("touchmove",this.onTouchMove,!1),layer.removeEventListener("touchend",this.onTouchEnd,!1),layer.removeEventListener("touchcancel",this.onTouchCancel,!1)},FastClick.notNeeded=function(layer){var metaViewport,chromeVersion,blackberryVersion,firefoxVersion;if("undefined"==typeof window.ontouchstart)return!0;if(chromeVersion=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]){if(!deviceIsAndroid)return!0;if(metaViewport=document.querySelector("meta[name=viewport]")){if(metaViewport.content.indexOf("user-scalable=no")!==-1)return!0;if(chromeVersion>31&&document.documentElement.scrollWidth<=window.outerWidth)return!0}}if(deviceIsBlackBerry10&&(blackberryVersion=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/),blackberryVersion[1]>=10&&blackberryVersion[2]>=3&&(metaViewport=document.querySelector("meta[name=viewport]")))){if(metaViewport.content.indexOf("user-scalable=no")!==-1)return!0;if(document.documentElement.scrollWidth<=window.outerWidth)return!0}return"none"===layer.style.msTouchAction||"manipulation"===layer.style.touchAction||(firefoxVersion=+(/Firefox\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1],!!(firefoxVersion>=27&&(metaViewport=document.querySelector("meta[name=viewport]"),metaViewport&&(metaViewport.content.indexOf("user-scalable=no")!==-1||document.documentElement.scrollWidth<=window.outerWidth)))||("none"===layer.style.touchAction||"manipulation"===layer.style.touchAction))},FastClick.attach=function(layer,options){return new FastClick(layer,options)},"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(function(){return FastClick}):"undefined"!=typeof module&&module.exports?(module.exports=FastClick.attach,module.exports.FastClick=FastClick):window.FastClick=FastClick}(),System.register("flarum/app",["flarum/ForumApp","flarum/initializers/store","flarum/initializers/preload","flarum/initializers/routes","flarum/initializers/components","flarum/initializers/humanTime","flarum/initializers/boot","flarum/initializers/alertEmailConfirmation"],function(_export,_context){var ForumApp,store,preload,routes,components,humanTime,boot,alertEmailConfirmation,app;return{setters:[function(_flarumForumApp){ForumApp=_flarumForumApp.default},function(_flarumInitializersStore){store=_flarumInitializersStore.default},function(_flarumInitializersPreload){preload=_flarumInitializersPreload.default},function(_flarumInitializersRoutes){routes=_flarumInitializersRoutes.default},function(_flarumInitializersComponents){components=_flarumInitializersComponents.default},function(_flarumInitializersHumanTime){humanTime=_flarumInitializersHumanTime.default},function(_flarumInitializersBoot){boot=_flarumInitializersBoot.default},function(_flarumInitializersAlertEmailConfirmation){alertEmailConfirmation=_flarumInitializersAlertEmailConfirmation.default}],execute:function(){app=new ForumApp,app.initializers.add("store",store),app.initializers.add("routes",routes),app.initializers.add("components",components),app.initializers.add("humanTime",humanTime),app.initializers.add("preload",preload,-100),app.initializers.add("boot",boot,-100),app.initializers.add("alertEmailConfirmation",alertEmailConfirmation,-100),_export("default",app)}}}),System.register("flarum/App",["flarum/utils/ItemList","flarum/components/Alert","flarum/components/Button","flarum/components/RequestErrorModal","flarum/components/ConfirmPasswordModal","flarum/Translator","flarum/utils/extract","flarum/utils/patchMithril","flarum/utils/RequestError","flarum/extend"],function(_export,_context){var ItemList,Alert,Button,RequestErrorModal,ConfirmPasswordModal,Translator,extract,patchMithril,RequestError,extend,App;return{setters:[function(_flarumUtilsItemList){ItemList=_flarumUtilsItemList.default},function(_flarumComponentsAlert){Alert=_flarumComponentsAlert.default},function(_flarumComponentsButton){Button=_flarumComponentsButton.default},function(_flarumComponentsRequestErrorModal){RequestErrorModal=_flarumComponentsRequestErrorModal.default},function(_flarumComponentsConfirmPasswordModal){ConfirmPasswordModal=_flarumComponentsConfirmPasswordModal.default},function(_flarumTranslator){Translator=_flarumTranslator.default},function(_flarumUtilsExtract){extract=_flarumUtilsExtract.default},function(_flarumUtilsPatchMithril){patchMithril=_flarumUtilsPatchMithril.default},function(_flarumUtilsRequestError){RequestError=_flarumUtilsRequestError.default},function(_flarumExtend){extend=_flarumExtend.extend}],execute:function(){App=function(){function App(){babelHelpers.classCallCheck(this,App),patchMithril(window),this.forum=null,this.routes={},this.preload={data:null,document:null,session:null},this.initializers=new ItemList,this.session=null,this.translator=new Translator,this.store=null,this.cache={},this.booted=!1,this.requestError=null,this.title="",this.titleCount=0}return babelHelpers.createClass(App,[{key:"boot",value:function(){var _this=this;this.translator.locale=this.locale,this.initializers.toArray().forEach(function(initializer){return initializer(_this)})}},{key:"preloadedDocument",value:function(){if(app.preload.document){var results=app.store.pushPayload(app.preload.document);return app.preload.document=null,results}return null}},{key:"setTitle",value:function(title){this.title=title,this.updateTitle()}},{key:"setTitleCount",value:function(count){this.titleCount=count,this.updateTitle()}},{key:"updateTitle",value:function(){document.title=(this.titleCount?"("+this.titleCount+") ":"")+(this.title?this.title+" - ":"")+this.forum.attribute("title")}},{key:"request",value:function(originalOptions){var _this2=this,options=babelHelpers.extends({},originalOptions);options.background=options.background||!0,extend(options,"config",function(result,xhr){return xhr.setRequestHeader("X-CSRF-Token",_this2.session.csrfToken)}),"GET"!==options.method&&"POST"!==options.method&&!function(){var method=options.method;extend(options,"config",function(result,xhr){return xhr.setRequestHeader("X-HTTP-Method-Override",method)}),options.method="POST"}(),options.deserialize=options.deserialize||function(responseText){return responseText},options.errorHandler=options.errorHandler||function(error){throw error};var original=options.extract;options.extract=function(xhr){var responseText=void 0;responseText=original?original(xhr.responseText):xhr.responseText||null;var status=xhr.status;if(status<200||status>299)throw new RequestError(status,responseText,options,xhr);if(xhr.getResponseHeader){var csrfToken=xhr.getResponseHeader("X-CSRF-Token");csrfToken&&(app.session.csrfToken=csrfToken)}try{return JSON.parse(responseText)}catch(e){throw new RequestError(500,responseText,options,xhr)}},this.requestError&&this.alerts.dismiss(this.requestError.alert);var deferred=m.deferred();return m.request(options).then(function(response){return deferred.resolve(response)},function(error){_this2.requestError=error;var children=void 0;switch(error.status){case 422:children=error.response.errors.map(function(error){return[error.detail,m("br",null)]}).reduce(function(a,b){return a.concat(b)},[]).slice(0,-1);break;case 401:case 403:children=app.translator.trans("core.lib.error.permission_denied_message");break;case 404:case 410:children=app.translator.trans("core.lib.error.not_found_message");break;case 429:children=app.translator.trans("core.lib.error.rate_limit_exceeded_message");break;default:children=app.translator.trans("core.lib.error.generic_message")}error.alert=new Alert({type:"error",children:children,controls:app.forum.attribute("debug")?[m(Button,{className:"Button Button--link",onclick:_this2.showDebug.bind(_this2,error)},"Debug")]:void 0});try{options.errorHandler(error)}catch(error){_this2.alerts.show(error.alert)}deferred.reject(error)}),deferred.promise}},{key:"showDebug",value:function(error){this.alerts.dismiss(this.requestErrorAlert),this.modal.show(new RequestErrorModal({error:error}))}},{key:"route",value:function(name){var params=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],url=this.routes[name].path.replace(/:([^\/]+)/g,function(m,key){return extract(params,key)}),queryString=m.route.buildQueryString(params),prefix="pathname"===m.route.mode?app.forum.attribute("basePath"):"";return prefix+url+(queryString?"?"+queryString:"")}}]),App}(),_export("default",App)}}}),System.register("flarum/Component",[],function(_export,_context){var Component;return{setters:[],execute:function(){Component=function(){function Component(){var props=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],children=arguments.length<=1||void 0===arguments[1]?null:arguments[1];babelHelpers.classCallCheck(this,Component),children&&(props.children=children),this.constructor.initProps(props),this.props=props,this.element=null,this.retain=!1,this.init()}return babelHelpers.createClass(Component,[{key:"init",value:function(){}},{key:"onunload",value:function(){}},{key:"render",value:function(){var _this=this,vdom=this.retain?{subtree:"retain"}:this.view();vdom.attrs=vdom.attrs||{};var originalConfig=vdom.attrs.config;return vdom.attrs.config=function(){for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];_this.element=args[0],_this.config.apply(_this,args.slice(1)),originalConfig&&originalConfig.apply(_this,args)},vdom}},{key:"$",value:function(_$){function $(_x){return _$.apply(this,arguments)}return $.toString=function(){return _$.toString()},$}(function(selector){var $element=$(this.element);return selector?$element.find(selector):$element})},{key:"config",value:function(){}},{key:"view",value:function(){throw new Error("Component#view must be implemented by subclass")}}],[{key:"component",value:function(){var props=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],children=arguments.length<=1||void 0===arguments[1]?null:arguments[1],componentProps=babelHelpers.extends({},props);children&&(componentProps.children=children),this.initProps(componentProps);var view=function(component){return component.props=componentProps,component.render()};view.$original=this.prototype.view;var output={controller:this.bind(void 0,componentProps),view:view,props:componentProps,component:this};return componentProps.key&&(output.attrs={key:componentProps.key}),output}},{key:"initProps",value:function(props){}}]),Component}(),_export("default",Component)}}}),System.register("flarum/components/Alert",["flarum/Component","flarum/components/Button","flarum/helpers/listItems","flarum/utils/extract"],function(_export,_context){var Component,Button,listItems,extract,Alert;return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumComponentsButton){Button=_flarumComponentsButton.default},function(_flarumHelpersListItems){listItems=_flarumHelpersListItems.default},function(_flarumUtilsExtract){extract=_flarumUtilsExtract.default}],execute:function(){Alert=function(_Component){function Alert(){return babelHelpers.classCallCheck(this,Alert),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(Alert).apply(this,arguments))}return babelHelpers.inherits(Alert,_Component),babelHelpers.createClass(Alert,[{key:"view",value:function(){var attrs=babelHelpers.extends({},this.props),type=extract(attrs,"type");attrs.className="Alert Alert--"+type+" "+(attrs.className||"");var children=extract(attrs,"children"),controls=extract(attrs,"controls")||[],dismissible=extract(attrs,"dismissible"),ondismiss=extract(attrs,"ondismiss"),dismissControl=[];return(dismissible||void 0===dismissible)&&dismissControl.push(m(Button,{icon:"times",className:"Button Button--link Button--icon Alert-dismiss",onclick:ondismiss})),m("div",attrs,m("span",{className:"Alert-body"},children),m("ul",{className:"Alert-controls"},listItems(controls.concat(dismissControl))))}}]),Alert}(Component),_export("default",Alert)}}}),System.register("flarum/components/AlertManager",["flarum/Component","flarum/components/Alert"],function(_export,_context){var Component,Alert,AlertManager;return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumComponentsAlert){Alert=_flarumComponentsAlert.default}],execute:function(){AlertManager=function(_Component){function AlertManager(){return babelHelpers.classCallCheck(this,AlertManager),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(AlertManager).apply(this,arguments))}return babelHelpers.inherits(AlertManager,_Component),babelHelpers.createClass(AlertManager,[{key:"init",value:function(){this.components=[]}},{key:"view",value:function(){return m("div",{className:"AlertManager"},this.components.map(function(component){return m("div",{className:"AlertManager-alert"},component)}))}},{key:"show",value:function(component){if(!(component instanceof Alert))throw new Error("The AlertManager component can only show Alert components");component.props.ondismiss=this.dismiss.bind(this,component),this.components.push(component),m.redraw()}},{key:"dismiss",value:function(component){var index=this.components.indexOf(component);index!==-1&&(this.components.splice(index,1),m.redraw())}},{key:"clear",value:function(){this.components=[],m.redraw()}}]),AlertManager}(Component),_export("default",AlertManager)}}}),System.register("flarum/components/AvatarEditor",["flarum/Component","flarum/helpers/avatar","flarum/helpers/icon","flarum/helpers/listItems","flarum/utils/ItemList","flarum/components/Button","flarum/components/LoadingIndicator"],function(_export,_context){var Component,avatar,icon,listItems,ItemList,Button,LoadingIndicator,AvatarEditor;return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumHelpersAvatar){avatar=_flarumHelpersAvatar.default},function(_flarumHelpersIcon){icon=_flarumHelpersIcon.default},function(_flarumHelpersListItems){listItems=_flarumHelpersListItems.default},function(_flarumUtilsItemList){ItemList=_flarumUtilsItemList.default},function(_flarumComponentsButton){Button=_flarumComponentsButton.default},function(_flarumComponentsLoadingIndicator){LoadingIndicator=_flarumComponentsLoadingIndicator.default}],execute:function(){AvatarEditor=function(_Component){function AvatarEditor(){return babelHelpers.classCallCheck(this,AvatarEditor),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(AvatarEditor).apply(this,arguments))}return babelHelpers.inherits(AvatarEditor,_Component),babelHelpers.createClass(AvatarEditor,[{key:"init",value:function(){this.loading=!1}},{key:"view",value:function(){var user=this.props.user;return m("div",{className:"AvatarEditor Dropdown "+this.props.className+(this.loading?" loading":"")},avatar(user),m("a",{className:"Dropdown-toggle","data-toggle":"dropdown",onclick:this.quickUpload.bind(this)},this.loading?LoadingIndicator.component():icon("pencil")),m("ul",{className:"Dropdown-menu Menu"},listItems(this.controlItems().toArray())))}},{key:"controlItems",value:function(){var items=new ItemList;return items.add("upload",Button.component({icon:"upload",children:app.translator.trans("core.forum.user.avatar_upload_button"),onclick:this.upload.bind(this)})),items.add("remove",Button.component({icon:"times",children:app.translator.trans("core.forum.user.avatar_remove_button"),onclick:this.remove.bind(this)})),items}},{key:"quickUpload",value:function(e){this.props.user.avatarUrl()||(e.preventDefault(),e.stopPropagation(),this.upload())}},{key:"upload",value:function(){var _this2=this;if(!this.loading){var user=this.props.user,$input=$('<input type="file">');$input.appendTo("body").hide().click().on("change",function(e){var data=new FormData;data.append("avatar",$(e.target)[0].files[0]),_this2.loading=!0,m.redraw(),app.request({method:"POST",url:app.forum.attribute("apiUrl")+"/users/"+user.id()+"/avatar",serialize:function(raw){return raw},data:data}).then(_this2.success.bind(_this2),_this2.failure.bind(_this2))})}}},{key:"remove",value:function(){var user=this.props.user;this.loading=!0,m.redraw(),app.request({method:"DELETE",url:app.forum.attribute("apiUrl")+"/users/"+user.id()+"/avatar"}).then(this.success.bind(this),this.failure.bind(this))}},{key:"success",value:function(response){app.store.pushPayload(response),delete this.props.user.avatarColor,this.loading=!1,m.redraw()}},{key:"failure",value:function(){this.loading=!1,m.redraw()}}],[{key:"initProps",value:function(props){babelHelpers.get(Object.getPrototypeOf(AvatarEditor),"initProps",this).call(this,props),props.className=props.className||""}}]),AvatarEditor}(Component),_export("default",AvatarEditor)}}}),System.register("flarum/components/Badge",["flarum/Component","flarum/helpers/icon","flarum/utils/extract"],function(_export,_context){var Component,icon,extract,Badge;return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumHelpersIcon){icon=_flarumHelpersIcon.default},function(_flarumUtilsExtract){extract=_flarumUtilsExtract.default}],execute:function(){Badge=function(_Component){function Badge(){return babelHelpers.classCallCheck(this,Badge),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(Badge).apply(this,arguments))}return babelHelpers.inherits(Badge,_Component),babelHelpers.createClass(Badge,[{key:"view",value:function(){var attrs=babelHelpers.extends({},this.props),type=extract(attrs,"type"),iconName=extract(attrs,"icon");return attrs.className="Badge "+(type?"Badge--"+type:"")+" "+(attrs.className||""),
attrs.title=extract(attrs,"label")||"",m("span",attrs,iconName?icon(iconName,{className:"Badge-icon"}):m.trust("&nbsp;"))}},{key:"config",value:function(isInitialized){isInitialized||this.props.label&&this.$().tooltip({container:"body"})}}]),Badge}(Component),_export("default",Badge)}}}),System.register("flarum/components/Button",["flarum/Component","flarum/helpers/icon","flarum/utils/extract","flarum/components/LoadingIndicator"],function(_export,_context){var Component,icon,extract,LoadingIndicator,Button;return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumHelpersIcon){icon=_flarumHelpersIcon.default},function(_flarumUtilsExtract){extract=_flarumUtilsExtract.default},function(_flarumComponentsLoadingIndicator){LoadingIndicator=_flarumComponentsLoadingIndicator.default}],execute:function(){Button=function(_Component){function Button(){return babelHelpers.classCallCheck(this,Button),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(Button).apply(this,arguments))}return babelHelpers.inherits(Button,_Component),babelHelpers.createClass(Button,[{key:"view",value:function(){var attrs=babelHelpers.extends({},this.props);delete attrs.children,attrs.className=attrs.className||"",attrs.type=attrs.type||"button";var iconName=extract(attrs,"icon");iconName&&(attrs.className+=" hasIcon");var loading=extract(attrs,"loading");return(attrs.disabled||loading)&&(attrs.className+=" disabled"+(loading?" loading":""),delete attrs.onclick),m("button",attrs,this.getButtonContent())}},{key:"getButtonContent",value:function(){var iconName=this.props.icon;return[iconName&&iconName!==!0?icon(iconName,{className:"Button-icon"}):"",this.props.children?m("span",{className:"Button-label"},this.props.children):"",this.props.loading?LoadingIndicator.component({size:"tiny",className:"LoadingIndicator--inline"}):""]}}]),Button}(Component),_export("default",Button)}}}),System.register("flarum/components/ChangeEmailModal",["flarum/components/Modal","flarum/components/Button"],function(_export,_context){var Modal,Button,ChangeEmailModal;return{setters:[function(_flarumComponentsModal){Modal=_flarumComponentsModal.default},function(_flarumComponentsButton){Button=_flarumComponentsButton.default}],execute:function(){ChangeEmailModal=function(_Modal){function ChangeEmailModal(){return babelHelpers.classCallCheck(this,ChangeEmailModal),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(ChangeEmailModal).apply(this,arguments))}return babelHelpers.inherits(ChangeEmailModal,_Modal),babelHelpers.createClass(ChangeEmailModal,[{key:"init",value:function(){babelHelpers.get(Object.getPrototypeOf(ChangeEmailModal.prototype),"init",this).call(this),this.success=!1,this.email=m.prop(app.session.user.email()),this.password=m.prop("")}},{key:"className",value:function(){return"ChangeEmailModal Modal--small"}},{key:"title",value:function(){return app.translator.trans("core.forum.change_email.title")}},{key:"content",value:function(){return this.success?m("div",{className:"Modal-body"},m("div",{className:"Form Form--centered"},m("p",{className:"helpText"},app.translator.trans("core.forum.change_email.confirmation_message",{email:m("strong",null,this.email())})),m("div",{className:"Form-group"},m(Button,{className:"Button Button--primary Button--block",onclick:this.hide.bind(this)},app.translator.trans("core.forum.change_email.dismiss_button"))))):m("div",{className:"Modal-body"},m("div",{className:"Form Form--centered"},m("div",{className:"Form-group"},m("input",{type:"email",name:"email",className:"FormControl",placeholder:app.session.user.email(),bidi:this.email,disabled:this.loading})),m("div",{className:"Form-group"},m("input",{type:"password",name:"password",className:"FormControl",placeholder:app.translator.trans("core.forum.change_email.confirm_password_label"),bidi:this.password,disabled:this.loading})),m("div",{className:"Form-group"},Button.component({className:"Button Button--primary Button--block",type:"submit",loading:this.loading,children:app.translator.trans("core.forum.change_email.submit_button")}))))}},{key:"onsubmit",value:function(e){var _this2=this;if(e.preventDefault(),this.email()===app.session.user.email())return void this.hide();app.session.user.email();this.loading=!0,app.session.user.save({email:this.email()},{errorHandler:this.onerror.bind(this),meta:{password:this.password()}}).then(function(){return _this2.success=!0}).catch(function(){}).then(this.loaded.bind(this))}},{key:"onerror",value:function(error){401===error.status&&(error.alert.props.children=app.translator.trans("core.forum.change_email.incorrect_password_message")),babelHelpers.get(Object.getPrototypeOf(ChangeEmailModal.prototype),"onerror",this).call(this,error)}}]),ChangeEmailModal}(Modal),_export("default",ChangeEmailModal)}}}),System.register("flarum/components/ChangePasswordModal",["flarum/components/Modal","flarum/components/Button"],function(_export,_context){var Modal,Button,ChangePasswordModal;return{setters:[function(_flarumComponentsModal){Modal=_flarumComponentsModal.default},function(_flarumComponentsButton){Button=_flarumComponentsButton.default}],execute:function(){ChangePasswordModal=function(_Modal){function ChangePasswordModal(){return babelHelpers.classCallCheck(this,ChangePasswordModal),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(ChangePasswordModal).apply(this,arguments))}return babelHelpers.inherits(ChangePasswordModal,_Modal),babelHelpers.createClass(ChangePasswordModal,[{key:"className",value:function(){return"ChangePasswordModal Modal--small"}},{key:"title",value:function(){return app.translator.trans("core.forum.change_password.title")}},{key:"content",value:function(){return m("div",{className:"Modal-body"},m("div",{className:"Form Form--centered"},m("p",{className:"helpText"},app.translator.trans("core.forum.change_password.text")),m("div",{className:"Form-group"},Button.component({className:"Button Button--primary Button--block",type:"submit",loading:this.loading,children:app.translator.trans("core.forum.change_password.send_button")}))))}},{key:"onsubmit",value:function(e){e.preventDefault(),this.loading=!0,app.request({method:"POST",url:app.forum.attribute("apiUrl")+"/forgot",data:{email:app.session.user.email()}}).then(this.hide.bind(this),this.loaded.bind(this))}}]),ChangePasswordModal}(Modal),_export("default",ChangePasswordModal)}}}),System.register("flarum/components/Checkbox",["flarum/Component","flarum/components/LoadingIndicator","flarum/helpers/icon"],function(_export,_context){var Component,LoadingIndicator,icon,Checkbox;return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumComponentsLoadingIndicator){LoadingIndicator=_flarumComponentsLoadingIndicator.default},function(_flarumHelpersIcon){icon=_flarumHelpersIcon.default}],execute:function(){Checkbox=function(_Component){function Checkbox(){return babelHelpers.classCallCheck(this,Checkbox),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(Checkbox).apply(this,arguments))}return babelHelpers.inherits(Checkbox,_Component),babelHelpers.createClass(Checkbox,[{key:"init",value:function(){this.loading=!1}},{key:"view",value:function(){var className="Checkbox "+(this.props.state?"on":"off")+" "+(this.props.className||"");return this.loading&&(className+=" loading"),this.props.disabled&&(className+=" disabled"),m("label",{className:className},m("input",{type:"checkbox",checked:this.props.state,disabled:this.props.disabled,onchange:m.withAttr("checked",this.onchange.bind(this))}),m("div",{className:"Checkbox-display"},this.getDisplay()),this.props.children)}},{key:"getDisplay",value:function(){return this.loading?LoadingIndicator.component({size:"tiny"}):icon(this.props.state?"check":"times")}},{key:"onchange",value:function(checked){this.props.onchange&&this.props.onchange(checked,this)}}]),Checkbox}(Component),_export("default",Checkbox)}}}),System.register("flarum/components/CommentPost",["flarum/components/Post","flarum/utils/classList","flarum/components/PostUser","flarum/components/PostMeta","flarum/components/PostEdited","flarum/components/EditPostComposer","flarum/components/Composer","flarum/utils/ItemList","flarum/helpers/listItems","flarum/components/Button"],function(_export,_context){var Post,classList,PostUser,PostMeta,PostEdited,EditPostComposer,Composer,ItemList,listItems,Button,CommentPost;return{setters:[function(_flarumComponentsPost){Post=_flarumComponentsPost.default},function(_flarumUtilsClassList){classList=_flarumUtilsClassList.default},function(_flarumComponentsPostUser){PostUser=_flarumComponentsPostUser.default},function(_flarumComponentsPostMeta){PostMeta=_flarumComponentsPostMeta.default},function(_flarumComponentsPostEdited){PostEdited=_flarumComponentsPostEdited.default},function(_flarumComponentsEditPostComposer){EditPostComposer=_flarumComponentsEditPostComposer.default},function(_flarumComponentsComposer){Composer=_flarumComponentsComposer.default},function(_flarumUtilsItemList){ItemList=_flarumUtilsItemList.default},function(_flarumHelpersListItems){listItems=_flarumHelpersListItems.default},function(_flarumComponentsButton){Button=_flarumComponentsButton.default}],execute:function(){CommentPost=function(_Post){function CommentPost(){return babelHelpers.classCallCheck(this,CommentPost),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(CommentPost).apply(this,arguments))}return babelHelpers.inherits(CommentPost,_Post),babelHelpers.createClass(CommentPost,[{key:"init",value:function(){var _this2=this;babelHelpers.get(Object.getPrototypeOf(CommentPost.prototype),"init",this).call(this),this.revealContent=!1,this.postUser=new PostUser({post:this.props.post}),this.subtree.check(function(){return _this2.postUser.cardVisible},function(){return _this2.isEditing()})}},{key:"content",value:function(){return[m("header",{className:"Post-header"},m("ul",null,listItems(this.headerItems().toArray()))),m("div",{className:"Post-body"},this.isEditing()?m("div",{className:"Post-preview",config:this.configPreview.bind(this)}):m.trust(this.props.post.contentHtml()))]}},{key:"config",value:function(isInitialized,context){babelHelpers.get(Object.getPrototypeOf(CommentPost.prototype),"config",this).apply(this,arguments);var contentHtml=this.isEditing()?"":this.props.post.contentHtml();context.contentHtml!==contentHtml&&this.$(".Post-body script").each(function(){eval.call(window,$(this).text())}),context.contentHtml=contentHtml}},{key:"isEditing",value:function(){return app.composer.component instanceof EditPostComposer&&app.composer.component.props.post===this.props.post}},{key:"attrs",value:function(){var post=this.props.post;return{className:classList({CommentPost:!0,"Post--hidden":post.isHidden(),"Post--edited":post.isEdited(),revealContent:this.revealContent,editing:this.isEditing()})}}},{key:"configPreview",value:function(element,isInitialized,context){if(!isInitialized){var preview=void 0,updatePreview=function(){var content=app.composer.component.content();preview!==content&&(preview=content,s9e.TextFormatter.preview(preview||"",element))};updatePreview();var updateInterval=setInterval(updatePreview,50);context.onunload=function(){return clearInterval(updateInterval)}}}},{key:"toggleContent",value:function(){this.revealContent=!this.revealContent}},{key:"headerItems",value:function(){var items=new ItemList,post=this.props.post,props={post:post};return items.add("user",this.postUser.render(),100),items.add("meta",PostMeta.component(props)),post.isEdited()&&!post.isHidden()&&items.add("edited",PostEdited.component(props)),post.isHidden()&&items.add("toggle",Button.component({className:"Button Button--default Button--more",icon:"ellipsis-h",onclick:this.toggleContent.bind(this)})),items}}]),CommentPost}(Post),_export("default",CommentPost)}}}),System.register("flarum/components/Composer",["flarum/Component","flarum/utils/ItemList","flarum/components/ComposerButton","flarum/helpers/listItems","flarum/utils/classList","flarum/utils/computed"],function(_export,_context){var Component,ItemList,ComposerButton,listItems,classList,computed,Composer;return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumUtilsItemList){ItemList=_flarumUtilsItemList.default},function(_flarumComponentsComposerButton){ComposerButton=_flarumComponentsComposerButton.default},function(_flarumHelpersListItems){listItems=_flarumHelpersListItems.default},function(_flarumUtilsClassList){classList=_flarumUtilsClassList.default},function(_flarumUtilsComputed){computed=_flarumUtilsComputed.default}],execute:function(){Composer=function(_Component){function Composer(){return babelHelpers.classCallCheck(this,Composer),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(Composer).apply(this,arguments))}return babelHelpers.inherits(Composer,_Component),babelHelpers.createClass(Composer,[{key:"init",value:function(){this.position=Composer.PositionEnum.HIDDEN,this.height=null,this.active=!1,this.computedHeight=computed("height","position",function(height,position){return position===Composer.PositionEnum.MINIMIZED?"":position===Composer.PositionEnum.FULLSCREEN?$(window).height():Math.max(200,Math.min(height,$(window).height()-$("#header").outerHeight()))})}},{key:"view",value:function(){var classes={normal:this.position===Composer.PositionEnum.NORMAL,minimized:this.position===Composer.PositionEnum.MINIMIZED,fullScreen:this.position===Composer.PositionEnum.FULLSCREEN,active:this.active};classes.visible=classes.normal||classes.minimized||classes.fullScreen,this.component&&(this.component.props.disabled=classes.minimized);var showIfMinimized=this.position===Composer.PositionEnum.MINIMIZED?this.show.bind(this):void 0;return m("div",{className:"Composer "+classList(classes)},m("div",{className:"Composer-handle",config:this.configHandle.bind(this)}),m("ul",{className:"Composer-controls"},listItems(this.controlItems().toArray())),m("div",{className:"Composer-content",onclick:showIfMinimized},this.component?this.component.render():""))}},{key:"config",value:function(isInitialized,context){var _this2=this,defaultHeight=void 0;if(isInitialized||(defaultHeight=this.$().height()),!isInitialized){context.retain=!0,this.height=localStorage.getItem("composerHeight")||defaultHeight,this.$().hide().css("bottom",-this.height),this.$().on("focus blur",":input",function(e){_this2.active="focusin"===e.type,m.redraw()}),this.$().on("keydown",":input","esc",function(){return _this2.close()}),window.onbeforeunload=function(){return _this2.component&&_this2.component.preventExit()||void 0};var handlers={};$(window).on("resize",handlers.onresize=this.updateHeight.bind(this)).resize(),$(document).on("mousemove",handlers.onmousemove=this.onmousemove.bind(this)).on("mouseup",handlers.onmouseup=this.onmouseup.bind(this)),context.onunload=function(){$(window).off("resize",handlers.onresize),$(document).off("mousemove",handlers.onmousemove).off("mouseup",handlers.onmouseup)}}}},{key:"configHandle",value:function(element,isInitialized){if(!isInitialized){var composer=this;$(element).css("cursor","row-resize").bind("dragstart mousedown",function(e){return e.preventDefault()}).mousedown(function(e){composer.mouseStart=e.clientY,composer.heightStart=composer.$().height(),composer.handle=$(this),$("body").css("cursor","row-resize")})}}},{key:"onmousemove",value:function(e){if(this.handle){var deltaPixels=this.mouseStart-e.clientY;this.height=this.heightStart+deltaPixels,this.updateHeight();var scrollTop=$(window).scrollTop(),anchorToBottom=scrollTop>0&&scrollTop+$(window).height()>=$(document).height();this.updateBodyPadding(anchorToBottom),localStorage.setItem("composerHeight",this.height)}}},{key:"onmouseup",value:function(){this.handle&&(this.handle=null,$("body").css("cursor",""))}},{key:"updateHeight",value:function(){var height=this.computedHeight(),$flexible=this.$(".Composer-flexible");if(this.$().height(height),$flexible.length){var headerHeight=$flexible.offset().top-this.$().offset().top,paddingBottom=parseInt($flexible.css("padding-bottom"),10),footerHeight=this.$(".Composer-footer").outerHeight(!0);$flexible.height(this.$().outerHeight()-headerHeight-paddingBottom-footerHeight)}}},{key:"updateBodyPadding",value:function(){var visible=this.position!==Composer.PositionEnum.HIDDEN&&this.position!==Composer.PositionEnum.MINIMIZED&&"absolute"!==this.$().css("position"),paddingBottom=visible?this.computedHeight()-parseInt($("#app").css("padding-bottom"),10):0;$("#content").css({paddingBottom:paddingBottom})}},{key:"isFullScreen",value:function(){return this.position===Composer.PositionEnum.FULLSCREEN||"absolute"===this.$().css("position")}},{key:"preventExit",value:function preventExit(){if(this.component){var preventExit=this.component.preventExit();if(preventExit)return!confirm(preventExit)}}},{key:"load",value:function(component){this.preventExit()||(this.component&&(this.clear(),m.redraw(!0)),this.component=component)}},{key:"clear",value:function(){this.component=null}},{key:"animateToPosition",value:function(position){var _this3=this,oldPosition=this.position,$composer=this.$().stop(!0),oldHeight=$composer.outerHeight(),scrollTop=$(window).scrollTop();this.position=position,m.redraw(!0),$composer.show(),this.updateHeight();var newHeight=$composer.outerHeight();oldPosition===Composer.PositionEnum.HIDDEN?$composer.css({bottom:-newHeight,height:newHeight}):$composer.css({height:oldHeight}),$composer.animate({bottom:0,height:newHeight},"fast",function(){return _this3.component.focus()}),this.updateBodyPadding(),$(window).scrollTop(scrollTop)}},{key:"showBackdrop",value:function(){this.$backdrop=$("<div/>").addClass("composer-backdrop").appendTo("body")}},{key:"hideBackdrop",value:function(){this.$backdrop&&this.$backdrop.remove()}},{key:"show",value:function(){this.position!==Composer.PositionEnum.NORMAL&&this.position!==Composer.PositionEnum.FULLSCREEN&&(this.animateToPosition(Composer.PositionEnum.NORMAL),this.isFullScreen()&&(this.$().css("top",$(window).scrollTop()),this.showBackdrop()))}},{key:"hide",value:function(){var _this4=this,$composer=this.$();$composer.stop(!0).animate({bottom:-$composer.height()},"fast",function(){_this4.position=Composer.PositionEnum.HIDDEN,_this4.clear(),m.redraw(),$composer.hide(),_this4.hideBackdrop(),_this4.updateBodyPadding()})}},{key:"close",value:function(){this.preventExit()||this.hide()}},{key:"minimize",value:function(){this.position!==Composer.PositionEnum.HIDDEN&&(this.animateToPosition(Composer.PositionEnum.MINIMIZED),this.$().css("top","auto"),this.hideBackdrop())}},{key:"fullScreen",value:function(){this.position!==Composer.PositionEnum.HIDDEN&&(this.position=Composer.PositionEnum.FULLSCREEN,m.redraw(),this.updateHeight(),this.component.focus())}},{key:"exitFullScreen",value:function(){this.position===Composer.PositionEnum.FULLSCREEN&&(this.position=Composer.PositionEnum.NORMAL,m.redraw(),this.updateHeight(),this.component.focus())}},{key:"controlItems",value:function(){var items=new ItemList;return this.position===Composer.PositionEnum.FULLSCREEN?items.add("exitFullScreen",ComposerButton.component({icon:"compress",title:app.translator.trans("core.forum.composer.exit_full_screen_tooltip"),onclick:this.exitFullScreen.bind(this)})):(this.position!==Composer.PositionEnum.MINIMIZED&&(items.add("minimize",ComposerButton.component({icon:"minus minimize",title:app.translator.trans("core.forum.composer.minimize_tooltip"),onclick:this.minimize.bind(this),itemClassName:"App-backControl"})),items.add("fullScreen",ComposerButton.component({icon:"expand",title:app.translator.trans("core.forum.composer.full_screen_tooltip"),onclick:this.fullScreen.bind(this)}))),items.add("close",ComposerButton.component({icon:"times",title:app.translator.trans("core.forum.composer.close_tooltip"),onclick:this.close.bind(this)}))),items}}]),Composer}(Component),Composer.PositionEnum={HIDDEN:"hidden",NORMAL:"normal",MINIMIZED:"minimized",FULLSCREEN:"fullScreen"},_export("default",Composer)}}}),System.register("flarum/components/ComposerBody",["flarum/Component","flarum/components/LoadingIndicator","flarum/components/TextEditor","flarum/helpers/avatar","flarum/helpers/listItems","flarum/utils/ItemList"],function(_export,_context){var Component,LoadingIndicator,TextEditor,avatar,listItems,ItemList,ComposerBody;return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumComponentsLoadingIndicator){LoadingIndicator=_flarumComponentsLoadingIndicator.default},function(_flarumComponentsTextEditor){TextEditor=_flarumComponentsTextEditor.default},function(_flarumHelpersAvatar){avatar=_flarumHelpersAvatar.default},function(_flarumHelpersListItems){listItems=_flarumHelpersListItems.default},function(_flarumUtilsItemList){ItemList=_flarumUtilsItemList.default}],execute:function(){ComposerBody=function(_Component){function ComposerBody(){return babelHelpers.classCallCheck(this,ComposerBody),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(ComposerBody).apply(this,arguments))}return babelHelpers.inherits(ComposerBody,_Component),babelHelpers.createClass(ComposerBody,[{key:"init",value:function(){this.loading=!1,this.content=m.prop(this.props.originalContent),this.editor=new TextEditor({submitLabel:this.props.submitLabel,placeholder:this.props.placeholder,onchange:this.content,onsubmit:this.onsubmit.bind(this),value:this.content()})}},{key:"view",value:function(){return this.editor.props.disabled=this.loading,m("div",{className:"ComposerBody "+(this.props.className||"")},avatar(this.props.user,{className:"ComposerBody-avatar"}),m("div",{className:"ComposerBody-content"},m("ul",{className:"ComposerBody-header"},listItems(this.headerItems().toArray())),m("div",{className:"ComposerBody-editor"},this.editor.render())),LoadingIndicator.component({className:"ComposerBody-loading"+(this.loading?" active":"")}))}},{key:"focus",value:function(){this.$(":input:enabled:visible:first").focus()}},{key:"preventExit",value:function(){var content=this.content();return content&&content!==this.props.originalContent&&this.props.confirmExit}},{key:"headerItems",value:function(){return new ItemList}},{key:"onsubmit",value:function(){}},{key:"loaded",value:function(){this.loading=!1,m.redraw()}}]),ComposerBody}(Component),_export("default",ComposerBody)}}}),System.register("flarum/components/ComposerButton",["flarum/components/Button"],function(_export,_context){var Button,ComposerButton;return{setters:[function(_flarumComponentsButton){Button=_flarumComponentsButton.default}],execute:function(){ComposerButton=function(_Button){function ComposerButton(){return babelHelpers.classCallCheck(this,ComposerButton),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(ComposerButton).apply(this,arguments))}return babelHelpers.inherits(ComposerButton,_Button),babelHelpers.createClass(ComposerButton,null,[{key:"initProps",value:function(props){babelHelpers.get(Object.getPrototypeOf(ComposerButton),"initProps",this).call(this,props),props.className=props.className||"Button Button--icon Button--link"}}]),ComposerButton}(Button),_export("default",ComposerButton)}}}),System.register("flarum/components/DiscussionComposer",["flarum/components/ComposerBody","flarum/utils/extractText"],function(_export,_context){var ComposerBody,extractText,DiscussionComposer;return{setters:[function(_flarumComponentsComposerBody){ComposerBody=_flarumComponentsComposerBody.default},function(_flarumUtilsExtractText){extractText=_flarumUtilsExtractText.default}],execute:function(){DiscussionComposer=function(_ComposerBody){function DiscussionComposer(){return babelHelpers.classCallCheck(this,DiscussionComposer),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(DiscussionComposer).apply(this,arguments))}return babelHelpers.inherits(DiscussionComposer,_ComposerBody),babelHelpers.createClass(DiscussionComposer,[{key:"init",value:function(){babelHelpers.get(Object.getPrototypeOf(DiscussionComposer.prototype),"init",this).call(this),this.title=m.prop("")}},{key:"headerItems",value:function(){var items=babelHelpers.get(Object.getPrototypeOf(DiscussionComposer.prototype),"headerItems",this).call(this);return items.add("title",m("h3",null,app.translator.trans("core.forum.composer_discussion.title")),100),items.add("discussionTitle",m("h3",null,m("input",{className:"FormControl",value:this.title(),oninput:m.withAttr("value",this.title),placeholder:this.props.titlePlaceholder,disabled:!!this.props.disabled,onkeydown:this.onkeydown.bind(this)}))),items}},{key:"onkeydown",value:function(e){13===e.which&&(e.preventDefault(),this.editor.setSelectionRange(0,0)),m.redraw.strategy("none")}},{key:"preventExit",value:function(){return(this.title()||this.content())&&this.props.confirmExit}},{key:"data",value:function(){return{title:this.title(),content:this.content()}}},{key:"onsubmit",value:function(){this.loading=!0;var data=this.data();app.store.createRecord("discussions").save(data).then(function(discussion){app.composer.hide(),app.cache.discussionList.addDiscussion(discussion),m.route(app.route.discussion(discussion))},this.loaded.bind(this))}}],[{key:"initProps",value:function(props){babelHelpers.get(Object.getPrototypeOf(DiscussionComposer),"initProps",this).call(this,props),props.placeholder=props.placeholder||extractText(app.translator.trans("core.forum.composer_discussion.body_placeholder")),props.submitLabel=props.submitLabel||app.translator.trans("core.forum.composer_discussion.submit_button"),props.confirmExit=props.confirmExit||extractText(app.translator.trans("core.forum.composer_discussion.discard_confirmation")),props.titlePlaceholder=props.titlePlaceholder||extractText(app.translator.trans("core.forum.composer_discussion.title_placeholder")),props.className="ComposerBody--discussion"}}]),DiscussionComposer}(ComposerBody),_export("default",DiscussionComposer)}}}),System.register("flarum/components/DiscussionHero",["flarum/Component","flarum/utils/ItemList","flarum/helpers/listItems"],function(_export,_context){var Component,ItemList,listItems,DiscussionHero;return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumUtilsItemList){ItemList=_flarumUtilsItemList.default},function(_flarumHelpersListItems){listItems=_flarumHelpersListItems.default}],execute:function(){DiscussionHero=function(_Component){function DiscussionHero(){return babelHelpers.classCallCheck(this,DiscussionHero),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(DiscussionHero).apply(this,arguments))}return babelHelpers.inherits(DiscussionHero,_Component),babelHelpers.createClass(DiscussionHero,[{key:"view",value:function(){return m("header",{className:"Hero DiscussionHero"},m("div",{className:"container"},m("ul",{className:"DiscussionHero-items"},listItems(this.items().toArray()))))}},{key:"items",value:function items(){var items=new ItemList,discussion=this.props.discussion,badges=discussion.badges().toArray();return badges.length&&items.add("badges",m("ul",{className:"DiscussionHero-badges badges"},listItems(badges)),10),items.add("title",m("h2",{className:"DiscussionHero-title"},discussion.title())),items}}]),DiscussionHero}(Component),_export("default",DiscussionHero)}}}),System.register("flarum/components/DiscussionList",["flarum/Component","flarum/components/DiscussionListItem","flarum/components/Button","flarum/components/LoadingIndicator","flarum/components/Placeholder"],function(_export,_context){var Component,DiscussionListItem,Button,LoadingIndicator,Placeholder,DiscussionList;return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumComponentsDiscussionListItem){DiscussionListItem=_flarumComponentsDiscussionListItem.default},function(_flarumComponentsButton){Button=_flarumComponentsButton.default},function(_flarumComponentsLoadingIndicator){LoadingIndicator=_flarumComponentsLoadingIndicator.default},function(_flarumComponentsPlaceholder){Placeholder=_flarumComponentsPlaceholder.default}],execute:function(){DiscussionList=function(_Component){function DiscussionList(){return babelHelpers.classCallCheck(this,DiscussionList),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(DiscussionList).apply(this,arguments))}return babelHelpers.inherits(DiscussionList,_Component),babelHelpers.createClass(DiscussionList,[{key:"init",value:function(){this.loading=!0,this.moreResults=!1,this.discussions=[],this.refresh()}},{key:"view",value:function(){var params=this.props.params,loading=void 0;if(this.loading?loading=LoadingIndicator.component():this.moreResults&&(loading=Button.component({children:app.translator.trans("core.forum.discussion_list.load_more_button"),className:"Button",onclick:this.loadMore.bind(this)})),0===this.discussions.length&&!this.loading){var text=app.translator.trans("core.forum.discussion_list.empty_text");return m("div",{className:"DiscussionList"},Placeholder.component({text:text}))}return m("div",{className:"DiscussionList"},m("ul",{className:"DiscussionList-discussions"},this.discussions.map(function(discussion){return m("li",{key:discussion.id(),"data-id":discussion.id()},DiscussionListItem.component({discussion:discussion,params:params}))})),m("div",{className:"DiscussionList-loadMore"},loading))}},{key:"requestParams",value:function(){var params={include:["startUser","lastUser"],filter:{}};return params.sort=this.sortMap()[this.props.params.sort],this.props.params.q&&(params.filter.q=this.props.params.q,params.include.push("relevantPosts","relevantPosts.discussion","relevantPosts.user")),params}},{key:"sortMap",value:function(){var map={};return this.props.params.q&&(map.relevance=""),map.latest="-lastTime",map.top="-commentsCount",map.newest="-startTime",map.oldest="startTime",map}},{key:"refresh",value:function(){var _this2=this,clear=arguments.length<=0||void 0===arguments[0]||arguments[0];return clear&&(this.loading=!0,this.discussions=[]),this.loadResults().then(function(results){_this2.discussions=[],_this2.parseResults(results)},function(){_this2.loading=!1,m.redraw()})}},{key:"loadResults",value:function(offset){var preloadedDiscussions=app.preloadedDocument();if(preloadedDiscussions)return m.deferred().resolve(preloadedDiscussions).promise;var params=this.requestParams();return params.page={offset:offset},params.include=params.include.join(","),app.store.find("discussions",params)}},{key:"loadMore",value:function(){this.loading=!0,this.loadResults(this.discussions.length).then(this.parseResults.bind(this))}},{key:"parseResults",value:function(results){return[].push.apply(this.discussions,results),this.loading=!1,this.moreResults=!!results.payload.links.next,m.lazyRedraw(),results}},{key:"removeDiscussion",value:function(discussion){var index=this.discussions.indexOf(discussion);index!==-1&&this.discussions.splice(index,1)}},{key:"addDiscussion",value:function(discussion){this.discussions.unshift(discussion)}}]),DiscussionList}(Component),_export("default",DiscussionList)}}}),System.register("flarum/components/DiscussionListItem",["flarum/Component","flarum/helpers/avatar","flarum/helpers/listItems","flarum/helpers/highlight","flarum/helpers/icon","flarum/utils/humanTime","flarum/utils/ItemList","flarum/utils/abbreviateNumber","flarum/components/Dropdown","flarum/components/TerminalPost","flarum/components/PostPreview","flarum/utils/SubtreeRetainer","flarum/utils/DiscussionControls","flarum/utils/slidable","flarum/utils/extractText","flarum/utils/classList"],function(_export,_context){var Component,avatar,listItems,highlight,icon,humanTime,ItemList,abbreviateNumber,Dropdown,TerminalPost,PostPreview,SubtreeRetainer,DiscussionControls,slidable,extractText,classList,DiscussionListItem;return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumHelpersAvatar){avatar=_flarumHelpersAvatar.default},function(_flarumHelpersListItems){listItems=_flarumHelpersListItems.default;
},function(_flarumHelpersHighlight){highlight=_flarumHelpersHighlight.default},function(_flarumHelpersIcon){icon=_flarumHelpersIcon.default},function(_flarumUtilsHumanTime){humanTime=_flarumUtilsHumanTime.default},function(_flarumUtilsItemList){ItemList=_flarumUtilsItemList.default},function(_flarumUtilsAbbreviateNumber){abbreviateNumber=_flarumUtilsAbbreviateNumber.default},function(_flarumComponentsDropdown){Dropdown=_flarumComponentsDropdown.default},function(_flarumComponentsTerminalPost){TerminalPost=_flarumComponentsTerminalPost.default},function(_flarumComponentsPostPreview){PostPreview=_flarumComponentsPostPreview.default},function(_flarumUtilsSubtreeRetainer){SubtreeRetainer=_flarumUtilsSubtreeRetainer.default},function(_flarumUtilsDiscussionControls){DiscussionControls=_flarumUtilsDiscussionControls.default},function(_flarumUtilsSlidable){slidable=_flarumUtilsSlidable.default},function(_flarumUtilsExtractText){extractText=_flarumUtilsExtractText.default},function(_flarumUtilsClassList){classList=_flarumUtilsClassList.default}],execute:function(){DiscussionListItem=function(_Component){function DiscussionListItem(){return babelHelpers.classCallCheck(this,DiscussionListItem),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(DiscussionListItem).apply(this,arguments))}return babelHelpers.inherits(DiscussionListItem,_Component),babelHelpers.createClass(DiscussionListItem,[{key:"init",value:function(){var _this2=this;this.subtree=new SubtreeRetainer(function(){return _this2.props.discussion.freshness},function(){var time=app.session.user&&app.session.user.readTime();return time&&time.getTime()},function(){return _this2.active()})}},{key:"attrs",value:function(){return{className:classList(["DiscussionListItem",this.active()?"active":"",this.props.discussion.isHidden()?"DiscussionListItem--hidden":""])}}},{key:"view",value:function(){var _this3=this,retain=this.subtree.retain();if(retain)return retain;var discussion=this.props.discussion,startUser=discussion.startUser(),isUnread=discussion.isUnread(),isRead=discussion.isRead(),showUnread=!this.showRepliesCount()&&isUnread,jumpTo=Math.min(discussion.lastPostNumber(),(discussion.readNumber()||0)+1),relevantPosts=this.props.params.q?discussion.relevantPosts():[],controls=DiscussionControls.controls(discussion,this).toArray(),attrs=this.attrs();return m("div",attrs,controls.length?Dropdown.component({icon:"ellipsis-v",children:controls,className:"DiscussionListItem-controls",buttonClassName:"Button Button--icon Button--flat Slidable-underneath Slidable-underneath--right"}):"",m("a",{className:"Slidable-underneath Slidable-underneath--left Slidable-underneath--elastic"+(isUnread?"":" disabled"),onclick:this.markAsRead.bind(this)},icon("check")),m("div",{className:"DiscussionListItem-content Slidable-content"+(isUnread?" unread":"")+(isRead?" read":"")},m("a",{href:startUser?app.route.user(startUser):"#",className:"DiscussionListItem-author",title:extractText(app.translator.trans("core.forum.discussion_list.started_text",{user:startUser,ago:humanTime(discussion.startTime())})),config:function(element){$(element).tooltip({placement:"right"}),m.route.apply(this,arguments)}},avatar(startUser,{title:""})),m("ul",{className:"DiscussionListItem-badges badges"},listItems(discussion.badges().toArray())),m("a",{href:app.route.discussion(discussion,jumpTo),config:m.route,className:"DiscussionListItem-main"},m("h3",{className:"DiscussionListItem-title"},highlight(discussion.title(),this.props.params.q)),m("ul",{className:"DiscussionListItem-info"},listItems(this.infoItems().toArray()))),m("span",{className:"DiscussionListItem-count",onclick:this.markAsRead.bind(this),title:showUnread?app.translator.trans("core.forum.discussion_list.mark_as_read_tooltip"):""},abbreviateNumber(discussion[showUnread?"unreadCount":"repliesCount"]())),relevantPosts&&relevantPosts.length?m("div",{className:"DiscussionListItem-relevantPosts"},relevantPosts.map(function(post){return PostPreview.component({post:post,highlight:_this3.props.params.q})})):""))}},{key:"config",value:function(isInitialized){var _this4=this;isInitialized||"ontouchstart"in window&&!function(){var slidableInstance=slidable(_this4.$().addClass("Slidable"));_this4.$(".DiscussionListItem-controls").on("hidden.bs.dropdown",function(){return slidableInstance.reset()})}()}},{key:"active",value:function(){var idParam=m.route.param("id");return idParam&&idParam.split("-")[0]===this.props.discussion.id()}},{key:"showStartPost",value:function(){return["newest","oldest"].indexOf(this.props.params.sort)!==-1}},{key:"showRepliesCount",value:function(){return"replies"===this.props.params.sort}},{key:"markAsRead",value:function(){var discussion=this.props.discussion;discussion.isUnread()&&(discussion.save({readNumber:discussion.lastPostNumber()}),m.redraw())}},{key:"infoItems",value:function(){var items=new ItemList;return items.add("terminalPost",TerminalPost.component({discussion:this.props.discussion,lastPost:!this.showStartPost()})),items}}]),DiscussionListItem}(Component),_export("default",DiscussionListItem)}}}),System.register("flarum/components/DiscussionPage",["flarum/components/Page","flarum/utils/ItemList","flarum/components/DiscussionHero","flarum/components/PostStream","flarum/components/PostStreamScrubber","flarum/components/LoadingIndicator","flarum/components/SplitDropdown","flarum/helpers/listItems","flarum/utils/DiscussionControls"],function(_export,_context){var Page,ItemList,DiscussionHero,PostStream,PostStreamScrubber,LoadingIndicator,SplitDropdown,listItems,DiscussionControls,DiscussionPage;return{setters:[function(_flarumComponentsPage){Page=_flarumComponentsPage.default},function(_flarumUtilsItemList){ItemList=_flarumUtilsItemList.default},function(_flarumComponentsDiscussionHero){DiscussionHero=_flarumComponentsDiscussionHero.default},function(_flarumComponentsPostStream){PostStream=_flarumComponentsPostStream.default},function(_flarumComponentsPostStreamScrubber){PostStreamScrubber=_flarumComponentsPostStreamScrubber.default},function(_flarumComponentsLoadingIndicator){LoadingIndicator=_flarumComponentsLoadingIndicator.default},function(_flarumComponentsSplitDropdown){SplitDropdown=_flarumComponentsSplitDropdown.default},function(_flarumHelpersListItems){listItems=_flarumHelpersListItems.default},function(_flarumUtilsDiscussionControls){DiscussionControls=_flarumUtilsDiscussionControls.default}],execute:function(){DiscussionPage=function(_Page){function DiscussionPage(){return babelHelpers.classCallCheck(this,DiscussionPage),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(DiscussionPage).apply(this,arguments))}return babelHelpers.inherits(DiscussionPage,_Page),babelHelpers.createClass(DiscussionPage,[{key:"init",value:function(){babelHelpers.get(Object.getPrototypeOf(DiscussionPage.prototype),"init",this).call(this),this.discussion=null,this.near=null,this.refresh(),app.cache.discussionList&&(app.pane.enable(),app.pane.hide(),app.previous instanceof DiscussionPage&&m.redraw.strategy("diff")),app.history.push("discussion"),this.bodyClass="App--discussion"}},{key:"onunload",value:function(e){if(this.discussion){var idParam=m.route.param("id");if(idParam&&idParam.split("-")[0]===this.discussion.id()){e.preventDefault();var near=m.route.param("near")||"1";return near!==String(this.near)&&this.stream.goToNumber(near),void(this.near=null)}}app.pane.disable(),app.composingReplyTo(this.discussion)&&!app.composer.component.content()?app.composer.hide():app.composer.minimize()}},{key:"view",value:function(){var discussion=this.discussion;return m("div",{className:"DiscussionPage"},app.cache.discussionList?m("div",{className:"DiscussionPage-list",config:this.configPane.bind(this)},$(".App-navigation").is(":visible")?"":app.cache.discussionList.render()):"",m("div",{className:"DiscussionPage-discussion"},discussion?[DiscussionHero.component({discussion:discussion}),m("div",{className:"container"},m("nav",{className:"DiscussionPage-nav"},m("ul",null,listItems(this.sidebarItems().toArray()))),m("div",{className:"DiscussionPage-stream"},this.stream.render()))]:LoadingIndicator.component({className:"LoadingIndicator--block"})))}},{key:"refresh",value:function(){this.near=m.route.param("near")||0,this.discussion=null;var preloadedDiscussion=app.preloadedDocument();if(preloadedDiscussion)setTimeout(this.show.bind(this,preloadedDiscussion),0);else{var params=this.requestParams();app.store.find("discussions",m.route.param("id").split("-")[0],params).then(this.show.bind(this))}m.lazyRedraw()}},{key:"requestParams",value:function(){return{page:{near:this.near}}}},{key:"show",value:function(discussion){this.discussion=discussion,app.history.push("discussion",discussion.title()),app.setTitle(discussion.title()),app.setTitleCount(0);var includedPosts=[];discussion.payload&&discussion.payload.included&&(includedPosts=discussion.payload.included.filter(function(record){return"posts"===record.type&&record.relationships&&record.relationships.discussion}).map(function(record){return app.store.getById("posts",record.id)}).sort(function(a,b){return a.id()-b.id()}).slice(0,20)),this.stream=new PostStream({discussion:discussion,includedPosts:includedPosts}),this.stream.on("positionChanged",this.positionChanged.bind(this)),this.stream.goToNumber(m.route.param("near")||includedPosts[0]&&includedPosts[0].number(),!0)}},{key:"configPane",value:function(element,isInitialized,context){if(!isInitialized){context.retain=!0;var $list=$(element),pane=app.pane;$list.hover(pane.show.bind(pane),pane.onmouseleave.bind(pane));var hotEdge=function(e){e.pageX<10&&pane.show()};$(document).on("mousemove",hotEdge),context.onunload=function(){return $(document).off("mousemove",hotEdge)};var $discussion=$list.find(".DiscussionListItem.active");if($discussion.length){var listTop=$list.offset().top,listBottom=listTop+$list.outerHeight(),discussionTop=$discussion.offset().top,discussionBottom=discussionTop+$discussion.outerHeight();(discussionTop<listTop||discussionBottom>listBottom)&&$list.scrollTop($list.scrollTop()-listTop+discussionTop)}}}},{key:"sidebarItems",value:function(){var items=new ItemList;return items.add("controls",SplitDropdown.component({children:DiscussionControls.controls(this.discussion,this).toArray(),icon:"ellipsis-v",className:"App-primaryControl",buttonClassName:"Button--primary"})),items.add("scrubber",PostStreamScrubber.component({stream:this.stream,className:"App-titleControl"}),-100),items}},{key:"positionChanged",value:function(startNumber,endNumber){var discussion=this.discussion,url=app.route.discussion(discussion,this.near=startNumber);m.route(url,!0),window.history.replaceState(null,document.title,url),app.history.push("discussion",discussion.title()),app.session.user&&endNumber>(discussion.readNumber()||0)&&(discussion.save({readNumber:endNumber}),m.redraw())}}]),DiscussionPage}(Page),_export("default",DiscussionPage)}}}),System.register("flarum/components/DiscussionRenamedNotification",["flarum/components/Notification"],function(_export,_context){var Notification,DiscussionRenamedNotification;return{setters:[function(_flarumComponentsNotification){Notification=_flarumComponentsNotification.default}],execute:function(){DiscussionRenamedNotification=function(_Notification){function DiscussionRenamedNotification(){return babelHelpers.classCallCheck(this,DiscussionRenamedNotification),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(DiscussionRenamedNotification).apply(this,arguments))}return babelHelpers.inherits(DiscussionRenamedNotification,_Notification),babelHelpers.createClass(DiscussionRenamedNotification,[{key:"icon",value:function(){return"pencil"}},{key:"href",value:function(){var notification=this.props.notification;return app.route.discussion(notification.subject(),notification.content().postNumber)}},{key:"content",value:function(){return app.translator.trans("core.forum.notifications.discussion_renamed_text",{user:this.props.notification.sender()})}}]),DiscussionRenamedNotification}(Notification),_export("default",DiscussionRenamedNotification)}}}),System.register("flarum/components/DiscussionRenamedPost",["flarum/components/EventPost"],function(_export,_context){var EventPost,DiscussionRenamedPost;return{setters:[function(_flarumComponentsEventPost){EventPost=_flarumComponentsEventPost.default}],execute:function(){DiscussionRenamedPost=function(_EventPost){function DiscussionRenamedPost(){return babelHelpers.classCallCheck(this,DiscussionRenamedPost),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(DiscussionRenamedPost).apply(this,arguments))}return babelHelpers.inherits(DiscussionRenamedPost,_EventPost),babelHelpers.createClass(DiscussionRenamedPost,[{key:"icon",value:function(){return"pencil"}},{key:"descriptionKey",value:function(){return"core.forum.post_stream.discussion_renamed_text"}},{key:"descriptionData",value:function(){var post=this.props.post,oldTitle=post.content()[0],newTitle=post.content()[1];return{old:m("strong",{className:"DiscussionRenamedPost-old"},oldTitle),new:m("strong",{className:"DiscussionRenamedPost-new"},newTitle)}}}]),DiscussionRenamedPost}(EventPost),_export("default",DiscussionRenamedPost)}}}),System.register("flarum/components/DiscussionsSearchSource",["flarum/helpers/highlight","flarum/components/LinkButton"],function(_export,_context){var highlight,LinkButton,DiscussionsSearchSource;return{setters:[function(_flarumHelpersHighlight){highlight=_flarumHelpersHighlight.default},function(_flarumComponentsLinkButton){LinkButton=_flarumComponentsLinkButton.default}],execute:function(){DiscussionsSearchSource=function(){function DiscussionsSearchSource(){babelHelpers.classCallCheck(this,DiscussionsSearchSource),this.results={}}return babelHelpers.createClass(DiscussionsSearchSource,[{key:"search",value:function(query){var _this=this;this.results[query]=[];var params={filter:{q:query},page:{limit:3},include:"relevantPosts,relevantPosts.discussion,relevantPosts.user"};return app.store.find("discussions",params).then(function(results){return _this.results[query]=results})}},{key:"view",value:function(query){var results=this.results[query]||[];return[m("li",{className:"Dropdown-header"},app.translator.trans("core.forum.search.discussions_heading")),m("li",null,LinkButton.component({icon:"search",children:app.translator.trans("core.forum.search.all_discussions_button",{query:query}),href:app.route("index",{q:query})})),results.map(function(discussion){var relevantPosts=discussion.relevantPosts(),post=relevantPosts&&relevantPosts[0];return m("li",{className:"DiscussionSearchResult","data-index":"discussions"+discussion.id()},m("a",{href:app.route.discussion(discussion,post&&post.number()),config:m.route},m("div",{className:"DiscussionSearchResult-title"},highlight(discussion.title(),query)),post?m("div",{className:"DiscussionSearchResult-excerpt"},highlight(post.contentPlain(),query,100)):""))})]}}]),DiscussionsSearchSource}(),_export("default",DiscussionsSearchSource)}}}),System.register("flarum/components/DiscussionsUserPage",["flarum/components/UserPage","flarum/components/DiscussionList"],function(_export,_context){var UserPage,DiscussionList,DiscussionsUserPage;return{setters:[function(_flarumComponentsUserPage){UserPage=_flarumComponentsUserPage.default},function(_flarumComponentsDiscussionList){DiscussionList=_flarumComponentsDiscussionList.default}],execute:function(){DiscussionsUserPage=function(_UserPage){function DiscussionsUserPage(){return babelHelpers.classCallCheck(this,DiscussionsUserPage),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(DiscussionsUserPage).apply(this,arguments))}return babelHelpers.inherits(DiscussionsUserPage,_UserPage),babelHelpers.createClass(DiscussionsUserPage,[{key:"init",value:function(){babelHelpers.get(Object.getPrototypeOf(DiscussionsUserPage.prototype),"init",this).call(this),this.loadUser(m.route.param("username"))}},{key:"content",value:function(){return m("div",{className:"DiscussionsUserPage"},DiscussionList.component({params:{q:"author:"+this.user.username()}}))}}]),DiscussionsUserPage}(UserPage),_export("default",DiscussionsUserPage)}}}),System.register("flarum/components/Dropdown",["flarum/Component","flarum/helpers/icon","flarum/helpers/listItems"],function(_export,_context){var Component,icon,listItems,Dropdown;return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumHelpersIcon){icon=_flarumHelpersIcon.default},function(_flarumHelpersListItems){listItems=_flarumHelpersListItems.default}],execute:function(){Dropdown=function(_Component){function Dropdown(){return babelHelpers.classCallCheck(this,Dropdown),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(Dropdown).apply(this,arguments))}return babelHelpers.inherits(Dropdown,_Component),babelHelpers.createClass(Dropdown,[{key:"view",value:function(){var items=this.props.children?listItems(this.props.children):[];return m("div",{className:"ButtonGroup Dropdown dropdown "+this.props.className+" itemCount"+items.length},this.getButton(),this.getMenu(items))}},{key:"config",value:function(isInitialized){var _this2=this;isInitialized||(this.$().on("shown.bs.dropdown",function(){var $menu=_this2.$(".Dropdown-menu"),isRight=$menu.hasClass("Dropdown-menu--right");$menu.removeClass("Dropdown-menu--top Dropdown-menu--right"),$menu.toggleClass("Dropdown-menu--top",$menu.offset().top+$menu.height()>$(window).scrollTop()+$(window).height()),$menu.toggleClass("Dropdown-menu--right",isRight||$menu.offset().left+$menu.width()>$(window).scrollLeft()+$(window).width()),_this2.props.onshow&&(_this2.props.onshow(),m.redraw())}),this.$().on("hidden.bs.dropdown",function(){_this2.props.onhide&&(_this2.props.onhide(),m.redraw())}))}},{key:"getButton",value:function(){return m("button",{className:"Dropdown-toggle "+this.props.buttonClassName,"data-toggle":"dropdown",onclick:this.props.onclick},this.getButtonContent())}},{key:"getButtonContent",value:function(){return[this.props.icon?icon(this.props.icon,{className:"Button-icon"}):"",m("span",{className:"Button-label"},this.props.label),this.props.caretIcon?icon(this.props.caretIcon,{className:"Button-caret"}):""]}},{key:"getMenu",value:function(items){return m("ul",{className:"Dropdown-menu dropdown-menu "+this.props.menuClassName},items)}}],[{key:"initProps",value:function(props){babelHelpers.get(Object.getPrototypeOf(Dropdown),"initProps",this).call(this,props),props.className=props.className||"",props.buttonClassName=props.buttonClassName||"",props.menuClassName=props.menuClassName||"",props.label=props.label||"",props.caretIcon="undefined"!=typeof props.caretIcon?props.caretIcon:"caret-down"}}]),Dropdown}(Component),_export("default",Dropdown)}}}),System.register("flarum/components/EditPostComposer",["flarum/components/ComposerBody","flarum/helpers/icon"],function(_export,_context){function minimizeComposerIfFullScreen(e){app.composer.isFullScreen()&&(app.composer.minimize(),e.stopPropagation())}var ComposerBody,icon,EditPostComposer;return{setters:[function(_flarumComponentsComposerBody){ComposerBody=_flarumComponentsComposerBody.default},function(_flarumHelpersIcon){icon=_flarumHelpersIcon.default}],execute:function(){EditPostComposer=function(_ComposerBody){function EditPostComposer(){return babelHelpers.classCallCheck(this,EditPostComposer),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(EditPostComposer).apply(this,arguments))}return babelHelpers.inherits(EditPostComposer,_ComposerBody),babelHelpers.createClass(EditPostComposer,[{key:"init",value:function(){var _this2=this;babelHelpers.get(Object.getPrototypeOf(EditPostComposer.prototype),"init",this).call(this),this.editor.props.preview=function(e){minimizeComposerIfFullScreen(e),m.route(app.route.post(_this2.props.post))}}},{key:"headerItems",value:function(){var items=babelHelpers.get(Object.getPrototypeOf(EditPostComposer.prototype),"headerItems",this).call(this),post=this.props.post,routeAndMinimize=function(element,isInitialized){isInitialized||($(element).on("click",minimizeComposerIfFullScreen),m.route.apply(this,arguments))};return items.add("title",m("h3",null,icon("pencil")," "," ",m("a",{href:app.route.discussion(post.discussion(),post.number()),config:routeAndMinimize},app.translator.trans("core.forum.composer_edit.post_link",{number:post.number(),discussion:post.discussion().title()})))),items}},{key:"data",value:function(){return{content:this.content()}}},{key:"onsubmit",value:function(){this.loading=!0;var data=this.data();this.props.post.save(data).then(function(){return app.composer.hide()},this.loaded.bind(this))}}],[{key:"initProps",value:function(props){babelHelpers.get(Object.getPrototypeOf(EditPostComposer),"initProps",this).call(this,props),props.submitLabel=props.submitLabel||app.translator.trans("core.forum.composer_edit.submit_button"),props.confirmExit=props.confirmExit||app.translator.trans("core.forum.composer_edit.discard_confirmation"),props.originalContent=props.originalContent||props.post.content(),props.user=props.user||props.post.user(),props.post.editedContent=props.originalContent}}]),EditPostComposer}(ComposerBody),_export("default",EditPostComposer)}}}),System.register("flarum/components/EditUserModal",["flarum/components/Modal","flarum/components/Button","flarum/components/GroupBadge","flarum/models/Group","flarum/utils/extractText"],function(_export,_context){var Modal,Button,GroupBadge,Group,extractText,EditUserModal;return{setters:[function(_flarumComponentsModal){Modal=_flarumComponentsModal.default},function(_flarumComponentsButton){Button=_flarumComponentsButton.default},function(_flarumComponentsGroupBadge){GroupBadge=_flarumComponentsGroupBadge.default},function(_flarumModelsGroup){Group=_flarumModelsGroup.default},function(_flarumUtilsExtractText){extractText=_flarumUtilsExtractText.default}],execute:function(){EditUserModal=function(_Modal){function EditUserModal(){return babelHelpers.classCallCheck(this,EditUserModal),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(EditUserModal).apply(this,arguments))}return babelHelpers.inherits(EditUserModal,_Modal),babelHelpers.createClass(EditUserModal,[{key:"init",value:function(){var _this2=this;babelHelpers.get(Object.getPrototypeOf(EditUserModal.prototype),"init",this).call(this);var user=this.props.user;this.username=m.prop(user.username()||""),this.email=m.prop(user.email()||""),this.setPassword=m.prop(!1),this.password=m.prop(user.password()||""),this.groups={},app.store.all("groups").filter(function(group){return[Group.GUEST_ID,Group.MEMBER_ID].indexOf(group.id())===-1}).forEach(function(group){return _this2.groups[group.id()]=m.prop(user.groups().indexOf(group)!==-1)})}},{key:"className",value:function(){return"EditUserModal Modal--small"}},{key:"title",value:function(){return"Edit User"}},{key:"content",value:function(){var _this3=this;return m("div",{className:"Modal-body"},m("div",{className:"Form"},m("div",{className:"Form-group"},m("label",null,"Username"),m("input",{className:"FormControl",placeholder:extractText(app.translator.trans("core.forum.edit_user.username_label")),value:this.username(),onchange:m.withAttr("value",this.username)})),m("div",{className:"Form-group"},m("label",null,"Email"),m("div",null,m("input",{className:"FormControl",placeholder:extractText(app.translator.trans("core.forum.edit_user.email_label")),value:this.email(),onchange:m.withAttr("value",this.email)}))),m("div",{className:"Form-group"},m("label",null,"Password"),m("div",null,m("label",{className:"checkbox"},m("input",{type:"checkbox",checked:this.setPassword(),onchange:function(e){_this3.setPassword(e.target.checked),m.redraw(!0),e.target.checked&&_this3.$("[name=password]").select(),m.redraw.strategy("none")}}),"Set new password"),this.setPassword()?m("input",{className:"FormControl",type:"password",name:"password",placeholder:extractText(app.translator.trans("core.forum.edit_user.password_label")),value:this.password(),onchange:m.withAttr("value",this.password)}):"")),m("div",{className:"Form-group EditUserModal-groups"},m("label",null,"Groups"),m("div",null,Object.keys(this.groups).map(function(id){return app.store.getById("groups",id)}).map(function(group){return m("label",{className:"checkbox"},m("input",{type:"checkbox",checked:_this3.groups[group.id()](),disabled:"1"===_this3.props.user.id()&&group.id()===Group.ADMINISTRATOR_ID,onchange:m.withAttr("checked",_this3.groups[group.id()])}),GroupBadge.component({group:group,label:""})," ",group.nameSingular())}))),m("div",{className:"Form-group"},Button.component({className:"Button Button--primary",type:"submit",loading:this.loading,children:app.translator.trans("core.forum.edit_user.submit_button")}))))}},{key:"data",value:function data(){var _this4=this,groups=Object.keys(this.groups).filter(function(id){return _this4.groups[id]()}).map(function(id){return app.store.getById("groups",id)}),data={username:this.username(),email:this.email(),relationships:{groups:groups}};return this.setPassword()&&(data.password=this.password()),data}},{key:"onsubmit",value:function(e){var _this5=this;e.preventDefault(),this.loading=!0,this.props.user.save(this.data(),{errorHandler:this.onerror.bind(this)}).then(this.hide.bind(this)).catch(function(){_this5.loading=!1,m.redraw()})}}]),EditUserModal}(Modal),_export("default",EditUserModal)}}}),System.register("flarum/components/EventPost",["flarum/components/Post","flarum/utils/string","flarum/helpers/username","flarum/helpers/icon"],function(_export,_context){var Post,ucfirst,usernameHelper,icon,EventPost;return{setters:[function(_flarumComponentsPost){Post=_flarumComponentsPost.default},function(_flarumUtilsString){ucfirst=_flarumUtilsString.ucfirst},function(_flarumHelpersUsername){usernameHelper=_flarumHelpersUsername.default},function(_flarumHelpersIcon){icon=_flarumHelpersIcon.default}],execute:function(){EventPost=function(_Post){function EventPost(){return babelHelpers.classCallCheck(this,EventPost),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(EventPost).apply(this,arguments))}return babelHelpers.inherits(EventPost,_Post),babelHelpers.createClass(EventPost,[{key:"attrs",value:function(){return{className:"EventPost "+ucfirst(this.props.post.contentType())+"Post"}}},{key:"content",value:function(){var user=this.props.post.user(),username=usernameHelper(user),data=babelHelpers.extends(this.descriptionData(),{user:user,username:user?m("a",{className:"EventPost-user",href:app.route.user(user),config:m.route},username):username});return[icon(this.icon(),{className:"EventPost-icon"}),m("div",{class:"EventPost-info"},app.translator.transChoice(this.descriptionKey(),data.count,data))]}},{key:"icon",value:function(){return""}},{key:"descriptionKey",value:function(){return""}},{key:"descriptionData",value:function(){return{}}}]),EventPost}(Post),_export("default",EventPost)}}}),System.register("flarum/components/FieldSet",["flarum/Component","flarum/helpers/listItems"],function(_export,_context){var Component,listItems,FieldSet;return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumHelpersListItems){listItems=_flarumHelpersListItems.default}],execute:function(){FieldSet=function(_Component){function FieldSet(){return babelHelpers.classCallCheck(this,FieldSet),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(FieldSet).apply(this,arguments))}return babelHelpers.inherits(FieldSet,_Component),babelHelpers.createClass(FieldSet,[{key:"view",value:function(){return m("fieldset",{className:this.props.className},m("legend",null,this.props.label),m("ul",null,listItems(this.props.children)))}}]),FieldSet}(Component),_export("default",FieldSet)}}}),System.register("flarum/components/ForgotPasswordModal",["flarum/components/Modal","flarum/components/Alert","flarum/components/Button","flarum/utils/extractText"],function(_export,_context){var Modal,Alert,Button,extractText,ForgotPasswordModal;return{setters:[function(_flarumComponentsModal){Modal=_flarumComponentsModal.default},function(_flarumComponentsAlert){Alert=_flarumComponentsAlert.default},function(_flarumComponentsButton){Button=_flarumComponentsButton.default},function(_flarumUtilsExtractText){extractText=_flarumUtilsExtractText.default}],execute:function(){ForgotPasswordModal=function(_Modal){function ForgotPasswordModal(){return babelHelpers.classCallCheck(this,ForgotPasswordModal),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(ForgotPasswordModal).apply(this,arguments))}return babelHelpers.inherits(ForgotPasswordModal,_Modal),babelHelpers.createClass(ForgotPasswordModal,[{key:"init",value:function(){babelHelpers.get(Object.getPrototypeOf(ForgotPasswordModal.prototype),"init",this).call(this),this.email=m.prop(this.props.email||""),this.success=!1}},{key:"className",value:function(){return"ForgotPasswordModal Modal--small"}},{key:"title",value:function(){return app.translator.trans("core.forum.forgot_password.title")}},{key:"content",value:function(){return this.success?m("div",{className:"Modal-body"},m("div",{className:"Form Form--centered"},m("p",{className:"helpText"},app.translator.trans("core.forum.forgot_password.email_sent_message")),m("div",{className:"Form-group"},m(Button,{className:"Button Button--primary Button--block",onclick:this.hide.bind(this)},app.translator.trans("core.forum.forgot_password.dismiss_button"))))):m("div",{className:"Modal-body"},m("div",{className:"Form Form--centered"},m("p",{className:"helpText"},app.translator.trans("core.forum.forgot_password.text")),m("div",{className:"Form-group"},m("input",{className:"FormControl",name:"email",type:"email",placeholder:extractText(app.translator.trans("core.forum.forgot_password.email_placeholder")),value:this.email(),onchange:m.withAttr("value",this.email),disabled:this.loading})),m("div",{className:"Form-group"},Button.component({className:"Button Button--primary Button--block",type:"submit",loading:this.loading,children:app.translator.trans("core.forum.forgot_password.submit_button")}))))}},{key:"onsubmit",value:function(e){var _this2=this;e.preventDefault(),this.loading=!0,app.request({method:"POST",url:app.forum.attribute("apiUrl")+"/forgot",data:{email:this.email()},errorHandler:this.onerror.bind(this)}).then(function(){_this2.success=!0,_this2.alert=null}).catch(function(){}).then(this.loaded.bind(this))}},{key:"onerror",value:function(error){404===error.status&&(error.alert.props.children=app.translator.trans("core.forum.forgot_password.not_found_message")),babelHelpers.get(Object.getPrototypeOf(ForgotPasswordModal.prototype),"onerror",this).call(this,error)}}]),ForgotPasswordModal}(Modal),_export("default",ForgotPasswordModal)}}}),System.register("flarum/components/GroupBadge",["flarum/components/Badge"],function(_export,_context){var Badge,GroupBadge;return{setters:[function(_flarumComponentsBadge){Badge=_flarumComponentsBadge.default}],execute:function(){GroupBadge=function(_Badge){function GroupBadge(){return babelHelpers.classCallCheck(this,GroupBadge),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(GroupBadge).apply(this,arguments))}return babelHelpers.inherits(GroupBadge,_Badge),babelHelpers.createClass(GroupBadge,null,[{key:"initProps",value:function(props){babelHelpers.get(Object.getPrototypeOf(GroupBadge),"initProps",this).call(this,props),props.group&&(props.icon=props.group.icon(),props.style={backgroundColor:props.group.color()},props.label="undefined"==typeof props.label?props.group.nameSingular():props.label,props.type="group--"+props.group.nameSingular(),delete props.group)}}]),GroupBadge}(Badge),_export("default",GroupBadge)}}}),System.register("flarum/components/HeaderPrimary",["flarum/Component","flarum/utils/ItemList","flarum/helpers/listItems","flarum/components/SelectDropdown","flarum/components/Button"],function(_export,_context){var Component,ItemList,listItems,SelectDropdown,Button,HeaderPrimary;
return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumUtilsItemList){ItemList=_flarumUtilsItemList.default},function(_flarumHelpersListItems){listItems=_flarumHelpersListItems.default},function(_flarumComponentsSelectDropdown){SelectDropdown=_flarumComponentsSelectDropdown.default},function(_flarumComponentsButton){Button=_flarumComponentsButton.default}],execute:function(){HeaderPrimary=function(_Component){function HeaderPrimary(){return babelHelpers.classCallCheck(this,HeaderPrimary),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(HeaderPrimary).apply(this,arguments))}return babelHelpers.inherits(HeaderPrimary,_Component),babelHelpers.createClass(HeaderPrimary,[{key:"view",value:function(){return m("ul",{className:"Header-controls"},listItems(this.items().toArray()))}},{key:"items",value:function(){return new ItemList}}]),HeaderPrimary}(Component),_export("default",HeaderPrimary)}}}),System.register("flarum/components/HeaderSecondary",["flarum/Component","flarum/components/Button","flarum/components/LogInModal","flarum/components/SignUpModal","flarum/components/SessionDropdown","flarum/components/SelectDropdown","flarum/components/NotificationsDropdown","flarum/utils/ItemList","flarum/helpers/listItems"],function(_export,_context){var Component,Button,LogInModal,SignUpModal,SessionDropdown,SelectDropdown,NotificationsDropdown,ItemList,listItems,HeaderSecondary;return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumComponentsButton){Button=_flarumComponentsButton.default},function(_flarumComponentsLogInModal){LogInModal=_flarumComponentsLogInModal.default},function(_flarumComponentsSignUpModal){SignUpModal=_flarumComponentsSignUpModal.default},function(_flarumComponentsSessionDropdown){SessionDropdown=_flarumComponentsSessionDropdown.default},function(_flarumComponentsSelectDropdown){SelectDropdown=_flarumComponentsSelectDropdown.default},function(_flarumComponentsNotificationsDropdown){NotificationsDropdown=_flarumComponentsNotificationsDropdown.default},function(_flarumUtilsItemList){ItemList=_flarumUtilsItemList.default},function(_flarumHelpersListItems){listItems=_flarumHelpersListItems.default}],execute:function(){HeaderSecondary=function(_Component){function HeaderSecondary(){return babelHelpers.classCallCheck(this,HeaderSecondary),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(HeaderSecondary).apply(this,arguments))}return babelHelpers.inherits(HeaderSecondary,_Component),babelHelpers.createClass(HeaderSecondary,[{key:"view",value:function(){return m("ul",{className:"Header-controls"},listItems(this.items().toArray()))}},{key:"items",value:function items(){var items=new ItemList;if(items.add("search",app.search.render(),30),Object.keys(app.locales).length>1){var locales=[],_loop=function(locale){locales.push(Button.component({active:app.locale===locale,children:app.locales[locale],icon:app.locale!==locale||"check",onclick:function(){app.session.user?app.session.user.savePreferences({locale:locale}).then(function(){return window.location.reload()}):(document.cookie="locale="+locale+"; path=/; expires=Tue, 19 Jan 2038 03:14:07 GMT",window.location.reload())}}))};for(var locale in app.locales)_loop(locale);items.add("locale",SelectDropdown.component({children:locales,buttonClassName:"Button Button--link"}),20)}return app.session.user?(items.add("notifications",NotificationsDropdown.component(),10),items.add("session",SessionDropdown.component(),0)):(app.forum.attribute("allowSignUp")&&items.add("signUp",Button.component({children:app.translator.trans("core.forum.header.sign_up_link"),className:"Button Button--link",onclick:function(){return app.modal.show(new SignUpModal)}}),10),items.add("logIn",Button.component({children:app.translator.trans("core.forum.header.log_in_link"),className:"Button Button--link",onclick:function(){return app.modal.show(new LogInModal)}}),0)),items}}]),HeaderSecondary}(Component),_export("default",HeaderSecondary)}}}),System.register("flarum/components/IndexPage",["flarum/extend","flarum/components/Page","flarum/utils/ItemList","flarum/helpers/listItems","flarum/helpers/icon","flarum/components/DiscussionList","flarum/components/WelcomeHero","flarum/components/DiscussionComposer","flarum/components/LogInModal","flarum/components/DiscussionPage","flarum/components/Select","flarum/components/Button","flarum/components/LinkButton","flarum/components/SelectDropdown"],function(_export,_context){var extend,Page,ItemList,listItems,icon,DiscussionList,WelcomeHero,DiscussionComposer,LogInModal,DiscussionPage,Select,Button,LinkButton,SelectDropdown,IndexPage;return{setters:[function(_flarumExtend){extend=_flarumExtend.extend},function(_flarumComponentsPage){Page=_flarumComponentsPage.default},function(_flarumUtilsItemList){ItemList=_flarumUtilsItemList.default},function(_flarumHelpersListItems){listItems=_flarumHelpersListItems.default},function(_flarumHelpersIcon){icon=_flarumHelpersIcon.default},function(_flarumComponentsDiscussionList){DiscussionList=_flarumComponentsDiscussionList.default},function(_flarumComponentsWelcomeHero){WelcomeHero=_flarumComponentsWelcomeHero.default},function(_flarumComponentsDiscussionComposer){DiscussionComposer=_flarumComponentsDiscussionComposer.default},function(_flarumComponentsLogInModal){LogInModal=_flarumComponentsLogInModal.default},function(_flarumComponentsDiscussionPage){DiscussionPage=_flarumComponentsDiscussionPage.default},function(_flarumComponentsSelect){Select=_flarumComponentsSelect.default},function(_flarumComponentsButton){Button=_flarumComponentsButton.default},function(_flarumComponentsLinkButton){LinkButton=_flarumComponentsLinkButton.default},function(_flarumComponentsSelectDropdown){SelectDropdown=_flarumComponentsSelectDropdown.default}],execute:function(){IndexPage=function(_Page){function IndexPage(){return babelHelpers.classCallCheck(this,IndexPage),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(IndexPage).apply(this,arguments))}return babelHelpers.inherits(IndexPage,_Page),babelHelpers.createClass(IndexPage,[{key:"init",value:function(){babelHelpers.get(Object.getPrototypeOf(IndexPage.prototype),"init",this).call(this),app.previous instanceof DiscussionPage&&(this.lastDiscussion=app.previous.discussion),app.previous instanceof IndexPage&&(app.cache.discussionList=null);var params=this.params();app.cache.discussionList&&Object.keys(params).some(function(key){if(app.cache.discussionList.props.params[key]!==params[key])return app.cache.discussionList=null,!0}),app.cache.discussionList||(app.cache.discussionList=new DiscussionList({params:params})),app.history.push("index",icon("bars")),this.bodyClass="App--index"}},{key:"onunload",value:function(){app.cache.scrollTop=$(window).scrollTop()}},{key:"view",value:function(){return m("div",{className:"IndexPage"},this.hero(),m("div",{className:"container"},m("nav",{className:"IndexPage-nav sideNav"},m("ul",null,listItems(this.sidebarItems().toArray()))),m("div",{className:"IndexPage-results sideNavOffset"},m("div",{className:"IndexPage-toolbar"},m("ul",{className:"IndexPage-toolbar-view"},listItems(this.viewItems().toArray())),m("ul",{className:"IndexPage-toolbar-action"},listItems(this.actionItems().toArray()))),app.cache.discussionList.render())))}},{key:"config",value:function(isInitialized,context){if(babelHelpers.get(Object.getPrototypeOf(IndexPage.prototype),"config",this).apply(this,arguments),!isInitialized){extend(context,"onunload",function(){return $("#app").css("min-height","")}),app.setTitle(""),app.setTitleCount(0);var oldHeroHeight=app.cache.heroHeight,heroHeight=app.cache.heroHeight=this.$(".Hero").outerHeight(),scrollTop=app.cache.scrollTop;$("#app").css("min-height",$(window).height()+heroHeight);var scroll=function(){return $(window).scrollTop(scrollTop-oldHeroHeight+heroHeight)};if(scroll(),setTimeout(scroll,1),this.lastDiscussion){var $discussion=this.$('.DiscussionListItem[data-id="'+this.lastDiscussion.id()+'"]');if($discussion.length){var indexTop=$("#header").outerHeight(),indexBottom=$(window).height(),discussionTop=$discussion.offset().top,discussionBottom=discussionTop+$discussion.outerHeight();(discussionTop<scrollTop+indexTop||discussionBottom>scrollTop+indexBottom)&&$(window).scrollTop(discussionTop-indexTop)}}}}},{key:"hero",value:function(){return WelcomeHero.component()}},{key:"sidebarItems",value:function(){var items=new ItemList,canStartDiscussion=app.forum.attribute("canStartDiscussion")||!app.session.user;return items.add("newDiscussion",Button.component({children:app.translator.trans(canStartDiscussion?"core.forum.index.start_discussion_button":"core.forum.index.cannot_start_discussion_button"),icon:"edit",className:"Button Button--primary IndexPage-newDiscussion",itemClassName:"App-primaryControl",onclick:this.newDiscussion.bind(this),disabled:!canStartDiscussion})),items.add("nav",SelectDropdown.component({children:this.navItems(this).toArray(),buttonClassName:"Button",className:"App-titleControl"})),items}},{key:"navItems",value:function(){var items=new ItemList,params=this.stickyParams();return items.add("allDiscussions",LinkButton.component({href:app.route("index",params),children:app.translator.trans("core.forum.index.all_discussions_link"),icon:"comments-o"}),100),items}},{key:"viewItems",value:function(){var items=new ItemList,sortMap=app.cache.discussionList.sortMap(),sortOptions={};for(var i in sortMap)sortOptions[i]=app.translator.trans("core.forum.index_sort."+i+"_button");return items.add("sort",Select.component({options:sortOptions,value:this.params().sort||Object.keys(sortMap)[0],onchange:this.changeSort.bind(this)})),items}},{key:"actionItems",value:function(){var items=new ItemList;return items.add("refresh",Button.component({title:app.translator.trans("core.forum.index.refresh_tooltip"),icon:"refresh",className:"Button Button--icon",onclick:function(){return app.cache.discussionList.refresh()}})),app.session.user&&items.add("markAllAsRead",Button.component({title:app.translator.trans("core.forum.index.mark_all_as_read_tooltip"),icon:"check",className:"Button Button--icon",onclick:this.markAllAsRead.bind(this)})),items}},{key:"searching",value:function(){return this.params().q}},{key:"clearSearch",value:function(){var params=this.params();delete params.q,m.route(app.route(this.props.routeName,params))}},{key:"changeSort",value:function(sort){var params=this.params();sort===Object.keys(app.cache.discussionList.sortMap())[0]?delete params.sort:params.sort=sort,m.route(app.route(this.props.routeName,params))}},{key:"stickyParams",value:function(){return{sort:m.route.param("sort"),q:m.route.param("q")}}},{key:"params",value:function params(){var params=this.stickyParams();return params.filter=m.route.param("filter"),params}},{key:"newDiscussion",value:function(){var deferred=m.deferred();return app.session.user?this.composeNewDiscussion(deferred):app.modal.show(new LogInModal({onlogin:this.composeNewDiscussion.bind(this,deferred)})),deferred.promise}},{key:"composeNewDiscussion",value:function(deferred){var component=new DiscussionComposer({user:app.session.user});return app.composer.load(component),app.composer.show(),deferred.resolve(component),deferred.promise}},{key:"markAllAsRead",value:function(){var confirmation=confirm(app.translator.trans("core.forum.index.mark_all_as_read_confirmation"));confirmation&&app.session.user.save({readTime:new Date})}}]),IndexPage}(Page),_export("default",IndexPage)}}}),System.register("flarum/components/LinkButton",["flarum/components/Button"],function(_export,_context){var Button,LinkButton;return{setters:[function(_flarumComponentsButton){Button=_flarumComponentsButton.default}],execute:function(){LinkButton=function(_Button){function LinkButton(){return babelHelpers.classCallCheck(this,LinkButton),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(LinkButton).apply(this,arguments))}return babelHelpers.inherits(LinkButton,_Button),babelHelpers.createClass(LinkButton,[{key:"view",value:function(){var vdom=babelHelpers.get(Object.getPrototypeOf(LinkButton.prototype),"view",this).call(this);return vdom.tag="a",vdom}}],[{key:"initProps",value:function(props){props.active=this.isActive(props),props.config=props.config||m.route}},{key:"isActive",value:function(props){return"undefined"!=typeof props.active?props.active:m.route()===props.href}}]),LinkButton}(Button),_export("default",LinkButton)}}}),System.register("flarum/components/LoadingIndicator",["flarum/Component"],function(_export,_context){var Component,LoadingIndicator;return{setters:[function(_flarumComponent){Component=_flarumComponent.default}],execute:function(){LoadingIndicator=function(_Component){function LoadingIndicator(){return babelHelpers.classCallCheck(this,LoadingIndicator),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(LoadingIndicator).apply(this,arguments))}return babelHelpers.inherits(LoadingIndicator,_Component),babelHelpers.createClass(LoadingIndicator,[{key:"view",value:function(){var attrs=babelHelpers.extends({},this.props);return attrs.className="LoadingIndicator "+(attrs.className||""),delete attrs.size,m("div",attrs,m.trust("&nbsp;"))}},{key:"config",value:function(){var size=this.props.size||"small";$.fn.spin.presets[size].zIndex="auto",this.$().spin(size)}}]),LoadingIndicator}(Component),_export("default",LoadingIndicator)}}}),System.register("flarum/components/LoadingPost",["flarum/Component","flarum/helpers/avatar"],function(_export,_context){var Component,avatar,LoadingPost;return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumHelpersAvatar){avatar=_flarumHelpersAvatar.default}],execute:function(){LoadingPost=function(_Component){function LoadingPost(){return babelHelpers.classCallCheck(this,LoadingPost),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(LoadingPost).apply(this,arguments))}return babelHelpers.inherits(LoadingPost,_Component),babelHelpers.createClass(LoadingPost,[{key:"view",value:function(){return m("div",{className:"Post CommentPost LoadingPost"},m("header",{className:"Post-header"},avatar(null,{className:"PostUser-avatar"}),m("div",{className:"fakeText"})),m("div",{className:"Post-body"},m("div",{className:"fakeText"}),m("div",{className:"fakeText"}),m("div",{className:"fakeText"})))}}]),LoadingPost}(Component),_export("default",LoadingPost)}}}),System.register("flarum/components/LogInButton",["flarum/components/Button"],function(_export,_context){var Button,LogInButton;return{setters:[function(_flarumComponentsButton){Button=_flarumComponentsButton.default}],execute:function(){LogInButton=function(_Button){function LogInButton(){return babelHelpers.classCallCheck(this,LogInButton),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(LogInButton).apply(this,arguments))}return babelHelpers.inherits(LogInButton,_Button),babelHelpers.createClass(LogInButton,null,[{key:"initProps",value:function(props){props.className=(props.className||"")+" LogInButton",props.onclick=function(){var width=600,height=400,$window=$(window);window.open(app.forum.attribute("baseUrl")+props.path,"logInPopup","width="+width+","+("height="+height+",")+("top="+($window.height()/2-height/2)+",")+("left="+($window.width()/2-width/2)+",")+"status=no,scrollbars=no,resizable=no")},babelHelpers.get(Object.getPrototypeOf(LogInButton),"initProps",this).call(this,props)}}]),LogInButton}(Button),_export("default",LogInButton)}}}),System.register("flarum/components/LogInButtons",["flarum/Component","flarum/utils/ItemList"],function(_export,_context){var Component,ItemList,LogInButtons;return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumUtilsItemList){ItemList=_flarumUtilsItemList.default}],execute:function(){LogInButtons=function(_Component){function LogInButtons(){return babelHelpers.classCallCheck(this,LogInButtons),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(LogInButtons).apply(this,arguments))}return babelHelpers.inherits(LogInButtons,_Component),babelHelpers.createClass(LogInButtons,[{key:"view",value:function(){return m("div",{className:"LogInButtons"},this.items().toArray())}},{key:"items",value:function(){return new ItemList}}]),LogInButtons}(Component),_export("default",LogInButtons)}}}),System.register("flarum/components/LogInModal",["flarum/components/Modal","flarum/components/ForgotPasswordModal","flarum/components/SignUpModal","flarum/components/Alert","flarum/components/Button","flarum/components/LogInButtons","flarum/utils/extractText"],function(_export,_context){var Modal,ForgotPasswordModal,SignUpModal,Alert,Button,LogInButtons,extractText,LogInModal;return{setters:[function(_flarumComponentsModal){Modal=_flarumComponentsModal.default},function(_flarumComponentsForgotPasswordModal){ForgotPasswordModal=_flarumComponentsForgotPasswordModal.default},function(_flarumComponentsSignUpModal){SignUpModal=_flarumComponentsSignUpModal.default},function(_flarumComponentsAlert){Alert=_flarumComponentsAlert.default},function(_flarumComponentsButton){Button=_flarumComponentsButton.default},function(_flarumComponentsLogInButtons){LogInButtons=_flarumComponentsLogInButtons.default},function(_flarumUtilsExtractText){extractText=_flarumUtilsExtractText.default}],execute:function(){LogInModal=function(_Modal){function LogInModal(){return babelHelpers.classCallCheck(this,LogInModal),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(LogInModal).apply(this,arguments))}return babelHelpers.inherits(LogInModal,_Modal),babelHelpers.createClass(LogInModal,[{key:"init",value:function(){babelHelpers.get(Object.getPrototypeOf(LogInModal.prototype),"init",this).call(this),this.email=m.prop(this.props.email||""),this.password=m.prop(this.props.password||"")}},{key:"className",value:function(){return"LogInModal Modal--small"}},{key:"title",value:function(){return app.translator.trans("core.forum.log_in.title")}},{key:"content",value:function(){return[m("div",{className:"Modal-body"},m(LogInButtons,null),m("div",{className:"Form Form--centered"},m("div",{className:"Form-group"},m("input",{className:"FormControl",name:"email",type:"text",placeholder:extractText(app.translator.trans("core.forum.log_in.username_or_email_placeholder")),bidi:this.email,disabled:this.loading})),m("div",{className:"Form-group"},m("input",{className:"FormControl",name:"password",type:"password",placeholder:extractText(app.translator.trans("core.forum.log_in.password_placeholder")),bidi:this.password,disabled:this.loading})),m("div",{className:"Form-group"},Button.component({className:"Button Button--primary Button--block",type:"submit",loading:this.loading,children:app.translator.trans("core.forum.log_in.submit_button")})))),m("div",{className:"Modal-footer"},m("p",{className:"LogInModal-forgotPassword"},m("a",{onclick:this.forgotPassword.bind(this)},app.translator.trans("core.forum.log_in.forgot_password_link"))),app.forum.attribute("allowSignUp")?m("p",{className:"LogInModal-signUp"},app.translator.trans("core.forum.log_in.sign_up_text",{a:m("a",{onclick:this.signUp.bind(this)})})):"")]}},{key:"forgotPassword",value:function(){var email=this.email(),props=email.indexOf("@")!==-1?{email:email}:void 0;app.modal.show(new ForgotPasswordModal(props))}},{key:"signUp",value:function(){var props={password:this.password()},email=this.email();props[email.indexOf("@")!==-1?"email":"username"]=email,app.modal.show(new SignUpModal(props))}},{key:"onready",value:function(){this.$("[name="+(this.email()?"password":"email")+"]").select()}},{key:"onsubmit",value:function(e){e.preventDefault(),this.loading=!0;var email=this.email(),password=this.password();app.session.login(email,password,{errorHandler:this.onerror.bind(this)}).then(function(){return window.location.reload()},this.loaded.bind(this))}},{key:"onerror",value:function(error){401===error.status&&(error.alert.props.children=app.translator.trans("core.forum.log_in.invalid_login_message")),babelHelpers.get(Object.getPrototypeOf(LogInModal.prototype),"onerror",this).call(this,error)}}]),LogInModal}(Modal),_export("default",LogInModal)}}}),System.register("flarum/components/Modal",["flarum/Component","flarum/components/Alert","flarum/components/Button"],function(_export,_context){var Component,Alert,Button,Modal;return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumComponentsAlert){Alert=_flarumComponentsAlert.default},function(_flarumComponentsButton){Button=_flarumComponentsButton.default}],execute:function(){Modal=function(_Component){function Modal(){return babelHelpers.classCallCheck(this,Modal),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(Modal).apply(this,arguments))}return babelHelpers.inherits(Modal,_Component),babelHelpers.createClass(Modal,[{key:"init",value:function(){this.alert=null}},{key:"view",value:function(){return this.alert&&(this.alert.props.dismissible=!1),m("div",{className:"Modal modal-dialog "+this.className()},m("div",{className:"Modal-content"},this.isDismissible()?m("div",{className:"Modal-close App-backControl"},Button.component({icon:"times",onclick:this.hide.bind(this),className:"Button Button--icon Button--link"})):"",m("form",{onsubmit:this.onsubmit.bind(this)},m("div",{className:"Modal-header"},m("h3",{className:"App-titleControl App-titleControl--text"},this.title())),alert?m("div",{className:"Modal-alert"},this.alert):"",this.content())))}},{key:"isDismissible",value:function(){return!0}},{key:"className",value:function(){}},{key:"title",value:function(){}},{key:"content",value:function(){}},{key:"onsubmit",value:function(){}},{key:"onready",value:function(){this.$("form").find("input, select, textarea").first().focus().select()}},{key:"onhide",value:function(){}},{key:"hide",value:function(){app.modal.close()}},{key:"loaded",value:function(){this.loading=!1,m.redraw()}},{key:"onerror",value:function(error){this.alert=error.alert,m.redraw(),422===error.status&&error.response.errors?this.$("form [name="+error.response.errors[0].source.pointer.replace("/data/attributes/","")+"]").select():this.onready()}}]),Modal}(Component),_export("default",Modal)}}}),System.register("flarum/components/ModalManager",["flarum/Component","flarum/components/Modal"],function(_export,_context){var Component,Modal,ModalManager;return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumComponentsModal){Modal=_flarumComponentsModal.default}],execute:function(){ModalManager=function(_Component){function ModalManager(){return babelHelpers.classCallCheck(this,ModalManager),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(ModalManager).apply(this,arguments))}return babelHelpers.inherits(ModalManager,_Component),babelHelpers.createClass(ModalManager,[{key:"init",value:function(){this.showing=!1,this.component=null}},{key:"view",value:function(){return m("div",{className:"ModalManager modal fade"},this.component&&this.component.render())}},{key:"config",value:function(isInitialized,context){isInitialized||(context.retain=!0,this.$().on("hidden.bs.modal",this.clear.bind(this)).on("shown.bs.modal",this.onready.bind(this)))}},{key:"show",value:function(component){if(!(component instanceof Modal))throw new Error("The ModalManager component can only show Modal components");clearTimeout(this.hideTimeout),this.showing=!0,this.component=component,app.current.retain=!0,m.redraw(!0),this.$().modal({backdrop:!!this.component.isDismissible()||"static"}).modal("show"),this.onready()}},{key:"close",value:function(){var _this2=this;this.showing&&(this.hideTimeout=setTimeout(function(){_this2.$().modal("hide"),_this2.showing=!1}))}},{key:"clear",value:function(){this.component&&this.component.onhide(),this.component=null,app.current.retain=!1,m.lazyRedraw()}},{key:"onready",value:function(){this.component&&this.component.onready&&this.component.onready(this.$())}}]),ModalManager}(Component),_export("default",ModalManager)}}}),System.register("flarum/components/Navigation",["flarum/Component","flarum/components/Button","flarum/components/LinkButton"],function(_export,_context){var Component,Button,LinkButton,Navigation;return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumComponentsButton){Button=_flarumComponentsButton.default},function(_flarumComponentsLinkButton){LinkButton=_flarumComponentsLinkButton.default}],execute:function(){Navigation=function(_Component){function Navigation(){return babelHelpers.classCallCheck(this,Navigation),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(Navigation).apply(this,arguments))}return babelHelpers.inherits(Navigation,_Component),babelHelpers.createClass(Navigation,[{key:"view",value:function(){var _app=app,history=_app.history,pane=_app.pane;return m("div",{className:"Navigation ButtonGroup "+(this.props.className||""),onmouseenter:pane&&pane.show.bind(pane),onmouseleave:pane&&pane.onmouseleave.bind(pane)},history.canGoBack()?[this.getBackButton(),this.getPaneButton()]:this.getDrawerButton())}},{key:"config",value:function(isInitialized,context){context.retain=!0}},{key:"getBackButton",value:function(){var _app2=app,history=_app2.history,previous=history.getPrevious()||{};return LinkButton.component({className:"Button Navigation-back "+(previous.title?"":"Button--icon"),href:history.backUrl(),icon:"chevron-left",children:previous.title,config:function(){},onclick:function(e){e.shiftKey||e.ctrlKey||e.metaKey||2===e.which||(e.preventDefault(),history.back())}})}},{key:"getPaneButton",value:function(){var _app3=app,pane=_app3.pane;return pane&&pane.active?Button.component({className:"Button Button--icon Navigation-pin"+(pane.pinned?" active":""),onclick:pane.togglePinned.bind(pane),icon:"thumb-tack"}):""}},{key:"getDrawerButton",value:function(){if(!this.props.drawer)return"";var _app4=app,drawer=_app4.drawer,user=app.session.user;return Button.component({className:"Button Button--icon Navigation-drawer"+(user&&user.newNotificationsCount()?" new":""),onclick:function(e){e.stopPropagation(),drawer.show()},icon:"reorder"})}}]),Navigation}(Component),_export("default",Navigation)}}}),System.register("flarum/components/Notification",["flarum/Component","flarum/helpers/avatar","flarum/helpers/icon","flarum/helpers/humanTime"],function(_export,_context){var Component,avatar,icon,humanTime,Notification;return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumHelpersAvatar){avatar=_flarumHelpersAvatar.default},function(_flarumHelpersIcon){icon=_flarumHelpersIcon.default},function(_flarumHelpersHumanTime){humanTime=_flarumHelpersHumanTime.default}],execute:function(){Notification=function(_Component){function Notification(){return babelHelpers.classCallCheck(this,Notification),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(Notification).apply(this,arguments))}return babelHelpers.inherits(Notification,_Component),babelHelpers.createClass(Notification,[{key:"view",value:function(){var notification=this.props.notification,href=this.href();return m("a",{className:"Notification Notification--"+notification.contentType()+" "+(notification.isRead()?"":"unread"),href:href,config:function(element,isInitialized){href.indexOf("://")===-1&&m.route.apply(this,arguments),isInitialized||$(element).click(this.markAsRead.bind(this))}},avatar(notification.sender()),icon(this.icon(),{className:"Notification-icon"}),m("span",{className:"Notification-content"},this.content()),humanTime(notification.time()),m("div",{className:"Notification-excerpt"},this.excerpt()))}},{key:"icon",value:function(){}},{key:"href",value:function(){}},{key:"content",value:function(){}},{key:"excerpt",value:function(){}},{key:"markAsRead",value:function(){this.props.notification.isRead()||(app.session.user.pushAttributes({unreadNotificationsCount:app.session.user.unreadNotificationsCount()-1}),this.props.notification.save({isRead:!0}))}}]),Notification}(Component),_export("default",Notification)}}}),System.register("flarum/components/NotificationGrid",["flarum/Component","flarum/components/Checkbox","flarum/helpers/icon","flarum/utils/ItemList"],function(_export,_context){var Component,Checkbox,icon,ItemList,NotificationGrid;return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumComponentsCheckbox){Checkbox=_flarumComponentsCheckbox.default},function(_flarumHelpersIcon){icon=_flarumHelpersIcon.default},function(_flarumUtilsItemList){ItemList=_flarumUtilsItemList.default}],execute:function(){NotificationGrid=function(_Component){function NotificationGrid(){return babelHelpers.classCallCheck(this,NotificationGrid),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(NotificationGrid).apply(this,arguments))}return babelHelpers.inherits(NotificationGrid,_Component),babelHelpers.createClass(NotificationGrid,[{key:"init",value:function(){var _this2=this;this.methods=[{name:"alert",icon:"bell",label:app.translator.trans("core.forum.settings.notify_by_web_heading")},{name:"email",icon:"envelope-o",label:app.translator.trans("core.forum.settings.notify_by_email_heading")}],this.inputs={},this.types=this.notificationTypes().toArray(),this.types.forEach(function(type){_this2.methods.forEach(function(method){var key=_this2.preferenceKey(type.name,method.name),preference=_this2.props.user.preferences()[key];_this2.inputs[key]=new Checkbox({state:!!preference,disabled:"undefined"==typeof preference,onchange:function(){return _this2.toggle([key])}})})})}},{key:"view",value:function(){var _this3=this;return m("table",{className:"NotificationGrid"},m("thead",null,m("tr",null,m("td",null),this.methods.map(function(method){return m("th",{className:"NotificationGrid-groupToggle",onclick:_this3.toggleMethod.bind(_this3,method.name)},icon(method.icon)," ",method.label)}))),m("tbody",null,this.types.map(function(type){return m("tr",null,m("td",{className:"NotificationGrid-groupToggle",onclick:_this3.toggleType.bind(_this3,type.name)},icon(type.icon)," ",type.label),_this3.methods.map(function(method){return m("td",{className:"NotificationGrid-checkbox"},_this3.inputs[_this3.preferenceKey(type.name,method.name)].render())}))})))}},{key:"config",value:function(isInitialized){isInitialized||(this.$("thead .NotificationGrid-groupToggle").bind("mouseenter mouseleave",function(e){var i=parseInt($(this).index(),10)+1;$(this).parents("table").find("td:nth-child("+i+")").toggleClass("highlighted","mouseenter"===e.type)}),this.$("tbody .NotificationGrid-groupToggle").bind("mouseenter mouseleave",function(e){$(this).parent().find("td").toggleClass("highlighted","mouseenter"===e.type)}))}},{key:"toggle",value:function(keys){var _this4=this,user=this.props.user,preferences=user.preferences(),enabled=!preferences[keys[0]];keys.forEach(function(key){var control=_this4.inputs[key];control.loading=!0,preferences[key]=control.props.state=enabled}),m.redraw(),user.save({preferences:preferences}).then(function(){keys.forEach(function(key){return _this4.inputs[key].loading=!1}),m.redraw()})}},{key:"toggleMethod",value:function(method){var _this5=this,keys=this.types.map(function(type){return _this5.preferenceKey(type.name,method)}).filter(function(key){return!_this5.inputs[key].props.disabled});this.toggle(keys)}},{key:"toggleType",value:function(type){var _this6=this,keys=this.methods.map(function(method){return _this6.preferenceKey(type,method.name)}).filter(function(key){return!_this6.inputs[key].props.disabled});this.toggle(keys)}},{key:"preferenceKey",value:function(type,method){return"notify_"+type+"_"+method}},{key:"notificationTypes",value:function(){var items=new ItemList;return items.add("discussionRenamed",{name:"discussionRenamed",icon:"pencil",label:app.translator.trans("core.forum.settings.notify_discussion_renamed_label")}),items}}]),NotificationGrid}(Component),
_export("default",NotificationGrid)}}}),System.register("flarum/components/NotificationList",["flarum/Component","flarum/helpers/listItems","flarum/components/Button","flarum/components/LoadingIndicator","flarum/models/Discussion"],function(_export,_context){var Component,listItems,Button,LoadingIndicator,Discussion,NotificationList;return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumHelpersListItems){listItems=_flarumHelpersListItems.default},function(_flarumComponentsButton){Button=_flarumComponentsButton.default},function(_flarumComponentsLoadingIndicator){LoadingIndicator=_flarumComponentsLoadingIndicator.default},function(_flarumModelsDiscussion){Discussion=_flarumModelsDiscussion.default}],execute:function(){NotificationList=function(_Component){function NotificationList(){return babelHelpers.classCallCheck(this,NotificationList),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(NotificationList).apply(this,arguments))}return babelHelpers.inherits(NotificationList,_Component),babelHelpers.createClass(NotificationList,[{key:"init",value:function(){this.loading=!1}},{key:"view",value:function(){var groups=[];return app.cache.notifications&&!function(){var discussions={};app.cache.notifications.forEach(function(notification){var subject=notification.subject();if("undefined"!=typeof subject){var discussion=!1;subject instanceof Discussion?discussion=subject:subject&&subject.discussion&&(discussion=subject.discussion());var key=discussion?discussion.id():0;discussions[key]=discussions[key]||{discussion:discussion,notifications:[]},discussions[key].notifications.push(notification),groups.indexOf(discussions[key])===-1&&groups.push(discussions[key])}})}(),m("div",{className:"NotificationList"},m("div",{className:"NotificationList-header"},m("div",{className:"App-primaryControl"},Button.component({className:"Button Button--icon Button--link",icon:"check",title:app.translator.trans("core.forum.notifications.mark_all_as_read_tooltip"),onclick:this.markAllAsRead.bind(this)})),m("h4",{className:"App-titleControl App-titleControl--text"},app.translator.trans("core.forum.notifications.title"))),m("div",{className:"NotificationList-content"},groups.length?groups.map(function(group){var badges=group.discussion&&group.discussion.badges().toArray();return m("div",{className:"NotificationGroup"},group.discussion?m("a",{className:"NotificationGroup-header",href:app.route.discussion(group.discussion),config:m.route},badges&&badges.length?m("ul",{className:"NotificationGroup-badges badges"},listItems(badges)):"",group.discussion.title()):m("div",{className:"NotificationGroup-header"},app.forum.attribute("title")),m("ul",{className:"NotificationGroup-content"},group.notifications.map(function(notification){var NotificationComponent=app.notificationComponents[notification.contentType()];return NotificationComponent?m("li",null,NotificationComponent.component({notification:notification})):""})))}):this.loading?LoadingIndicator.component({className:"LoadingIndicator--block"}):m("div",{className:"NotificationList-empty"},app.translator.trans("core.forum.notifications.empty_text"))))}},{key:"load",value:function(){var _this2=this;app.cache.notifications&&!app.session.user.newNotificationsCount()||(this.loading=!0,m.redraw(),app.store.find("notifications").then(function(notifications){app.session.user.pushAttributes({newNotificationsCount:0}),app.cache.notifications=notifications.sort(function(a,b){return b.time()-a.time()})}).catch(function(){}).then(function(){_this2.loading=!1,m.redraw()}))}},{key:"markAllAsRead",value:function(){app.cache.notifications&&(app.session.user.pushAttributes({unreadNotificationsCount:0}),app.cache.notifications.forEach(function(notification){return notification.pushAttributes({isRead:!0})}),app.request({url:app.forum.attribute("apiUrl")+"/notifications/read",method:"POST"}))}}]),NotificationList}(Component),_export("default",NotificationList)}}}),System.register("flarum/components/NotificationsDropdown",["flarum/components/Dropdown","flarum/helpers/icon","flarum/components/NotificationList"],function(_export,_context){var Dropdown,icon,NotificationList,NotificationsDropdown;return{setters:[function(_flarumComponentsDropdown){Dropdown=_flarumComponentsDropdown.default},function(_flarumHelpersIcon){icon=_flarumHelpersIcon.default},function(_flarumComponentsNotificationList){NotificationList=_flarumComponentsNotificationList.default}],execute:function(){NotificationsDropdown=function(_Dropdown){function NotificationsDropdown(){return babelHelpers.classCallCheck(this,NotificationsDropdown),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(NotificationsDropdown).apply(this,arguments))}return babelHelpers.inherits(NotificationsDropdown,_Dropdown),babelHelpers.createClass(NotificationsDropdown,[{key:"init",value:function(){babelHelpers.get(Object.getPrototypeOf(NotificationsDropdown.prototype),"init",this).call(this),this.showing=!1,this.list=new NotificationList}},{key:"getButton",value:function(){var newNotifications=this.getNewCount(),vdom=babelHelpers.get(Object.getPrototypeOf(NotificationsDropdown.prototype),"getButton",this).call(this);return vdom.attrs.title=this.props.label,vdom.attrs.className+=newNotifications?" new":"",vdom.attrs.onclick=this.onclick.bind(this),vdom}},{key:"getButtonContent",value:function(){var unread=this.getUnreadCount();return[icon(this.props.icon,{className:"Button-icon"}),unread?m("span",{className:"NotificationsDropdown-unread"},unread):"",m("span",{className:"Button-label"},this.props.label)]}},{key:"getMenu",value:function(){return m("div",{className:"Dropdown-menu "+this.props.menuClassName,onclick:this.menuClick.bind(this)},this.showing?this.list.render():"")}},{key:"onclick",value:function(){app.drawer.isOpen()?this.goToRoute():(this.showing=!0,this.list.load())}},{key:"goToRoute",value:function(){m.route(app.route("notifications"))}},{key:"getUnreadCount",value:function(){return app.session.user.unreadNotificationsCount()}},{key:"getNewCount",value:function(){return app.session.user.newNotificationsCount()}},{key:"menuClick",value:function(e){(e.shiftKey||e.metaKey||e.ctrlKey||2===e.which)&&e.stopPropagation()}}],[{key:"initProps",value:function(props){props.className=props.className||"NotificationsDropdown",props.buttonClassName=props.buttonClassName||"Button Button--flat",props.menuClassName=props.menuClassName||"Dropdown-menu--right",props.label=props.label||app.translator.trans("core.forum.notifications.tooltip"),props.icon=props.icon||"bell",babelHelpers.get(Object.getPrototypeOf(NotificationsDropdown),"initProps",this).call(this,props)}}]),NotificationsDropdown}(Dropdown),_export("default",NotificationsDropdown)}}}),System.register("flarum/components/NotificationsPage",["flarum/components/Page","flarum/components/NotificationList"],function(_export,_context){var Page,NotificationList,NotificationsPage;return{setters:[function(_flarumComponentsPage){Page=_flarumComponentsPage.default},function(_flarumComponentsNotificationList){NotificationList=_flarumComponentsNotificationList.default}],execute:function(){NotificationsPage=function(_Page){function NotificationsPage(){return babelHelpers.classCallCheck(this,NotificationsPage),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(NotificationsPage).apply(this,arguments))}return babelHelpers.inherits(NotificationsPage,_Page),babelHelpers.createClass(NotificationsPage,[{key:"init",value:function(){babelHelpers.get(Object.getPrototypeOf(NotificationsPage.prototype),"init",this).call(this),app.history.push("notifications"),this.list=new NotificationList,this.list.load(),this.bodyClass="App--notifications"}},{key:"view",value:function(){return m("div",{className:"NotificationsPage"},this.list.render())}}]),NotificationsPage}(Page),_export("default",NotificationsPage)}}}),System.register("flarum/components/Page",["flarum/Component"],function(_export,_context){var Component,Page;return{setters:[function(_flarumComponent){Component=_flarumComponent.default}],execute:function(){Page=function(_Component){function Page(){return babelHelpers.classCallCheck(this,Page),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(Page).apply(this,arguments))}return babelHelpers.inherits(Page,_Component),babelHelpers.createClass(Page,[{key:"init",value:function(){app.previous=app.current,app.current=this,app.drawer.hide(),app.modal.close(),this.bodyClass=""}},{key:"config",value:function(isInitialized,context){var _this2=this;isInitialized||this.bodyClass&&($("#app").addClass(this.bodyClass),context.onunload=function(){return $("#app").removeClass(_this2.bodyClass)})}}]),Page}(Component),_export("default",Page)}}}),System.register("flarum/components/Placeholder",["flarum/Component"],function(_export,_context){var Component,Placeholder;return{setters:[function(_flarumComponent){Component=_flarumComponent.default}],execute:function(){Placeholder=function(_Component){function Placeholder(){return babelHelpers.classCallCheck(this,Placeholder),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(Placeholder).apply(this,arguments))}return babelHelpers.inherits(Placeholder,_Component),babelHelpers.createClass(Placeholder,[{key:"view",value:function(){return m("div",{className:"Placeholder"},m("p",null,this.props.text))}}]),Placeholder}(Component),_export("default",Placeholder)}}}),System.register("flarum/components/Post",["flarum/Component","flarum/utils/SubtreeRetainer","flarum/components/Dropdown","flarum/utils/PostControls","flarum/helpers/listItems","flarum/utils/ItemList"],function(_export,_context){var Component,SubtreeRetainer,Dropdown,PostControls,listItems,ItemList,Post;return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumUtilsSubtreeRetainer){SubtreeRetainer=_flarumUtilsSubtreeRetainer.default},function(_flarumComponentsDropdown){Dropdown=_flarumComponentsDropdown.default},function(_flarumUtilsPostControls){PostControls=_flarumUtilsPostControls.default},function(_flarumHelpersListItems){listItems=_flarumHelpersListItems.default},function(_flarumUtilsItemList){ItemList=_flarumUtilsItemList.default}],execute:function(){Post=function(_Component){function Post(){return babelHelpers.classCallCheck(this,Post),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(Post).apply(this,arguments))}return babelHelpers.inherits(Post,_Component),babelHelpers.createClass(Post,[{key:"init",value:function(){var _this2=this;this.loading=!1,this.subtree=new SubtreeRetainer(function(){return _this2.props.post.freshness},function(){var user=_this2.props.post.user();return user&&user.freshness},function(){return _this2.controlsOpen})}},{key:"view",value:function(){var _this3=this,attrs=this.attrs();return attrs.className="Post "+(this.loading?"Post--loading ":"")+(attrs.className||""),m("article",attrs,this.subtree.retain()||function(){var controls=PostControls.controls(_this3.props.post,_this3).toArray();return m("div",null,_this3.content(),m("aside",{className:"Post-actions"},m("ul",null,listItems(_this3.actionItems().toArray()),controls.length?m("li",null,m(Dropdown,{className:"Post-controls",buttonClassName:"Button Button--icon Button--flat",menuClassName:"Dropdown-menu--right",icon:"ellipsis-h",onshow:function(){return _this3.$(".Post-actions").addClass("open")},onhide:function(){return _this3.$(".Post-actions").removeClass("open")}},controls)):"")),m("footer",{className:"Post-footer"},m("ul",null,listItems(_this3.footerItems().toArray()))))}())}},{key:"config",value:function(isInitialized){var $actions=this.$(".Post-actions"),$controls=this.$(".Post-controls");$actions.toggleClass("open",$controls.hasClass("open"))}},{key:"attrs",value:function(){return{}}},{key:"content",value:function(){return""}},{key:"actionItems",value:function(){return new ItemList}},{key:"footerItems",value:function(){return new ItemList}}]),Post}(Component),_export("default",Post)}}}),System.register("flarum/components/PostEdited",["flarum/Component","flarum/helpers/icon","flarum/utils/humanTime","flarum/utils/extractText"],function(_export,_context){var Component,icon,humanTime,extractText,PostEdited;return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumHelpersIcon){icon=_flarumHelpersIcon.default},function(_flarumUtilsHumanTime){humanTime=_flarumUtilsHumanTime.default},function(_flarumUtilsExtractText){extractText=_flarumUtilsExtractText.default}],execute:function(){PostEdited=function(_Component){function PostEdited(){return babelHelpers.classCallCheck(this,PostEdited),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(PostEdited).apply(this,arguments))}return babelHelpers.inherits(PostEdited,_Component),babelHelpers.createClass(PostEdited,[{key:"view",value:function(){var post=this.props.post,editUser=post.editUser(),title=extractText(app.translator.trans("core.forum.post.edited_tooltip",{user:editUser,ago:humanTime(post.editTime())}));return m("span",{className:"PostEdited",title:title},icon("pencil"))}},{key:"config",value:function(isInitialized){isInitialized||this.$().tooltip()}}]),PostEdited}(Component),_export("default",PostEdited)}}}),System.register("flarum/components/PostMeta",["flarum/Component","flarum/helpers/humanTime","flarum/helpers/fullTime"],function(_export,_context){var Component,humanTime,fullTime,PostMeta;return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumHelpersHumanTime){humanTime=_flarumHelpersHumanTime.default},function(_flarumHelpersFullTime){fullTime=_flarumHelpersFullTime.default}],execute:function(){PostMeta=function(_Component){function PostMeta(){return babelHelpers.classCallCheck(this,PostMeta),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(PostMeta).apply(this,arguments))}return babelHelpers.inherits(PostMeta,_Component),babelHelpers.createClass(PostMeta,[{key:"view",value:function(){var post=this.props.post,time=post.time(),permalink=this.getPermalink(post),touch="ontouchstart"in document.documentElement,selectPermalink=function(){var _this2=this;setTimeout(function(){return $(_this2).parent().find(".PostMeta-permalink").select()}),m.redraw.strategy("none")};return m("div",{className:"Dropdown PostMeta"},m("a",{className:"Dropdown-toggle",onclick:selectPermalink,"data-toggle":"dropdown"},humanTime(time)),m("div",{className:"Dropdown-menu dropdown-menu"},m("span",{className:"PostMeta-number"},app.translator.trans("core.forum.post.number_tooltip",{number:post.number()}))," ",fullTime(time),touch?m("a",{className:"Button PostMeta-permalink",href:permalink},permalink):m("input",{className:"FormControl PostMeta-permalink",value:permalink,onclick:function(e){return e.stopPropagation()}})))}},{key:"getPermalink",value:function(post){return window.location.origin+app.route.post(post)}}]),PostMeta}(Component),_export("default",PostMeta)}}}),System.register("flarum/components/PostPreview",["flarum/Component","flarum/helpers/avatar","flarum/helpers/username","flarum/helpers/highlight"],function(_export,_context){var Component,avatar,username,highlight,PostPreview;return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumHelpersAvatar){avatar=_flarumHelpersAvatar.default},function(_flarumHelpersUsername){username=_flarumHelpersUsername.default},function(_flarumHelpersHighlight){highlight=_flarumHelpersHighlight.default}],execute:function(){PostPreview=function(_Component){function PostPreview(){return babelHelpers.classCallCheck(this,PostPreview),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(PostPreview).apply(this,arguments))}return babelHelpers.inherits(PostPreview,_Component),babelHelpers.createClass(PostPreview,[{key:"view",value:function(){var post=this.props.post,user=post.user(),excerpt=highlight(post.contentPlain(),this.props.highlight,300);return m("a",{className:"PostPreview",href:app.route.post(post),config:m.route,onclick:this.props.onclick},m("span",{className:"PostPreview-content"},avatar(user),username(user)," ",m("span",{className:"PostPreview-excerpt"},excerpt)))}}]),PostPreview}(Component),_export("default",PostPreview)}}}),System.register("flarum/components/PostStream",["flarum/Component","flarum/utils/ScrollListener","flarum/components/LoadingPost","flarum/utils/anchorScroll","flarum/utils/mixin","flarum/utils/evented","flarum/components/ReplyPlaceholder","flarum/components/Button"],function(_export,_context){var Component,ScrollListener,PostLoading,anchorScroll,mixin,evented,ReplyPlaceholder,Button,PostStream;return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumUtilsScrollListener){ScrollListener=_flarumUtilsScrollListener.default},function(_flarumComponentsLoadingPost){PostLoading=_flarumComponentsLoadingPost.default},function(_flarumUtilsAnchorScroll){anchorScroll=_flarumUtilsAnchorScroll.default},function(_flarumUtilsMixin){mixin=_flarumUtilsMixin.default},function(_flarumUtilsEvented){evented=_flarumUtilsEvented.default},function(_flarumComponentsReplyPlaceholder){ReplyPlaceholder=_flarumComponentsReplyPlaceholder.default},function(_flarumComponentsButton){Button=_flarumComponentsButton.default}],execute:function(){PostStream=function(_Component){function PostStream(){return babelHelpers.classCallCheck(this,PostStream),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(PostStream).apply(this,arguments))}return babelHelpers.inherits(PostStream,_Component),babelHelpers.createClass(PostStream,[{key:"init",value:function(){this.discussion=this.props.discussion,this.paused=!1,this.scrollListener=new ScrollListener(this.onscroll.bind(this)),this.loadPageTimeouts={},this.pagesLoading=0,this.show(this.props.includedPosts)}},{key:"goToNumber",value:function(number,noAnimation){var _this2=this;if("reply"===number)return this.goToLast().then(function(){$("html,body").stop(!0).animate({scrollTop:$(document).height()-$(window).height()},"fast",function(){_this2.flashItem(_this2.$(".PostStream-item:last-child"))})});this.paused=!0;var promise=this.loadNearNumber(number);return m.redraw(!0),promise.then(function(){m.redraw(!0),_this2.scrollToNumber(number,noAnimation).done(_this2.unpause.bind(_this2))})}},{key:"goToIndex",value:function(index,backwards,noAnimation){var _this3=this;this.paused=!0;var promise=this.loadNearIndex(index);return m.redraw(!0),promise.then(function(){anchorScroll(_this3.$(".PostStream-item:"+(backwards?"last":"first")),function(){return m.redraw(!0)}),_this3.scrollToIndex(index,noAnimation,backwards).done(_this3.unpause.bind(_this3))})}},{key:"goToFirst",value:function(){return this.goToIndex(0)}},{key:"goToLast",value:function(){return this.goToIndex(this.count()-1,!0)}},{key:"update",value:function(){this.viewingEnd&&(this.visibleEnd=this.count(),this.loadRange(this.visibleStart,this.visibleEnd).then(function(){return m.redraw()}))}},{key:"count",value:function(){return this.discussion.postIds().length}},{key:"sanitizeIndex",value:function(index){return Math.max(0,Math.min(this.count(),index))}},{key:"show",value:function(posts){this.visibleStart=posts.length?this.discussion.postIds().indexOf(posts[0].id()):0,this.visibleEnd=this.visibleStart+posts.length}},{key:"reset",value:function(start,end){this.visibleStart=start||0,this.visibleEnd=this.sanitizeIndex(end||this.constructor.loadCount)}},{key:"posts",value:function(){return this.discussion.postIds().slice(this.visibleStart,this.visibleEnd).map(function(id){var post=app.store.getById("posts",id);return post&&post.discussion()&&"undefined"!=typeof post.canEdit()?post:null})}},{key:"view",value:function(){function fadeIn(element,isInitialized,context){context.fadedIn||$(element).hide().fadeIn(),context.fadedIn=!0}var _this4=this,lastTime=void 0;this.visibleEnd=this.sanitizeIndex(this.visibleEnd),this.viewingEnd=this.visibleEnd===this.count();var posts=this.posts(),postIds=this.discussion.postIds(),items=posts.map(function(post,i){var content=void 0,attrs={"data-index":_this4.visibleStart+i};if(post){var time=post.time(),PostComponent=app.postComponents[post.contentType()];content=PostComponent?PostComponent.component({post:post}):"",attrs.key="post"+post.id(),attrs.config=fadeIn,attrs["data-time"]=time.toISOString(),attrs["data-number"]=post.number(),attrs["data-id"]=post.id(),attrs["data-type"]=post.contentType();var dt=time-lastTime;dt>3456e5&&(content=[m("div",{className:"PostStream-timeGap"},m("span",null,app.translator.trans("core.forum.post_stream.time_lapsed_text",{period:moment.duration(dt).humanize()}))),content]),lastTime=time}else attrs.key="post"+postIds[_this4.visibleStart+i],content=PostLoading.component();return m("div",babelHelpers.extends({className:"PostStream-item"},attrs),content)});return!this.viewingEnd&&posts[this.visibleEnd-this.visibleStart-1]&&items.push(m("div",{className:"PostStream-loadMore",key:"loadMore"},m(Button,{className:"Button",onclick:this.loadNext.bind(this)},app.translator.trans("core.forum.post_stream.load_more_button")))),!this.viewingEnd||app.session.user&&!this.discussion.canReply()||items.push(m("div",{className:"PostStream-item",key:"reply"},ReplyPlaceholder.component({discussion:this.discussion}))),m("div",{className:"PostStream"},items)}},{key:"config",value:function(isInitialized,context){var _this5=this;isInitialized||(setTimeout(function(){return _this5.scrollListener.start()}),context.onunload=function(){_this5.scrollListener.stop(),clearTimeout(_this5.calculatePositionTimeout)})}},{key:"onscroll",value:function(top){if(!this.paused){var marginTop=this.getMarginTop(),viewportHeight=$(window).height()-marginTop,viewportTop=top+marginTop,loadAheadDistance=300;if(this.visibleStart>0){var $item=this.$(".PostStream-item[data-index="+this.visibleStart+"]");$item.length&&$item.offset().top>viewportTop-loadAheadDistance&&this.loadPrevious()}if(this.visibleEnd<this.count()){var _$item=this.$(".PostStream-item[data-index="+(this.visibleEnd-1)+"]");_$item.length&&_$item.offset().top+_$item.outerHeight(!0)<viewportTop+viewportHeight+loadAheadDistance&&this.loadNext()}clearTimeout(this.calculatePositionTimeout),this.calculatePositionTimeout=setTimeout(this.calculatePosition.bind(this),100)}}},{key:"loadNext",value:function(){var start=this.visibleEnd,end=this.visibleEnd=this.sanitizeIndex(this.visibleEnd+this.constructor.loadCount),twoPagesAway=start-2*this.constructor.loadCount;twoPagesAway>this.visibleStart&&twoPagesAway>=0&&(this.visibleStart=twoPagesAway+this.constructor.loadCount+1,this.loadPageTimeouts[twoPagesAway]&&(clearTimeout(this.loadPageTimeouts[twoPagesAway]),this.loadPageTimeouts[twoPagesAway]=null,this.pagesLoading--)),this.loadPage(start,end)}},{key:"loadPrevious",value:function(){var end=this.visibleStart,start=this.visibleStart=this.sanitizeIndex(this.visibleStart-this.constructor.loadCount),twoPagesAway=start+2*this.constructor.loadCount;twoPagesAway<this.visibleEnd&&twoPagesAway<=this.count()&&(this.visibleEnd=twoPagesAway,this.loadPageTimeouts[twoPagesAway]&&(clearTimeout(this.loadPageTimeouts[twoPagesAway]),this.loadPageTimeouts[twoPagesAway]=null,this.pagesLoading--)),this.loadPage(start,end,!0)}},{key:"loadPage",value:function(start,end,backwards){var _this6=this,redraw=function(){if(!(start<_this6.visibleStart||end>_this6.visibleEnd)){var anchorIndex=backwards?_this6.visibleEnd-1:_this6.visibleStart;anchorScroll('.PostStream-item[data-index="'+anchorIndex+'"]',function(){return m.redraw(!0)}),_this6.unpause()}};redraw(),this.loadPageTimeouts[start]=setTimeout(function(){_this6.loadRange(start,end).then(function(){redraw(),_this6.pagesLoading--}),_this6.loadPageTimeouts[start]=null},this.pagesLoading?1e3:0),this.pagesLoading++}},{key:"loadRange",value:function(start,end){var loadIds=[],loaded=[];return this.discussion.postIds().slice(start,end).forEach(function(id){var post=app.store.getById("posts",id);post&&post.discussion()&&"undefined"!=typeof post.canEdit()?loaded.push(post):loadIds.push(id)}),loadIds.length?app.store.find("posts",loadIds):m.deferred().resolve(loaded).promise}},{key:"loadNearNumber",value:function(number){return this.posts().some(function(post){return post&&Number(post.number())===Number(number)})?m.deferred().resolve().promise:(this.reset(),app.store.find("posts",{filter:{discussion:this.discussion.id()},page:{near:number}}).then(this.show.bind(this)))}},{key:"loadNearIndex",value:function(index){if(index>=this.visibleStart&&index<=this.visibleEnd)return m.deferred().resolve().promise;var start=this.sanitizeIndex(index-this.constructor.loadCount/2),end=start+this.constructor.loadCount;return this.reset(start,end),this.loadRange(start,end).then(this.show.bind(this))}},{key:"calculatePosition",value:function(){var marginTop=this.getMarginTop(),$window=$(window),viewportHeight=$window.height()-marginTop,scrollTop=$window.scrollTop()+marginTop,startNumber=void 0,endNumber=void 0;this.$(".PostStream-item").each(function(){var $item=$(this),top=$item.offset().top,height=$item.outerHeight(!0);if(top+height>scrollTop){if(startNumber||(startNumber=endNumber=$item.data("number")),!(top+height<scrollTop+viewportHeight))return!1;$item.data("number")&&(endNumber=$item.data("number"))}}),startNumber&&this.trigger("positionChanged",startNumber||1,endNumber)}},{key:"getMarginTop",value:function(){return this.$()&&$("#header").outerHeight()+parseInt(this.$().css("margin-top"),10)}},{key:"scrollToNumber",value:function(number,noAnimation){var $item=this.$(".PostStream-item[data-number="+number+"]");return this.scrollToItem($item,noAnimation).done(this.flashItem.bind(this,$item))}},{key:"scrollToIndex",value:function(index,noAnimation,bottom){var $item=this.$(".PostStream-item[data-index="+index+"]");return this.scrollToItem($item,noAnimation,!0,bottom)}},{key:"scrollToItem",value:function($item,noAnimation,force,bottom){var $container=$("html, body").stop(!0);if($item.length){var itemTop=$item.offset().top-this.getMarginTop(),itemBottom=$item.offset().top+$item.height(),scrollTop=$(document).scrollTop(),scrollBottom=scrollTop+$(window).height();if(force||itemTop<scrollTop||itemBottom>scrollBottom){var top=bottom?itemBottom-$(window).height()+app.composer.computedHeight():$item.is(":first-child")?0:itemTop;noAnimation?$container.scrollTop(top):top!==scrollTop&&$container.animate({scrollTop:top},"fast")}}return $container.promise()}},{key:"flashItem",value:function($item){$item.addClass("flash").one("animationend webkitAnimationEnd",function(){return $item.removeClass("flash")})}},{key:"unpause",value:function(){this.paused=!1,this.scrollListener.update(!0),this.trigger("unpaused")}}]),PostStream}(Component),PostStream.loadCount=20,babelHelpers.extends(PostStream.prototype,evented),_export("default",PostStream)}}}),System.register("flarum/components/PostStreamScrubber",["flarum/Component","flarum/helpers/icon","flarum/utils/ScrollListener","flarum/utils/SubtreeRetainer","flarum/utils/computed","flarum/utils/formatNumber"],function(_export,_context){var Component,icon,ScrollListener,SubtreeRetainer,computed,formatNumber,PostStreamScrubber;return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumHelpersIcon){icon=_flarumHelpersIcon.default},function(_flarumUtilsScrollListener){ScrollListener=_flarumUtilsScrollListener.default},function(_flarumUtilsSubtreeRetainer){SubtreeRetainer=_flarumUtilsSubtreeRetainer.default},function(_flarumUtilsComputed){computed=_flarumUtilsComputed.default},function(_flarumUtilsFormatNumber){formatNumber=_flarumUtilsFormatNumber.default}],execute:function(){PostStreamScrubber=function(_Component){function PostStreamScrubber(){return babelHelpers.classCallCheck(this,PostStreamScrubber),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(PostStreamScrubber).apply(this,arguments))}return babelHelpers.inherits(PostStreamScrubber,_Component),babelHelpers.createClass(PostStreamScrubber,[{key:"init",value:function(){this.handlers={},this.index=0,this.visible=1,this.description="",this.props.stream.on("unpaused",this.handlers.streamWasUnpaused=this.streamWasUnpaused.bind(this)),this.scrollListener=new ScrollListener(this.onscroll.bind(this)),this.subtree=new SubtreeRetainer(function(){return!0})}},{key:"view",value:function(){function styleUnread(element,isInitialized,context){var $element=$(element),newStyle={top:100-100*unreadPercent+"%",height:100*unreadPercent+"%"};context.oldStyle?$element.stop(!0).css(context.oldStyle).animate(newStyle):$element.css(newStyle),context.oldStyle=newStyle}var retain=this.subtree.retain(),count=this.count(),unreadCount=this.props.stream.discussion.unreadCount(),unreadPercent=count?Math.min(count-this.index,unreadCount)/count:0,viewing=app.translator.transChoice("core.forum.post_scrubber.viewing_text",count,{index:m("span",{className:"Scrubber-index"},retain||formatNumber(Math.ceil(this.index+this.visible))),count:m("span",{className:"Scrubber-count"},formatNumber(count))});return m("div",{className:"PostStreamScrubber Dropdown "+(this.disabled()?"disabled ":"")+(this.props.className||"")},m("button",{className:"Button Dropdown-toggle","data-toggle":"dropdown"},viewing," ",icon("sort")),m("div",{className:"Dropdown-menu dropdown-menu"},m("div",{className:"Scrubber"},m("a",{className:"Scrubber-first",onclick:this.goToFirst.bind(this)},icon("angle-double-up")," ",app.translator.trans("core.forum.post_scrubber.original_post_link")),m("div",{className:"Scrubber-scrollbar"},m("div",{className:"Scrubber-before"}),m("div",{className:"Scrubber-handle"},m("div",{className:"Scrubber-bar"}),m("div",{className:"Scrubber-info"},m("strong",null,viewing),m("span",{class:"Scrubber-description"},retain||this.description))),m("div",{className:"Scrubber-after"}),m("div",{className:"Scrubber-unread",config:styleUnread},app.translator.trans("core.forum.post_scrubber.unread_text",{count:unreadCount}))),m("a",{className:"Scrubber-last",onclick:this.goToLast.bind(this)},icon("angle-double-down")," ",app.translator.trans("core.forum.post_scrubber.now_link")))))}},{key:"goToFirst",value:function(){this.props.stream.goToFirst(),this.index=0,this.renderScrollbar(!0)}},{key:"goToLast",value:function(){this.props.stream.goToLast(),this.index=this.props.stream.count(),this.renderScrollbar(!0)}},{key:"count",value:function(){return this.props.stream.count()}},{key:"streamWasUnpaused",value:function(){this.update(window.pageYOffset),this.renderScrollbar(!0)}},{key:"disabled",value:function(){return this.visible>=this.count()}},{key:"onscroll",value:function(top){var stream=this.props.stream;!stream.paused&&stream.$()&&(this.update(top),this.renderScrollbar())}},{key:"update",value:function(scrollTop){var stream=this.props.stream,marginTop=stream.getMarginTop(),viewportTop=scrollTop+marginTop,viewportHeight=$(window).height()-marginTop,$items=stream.$("> .PostStream-item[data-index]"),index=$items.first().data("index")||0,visible=0,period="";$items.each(function(){var $this=$(this),top=$this.offset().top,height=$this.outerHeight(!0);if(top+height<viewportTop)return!0;if(top>viewportTop+viewportHeight)return!1;var visibleTop=Math.max(0,viewportTop-top),visibleBottom=Math.min(height,viewportTop+viewportHeight-top),visiblePost=visibleBottom-visibleTop;top<=viewportTop&&(index=parseFloat($this.data("index"))+visibleTop/height),visiblePost>0&&(visible+=visiblePost/height);var time=$this.data("time");time&&(period=time)}),this.index=index,this.visible=visible,this.description=period?moment(period).format("MMMM YYYY"):""}},{key:"config",value:function(isInitialized,context){isInitialized||(context.onunload=this.ondestroy.bind(this),this.scrollListener.start(),$(window).on("resize",this.handlers.onresize=this.onresize.bind(this)).resize(),this.$(".Scrubber-scrollbar").bind("click",this.onclick.bind(this)).css({cursor:"pointer","user-select":"none"}).bind("dragstart mousedown touchstart",function(e){return e.preventDefault();
}),this.dragging=!1,this.mouseStart=0,this.indexStart=0,this.$(".Scrubber-handle").css("cursor","move").bind("mousedown touchstart",this.onmousedown.bind(this)).click(function(e){return e.stopPropagation()}),$(document).on("mousemove touchmove",this.handlers.onmousemove=this.onmousemove.bind(this)).on("mouseup touchend",this.handlers.onmouseup=this.onmouseup.bind(this)))}},{key:"ondestroy",value:function(){this.scrollListener.stop(),this.props.stream.off("unpaused",this.handlers.streamWasUnpaused),$(window).off("resize",this.handlers.onresize),$(document).off("mousemove touchmove",this.handlers.onmousemove).off("mouseup touchend",this.handlers.onmouseup)}},{key:"renderScrollbar",value:function(animate){var percentPerPost=this.percentPerPost(),index=this.index,count=this.count(),visible=this.visible||1,$scrubber=this.$();$scrubber.find(".Scrubber-index").text(formatNumber(Math.ceil(index+visible))),$scrubber.find(".Scrubber-description").text(this.description),$scrubber.toggleClass("disabled",this.disabled());var heights={};heights.before=Math.max(0,percentPerPost.index*Math.min(index,count-visible)),heights.handle=Math.min(100-heights.before,percentPerPost.visible*visible),heights.after=100-heights.before-heights.handle;var func=animate?"animate":"css";for(var part in heights){var $part=$scrubber.find(".Scrubber-"+part);$part.stop(!0,!0)[func]({height:heights[part]+"%"},"fast"),"animate"===func&&$part.css("overflow","visible")}}},{key:"percentPerPost",value:function percentPerPost(){var count=this.count()||1,visible=this.visible||1,minPercentVisible=50/this.$(".Scrubber-scrollbar").outerHeight()*100,percentPerVisiblePost=Math.max(100/count,minPercentVisible/visible),percentPerPost=count===visible?0:(100-percentPerVisiblePost*visible)/(count-visible);return{index:percentPerPost,visible:percentPerVisiblePost}}},{key:"onresize",value:function(){this.scrollListener.update(!0);var scrubber=this.$(),scrollbar=this.$(".Scrubber-scrollbar");scrollbar.css("max-height",$(window).height()-scrubber.offset().top+$(window).scrollTop()-parseInt($("#app").css("padding-bottom"),10)-(scrubber.outerHeight()-scrollbar.outerHeight()))}},{key:"onmousedown",value:function(e){this.mouseStart=e.clientY||e.originalEvent.touches[0].clientY,this.indexStart=this.index,this.dragging=!0,this.props.stream.paused=!0,$("body").css("cursor","move")}},{key:"onmousemove",value:function(e){if(this.dragging){var deltaPixels=(e.clientY||e.originalEvent.touches[0].clientY)-this.mouseStart,deltaPercent=deltaPixels/this.$(".Scrubber-scrollbar").outerHeight()*100,deltaIndex=deltaPercent/this.percentPerPost().index||0,newIndex=Math.min(this.indexStart+deltaIndex,this.count()-1);this.index=Math.max(0,newIndex),this.renderScrollbar()}}},{key:"onmouseup",value:function(){if(this.dragging){this.mouseStart=0,this.indexStart=0,this.dragging=!1,$("body").css("cursor",""),this.$().removeClass("open");var intIndex=Math.floor(this.index);this.props.stream.goToIndex(intIndex),this.renderScrollbar(!0)}}},{key:"onclick",value:function(e){var $scrollbar=this.$(".Scrubber-scrollbar"),offsetPixels=(e.clientY||e.originalEvent.touches[0].clientY)-$scrollbar.offset().top+$("body").scrollTop(),offsetPercent=offsetPixels/$scrollbar.outerHeight()*100;offsetPercent-=parseFloat($scrollbar.find(".Scrubber-handle")[0].style.height)/2;var offsetIndex=offsetPercent/this.percentPerPost().index;offsetIndex=Math.max(0,Math.min(this.count()-1,offsetIndex)),this.props.stream.goToIndex(Math.floor(offsetIndex)),this.index=offsetIndex,this.renderScrollbar(!0),this.$().removeClass("open")}}]),PostStreamScrubber}(Component),_export("default",PostStreamScrubber)}}}),System.register("flarum/components/PostsUserPage",["flarum/components/UserPage","flarum/components/LoadingIndicator","flarum/components/Button","flarum/components/CommentPost"],function(_export,_context){var UserPage,LoadingIndicator,Button,CommentPost,PostsUserPage;return{setters:[function(_flarumComponentsUserPage){UserPage=_flarumComponentsUserPage.default},function(_flarumComponentsLoadingIndicator){LoadingIndicator=_flarumComponentsLoadingIndicator.default},function(_flarumComponentsButton){Button=_flarumComponentsButton.default},function(_flarumComponentsCommentPost){CommentPost=_flarumComponentsCommentPost.default}],execute:function(){PostsUserPage=function(_UserPage){function PostsUserPage(){return babelHelpers.classCallCheck(this,PostsUserPage),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(PostsUserPage).apply(this,arguments))}return babelHelpers.inherits(PostsUserPage,_UserPage),babelHelpers.createClass(PostsUserPage,[{key:"init",value:function(){babelHelpers.get(Object.getPrototypeOf(PostsUserPage.prototype),"init",this).call(this),this.loading=!0,this.moreResults=!1,this.posts=[],this.loadLimit=20,this.loadUser(m.route.param("username"))}},{key:"content",value:function(){var footer=void 0;return this.loading?footer=LoadingIndicator.component():this.moreResults&&(footer=m("div",{className:"PostsUserPage-loadMore"},Button.component({children:app.translator.trans("core.forum.user.posts_load_more_button"),className:"Button",onclick:this.loadMore.bind(this)}))),m("div",{className:"PostsUserPage"},m("ul",{className:"PostsUserPage-list"},this.posts.map(function(post){return m("li",null,m("div",{className:"PostsUserPage-discussion"},app.translator.trans("core.forum.user.in_discussion_text",{discussion:m("a",{href:app.route.post(post),config:m.route},post.discussion().title())})),CommentPost.component({post:post}))})),footer)}},{key:"show",value:function(user){babelHelpers.get(Object.getPrototypeOf(PostsUserPage.prototype),"show",this).call(this,user),this.refresh()}},{key:"refresh",value:function(){this.loading=!0,this.posts=[],m.lazyRedraw(),this.loadResults().then(this.parseResults.bind(this))}},{key:"loadResults",value:function(offset){return app.store.find("posts",{filter:{user:this.user.id(),type:"comment"},page:{offset:offset,limit:this.loadLimit},sort:"-time"})}},{key:"loadMore",value:function(){this.loading=!0,this.loadResults(this.posts.length).then(this.parseResults.bind(this))}},{key:"parseResults",value:function(results){return this.loading=!1,[].push.apply(this.posts,results),this.moreResults=results.length>=this.loadLimit,m.redraw(),results}}]),PostsUserPage}(UserPage),_export("default",PostsUserPage)}}}),System.register("flarum/components/PostUser",["flarum/Component","flarum/components/UserCard","flarum/helpers/avatar","flarum/helpers/username","flarum/helpers/userOnline","flarum/helpers/listItems"],function(_export,_context){var Component,UserCard,avatar,username,userOnline,listItems,PostUser;return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumComponentsUserCard){UserCard=_flarumComponentsUserCard.default},function(_flarumHelpersAvatar){avatar=_flarumHelpersAvatar.default},function(_flarumHelpersUsername){username=_flarumHelpersUsername.default},function(_flarumHelpersUserOnline){userOnline=_flarumHelpersUserOnline.default},function(_flarumHelpersListItems){listItems=_flarumHelpersListItems.default}],execute:function(){PostUser=function(_Component){function PostUser(){return babelHelpers.classCallCheck(this,PostUser),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(PostUser).apply(this,arguments))}return babelHelpers.inherits(PostUser,_Component),babelHelpers.createClass(PostUser,[{key:"init",value:function(){this.cardVisible=!1}},{key:"view",value:function(){var post=this.props.post,user=post.user();if(!user)return m("div",{className:"PostUser"},m("h3",null,avatar(user,{className:"PostUser-avatar"})," ",username(user)));var card="";return!post.isHidden()&&this.cardVisible&&(card=UserCard.component({user:user,className:"UserCard--popover",controlsButtonClassName:"Button Button--icon Button--flat"})),m("div",{className:"PostUser"},userOnline(user),m("h3",null,m("a",{href:app.route.user(user),config:m.route},avatar(user,{className:"PostUser-avatar"})," ",username(user))),m("ul",{className:"PostUser-badges badges"},listItems(user.badges().toArray())),card)}},{key:"config",value:function(isInitialized){var _this2=this;if(!isInitialized){var timeout=void 0;this.$().on("mouseover","h3 a, .UserCard",function(){clearTimeout(timeout),timeout=setTimeout(_this2.showCard.bind(_this2),500)}).on("mouseout","h3 a, .UserCard",function(){clearTimeout(timeout),timeout=setTimeout(_this2.hideCard.bind(_this2),250)})}}},{key:"showCard",value:function(){var _this3=this;this.cardVisible=!0,m.redraw(),setTimeout(function(){return _this3.$(".UserCard").addClass("in")})}},{key:"hideCard",value:function(){var _this4=this;this.$(".UserCard").removeClass("in").one("transitionend webkitTransitionEnd oTransitionEnd",function(){_this4.cardVisible=!1,m.redraw()})}}]),PostUser}(Component),_export("default",PostUser)}}}),System.register("flarum/components/ReplyComposer",["flarum/components/ComposerBody","flarum/components/Alert","flarum/components/Button","flarum/helpers/icon","flarum/utils/extractText"],function(_export,_context){function minimizeComposerIfFullScreen(e){app.composer.isFullScreen()&&(app.composer.minimize(),e.stopPropagation())}var ComposerBody,Alert,Button,icon,extractText,ReplyComposer;return{setters:[function(_flarumComponentsComposerBody){ComposerBody=_flarumComponentsComposerBody.default},function(_flarumComponentsAlert){Alert=_flarumComponentsAlert.default},function(_flarumComponentsButton){Button=_flarumComponentsButton.default},function(_flarumHelpersIcon){icon=_flarumHelpersIcon.default},function(_flarumUtilsExtractText){extractText=_flarumUtilsExtractText.default}],execute:function(){ReplyComposer=function(_ComposerBody){function ReplyComposer(){return babelHelpers.classCallCheck(this,ReplyComposer),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(ReplyComposer).apply(this,arguments))}return babelHelpers.inherits(ReplyComposer,_ComposerBody),babelHelpers.createClass(ReplyComposer,[{key:"init",value:function(){var _this2=this;babelHelpers.get(Object.getPrototypeOf(ReplyComposer.prototype),"init",this).call(this),this.editor.props.preview=function(e){minimizeComposerIfFullScreen(e),m.route(app.route.discussion(_this2.props.discussion,"reply"))}}},{key:"headerItems",value:function(){var items=babelHelpers.get(Object.getPrototypeOf(ReplyComposer.prototype),"headerItems",this).call(this),discussion=this.props.discussion,routeAndMinimize=function(element,isInitialized){isInitialized||($(element).on("click",minimizeComposerIfFullScreen),m.route.apply(this,arguments))};return items.add("title",m("h3",null,icon("reply")," "," ",m("a",{href:app.route.discussion(discussion),config:routeAndMinimize},discussion.title()))),items}},{key:"data",value:function(){return{content:this.content(),relationships:{discussion:this.props.discussion}}}},{key:"onsubmit",value:function(){var discussion=this.props.discussion;this.loading=!0,m.redraw();var data=this.data();app.store.createRecord("posts").save(data).then(function(post){app.viewingDiscussion(discussion)?app.current.stream.update():!function(){var alert=void 0,viewButton=Button.component({className:"Button Button--link",children:app.translator.trans("core.forum.composer_reply.view_button"),onclick:function(){m.route(app.route.post(post)),app.alerts.dismiss(alert)}});app.alerts.show(alert=new Alert({type:"success",message:app.translator.trans("core.forum.composer_reply.posted_message"),controls:[viewButton]}))}(),app.composer.hide()},this.loaded.bind(this))}}],[{key:"initProps",value:function(props){babelHelpers.get(Object.getPrototypeOf(ReplyComposer),"initProps",this).call(this,props),props.placeholder=props.placeholder||extractText(app.translator.trans("core.forum.composer_reply.body_placeholder")),props.submitLabel=props.submitLabel||app.translator.trans("core.forum.composer_reply.submit_button"),props.confirmExit=props.confirmExit||extractText(app.translator.trans("core.forum.composer_reply.discard_confirmation"))}}]),ReplyComposer}(ComposerBody),_export("default",ReplyComposer)}}}),System.register("flarum/components/ReplyPlaceholder",["flarum/Component","flarum/helpers/avatar","flarum/helpers/username","flarum/utils/DiscussionControls"],function(_export,_context){var Component,avatar,username,DiscussionControls,ReplyPlaceholder;return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumHelpersAvatar){avatar=_flarumHelpersAvatar.default},function(_flarumHelpersUsername){username=_flarumHelpersUsername.default},function(_flarumUtilsDiscussionControls){DiscussionControls=_flarumUtilsDiscussionControls.default}],execute:function(){ReplyPlaceholder=function(_Component){function ReplyPlaceholder(){return babelHelpers.classCallCheck(this,ReplyPlaceholder),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(ReplyPlaceholder).apply(this,arguments))}return babelHelpers.inherits(ReplyPlaceholder,_Component),babelHelpers.createClass(ReplyPlaceholder,[{key:"view",value:function(){function triggerClick(e){$(this).trigger("click"),e.preventDefault()}var _this2=this;if(app.composingReplyTo(this.props.discussion))return m("article",{className:"Post CommentPost editing"},m("header",{className:"Post-header"},m("div",{className:"PostUser"},m("h3",null,avatar(app.session.user,{className:"PostUser-avatar"}),username(app.session.user)))),m("div",{className:"Post-body",config:this.configPreview.bind(this)}));var reply=function(){DiscussionControls.replyAction.call(_this2.props.discussion,!0)};return m("article",{className:"Post ReplyPlaceholder",onclick:reply,onmousedown:triggerClick},m("header",{className:"Post-header"},avatar(app.session.user,{className:"PostUser-avatar"})," ",app.translator.trans("core.forum.post_stream.reply_placeholder")))}},{key:"configPreview",value:function(element,isInitialized,context){if(!isInitialized){var preview=void 0,updateInterval=setInterval(function(){var content=app.composer.component.content();if(preview!==content){preview=content;var anchorToBottom=$(window).scrollTop()+$(window).height()>=$(document).height();s9e.TextFormatter.preview(preview||"",element),anchorToBottom&&$(window).scrollTop($(document).height())}},50);context.onunload=function(){return clearInterval(updateInterval)}}}}]),ReplyPlaceholder}(Component),_export("default",ReplyPlaceholder)}}}),System.register("flarum/components/RequestErrorModal",["flarum/components/Modal"],function(_export,_context){var Modal,RequestErrorModal;return{setters:[function(_flarumComponentsModal){Modal=_flarumComponentsModal.default}],execute:function(){RequestErrorModal=function(_Modal){function RequestErrorModal(){return babelHelpers.classCallCheck(this,RequestErrorModal),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(RequestErrorModal).apply(this,arguments))}return babelHelpers.inherits(RequestErrorModal,_Modal),babelHelpers.createClass(RequestErrorModal,[{key:"className",value:function(){return"RequestErrorModal Modal--large"}},{key:"title",value:function(){return this.props.error.xhr?this.props.error.xhr.status+" "+this.props.error.xhr.statusText:""}},{key:"content",value:function(){var responseText=void 0;try{responseText=JSON.stringify(JSON.parse(this.props.error.responseText),null,2)}catch(e){responseText=this.props.error.responseText}return m("div",{className:"Modal-body"},m("pre",null,this.props.error.options.method," ",this.props.error.options.url,m("br",null),m("br",null),responseText))}}]),RequestErrorModal}(Modal),_export("default",RequestErrorModal)}}}),System.register("flarum/components/Search",["flarum/Component","flarum/components/LoadingIndicator","flarum/utils/ItemList","flarum/utils/classList","flarum/utils/extractText","flarum/helpers/icon","flarum/components/DiscussionsSearchSource","flarum/components/UsersSearchSource"],function(_export,_context){var Component,LoadingIndicator,ItemList,classList,extractText,icon,DiscussionsSearchSource,UsersSearchSource,Search;return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumComponentsLoadingIndicator){LoadingIndicator=_flarumComponentsLoadingIndicator.default},function(_flarumUtilsItemList){ItemList=_flarumUtilsItemList.default},function(_flarumUtilsClassList){classList=_flarumUtilsClassList.default},function(_flarumUtilsExtractText){extractText=_flarumUtilsExtractText.default},function(_flarumHelpersIcon){icon=_flarumHelpersIcon.default},function(_flarumComponentsDiscussionsSearchSource){DiscussionsSearchSource=_flarumComponentsDiscussionsSearchSource.default},function(_flarumComponentsUsersSearchSource){UsersSearchSource=_flarumComponentsUsersSearchSource.default}],execute:function(){Search=function(_Component){function Search(){return babelHelpers.classCallCheck(this,Search),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(Search).apply(this,arguments))}return babelHelpers.inherits(Search,_Component),babelHelpers.createClass(Search,[{key:"init",value:function(){this.value=m.prop(""),this.hasFocus=!1,this.sources=this.sourceItems().toArray(),this.loadingSources=0,this.searched=[],this.index=0}},{key:"view",value:function(){var _this2=this,currentSearch=this.getCurrentSearch();return"undefined"==typeof this.value()&&this.value(currentSearch||""),m("div",{className:"Search "+classList({open:this.value()&&this.hasFocus,focused:this.hasFocus,active:!!currentSearch,loading:!!this.loadingSources})},m("div",{className:"Search-input"},m("input",{className:"FormControl",placeholder:extractText(app.translator.trans("core.forum.header.search_placeholder")),value:this.value(),oninput:m.withAttr("value",this.value),onfocus:function(){return _this2.hasFocus=!0},onblur:function(){return _this2.hasFocus=!1}}),this.loadingSources?LoadingIndicator.component({size:"tiny",className:"Button Button--icon Button--link"}):currentSearch?m("button",{className:"Search-clear Button Button--icon Button--link",onclick:this.clear.bind(this)},icon("times-circle")):""),m("ul",{className:"Dropdown-menu Search-results"},this.value()&&this.hasFocus?this.sources.map(function(source){return source.view(_this2.value())}):""))}},{key:"config",value:function(isInitialized){var _this3=this;if(this.setIndex(this.getCurrentNumericIndex()),!isInitialized){var search=this;this.$(".Search-results").on("mousedown",function(e){return e.preventDefault()}).on("click",function(){return _this3.$("input").blur()}).on("mouseenter","> li:not(.Dropdown-header)",function(){search.setIndex(search.selectableItems().index(this))}),this.$("input").on("keydown",function(e){switch(e.which){case 40:case 38:_this3.setIndex(_this3.getCurrentNumericIndex()+(40===e.which?1:-1),!0),e.preventDefault();break;case 13:_this3.value()?m.route(_this3.getItem(_this3.index).find("a").attr("href")):_this3.clear(),_this3.$("input").blur();break;case 27:_this3.clear()}}).on("input focus",function(){var query=this.value.toLowerCase();query&&(clearTimeout(search.searchTimeout),search.searchTimeout=setTimeout(function(){search.searched.indexOf(query)===-1&&(query.length>=3&&search.sources.map(function(source){source.search&&(search.loadingSources++,source.search(query).then(function(){search.loadingSources--,m.redraw()}))}),search.searched.push(query),m.redraw())},250))}).on("focus",function(){$(this).one("mouseup",function(e){return e.preventDefault()}).select()})}}},{key:"getCurrentSearch",value:function(){return app.current&&"function"==typeof app.current.searching&&app.current.searching()}},{key:"clear",value:function(){this.value(""),this.getCurrentSearch()?app.current.clearSearch():m.redraw()}},{key:"sourceItems",value:function(){var items=new ItemList;return items.add("discussions",new DiscussionsSearchSource),items.add("users",new UsersSearchSource),items}},{key:"selectableItems",value:function(){return this.$(".Search-results > li:not(.Dropdown-header)")}},{key:"getCurrentNumericIndex",value:function(){return this.selectableItems().index(this.getItem(this.index))}},{key:"getItem",value:function(index){var $items=this.selectableItems(),$item=$items.filter('[data-index="'+index+'"]');return $item.length||($item=$items.eq(index)),$item}},{key:"setIndex",value:function(index,scrollToItem){var $items=this.selectableItems(),$dropdown=$items.parent(),fixedIndex=index;index<0?fixedIndex=$items.length-1:index>=$items.length&&(fixedIndex=0);var $item=$items.removeClass("active").eq(fixedIndex).addClass("active");if(this.index=$item.attr("data-index")||fixedIndex,scrollToItem){var dropdownScroll=$dropdown.scrollTop(),dropdownTop=$dropdown.offset().top,dropdownBottom=dropdownTop+$dropdown.outerHeight(),itemTop=$item.offset().top,itemBottom=itemTop+$item.outerHeight(),scrollTop=void 0;itemTop<dropdownTop?scrollTop=dropdownScroll-dropdownTop+itemTop-parseInt($dropdown.css("padding-top"),10):itemBottom>dropdownBottom&&(scrollTop=dropdownScroll-dropdownBottom+itemBottom+parseInt($dropdown.css("padding-bottom"),10)),"undefined"!=typeof scrollTop&&$dropdown.stop(!0).animate({scrollTop:scrollTop},100)}}}]),Search}(Component),_export("default",Search)}}}),System.register("flarum/components/SearchSource",[],function(_export,_context){var SearchSource;return{setters:[],execute:function(){SearchSource=function(){function SearchSource(){babelHelpers.classCallCheck(this,SearchSource)}return babelHelpers.createClass(SearchSource,[{key:"search",value:function(){}},{key:"view",value:function(){}}]),SearchSource}(),_export("default",SearchSource)}}}),System.register("flarum/components/Select",["flarum/Component","flarum/helpers/icon"],function(_export,_context){var Component,icon,Select;return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumHelpersIcon){icon=_flarumHelpersIcon.default}],execute:function(){Select=function(_Component){function Select(){return babelHelpers.classCallCheck(this,Select),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(Select).apply(this,arguments))}return babelHelpers.inherits(Select,_Component),babelHelpers.createClass(Select,[{key:"view",value:function(){var _props=this.props,options=_props.options,onchange=_props.onchange,value=_props.value;return m("span",{className:"Select"},m("select",{className:"Select-input FormControl",onchange:onchange?m.withAttr("value",onchange.bind(this)):void 0,value:value},Object.keys(options).map(function(key){return m("option",{value:key},options[key])})),icon("sort",{className:"Select-caret"}))}}]),Select}(Component),_export("default",Select)}}}),System.register("flarum/components/SelectDropdown",["flarum/components/Dropdown","flarum/helpers/icon"],function(_export,_context){var Dropdown,icon,SelectDropdown;return{setters:[function(_flarumComponentsDropdown){Dropdown=_flarumComponentsDropdown.default},function(_flarumHelpersIcon){icon=_flarumHelpersIcon.default}],execute:function(){SelectDropdown=function(_Dropdown){function SelectDropdown(){return babelHelpers.classCallCheck(this,SelectDropdown),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(SelectDropdown).apply(this,arguments))}return babelHelpers.inherits(SelectDropdown,_Dropdown),babelHelpers.createClass(SelectDropdown,[{key:"getButtonContent",value:function(){var activeChild=this.props.children.filter(function(child){return child.props.active})[0],label=activeChild&&activeChild.props.children||this.props.defaultLabel;return label instanceof Array&&(label=label[0]),[m("span",{className:"Button-label"},label),icon(this.props.caretIcon,{className:"Button-caret"})]}}],[{key:"initProps",value:function(props){props.caretIcon="undefined"!=typeof props.caretIcon?props.caretIcon:"sort",babelHelpers.get(Object.getPrototypeOf(SelectDropdown),"initProps",this).call(this,props),props.className+=" Dropdown--select"}}]),SelectDropdown}(Dropdown),_export("default",SelectDropdown)}}}),System.register("flarum/components/Separator",["flarum/Component"],function(_export,_context){var Component,Separator;return{setters:[function(_flarumComponent){Component=_flarumComponent.default}],execute:function(){Separator=function(_Component){function Separator(){return babelHelpers.classCallCheck(this,Separator),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(Separator).apply(this,arguments))}return babelHelpers.inherits(Separator,_Component),babelHelpers.createClass(Separator,[{key:"view",value:function(){return m("li",{className:"Dropdown-separator"})}}]),Separator}(Component),Separator.isListItem=!0,_export("default",Separator)}}}),System.register("flarum/components/SessionDropdown",["flarum/helpers/avatar","flarum/helpers/username","flarum/components/Dropdown","flarum/components/LinkButton","flarum/components/Button","flarum/utils/ItemList","flarum/components/Separator","flarum/models/Group"],function(_export,_context){var avatar,username,Dropdown,LinkButton,Button,ItemList,Separator,Group,SessionDropdown;return{setters:[function(_flarumHelpersAvatar){avatar=_flarumHelpersAvatar.default},function(_flarumHelpersUsername){username=_flarumHelpersUsername.default},function(_flarumComponentsDropdown){Dropdown=_flarumComponentsDropdown.default},function(_flarumComponentsLinkButton){LinkButton=_flarumComponentsLinkButton.default},function(_flarumComponentsButton){Button=_flarumComponentsButton.default},function(_flarumUtilsItemList){ItemList=_flarumUtilsItemList.default},function(_flarumComponentsSeparator){Separator=_flarumComponentsSeparator.default},function(_flarumModelsGroup){Group=_flarumModelsGroup.default}],execute:function(){SessionDropdown=function(_Dropdown){function SessionDropdown(){return babelHelpers.classCallCheck(this,SessionDropdown),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(SessionDropdown).apply(this,arguments))}return babelHelpers.inherits(SessionDropdown,_Dropdown),babelHelpers.createClass(SessionDropdown,[{key:"view",value:function(){return this.props.children=this.items().toArray(),babelHelpers.get(Object.getPrototypeOf(SessionDropdown.prototype),"view",this).call(this)}},{key:"getButtonContent",value:function(){var user=app.session.user;return[avatar(user)," ",m("span",{className:"Button-label"},username(user))]}},{key:"items",value:function items(){var items=new ItemList,user=app.session.user;return items.add("profile",LinkButton.component({icon:"user",children:app.translator.trans("core.forum.header.profile_button"),href:app.route.user(user)}),100),items.add("settings",LinkButton.component({icon:"cog",children:app.translator.trans("core.forum.header.settings_button"),href:app.route("settings")}),50),user.groups().some(function(group){return group.id()===Group.ADMINISTRATOR_ID})&&items.add("administration",LinkButton.component({icon:"wrench",children:app.translator.trans("core.forum.header.admin_button"),href:app.forum.attribute("baseUrl")+"/admin",target:"_blank",config:function(){}}),0),items.add("separator",Separator.component(),-90),items.add("logOut",Button.component({icon:"sign-out",children:app.translator.trans("core.forum.header.log_out_button"),onclick:app.session.logout.bind(app.session)}),-100),items}}],[{key:"initProps",value:function(props){babelHelpers.get(Object.getPrototypeOf(SessionDropdown),"initProps",this).call(this,props),props.className="SessionDropdown",props.buttonClassName="Button Button--user Button--flat",props.menuClassName="Dropdown-menu--right"}}]),SessionDropdown}(Dropdown),_export("default",SessionDropdown)}}}),System.register("flarum/components/SettingsPage",["flarum/components/UserPage","flarum/utils/ItemList","flarum/components/Switch","flarum/components/Button","flarum/components/FieldSet","flarum/components/NotificationGrid","flarum/components/ChangePasswordModal","flarum/components/ChangeEmailModal","flarum/helpers/listItems"],function(_export,_context){var UserPage,ItemList,Switch,Button,FieldSet,NotificationGrid,ChangePasswordModal,ChangeEmailModal,listItems,SettingsPage;return{setters:[function(_flarumComponentsUserPage){UserPage=_flarumComponentsUserPage.default},function(_flarumUtilsItemList){ItemList=_flarumUtilsItemList.default},function(_flarumComponentsSwitch){Switch=_flarumComponentsSwitch.default},function(_flarumComponentsButton){Button=_flarumComponentsButton.default},function(_flarumComponentsFieldSet){FieldSet=_flarumComponentsFieldSet.default},function(_flarumComponentsNotificationGrid){NotificationGrid=_flarumComponentsNotificationGrid.default},function(_flarumComponentsChangePasswordModal){ChangePasswordModal=_flarumComponentsChangePasswordModal.default},function(_flarumComponentsChangeEmailModal){ChangeEmailModal=_flarumComponentsChangeEmailModal.default},function(_flarumHelpersListItems){listItems=_flarumHelpersListItems.default}],execute:function(){SettingsPage=function(_UserPage){function SettingsPage(){return babelHelpers.classCallCheck(this,SettingsPage),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(SettingsPage).apply(this,arguments))}return babelHelpers.inherits(SettingsPage,_UserPage),babelHelpers.createClass(SettingsPage,[{key:"init",value:function(){babelHelpers.get(Object.getPrototypeOf(SettingsPage.prototype),"init",this).call(this),this.show(app.session.user),app.setTitle(app.translator.trans("core.forum.settings.title"))}},{key:"content",value:function(){return m("div",{className:"SettingsPage"},m("ul",null,listItems(this.settingsItems().toArray())))}},{key:"settingsItems",value:function(){var items=new ItemList;return items.add("account",FieldSet.component({label:app.translator.trans("core.forum.settings.account_heading"),className:"Settings-account",children:this.accountItems().toArray()})),items.add("notifications",FieldSet.component({label:app.translator.trans("core.forum.settings.notifications_heading"),className:"Settings-notifications",children:this.notificationsItems().toArray()})),items.add("privacy",FieldSet.component({label:app.translator.trans("core.forum.settings.privacy_heading"),className:"Settings-privacy",children:this.privacyItems().toArray()})),items}},{key:"accountItems",value:function(){var items=new ItemList;return items.add("changePassword",Button.component({children:app.translator.trans("core.forum.settings.change_password_button"),className:"Button",onclick:function(){return app.modal.show(new ChangePasswordModal)}})),items.add("changeEmail",Button.component({children:app.translator.trans("core.forum.settings.change_email_button"),className:"Button",onclick:function(){return app.modal.show(new ChangeEmailModal)}})),items}},{key:"notificationsItems",value:function(){var items=new ItemList;return items.add("notificationGrid",NotificationGrid.component({user:this.user})),items}},{key:"preferenceSaver",value:function(key){var _this2=this;return function(value,component){component&&(component.loading=!0),m.redraw(),_this2.user.savePreferences(babelHelpers.defineProperty({},key,value)).then(function(){component&&(component.loading=!1),m.redraw()})}}},{key:"privacyItems",value:function(){var _this3=this,items=new ItemList;return items.add("discloseOnline",Switch.component({children:app.translator.trans("core.forum.settings.privacy_disclose_online_label"),state:this.user.preferences().discloseOnline,onchange:function(value,component){_this3.user.pushAttributes({lastSeenTime:null}),_this3.preferenceSaver("discloseOnline")(value,component)}})),items}}]),SettingsPage}(UserPage),_export("default",SettingsPage)}}}),System.register("flarum/components/SignUpModal",["flarum/components/Modal","flarum/components/LogInModal","flarum/helpers/avatar","flarum/components/Button","flarum/components/LogInButtons","flarum/utils/extractText"],function(_export,_context){var Modal,LogInModal,avatar,Button,LogInButtons,extractText,SignUpModal;return{setters:[function(_flarumComponentsModal){Modal=_flarumComponentsModal.default},function(_flarumComponentsLogInModal){LogInModal=_flarumComponentsLogInModal.default},function(_flarumHelpersAvatar){avatar=_flarumHelpersAvatar.default},function(_flarumComponentsButton){Button=_flarumComponentsButton.default},function(_flarumComponentsLogInButtons){LogInButtons=_flarumComponentsLogInButtons.default;
},function(_flarumUtilsExtractText){extractText=_flarumUtilsExtractText.default}],execute:function(){SignUpModal=function(_Modal){function SignUpModal(){return babelHelpers.classCallCheck(this,SignUpModal),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(SignUpModal).apply(this,arguments))}return babelHelpers.inherits(SignUpModal,_Modal),babelHelpers.createClass(SignUpModal,[{key:"init",value:function(){babelHelpers.get(Object.getPrototypeOf(SignUpModal.prototype),"init",this).call(this),this.username=m.prop(this.props.username||""),this.email=m.prop(this.props.email||""),this.password=m.prop(this.props.password||"")}},{key:"className",value:function(){return"Modal--small SignUpModal"+(this.welcomeUser?" SignUpModal--success":"")}},{key:"title",value:function(){return app.translator.trans("core.forum.sign_up.title")}},{key:"content",value:function(){return[m("div",{className:"Modal-body"},this.body()),m("div",{className:"Modal-footer"},this.footer())]}},{key:"body",value:function(){return[this.props.token?"":m(LogInButtons,null),m("div",{className:"Form Form--centered"},m("div",{className:"Form-group"},m("input",{className:"FormControl",name:"username",type:"text",placeholder:extractText(app.translator.trans("core.forum.sign_up.username_placeholder")),value:this.username(),onchange:m.withAttr("value",this.username),disabled:this.loading})),m("div",{className:"Form-group"},m("input",{className:"FormControl",name:"email",type:"email",placeholder:extractText(app.translator.trans("core.forum.sign_up.email_placeholder")),value:this.email(),onchange:m.withAttr("value",this.email),disabled:this.loading||this.props.token&&this.props.email})),this.props.token?"":m("div",{className:"Form-group"},m("input",{className:"FormControl",name:"password",type:"password",placeholder:extractText(app.translator.trans("core.forum.sign_up.password_placeholder")),value:this.password(),onchange:m.withAttr("value",this.password),disabled:this.loading})),m("div",{className:"Form-group"},m(Button,{className:"Button Button--primary Button--block",type:"submit",loading:this.loading},app.translator.trans("core.forum.sign_up.submit_button"))))]}},{key:"footer",value:function(){return[m("p",{className:"SignUpModal-logIn"},app.translator.trans("core.forum.sign_up.log_in_text",{a:m("a",{onclick:this.logIn.bind(this)})}))]}},{key:"logIn",value:function(){var props={email:this.email()||this.username(),password:this.password()};app.modal.show(new LogInModal(props))}},{key:"onready",value:function(){this.props.username&&!this.props.email?this.$("[name=email]").select():this.$("[name=username]").select()}},{key:"onsubmit",value:function(e){e.preventDefault(),this.loading=!0;var data=this.submitData();app.request({url:app.forum.attribute("baseUrl")+"/register",method:"POST",data:data,errorHandler:this.onerror.bind(this)}).then(function(){return window.location.reload()},this.loaded.bind(this))}},{key:"submitData",value:function(){var data={username:this.username(),email:this.email()};return this.props.token?data.token=this.props.token:data.password=this.password(),this.props.avatarUrl&&(data.avatarUrl=this.props.avatarUrl),data}}]),SignUpModal}(Modal),_export("default",SignUpModal)}}}),System.register("flarum/components/SplitDropdown",["flarum/components/Dropdown","flarum/components/Button","flarum/helpers/icon"],function(_export,_context){var Dropdown,Button,icon,SplitDropdown;return{setters:[function(_flarumComponentsDropdown){Dropdown=_flarumComponentsDropdown.default},function(_flarumComponentsButton){Button=_flarumComponentsButton.default},function(_flarumHelpersIcon){icon=_flarumHelpersIcon.default}],execute:function(){SplitDropdown=function(_Dropdown){function SplitDropdown(){return babelHelpers.classCallCheck(this,SplitDropdown),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(SplitDropdown).apply(this,arguments))}return babelHelpers.inherits(SplitDropdown,_Dropdown),babelHelpers.createClass(SplitDropdown,[{key:"getButton",value:function(){var firstChild=this.getFirstChild(),buttonProps=babelHelpers.extends({},firstChild.props);return buttonProps.className=(buttonProps.className||"")+" SplitDropdown-button Button "+this.props.buttonClassName,[Button.component(buttonProps),m("button",{className:"Dropdown-toggle Button Button--icon "+this.props.buttonClassName,"data-toggle":"dropdown"},icon(this.props.icon,{className:"Button-icon"}),icon("caret-down",{className:"Button-caret"}))]}},{key:"getFirstChild",value:function(){for(var firstChild=this.props.children;firstChild instanceof Array;)firstChild=firstChild[0];return firstChild}}],[{key:"initProps",value:function(props){babelHelpers.get(Object.getPrototypeOf(SplitDropdown),"initProps",this).call(this,props),props.className+=" Dropdown--split",props.menuClassName+=" Dropdown-menu--right"}}]),SplitDropdown}(Dropdown),_export("default",SplitDropdown)}}}),System.register("flarum/components/Switch",["flarum/components/Checkbox"],function(_export,_context){var Checkbox,Switch;return{setters:[function(_flarumComponentsCheckbox){Checkbox=_flarumComponentsCheckbox.default}],execute:function(){Switch=function(_Checkbox){function Switch(){return babelHelpers.classCallCheck(this,Switch),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(Switch).apply(this,arguments))}return babelHelpers.inherits(Switch,_Checkbox),babelHelpers.createClass(Switch,[{key:"getDisplay",value:function(){return this.loading?babelHelpers.get(Object.getPrototypeOf(Switch.prototype),"getDisplay",this).call(this):""}}],[{key:"initProps",value:function(props){babelHelpers.get(Object.getPrototypeOf(Switch),"initProps",this).call(this,props),props.className=(props.className||"")+" Checkbox--switch"}}]),Switch}(Checkbox),_export("default",Switch)}}}),System.register("flarum/components/TerminalPost",["flarum/Component","flarum/helpers/humanTime","flarum/helpers/icon"],function(_export,_context){var Component,humanTime,icon,TerminalPost;return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumHelpersHumanTime){humanTime=_flarumHelpersHumanTime.default},function(_flarumHelpersIcon){icon=_flarumHelpersIcon.default}],execute:function(){TerminalPost=function(_Component){function TerminalPost(){return babelHelpers.classCallCheck(this,TerminalPost),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(TerminalPost).apply(this,arguments))}return babelHelpers.inherits(TerminalPost,_Component),babelHelpers.createClass(TerminalPost,[{key:"view",value:function(){var discussion=this.props.discussion,lastPost=this.props.lastPost&&discussion.repliesCount(),user=discussion[lastPost?"lastUser":"startUser"](),time=discussion[lastPost?"lastTime":"startTime"]();return m("span",null,lastPost?icon("reply"):""," ",app.translator.trans("core.forum.discussion_list."+(lastPost?"replied":"started")+"_text",{user:user,ago:humanTime(time)}))}}]),TerminalPost}(Component),_export("default",TerminalPost)}}}),System.register("flarum/components/TextEditor",["flarum/Component","flarum/utils/ItemList","flarum/helpers/listItems","flarum/components/Button"],function(_export,_context){var Component,ItemList,listItems,Button,TextEditor;return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumUtilsItemList){ItemList=_flarumUtilsItemList.default},function(_flarumHelpersListItems){listItems=_flarumHelpersListItems.default},function(_flarumComponentsButton){Button=_flarumComponentsButton.default}],execute:function(){TextEditor=function(_Component){function TextEditor(){return babelHelpers.classCallCheck(this,TextEditor),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(TextEditor).apply(this,arguments))}return babelHelpers.inherits(TextEditor,_Component),babelHelpers.createClass(TextEditor,[{key:"init",value:function(){this.value=m.prop(this.props.value||"")}},{key:"view",value:function(){return m("div",{className:"TextEditor"},m("textarea",{className:"FormControl Composer-flexible",config:this.configTextarea.bind(this),oninput:m.withAttr("value",this.oninput.bind(this)),placeholder:this.props.placeholder||"",disabled:!!this.props.disabled,value:this.value()}),m("ul",{className:"TextEditor-controls Composer-footer"},listItems(this.controlItems().toArray())))}},{key:"configTextarea",value:function(element,isInitialized){var _this2=this;if(!isInitialized){var handler=function(){_this2.onsubmit(),m.redraw()};$(element).bind("keydown","meta+return",handler),$(element).bind("keydown","ctrl+return",handler)}}},{key:"controlItems",value:function(){var items=new ItemList;return items.add("submit",Button.component({children:this.props.submitLabel,icon:"check",className:"Button Button--primary",itemClassName:"App-primaryControl",onclick:this.onsubmit.bind(this)})),this.props.preview&&items.add("preview",Button.component({icon:"eye",className:"Button Button--icon",onclick:this.props.preview})),items}},{key:"setValue",value:function(value){this.$("textarea").val(value).trigger("input")}},{key:"setSelectionRange",value:function(start,end){var $textarea=this.$("textarea");$textarea[0].setSelectionRange(start,end),$textarea.focus()}},{key:"getSelectionRange",value:function(){var $textarea=this.$("textarea");return[$textarea[0].selectionStart,$textarea[0].selectionEnd]}},{key:"insertAtCursor",value:function(insert){var textarea=this.$("textarea")[0],value=this.value(),index=textarea?textarea.selectionStart:value.length;if(this.setValue(value.slice(0,index)+insert+value.slice(index)),textarea){var pos=index+insert.length;this.setSelectionRange(pos,pos)}}},{key:"oninput",value:function(value){this.value(value),this.props.onchange(this.value()),m.redraw.strategy("none")}},{key:"onsubmit",value:function(){this.props.onsubmit(this.value())}}]),TextEditor}(Component),_export("default",TextEditor)}}}),System.register("flarum/components/UserBio",["flarum/Component","flarum/components/LoadingIndicator","flarum/utils/classList","flarum/utils/extractText"],function(_export,_context){var Component,LoadingIndicator,classList,extractText,UserBio;return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumComponentsLoadingIndicator){LoadingIndicator=_flarumComponentsLoadingIndicator.default},function(_flarumUtilsClassList){classList=_flarumUtilsClassList.default},function(_flarumUtilsExtractText){extractText=_flarumUtilsExtractText.default}],execute:function(){UserBio=function(_Component){function UserBio(){return babelHelpers.classCallCheck(this,UserBio),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(UserBio).apply(this,arguments))}return babelHelpers.inherits(UserBio,_Component),babelHelpers.createClass(UserBio,[{key:"init",value:function(){this.editing=!1,this.loading=!1}},{key:"view",value:function(){var user=this.props.user,content=void 0;if(this.editing)content=m("textarea",{className:"FormControl",placeholder:extractText(app.translator.trans("core.forum.user.bio_placeholder")),rows:"3",value:user.bio()});else{var subContent=void 0;if(this.loading)subContent=m("p",{className:"UserBio-placeholder"},LoadingIndicator.component({size:"tiny"}));else{var bioHtml=user.bioHtml();bioHtml?subContent=m.trust(bioHtml):this.props.editable&&(subContent=m("p",{className:"UserBio-placeholder"},app.translator.trans("core.forum.user.bio_placeholder")))}content=m("div",{className:"UserBio-content"},subContent)}return m("div",{className:"UserBio "+classList({editable:this.props.editable,editing:this.editing}),onclick:this.edit.bind(this)},content)}},{key:"edit",value:function(){if(this.props.editable){this.editing=!0,m.redraw();var bio=this,save=function(e){e.shiftKey||(e.preventDefault(),bio.save($(this).val()))};this.$("textarea").focus().bind("blur",save).bind("keydown","return",save)}}},{key:"save",value:function(value){var _this2=this,user=this.props.user;user.bio()!==value&&(this.loading=!0,user.save({bio:value}).catch(function(){}).then(function(){_this2.loading=!1,m.redraw()})),this.editing=!1,m.redraw()}}]),UserBio}(Component),_export("default",UserBio)}}}),System.register("flarum/components/UserCard",["flarum/Component","flarum/utils/humanTime","flarum/utils/ItemList","flarum/utils/UserControls","flarum/helpers/avatar","flarum/helpers/username","flarum/helpers/icon","flarum/components/Dropdown","flarum/components/UserBio","flarum/components/AvatarEditor","flarum/helpers/listItems"],function(_export,_context){var Component,humanTime,ItemList,UserControls,avatar,username,icon,Dropdown,UserBio,AvatarEditor,listItems,UserCard;return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumUtilsHumanTime){humanTime=_flarumUtilsHumanTime.default},function(_flarumUtilsItemList){ItemList=_flarumUtilsItemList.default},function(_flarumUtilsUserControls){UserControls=_flarumUtilsUserControls.default},function(_flarumHelpersAvatar){avatar=_flarumHelpersAvatar.default},function(_flarumHelpersUsername){username=_flarumHelpersUsername.default},function(_flarumHelpersIcon){icon=_flarumHelpersIcon.default},function(_flarumComponentsDropdown){Dropdown=_flarumComponentsDropdown.default},function(_flarumComponentsUserBio){UserBio=_flarumComponentsUserBio.default},function(_flarumComponentsAvatarEditor){AvatarEditor=_flarumComponentsAvatarEditor.default},function(_flarumHelpersListItems){listItems=_flarumHelpersListItems.default}],execute:function(){UserCard=function(_Component){function UserCard(){return babelHelpers.classCallCheck(this,UserCard),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(UserCard).apply(this,arguments))}return babelHelpers.inherits(UserCard,_Component),babelHelpers.createClass(UserCard,[{key:"view",value:function(){var user=this.props.user,controls=UserControls.controls(user,this).toArray(),color=user.color(),badges=user.badges().toArray();return m("div",{className:"UserCard "+(this.props.className||""),style:color?{backgroundColor:color}:""},m("div",{className:"darkenBackground"},m("div",{className:"container"},controls.length?Dropdown.component({children:controls,className:"UserCard-controls App-primaryControl",menuClassName:"Dropdown-menu--right",buttonClassName:this.props.controlsButtonClassName,label:app.translator.trans("core.forum.user_controls.button"),icon:"ellipsis-v"}):"",m("div",{className:"UserCard-profile"},m("h2",{className:"UserCard-identity"},this.props.editable?[AvatarEditor.component({user:user,className:"UserCard-avatar"}),username(user)]:m("a",{href:app.route.user(user),config:m.route},m("div",{className:"UserCard-avatar"},avatar(user)),username(user))),badges.length?m("ul",{className:"UserCard-badges badges"},listItems(badges)):"",m("ul",{className:"UserCard-info"},listItems(this.infoItems().toArray()))))))}},{key:"infoItems",value:function(){var items=new ItemList,user=this.props.user,lastSeenTime=user.lastSeenTime();if(items.add("bio",UserBio.component({user:user,editable:this.props.editable})),lastSeenTime){var online=user.isOnline();items.add("lastSeen",m("span",{className:"UserCard-lastSeen"+(online?" online":"")},online?[icon("circle")," ",app.translator.trans("core.forum.user.online_text")]:[icon("clock-o")," ",humanTime(lastSeenTime)]))}return items.add("joined",app.translator.trans("core.forum.user.joined_date_text",{ago:humanTime(user.joinTime())})),items}}]),UserCard}(Component),_export("default",UserCard)}}}),System.register("flarum/components/UserPage",["flarum/components/Page","flarum/utils/ItemList","flarum/utils/affixSidebar","flarum/components/UserCard","flarum/components/LoadingIndicator","flarum/components/SelectDropdown","flarum/components/LinkButton","flarum/components/Separator","flarum/helpers/listItems"],function(_export,_context){var Page,ItemList,affixSidebar,UserCard,LoadingIndicator,SelectDropdown,LinkButton,Separator,listItems,UserPage;return{setters:[function(_flarumComponentsPage){Page=_flarumComponentsPage.default},function(_flarumUtilsItemList){ItemList=_flarumUtilsItemList.default},function(_flarumUtilsAffixSidebar){affixSidebar=_flarumUtilsAffixSidebar.default},function(_flarumComponentsUserCard){UserCard=_flarumComponentsUserCard.default},function(_flarumComponentsLoadingIndicator){LoadingIndicator=_flarumComponentsLoadingIndicator.default},function(_flarumComponentsSelectDropdown){SelectDropdown=_flarumComponentsSelectDropdown.default},function(_flarumComponentsLinkButton){LinkButton=_flarumComponentsLinkButton.default},function(_flarumComponentsSeparator){Separator=_flarumComponentsSeparator.default},function(_flarumHelpersListItems){listItems=_flarumHelpersListItems.default}],execute:function(){UserPage=function(_Page){function UserPage(){return babelHelpers.classCallCheck(this,UserPage),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(UserPage).apply(this,arguments))}return babelHelpers.inherits(UserPage,_Page),babelHelpers.createClass(UserPage,[{key:"init",value:function(){babelHelpers.get(Object.getPrototypeOf(UserPage.prototype),"init",this).call(this),this.user=null,app.history.push("user"),this.bodyClass="App--user"}},{key:"view",value:function(){return m("div",{className:"UserPage"},this.user?[UserCard.component({user:this.user,className:"Hero UserHero",editable:this.user.canEdit()||this.user===app.session.user,controlsButtonClassName:"Button"}),m("div",{className:"container"},m("nav",{className:"sideNav UserPage-nav",config:affixSidebar},m("ul",null,listItems(this.sidebarItems().toArray()))),m("div",{className:"sideNavOffset UserPage-content"},this.content()))]:[LoadingIndicator.component({className:"LoadingIndicator--block"})])}},{key:"content",value:function(){}},{key:"show",value:function(user){this.user=user,app.history.push("user",user.username()),app.setTitle(user.username()),m.redraw()}},{key:"loadUser",value:function(username){var _this2=this,lowercaseUsername=username.toLowerCase();app.store.all("users").some(function(user){if(user.username().toLowerCase()===lowercaseUsername&&user.joinTime())return _this2.show(user),!0}),this.user||app.store.find("users",username).then(this.show.bind(this))}},{key:"sidebarItems",value:function(){var items=new ItemList;return items.add("nav",SelectDropdown.component({children:this.navItems().toArray(),className:"App-titleControl",buttonClassName:"Button"})),items}},{key:"navItems",value:function(){var items=new ItemList,user=this.user;return items.add("posts",LinkButton.component({href:app.route("user.posts",{username:user.username()}),children:[app.translator.trans("core.forum.user.posts_link"),m("span",{className:"Button-badge"},user.commentsCount())],icon:"comment-o"}),100),items.add("discussions",LinkButton.component({href:app.route("user.discussions",{username:user.username()}),children:[app.translator.trans("core.forum.user.discussions_link"),m("span",{className:"Button-badge"},user.discussionsCount())],icon:"reorder"}),90),app.session.user===user&&(items.add("separator",Separator.component(),-90),items.add("settings",LinkButton.component({href:app.route("settings"),children:app.translator.trans("core.forum.user.settings_link"),icon:"cog"}),-100)),items}}]),UserPage}(Page),_export("default",UserPage)}}}),System.register("flarum/components/UsersSearchSource",["flarum/helpers/highlight","flarum/helpers/avatar","flarum/helpers/username"],function(_export,_context){var highlight,avatar,username,UsersSearchResults;return{setters:[function(_flarumHelpersHighlight){highlight=_flarumHelpersHighlight.default},function(_flarumHelpersAvatar){avatar=_flarumHelpersAvatar.default},function(_flarumHelpersUsername){username=_flarumHelpersUsername.default}],execute:function(){UsersSearchResults=function(){function UsersSearchResults(){babelHelpers.classCallCheck(this,UsersSearchResults)}return babelHelpers.createClass(UsersSearchResults,[{key:"search",value:function(query){return app.store.find("users",{filter:{q:query},page:{limit:5}})}},{key:"view",value:function(query){var results=app.store.all("users").filter(function(user){return user.username().toLowerCase().substr(0,query.length)===query});return results.length?[m("li",{className:"Dropdown-header"},app.translator.trans("core.forum.search.users_heading")),results.map(function(user){var name=username(user);return name.children[0]=highlight(name.children[0],query),m("li",{className:"UserSearchResult","data-index":"users"+user.id()},m("a",{href:app.route.user(user),config:m.route},avatar(user),name))})]:""}}]),UsersSearchResults}(),_export("default",UsersSearchResults)}}}),System.register("flarum/components/WelcomeHero",["flarum/Component","flarum/components/Button"],function(_export,_context){var Component,Button,WelcomeHero;return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumComponentsButton){Button=_flarumComponentsButton.default}],execute:function(){WelcomeHero=function(_Component){function WelcomeHero(){return babelHelpers.classCallCheck(this,WelcomeHero),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(WelcomeHero).apply(this,arguments))}return babelHelpers.inherits(WelcomeHero,_Component),babelHelpers.createClass(WelcomeHero,[{key:"init",value:function(){this.hidden=localStorage.getItem("welcomeHidden")}},{key:"view",value:function(){var _this2=this;if(this.hidden)return m("div",null);var slideUp=function(){_this2.$().slideUp(_this2.hide.bind(_this2))};return m("header",{className:"Hero WelcomeHero"},m("div",{class:"container"},Button.component({icon:"times",onclick:slideUp,className:"Hero-close Button Button--icon Button--link"}),m("div",{className:"containerNarrow"},m("h2",{className:"Hero-title"},app.forum.attribute("welcomeTitle")),m("div",{className:"Hero-subtitle"},m.trust(app.forum.attribute("welcomeMessage"))))))}},{key:"hide",value:function(){localStorage.setItem("welcomeHidden","true"),this.hidden=!0}}]),WelcomeHero}(Component),_export("default",WelcomeHero)}}}),System.register("flarum/extend",[],function(_export,_context){return{setters:[],execute:function(){function extend(object,method,callback){var original=object[method];object[method]=function(){for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];var value=original?original.apply(this,args):void 0;return callback.apply(this,[value].concat(args)),value},babelHelpers.extends(object[method],original)}function override(object,method,newMethod){var original=object[method];object[method]=function(){for(var _len2=arguments.length,args=Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];return newMethod.apply(this,[original.bind(this)].concat(args))},babelHelpers.extends(object[method],original)}_export("extend",extend),_export("override",override)}}}),System.register("flarum/ForumApp",["flarum/utils/History","flarum/App","flarum/components/Search","flarum/components/Composer","flarum/components/ReplyComposer","flarum/components/DiscussionPage","flarum/components/SignUpModal"],function(_export,_context){var History,App,Search,Composer,ReplyComposer,DiscussionPage,SignUpModal,ForumApp;return{setters:[function(_flarumUtilsHistory){History=_flarumUtilsHistory.default},function(_flarumApp){App=_flarumApp.default},function(_flarumComponentsSearch){Search=_flarumComponentsSearch.default},function(_flarumComponentsComposer){Composer=_flarumComponentsComposer.default},function(_flarumComponentsReplyComposer){ReplyComposer=_flarumComponentsReplyComposer.default},function(_flarumComponentsDiscussionPage){DiscussionPage=_flarumComponentsDiscussionPage.default},function(_flarumComponentsSignUpModal){SignUpModal=_flarumComponentsSignUpModal.default}],execute:function(){ForumApp=function(_App){function ForumApp(){var _Object$getPrototypeO;babelHelpers.classCallCheck(this,ForumApp);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];var _this=babelHelpers.possibleConstructorReturn(this,(_Object$getPrototypeO=Object.getPrototypeOf(ForumApp)).call.apply(_Object$getPrototypeO,[this].concat(args)));return _this.history=new History,_this.pane=null,_this.search=new Search,_this.drawer=null,_this.postComponents={},_this.notificationComponents={},_this}return babelHelpers.inherits(ForumApp,_App),babelHelpers.createClass(ForumApp,[{key:"composingReplyTo",value:function(discussion){return this.composer.component instanceof ReplyComposer&&this.composer.component.props.discussion===discussion&&this.composer.position!==Composer.PositionEnum.HIDDEN}},{key:"viewingDiscussion",value:function(discussion){return this.current instanceof DiscussionPage&&this.current.discussion===discussion}},{key:"authenticationComplete",value:function(payload){if(payload.authenticated)window.location.reload();else{var modal=new SignUpModal(payload);this.modal.show(modal),modal.$("[name=password]").focus()}}}]),ForumApp}(App),_export("default",ForumApp)}}}),System.register("flarum/helpers/avatar",[],function(_export,_context){function avatar(user){var attrs=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];attrs.className="Avatar "+(attrs.className||"");var content="",hasTitle="undefined"===attrs.title||attrs.title;if(hasTitle||delete attrs.title,user){var username=user.username()||"?",avatarUrl=user.avatarUrl();if(hasTitle&&(attrs.title=attrs.title||username),avatarUrl)return m("img",babelHelpers.extends({},attrs,{src:avatarUrl}));content=username.charAt(0).toUpperCase(),attrs.style={background:user.color()}}return m("span",attrs,content)}return _export("default",avatar),{setters:[],execute:function(){}}}),System.register("flarum/helpers/fullTime",[],function(_export,_context){function fullTime(time){var mo=moment(time),datetime=mo.format(),full=mo.format("LLLL");return m("time",{pubdate:!0,datetime:datetime},full)}return _export("default",fullTime),{setters:[],execute:function(){}}}),System.register("flarum/helpers/highlight",["flarum/utils/string"],function(_export,_context){function highlight(string,phrase,length){if(!phrase&&!length)return string;var regexp=phrase instanceof RegExp?phrase:new RegExp(phrase,"gi"),highlighted=string,start=0;return length&&(phrase&&(start=Math.max(0,string.search(regexp)-length/2)),highlighted=truncate(highlighted,length,start)),highlighted=$("<div/>").text(highlighted).html(),phrase&&(highlighted=highlighted.replace(regexp,"<mark>$&</mark>")),m.trust(highlighted)}var truncate;return _export("default",highlight),{setters:[function(_flarumUtilsString){truncate=_flarumUtilsString.truncate}],execute:function(){}}}),System.register("flarum/helpers/humanTime",["flarum/utils/humanTime"],function(_export,_context){function humanTime(time){var mo=moment(time),datetime=mo.format(),full=mo.format("LLLL"),ago=humanTimeUtil(time);return m("time",{pubdate:!0,datetime:datetime,title:full,"data-humantime":!0},ago)}var humanTimeUtil;return _export("default",humanTime),{setters:[function(_flarumUtilsHumanTime){humanTimeUtil=_flarumUtilsHumanTime.default}],execute:function(){}}}),System.register("flarum/helpers/icon",[],function(_export,_context){function icon(name){var attrs=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return attrs.className="icon fa fa-fw fa-"+name+" "+(attrs.className||""),m("i",attrs)}return _export("default",icon),{setters:[],execute:function(){}}}),System.register("flarum/helpers/listItems",["flarum/components/Separator","flarum/utils/classList"],function(_export,_context){function isSeparator(item){return item&&item.component===Separator}function withoutUnnecessarySeparators(items){var newItems=[],prevItem=void 0;return items.forEach(function(item,i){(!isSeparator(item)||prevItem&&!isSeparator(prevItem)&&i!==items.length-1)&&(prevItem=item,newItems.push(item))}),newItems}function listItems(items){return items instanceof Array||(items=[items]),withoutUnnecessarySeparators(items).map(function(item){var isListItem=item.component&&item.component.isListItem,active=item.component&&item.component.isActive&&item.component.isActive(item.props),className=item.props?item.props.itemClassName:item.itemClassName;isListItem&&(item.attrs=item.attrs||{},item.attrs.key=item.attrs.key||item.itemName);var space=new String(" ");return space.attrs={key:"_space_"+item.itemName},[isListItem?item:m("li",{className:classList([item.itemName?"item-"+item.itemName:"",className,active?"active":""]),key:item.itemName},item),space]})}var Separator,classList;return _export("default",listItems),{setters:[function(_flarumComponentsSeparator){Separator=_flarumComponentsSeparator.default},function(_flarumUtilsClassList){classList=_flarumUtilsClassList.default}],execute:function(){}}}),System.register("flarum/helpers/punctuateSeries",[],function(_export,_context){function punctuateSeries(items){if(2===items.length)return app.translator.trans("core.lib.series.two_text",{first:items[0],second:items[1]});if(items.length>=3){var second=items.slice(1,items.length-1).reduce(function(list,item){return list.concat([item,app.translator.trans("core.lib.series.glue_text")])},[]).slice(0,-1);return app.translator.trans("core.lib.series.three_text",{first:items[0],second:second,third:items[items.length-1]})}return items}return _export("default",punctuateSeries),{setters:[],execute:function(){}}}),System.register("flarum/helpers/username",[],function(_export,_context){function username(user){var name=user&&user.username()||app.translator.trans("core.lib.username.deleted_text");return m("span",{className:"username"},name)}return _export("default",username),{setters:[],execute:function(){}}}),System.register("flarum/helpers/userOnline",["flarum/helpers/icon"],function(_export,_context){function userOnline(user){if(user.lastSeenTime()&&user.isOnline())return m("span",{className:"UserOnline"},icon("circle"))}var icon;return _export("default",userOnline),{setters:[function(_flarumHelpersIcon){icon=_flarumHelpersIcon.default}],execute:function(){}}}),System.register("flarum/initializers/alertEmailConfirmation",["flarum/components/Alert","flarum/components/Button","flarum/helpers/icon"],function(_export,_context){function alertEmailConfirmation(app){var user=app.session.user;if(user&&!user.isActivated()){var resendButton=Button.component({className:"Button Button--link",children:app.translator.trans("core.forum.user_email_confirmation.resend_button"),onclick:function(){resendButton.props.loading=!0,m.redraw(),app.request({method:"POST",url:app.forum.attribute("apiUrl")+"/users/"+user.id()+"/send-confirmation"}).then(function(){resendButton.props.loading=!1,resendButton.props.children=[icon("check")," ",app.translator.trans("core.forum.user_email_confirmation.sent_message")],resendButton.props.disabled=!0,m.redraw()}).catch(function(){resendButton.props.loading=!1,m.redraw()})}}),ContainedAlert=function(_Alert){function ContainedAlert(){return babelHelpers.classCallCheck(this,ContainedAlert),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(ContainedAlert).apply(this,arguments))}return babelHelpers.inherits(ContainedAlert,_Alert),babelHelpers.createClass(ContainedAlert,[{key:"view",value:function(){var vdom=babelHelpers.get(Object.getPrototypeOf(ContainedAlert.prototype),"view",this).call(this);return vdom.children=[m("div",{className:"container"},vdom.children)],vdom}}]),ContainedAlert}(Alert);m.mount($("<div/>").insertBefore("#content")[0],ContainedAlert.component({dismissible:!1,children:app.translator.trans("core.forum.user_email_confirmation.alert_message",{email:m("strong",null,user.email())}),controls:[resendButton]}))}}var Alert,Button,icon;return _export("default",alertEmailConfirmation),{setters:[function(_flarumComponentsAlert){Alert=_flarumComponentsAlert.default},function(_flarumComponentsButton){Button=_flarumComponentsButton.default},function(_flarumHelpersIcon){icon=_flarumHelpersIcon.default}],execute:function(){}}}),System.register("flarum/initializers/boot",["flarum/utils/ScrollListener","flarum/utils/Pane","flarum/utils/Drawer","flarum/utils/mapRoutes","flarum/helpers/icon","flarum/components/Navigation","flarum/components/HeaderPrimary","flarum/components/HeaderSecondary","flarum/components/Composer","flarum/components/ModalManager","flarum/components/AlertManager"],function(_export,_context){
function boot(app){var defaultRoute=app.forum.attribute("defaultRoute"),defaultAction="index";for(var i in app.routes)app.routes[i].path===defaultRoute&&(defaultAction=i);app.routes[defaultAction].path="/",app.history.push(defaultAction,icon("bars"),"/"),m.startComputation(),m.mount(document.getElementById("app-navigation"),Navigation.component({className:"App-backControl",drawer:!0})),m.mount(document.getElementById("header-navigation"),Navigation.component()),m.mount(document.getElementById("header-primary"),HeaderPrimary.component()),m.mount(document.getElementById("header-secondary"),HeaderSecondary.component()),app.pane=new Pane(document.getElementById("app")),app.drawer=new Drawer,app.composer=m.mount(document.getElementById("composer"),Composer.component()),app.modal=m.mount(document.getElementById("modal"),ModalManager.component()),app.alerts=m.mount(document.getElementById("alerts"),AlertManager.component());var basePath=app.forum.attribute("basePath");m.route.mode="pathname",m.route(document.getElementById("content"),basePath+"/",mapRoutes(app.routes,basePath)),m.endComputation(),$("#home-link").click(function(e){e.ctrlKey||e.metaKey||2===e.which||(e.preventDefault(),app.history.home())}),new ScrollListener(function(top){var $app=$("#app"),offset=$app.offset().top;$app.toggleClass("affix",top>=offset).toggleClass("scrolled",top>offset)}).start(),$(function(){FastClick.attach(document.body),$("body").addClass("ontouchstart"in window?"touch":"no-touch")}),app.booted=!0}var ScrollListener,Pane,Drawer,mapRoutes,icon,Navigation,HeaderPrimary,HeaderSecondary,Composer,ModalManager,AlertManager;return _export("default",boot),{setters:[function(_flarumUtilsScrollListener){ScrollListener=_flarumUtilsScrollListener.default},function(_flarumUtilsPane){Pane=_flarumUtilsPane.default},function(_flarumUtilsDrawer){Drawer=_flarumUtilsDrawer.default},function(_flarumUtilsMapRoutes){mapRoutes=_flarumUtilsMapRoutes.default},function(_flarumHelpersIcon){icon=_flarumHelpersIcon.default},function(_flarumComponentsNavigation){Navigation=_flarumComponentsNavigation.default},function(_flarumComponentsHeaderPrimary){HeaderPrimary=_flarumComponentsHeaderPrimary.default},function(_flarumComponentsHeaderSecondary){HeaderSecondary=_flarumComponentsHeaderSecondary.default},function(_flarumComponentsComposer){Composer=_flarumComponentsComposer.default},function(_flarumComponentsModalManager){ModalManager=_flarumComponentsModalManager.default},function(_flarumComponentsAlertManager){AlertManager=_flarumComponentsAlertManager.default}],execute:function(){}}}),System.register("flarum/initializers/components",["flarum/components/CommentPost","flarum/components/DiscussionRenamedPost","flarum/components/PostedActivity","flarum/components/JoinedActivity","flarum/components/DiscussionRenamedNotification"],function(_export,_context){function components(app){app.postComponents.comment=CommentPost,app.postComponents.discussionRenamed=DiscussionRenamedPost,app.notificationComponents.discussionRenamed=DiscussionRenamedNotification}var CommentPost,DiscussionRenamedPost,PostedActivity,JoinedActivity,DiscussionRenamedNotification;return _export("default",components),{setters:[function(_flarumComponentsCommentPost){CommentPost=_flarumComponentsCommentPost.default},function(_flarumComponentsDiscussionRenamedPost){DiscussionRenamedPost=_flarumComponentsDiscussionRenamedPost.default},function(_flarumComponentsPostedActivity){PostedActivity=_flarumComponentsPostedActivity.default},function(_flarumComponentsJoinedActivity){JoinedActivity=_flarumComponentsJoinedActivity.default},function(_flarumComponentsDiscussionRenamedNotification){DiscussionRenamedNotification=_flarumComponentsDiscussionRenamedNotification.default}],execute:function(){}}}),System.register("flarum/initializers/humanTime",["flarum/utils/humanTime"],function(_export,_context){function updateHumanTimes(){$("[data-humantime]").each(function(){var $this=$(this),ago=humanTimeUtil($this.attr("datetime"));$this.html(ago)})}function humanTime(){setInterval(updateHumanTimes,1e3)}var humanTimeUtil;return _export("default",humanTime),{setters:[function(_flarumUtilsHumanTime){humanTimeUtil=_flarumUtilsHumanTime.default}],execute:function(){}}}),System.register("flarum/initializers/preload",["flarum/Session"],function(_export,_context){function preload(app){app.store.pushPayload({data:app.preload.data}),app.forum=app.store.getById("forums",1),app.session=new Session(app.store.getById("users",app.preload.session.userId),app.preload.session.csrfToken)}var Session;return _export("default",preload),{setters:[function(_flarumSession){Session=_flarumSession.default}],execute:function(){}}}),System.register("flarum/initializers/routes",["flarum/components/IndexPage","flarum/components/DiscussionPage","flarum/components/PostsUserPage","flarum/components/DiscussionsUserPage","flarum/components/SettingsPage","flarum/components/NotificationsPage"],function(_export,_context){var IndexPage,DiscussionPage,PostsUserPage,DiscussionsUserPage,SettingsPage,NotificationsPage;return _export("default",function(app){app.routes={index:{path:"/all",component:IndexPage.component()},"index.filter":{path:"/:filter",component:IndexPage.component()},discussion:{path:"/d/:id",component:DiscussionPage.component()},"discussion.near":{path:"/d/:id/:near",component:DiscussionPage.component()},user:{path:"/u/:username",component:PostsUserPage.component()},"user.posts":{path:"/u/:username",component:PostsUserPage.component()},"user.discussions":{path:"/u/:username/discussions",component:DiscussionsUserPage.component()},settings:{path:"/settings",component:SettingsPage.component()},notifications:{path:"/notifications",component:NotificationsPage.component()}},app.route.discussion=function(discussion,near){return app.route(near&&1!==near?"discussion.near":"discussion",{id:discussion.id()+"-"+discussion.slug(),near:near&&1!==near?near:void 0})},app.route.post=function(post){return app.route.discussion(post.discussion(),post.number())},app.route.user=function(user){return app.route("user",{username:user.username()})}}),{setters:[function(_flarumComponentsIndexPage){IndexPage=_flarumComponentsIndexPage.default},function(_flarumComponentsDiscussionPage){DiscussionPage=_flarumComponentsDiscussionPage.default},function(_flarumComponentsPostsUserPage){PostsUserPage=_flarumComponentsPostsUserPage.default},function(_flarumComponentsDiscussionsUserPage){DiscussionsUserPage=_flarumComponentsDiscussionsUserPage.default},function(_flarumComponentsSettingsPage){SettingsPage=_flarumComponentsSettingsPage.default},function(_flarumComponentsNotificationsPage){NotificationsPage=_flarumComponentsNotificationsPage.default}],execute:function(){}}}),System.register("flarum/initializers/store",["flarum/Store","flarum/models/Forum","flarum/models/User","flarum/models/Discussion","flarum/models/Post","flarum/models/Group","flarum/models/Activity","flarum/models/Notification"],function(_export,_context){function store(app){app.store=new Store({forums:Forum,users:User,discussions:Discussion,posts:Post,groups:Group,activity:Activity,notifications:Notification})}var Store,Forum,User,Discussion,Post,Group,Activity,Notification;return _export("default",store),{setters:[function(_flarumStore){Store=_flarumStore.default},function(_flarumModelsForum){Forum=_flarumModelsForum.default},function(_flarumModelsUser){User=_flarumModelsUser.default},function(_flarumModelsDiscussion){Discussion=_flarumModelsDiscussion.default},function(_flarumModelsPost){Post=_flarumModelsPost.default},function(_flarumModelsGroup){Group=_flarumModelsGroup.default},function(_flarumModelsActivity){Activity=_flarumModelsActivity.default},function(_flarumModelsNotification){Notification=_flarumModelsNotification.default}],execute:function(){}}}),System.register("flarum/Model",[],function(_export,_context){var Model;return{setters:[],execute:function(){Model=function(){function Model(){var data=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],store=arguments.length<=1||void 0===arguments[1]?null:arguments[1];babelHelpers.classCallCheck(this,Model),this.data=data,this.freshness=new Date,this.exists=!1,this.store=store}return babelHelpers.createClass(Model,[{key:"id",value:function(){return this.data.id}},{key:"attribute",value:function(_attribute){return this.data.attributes[_attribute]}},{key:"pushData",value:function(data){for(var key in data)if("object"===babelHelpers.typeof(data[key])){this.data[key]=this.data[key]||{};for(var innerKey in data[key])data[key][innerKey]instanceof Model&&(data[key][innerKey]={data:Model.getIdentifier(data[key][innerKey])}),this.data[key][innerKey]=data[key][innerKey]}else this.data[key]=data[key];this.freshness=new Date}},{key:"pushAttributes",value:function(attributes){this.pushData({attributes:attributes})}},{key:"save",value:function(attributes){var _this=this,options=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],data={type:this.data.type,id:this.data.id,attributes:attributes};if(attributes.relationships){data.relationships={};for(var key in attributes.relationships){var model=attributes.relationships[key];data.relationships[key]={data:model instanceof Array?model.map(Model.getIdentifier):Model.getIdentifier(model)}}delete attributes.relationships}var oldData=this.copyData();this.pushData(data);var request={data:data};return options.meta&&(request.meta=options.meta),app.request(babelHelpers.extends({method:this.exists?"PATCH":"POST",url:app.forum.attribute("apiUrl")+this.apiEndpoint(),data:request},options)).then(function(payload){return _this.store.data[payload.data.type]=_this.store.data[payload.data.type]||{},_this.store.data[payload.data.type][payload.data.id]=_this,_this.store.pushPayload(payload)},function(response){throw _this.pushData(oldData),m.lazyRedraw(),response})}},{key:"delete",value:function(data){var _this2=this,options=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return this.exists?app.request(babelHelpers.extends({method:"DELETE",url:app.forum.attribute("apiUrl")+this.apiEndpoint(),data:data},options)).then(function(){_this2.exists=!1,_this2.store.remove(_this2)}):m.deferred.resolve().promise}},{key:"apiEndpoint",value:function(){return"/"+this.data.type+(this.exists?"/"+this.data.id:"")}},{key:"copyData",value:function(){return JSON.parse(JSON.stringify(this.data))}}],[{key:"attribute",value:function(name,transform){return function(){var value=this.data.attributes&&this.data.attributes[name];return transform?transform(value):value}}},{key:"hasOne",value:function(name){return function(){if(this.data.relationships){var relationship=this.data.relationships[name];if(relationship)return app.store.getById(relationship.data.type,relationship.data.id)}return!1}}},{key:"hasMany",value:function(name){return function(){if(this.data.relationships){var relationship=this.data.relationships[name];if(relationship)return relationship.data.map(function(data){return app.store.getById(data.type,data.id)})}return!1}}},{key:"transformDate",value:function(value){return value?new Date(value):null}},{key:"getIdentifier",value:function(model){return{type:model.data.type,id:model.data.id}}}]),Model}(),_export("default",Model)}}}),System.register("flarum/models/Discussion",["flarum/Model","flarum/utils/mixin","flarum/utils/computed","flarum/utils/ItemList","flarum/components/Badge"],function(_export,_context){var Model,mixin,computed,ItemList,Badge,Discussion;return{setters:[function(_flarumModel){Model=_flarumModel.default},function(_flarumUtilsMixin){mixin=_flarumUtilsMixin.default},function(_flarumUtilsComputed){computed=_flarumUtilsComputed.default},function(_flarumUtilsItemList){ItemList=_flarumUtilsItemList.default},function(_flarumComponentsBadge){Badge=_flarumComponentsBadge.default}],execute:function(){Discussion=function(_Model){function Discussion(){return babelHelpers.classCallCheck(this,Discussion),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(Discussion).apply(this,arguments))}return babelHelpers.inherits(Discussion,_Model),Discussion}(Model),_export("default",Discussion),babelHelpers.extends(Discussion.prototype,{title:Model.attribute("title"),slug:Model.attribute("slug"),startTime:Model.attribute("startTime",Model.transformDate),startUser:Model.hasOne("startUser"),startPost:Model.hasOne("startPost"),lastTime:Model.attribute("lastTime",Model.transformDate),lastUser:Model.hasOne("lastUser"),lastPost:Model.hasOne("lastPost"),lastPostNumber:Model.attribute("lastPostNumber"),commentsCount:Model.attribute("commentsCount"),repliesCount:computed("commentsCount",function(commentsCount){return Math.max(0,commentsCount-1)}),posts:Model.hasMany("posts"),relevantPosts:Model.hasMany("relevantPosts"),readTime:Model.attribute("readTime",Model.transformDate),readNumber:Model.attribute("readNumber"),isUnread:computed("unreadCount",function(unreadCount){return!!unreadCount}),isRead:computed("unreadCount",function(unreadCount){return app.session.user&&!unreadCount}),hideTime:Model.attribute("hideTime",Model.transformDate),hideUser:Model.hasOne("hideUser"),isHidden:computed("hideTime","commentsCount",function(hideTime,commentsCount){return!!hideTime||0===commentsCount}),canReply:Model.attribute("canReply"),canRename:Model.attribute("canRename"),canHide:Model.attribute("canHide"),canDelete:Model.attribute("canDelete"),removePost:function(id){var relationships=this.data.relationships,posts=relationships&&relationships.posts;posts&&posts.data.some(function(data,i){if(id===data.id)return posts.data.splice(i,1),!0})},unreadCount:function(){var user=app.session.user;return user&&user.readTime()<this.lastTime()?Math.max(0,this.lastPostNumber()-(this.readNumber()||0)):0},badges:function(){var items=new ItemList;return this.isHidden()&&items.add("hidden",m(Badge,{type:"hidden",icon:"trash",label:app.translator.trans("core.lib.badge.hidden_tooltip")})),items},postIds:function(){var posts=this.data.relationships.posts;return posts?posts.data.map(function(link){return link.id}):[]}}),_export("default",Discussion)}}}),System.register("flarum/models/Forum",["flarum/Model","flarum/utils/mixin"],function(_export,_context){var Model,mixin,Forum;return{setters:[function(_flarumModel){Model=_flarumModel.default},function(_flarumUtilsMixin){mixin=_flarumUtilsMixin.default}],execute:function(){Forum=function(_Model){function Forum(){return babelHelpers.classCallCheck(this,Forum),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(Forum).apply(this,arguments))}return babelHelpers.inherits(Forum,_Model),babelHelpers.createClass(Forum,[{key:"apiEndpoint",value:function(){return"/forum"}}]),Forum}(Model),_export("default",Forum)}}}),System.register("flarum/models/Group",["flarum/Model","flarum/utils/mixin"],function(_export,_context){var Model,mixin,Group;return{setters:[function(_flarumModel){Model=_flarumModel.default},function(_flarumUtilsMixin){mixin=_flarumUtilsMixin.default}],execute:function(){Group=function(_Model){function Group(){return babelHelpers.classCallCheck(this,Group),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(Group).apply(this,arguments))}return babelHelpers.inherits(Group,_Model),Group}(Model),babelHelpers.extends(Group.prototype,{nameSingular:Model.attribute("nameSingular"),namePlural:Model.attribute("namePlural"),color:Model.attribute("color"),icon:Model.attribute("icon")}),Group.ADMINISTRATOR_ID="1",Group.GUEST_ID="2",Group.MEMBER_ID="3",_export("default",Group)}}}),System.register("flarum/models/Notification",["flarum/Model","flarum/utils/mixin","flarum/utils/computed"],function(_export,_context){var Model,mixin,computed,Notification;return{setters:[function(_flarumModel){Model=_flarumModel.default},function(_flarumUtilsMixin){mixin=_flarumUtilsMixin.default},function(_flarumUtilsComputed){computed=_flarumUtilsComputed.default}],execute:function(){Notification=function(_Model){function Notification(){return babelHelpers.classCallCheck(this,Notification),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(Notification).apply(this,arguments))}return babelHelpers.inherits(Notification,_Model),Notification}(Model),_export("default",Notification),babelHelpers.extends(Notification.prototype,{contentType:Model.attribute("contentType"),subjectId:Model.attribute("subjectId"),content:Model.attribute("content"),time:Model.attribute("time",Model.date),isRead:Model.attribute("isRead"),unreadCount:Model.attribute("unreadCount"),additionalUnreadCount:computed("unreadCount",function(unreadCount){return Math.max(0,unreadCount-1)}),user:Model.hasOne("user"),sender:Model.hasOne("sender"),subject:Model.hasOne("subject")}),_export("default",Notification)}}}),System.register("flarum/models/Post",["flarum/Model","flarum/utils/mixin","flarum/utils/computed","flarum/utils/string"],function(_export,_context){var Model,mixin,computed,getPlainContent,Post;return{setters:[function(_flarumModel){Model=_flarumModel.default},function(_flarumUtilsMixin){mixin=_flarumUtilsMixin.default},function(_flarumUtilsComputed){computed=_flarumUtilsComputed.default},function(_flarumUtilsString){getPlainContent=_flarumUtilsString.getPlainContent}],execute:function(){Post=function(_Model){function Post(){return babelHelpers.classCallCheck(this,Post),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(Post).apply(this,arguments))}return babelHelpers.inherits(Post,_Model),Post}(Model),_export("default",Post),babelHelpers.extends(Post.prototype,{number:Model.attribute("number"),discussion:Model.hasOne("discussion"),time:Model.attribute("time",Model.transformDate),user:Model.hasOne("user"),contentType:Model.attribute("contentType"),content:Model.attribute("content"),contentHtml:Model.attribute("contentHtml"),contentPlain:computed("contentHtml",getPlainContent),editTime:Model.attribute("editTime",Model.transformDate),editUser:Model.hasOne("editUser"),isEdited:computed("editTime",function(editTime){return!!editTime}),hideTime:Model.attribute("hideTime",Model.transformDate),hideUser:Model.hasOne("hideUser"),isHidden:computed("hideTime",function(hideTime){return!!hideTime}),canEdit:Model.attribute("canEdit"),canDelete:Model.attribute("canDelete")}),_export("default",Post)}}}),System.register("flarum/models/User",["flarum/Model","flarum/utils/mixin","flarum/utils/stringToColor","flarum/utils/ItemList","flarum/utils/computed","flarum/components/GroupBadge"],function(_export,_context){var Model,mixin,stringToColor,ItemList,computed,GroupBadge,User;return{setters:[function(_flarumModel){Model=_flarumModel.default},function(_flarumUtilsMixin){mixin=_flarumUtilsMixin.default},function(_flarumUtilsStringToColor){stringToColor=_flarumUtilsStringToColor.default},function(_flarumUtilsItemList){ItemList=_flarumUtilsItemList.default},function(_flarumUtilsComputed){computed=_flarumUtilsComputed.default},function(_flarumComponentsGroupBadge){GroupBadge=_flarumComponentsGroupBadge.default}],execute:function(){User=function(_Model){function User(){return babelHelpers.classCallCheck(this,User),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(User).apply(this,arguments))}return babelHelpers.inherits(User,_Model),User}(Model),_export("default",User),babelHelpers.extends(User.prototype,{username:Model.attribute("username"),email:Model.attribute("email"),isActivated:Model.attribute("isActivated"),password:Model.attribute("password"),avatarUrl:Model.attribute("avatarUrl"),bio:Model.attribute("bio"),bioHtml:computed("bio",function(bio){return bio?"<p>"+$("<div/>").text(bio).html().replace(/\n/g,"<br>").autoLink({rel:"nofollow"})+"</p>":""}),preferences:Model.attribute("preferences"),groups:Model.hasMany("groups"),joinTime:Model.attribute("joinTime",Model.transformDate),lastSeenTime:Model.attribute("lastSeenTime",Model.transformDate),readTime:Model.attribute("readTime",Model.transformDate),unreadNotificationsCount:Model.attribute("unreadNotificationsCount"),newNotificationsCount:Model.attribute("newNotificationsCount"),discussionsCount:Model.attribute("discussionsCount"),commentsCount:Model.attribute("commentsCount"),canEdit:Model.attribute("canEdit"),canDelete:Model.attribute("canDelete"),avatarColor:null,color:computed("username","avatarUrl","avatarColor",function(username,avatarUrl,avatarColor){return avatarColor?"rgb("+avatarColor.join(", ")+")":avatarUrl?(this.calculateAvatarColor(),""):"#"+stringToColor(username)}),isOnline:function(){return this.lastSeenTime()>moment().subtract(5,"minutes").toDate()},badges:function(){var items=new ItemList,groups=this.groups();return groups&&groups.forEach(function(group){items.add("group"+group.id(),GroupBadge.component({group:group}))}),items},calculateAvatarColor:function(){var image=new Image,user=this;image.onload=function(){var colorThief=new ColorThief;user.avatarColor=colorThief.getColor(this),user.freshness=new Date,m.redraw()},image.src=this.avatarUrl()},savePreferences:function(newPreferences){var preferences=this.preferences();return babelHelpers.extends(preferences,newPreferences),this.save({preferences:preferences})}}),_export("default",User)}}}),System.register("flarum/Session",[],function(_export,_context){var Session;return{setters:[],execute:function(){Session=function(){function Session(user,csrfToken){babelHelpers.classCallCheck(this,Session),this.user=user,this.csrfToken=csrfToken}return babelHelpers.createClass(Session,[{key:"login",value:function(identification,password){var options=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return app.request(babelHelpers.extends({method:"POST",url:app.forum.attribute("baseUrl")+"/login",data:{identification:identification,password:password}},options))}},{key:"logout",value:function(){window.location=app.forum.attribute("baseUrl")+"/logout?token="+this.csrfToken}}]),Session}(),_export("default",Session)}}}),System.register("flarum/Store",[],function(_export,_context){var Store;return{setters:[],execute:function(){Store=function(){function Store(models){babelHelpers.classCallCheck(this,Store),this.data={},this.models=models}return babelHelpers.createClass(Store,[{key:"pushPayload",value:function(payload){payload.included&&payload.included.map(this.pushObject.bind(this));var result=payload.data instanceof Array?payload.data.map(this.pushObject.bind(this)):this.pushObject(payload.data);return result.payload=payload,result}},{key:"pushObject",value:function(data){if(!this.models[data.type])return null;var type=this.data[data.type]=this.data[data.type]||{};return type[data.id]?type[data.id].pushData(data):type[data.id]=this.createRecord(data.type,data),type[data.id].exists=!0,type[data.id]}},{key:"find",value:function(type,id){var query=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],options=arguments.length<=3||void 0===arguments[3]?{}:arguments[3],data=query,url=app.forum.attribute("apiUrl")+"/"+type;return id instanceof Array?url+="?filter[id]="+id.join(","):"object"===("undefined"==typeof id?"undefined":babelHelpers.typeof(id))?data=id:id&&(url+="/"+id),app.request(babelHelpers.extends({method:"GET",url:url,data:data},options)).then(this.pushPayload.bind(this))}},{key:"getById",value:function(type,id){return this.data[type]&&this.data[type][id]}},{key:"getBy",value:function(type,key,value){return this.all(type).filter(function(model){return model[key]()===value})[0]}},{key:"all",value:function(type){var records=this.data[type];return records?Object.keys(records).map(function(id){return records[id]}):[]}},{key:"remove",value:function(model){delete this.data[model.data.type][model.id()]}},{key:"createRecord",value:function(type){var data=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return data.type=data.type||type,new this.models[type](data,this)}}]),Store}(),_export("default",Store)}}}),System.register("flarum/Translator",["flarum/models/User","flarum/helpers/username","flarum/utils/extractText","flarum/utils/extract"],function(_export,_context){var User,username,extractText,extract,Translator;return{setters:[function(_flarumModelsUser){User=_flarumModelsUser.default},function(_flarumHelpersUsername){username=_flarumHelpersUsername.default},function(_flarumUtilsExtractText){extractText=_flarumUtilsExtractText.default},function(_flarumUtilsExtract){extract=_flarumUtilsExtract.default}],execute:function(){Translator=function(){function Translator(){babelHelpers.classCallCheck(this,Translator),this.translations={},this.locale=null}return babelHelpers.createClass(Translator,[{key:"trans",value:function(id,parameters){var translation=this.translations[id];return translation?this.apply(translation,parameters||{}):id}},{key:"transChoice",value:function(id,number,parameters){var translation=this.translations[id];return translation?(number=parseInt(number,10),translation=this.pluralize(translation,number),this.apply(translation,parameters||{})):id}},{key:"apply",value:function(translation,input){if("user"in input){var user=extract(input,"user");input.username||(input.username=username(user))}translation=translation.split(new RegExp("({[a-z0-9_]+}|</?[a-z0-9_]+>)","gi"));var hydrated=[],open=[hydrated];return translation.forEach(function(part){var match=part.match(new RegExp("{([a-z0-9_]+)}|<(/?)([a-z0-9_]+)>","i"));if(match){if(match[1])open[0].push(input[match[1]]);else if(match[3])if(match[2])open.shift();else{var tag=input[match[3]]||[];open[0].push(tag),open.unshift(tag.children||tag)}}else open[0].push(part)}),hydrated.filter(function(part){return part})}},{key:"pluralize",value:function(translation,number){var _this=this,sPluralRegex=new RegExp(/^\w+\: +(.+)$/),cPluralRegex=new RegExp(/^\s*((\{\s*(\-?\d+[\s*,\s*\-?\d+]*)\s*\})|([\[\]])\s*(-Inf|\-?\d+)\s*,\s*(\+?Inf|\-?\d+)\s*([\[\]]))\s?(.+?)$/),iPluralRegex=new RegExp(/^\s*(\{\s*(\-?\d+[\s*,\s*\-?\d+]*)\s*\})|([\[\]])\s*(-Inf|\-?\d+)\s*,\s*(\+?Inf|\-?\d+)\s*([\[\]])/),standardRules=[],explicitRules=[];return translation.split("|").forEach(function(part){if(cPluralRegex.test(part)){var matches=part.match(cPluralRegex);explicitRules[matches[0]]=matches[matches.length-1]}else if(sPluralRegex.test(part)){var _matches=part.match(sPluralRegex);standardRules.push(_matches[1])}else standardRules.push(part)}),explicitRules.forEach(function(rule,e){if(iPluralRegex.test(e)){var matches=e.match(iPluralRegex);if(matches[1]){var ns=matches[2].split(",");for(var n in ns)if(number==ns[n])return explicitRules[e]}else{var leftNumber=_this.convertNumber(matches[4]),rightNumber=_this.convertNumber(matches[5]);if(("["===matches[3]?number>=leftNumber:number>leftNumber)&&("]"===matches[6]?number<=rightNumber:number<rightNumber))return explicitRules[e]}}}),standardRules[this.pluralPosition(number,this.locale)]||standardRules[0]||void 0}},{key:"convertNumber",value:function(number){return"-Inf"===number?Number.NEGATIVE_INFINITY:"+Inf"===number||"Inf"===number?Number.POSITIVE_INFINITY:parseInt(number,10)}},{key:"pluralPosition",value:function(number,locale){switch("pt_BR"===locale&&(locale="xbr"),locale.length>3&&(locale=locale.split("_")[0]),locale){case"bo":case"dz":case"id":case"ja":case"jv":case"ka":case"km":case"kn":case"ko":case"ms":case"th":case"tr":case"vi":case"zh":return 0;case"af":case"az":case"bn":case"bg":case"ca":case"da":case"de":case"el":case"en":case"eo":case"es":case"et":case"eu":case"fa":case"fi":case"fo":case"fur":case"fy":case"gl":case"gu":case"ha":case"he":case"hu":case"is":case"it":case"ku":case"lb":case"ml":case"mn":case"mr":case"nah":case"nb":case"ne":case"nl":case"nn":case"no":case"om":case"or":case"pa":case"pap":case"ps":case"pt":case"so":case"sq":case"sv":case"sw":case"ta":case"te":case"tk":case"ur":case"zu":return 1==number?0:1;case"am":case"bh":case"fil":case"fr":case"gun":case"hi":case"ln":case"mg":case"nso":case"xbr":case"ti":case"wa":return 0===number||1==number?0:1;case"be":case"bs":case"hr":case"ru":case"sr":case"uk":return number%10==1&&number%100!=11?0:number%10>=2&&number%10<=4&&(number%100<10||number%100>=20)?1:2;case"cs":case"sk":return 1==number?0:number>=2&&number<=4?1:2;case"ga":return 1==number?0:2==number?1:2;case"lt":return number%10==1&&number%100!=11?0:number%10>=2&&(number%100<10||number%100>=20)?1:2;case"sl":return number%100==1?0:number%100==2?1:number%100==3||number%100==4?2:3;case"mk":return number%10==1?0:1;case"mt":return 1==number?0:0===number||number%100>1&&number%100<11?1:number%100>10&&number%100<20?2:3;case"lv":return 0===number?0:number%10==1&&number%100!=11?1:2;case"pl":return 1==number?0:number%10>=2&&number%10<=4&&(number%100<12||number%100>14)?1:2;case"cy":return 1==number?0:2==number?1:8==number||11==number?2:3;case"ro":return 1==number?0:0===number||number%100>0&&number%100<20?1:2;case"ar":return 0===number?0:1==number?1:2==number?2:number>=3&&number<=10?3:number>=11&&number<=99?4:5;default:return 0}}}]),Translator}(),_export("default",Translator)}}}),System.register("flarum/utils/abbreviateNumber",[],function(_export,_context){function abbreviateNumber(number){return number>=1e6?Math.floor(number/1e6)+app.translator.trans("core.lib.number_suffix.mega_text"):number>=1e3?Math.floor(number/1e3)+app.translator.trans("core.lib.number_suffix.kilo_text"):number.toString()}return _export("default",abbreviateNumber),{setters:[],execute:function(){}}}),System.register("flarum/utils/affixSidebar",[],function(_export,_context){function affixSidebar(element,isInitialized){var _this=this;if(!isInitialized){var $sidebar=$(element),$header=$("#header"),$footer=$("#footer");$sidebar.outerHeight(!0)>$(window).height()-$header.outerHeight(!0)||$sidebar.find("> ul").affix({offset:{top:function(){return $sidebar.offset().top-$header.outerHeight(!0)-parseInt($sidebar.css("margin-top"),10)},bottom:function(){return _this.bottom=$footer.outerHeight(!0)}}})}}return _export("default",affixSidebar),{setters:[],execute:function(){}}}),System.register("flarum/utils/anchorScroll",[],function(_export,_context){function anchorScroll(element,callback){var $window=$(window),relativeScroll=$(element).offset().top-$window.scrollTop();callback(),$window.scrollTop($(element).offset().top-relativeScroll)}return _export("default",anchorScroll),{setters:[],execute:function(){}}}),System.register("flarum/utils/classList",[],function(_export,_context){function classList(classes){var classNames=void 0;if(classes instanceof Array)classNames=classes.filter(function(name){return name});else{classNames=[];for(var i in classes)classes[i]&&classNames.push(i)}return classNames.join(" ")}return _export("default",classList),{setters:[],execute:function(){}}}),System.register("flarum/utils/computed",[],function(_export,_context){function computed(){for(var _len=arguments.length,dependentKeys=Array(_len),_key=0;_key<_len;_key++)dependentKeys[_key]=arguments[_key];var keys=dependentKeys.slice(0,-1),compute=dependentKeys.slice(-1)[0],dependentValues={},computedValue=void 0;return function(){var _this=this,recompute=!1;return keys.forEach(function(key){var value="function"==typeof _this[key]?_this[key]():_this[key];dependentValues[key]!==value&&(recompute=!0,dependentValues[key]=value)}),recompute&&(computedValue=compute.apply(this,keys.map(function(key){return dependentValues[key]}))),computedValue}}return _export("default",computed),{setters:[],execute:function(){}}}),System.register("flarum/utils/DiscussionControls",["flarum/components/DiscussionPage","flarum/components/ReplyComposer","flarum/components/LogInModal","flarum/components/Button","flarum/components/Separator","flarum/utils/ItemList","flarum/utils/extractText"],function(_export,_context){var DiscussionPage,ReplyComposer,LogInModal,Button,Separator,ItemList,extractText;return{setters:[function(_flarumComponentsDiscussionPage){DiscussionPage=_flarumComponentsDiscussionPage.default},function(_flarumComponentsReplyComposer){ReplyComposer=_flarumComponentsReplyComposer.default},function(_flarumComponentsLogInModal){LogInModal=_flarumComponentsLogInModal.default},function(_flarumComponentsButton){Button=_flarumComponentsButton.default},function(_flarumComponentsSeparator){
Separator=_flarumComponentsSeparator.default},function(_flarumUtilsItemList){ItemList=_flarumUtilsItemList.default},function(_flarumUtilsExtractText){extractText=_flarumUtilsExtractText.default}],execute:function(){_export("default",{controls:function(discussion,context){var _this=this,items=new ItemList;return["user","moderation","destructive"].forEach(function(section){var controls=_this[section+"Controls"](discussion,context).toArray();controls.length&&(controls.forEach(function(item){return items.add(item.itemName,item)}),items.add(section+"Separator",Separator.component()))}),items},userControls:function(discussion,context){var items=new ItemList;return context instanceof DiscussionPage&&items.add("reply",!app.session.user||discussion.canReply()?Button.component({icon:"reply",children:app.translator.trans(app.session.user?"core.forum.discussion_controls.reply_button":"core.forum.discussion_controls.log_in_to_reply_button"),onclick:this.replyAction.bind(discussion,!0,!1)}):Button.component({icon:"reply",children:app.translator.trans("core.forum.discussion_controls.cannot_reply_button"),className:"disabled",title:app.translator.trans("core.forum.discussion_controls.cannot_reply_text")})),items},moderationControls:function(discussion){var items=new ItemList;return discussion.canRename()&&items.add("rename",Button.component({icon:"pencil",children:app.translator.trans("core.forum.discussion_controls.rename_button"),onclick:this.renameAction.bind(discussion)})),items},destructiveControls:function(discussion){var items=new ItemList;return discussion.isHidden()?discussion.canDelete()&&(items.add("restore",Button.component({icon:"reply",children:app.translator.trans("core.forum.discussion_controls.restore_button"),onclick:this.restoreAction.bind(discussion),disabled:0===discussion.commentsCount()})),items.add("delete",Button.component({icon:"times",children:app.translator.trans("core.forum.discussion_controls.delete_forever_button"),onclick:this.deleteAction.bind(discussion)}))):discussion.canHide()&&items.add("hide",Button.component({icon:"trash-o",children:app.translator.trans("core.forum.discussion_controls.delete_button"),onclick:this.hideAction.bind(discussion)})),items},replyAction:function(goToLast,forceRefresh){var _this2=this,deferred=m.deferred(),reply=function(){if(_this2.canReply()){goToLast&&app.viewingDiscussion(_this2)&&app.current.stream.goToLast();var component=app.composer.component;app.composingReplyTo(_this2)&&!forceRefresh||(component=new ReplyComposer({user:app.session.user,discussion:_this2}),app.composer.load(component)),app.composer.show(),deferred.resolve(component)}else deferred.reject()};return app.session.user?reply():app.modal.show(new LogInModal({onlogin:function(){return app.current.one("loaded",reply)}})),deferred.promise},hideAction:function(){return this.pushAttributes({hideTime:new Date,hideUser:app.session.user}),this.save({isHidden:!0})},restoreAction:function(){return this.pushAttributes({hideTime:null,hideUser:null}),this.save({isHidden:!1})},deleteAction:function(){var _this3=this;if(confirm(extractText(app.translator.trans("core.forum.discussion_controls.delete_confirmation"))))return app.viewingDiscussion(this)&&app.history.back(),this.delete().then(function(){app.cache.discussionList&&(app.cache.discussionList.removeDiscussion(_this3),m.redraw())})},renameAction:function(){var _this4=this,currentTitle=this.title(),title=prompt(extractText(app.translator.trans("core.forum.discussion_controls.rename_text")),currentTitle);if(title&&title!==currentTitle)return this.save({title:title}).then(function(){app.viewingDiscussion(_this4)&&app.current.stream.update(),m.redraw()})}})}}}),System.register("flarum/utils/Drawer",[],function(_export,_context){var Drawer;return{setters:[],execute:function(){Drawer=function(){function Drawer(){var _this=this;babelHelpers.classCallCheck(this,Drawer),$("#content").click(function(e){_this.isOpen()&&(e.preventDefault(),_this.hide())})}return babelHelpers.createClass(Drawer,[{key:"isOpen",value:function(){return $("#app").hasClass("drawerOpen")}},{key:"hide",value:function(){$("#app").removeClass("drawerOpen"),this.$backdrop&&this.$backdrop.remove()}},{key:"show",value:function(){var _this2=this;$("#app").addClass("drawerOpen"),this.$backdrop=$("<div/>").addClass("drawer-backdrop fade").appendTo("body").click(function(){return _this2.hide()}),setTimeout(function(){return _this2.$backdrop.addClass("in")})}}]),Drawer}(),_export("default",Drawer)}}}),System.register("flarum/utils/evented",[],function(_export,_context){return{setters:[],execute:function(){_export("default",{handlers:null,getHandlers:function(event){return this.handlers=this.handlers||{},this.handlers[event]=this.handlers[event]||[],this.handlers[event]},trigger:function(event){for(var _this=this,_len=arguments.length,args=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)args[_key-1]=arguments[_key];this.getHandlers(event).forEach(function(handler){return handler.apply(_this,args)})},on:function(event,handler){this.getHandlers(event).push(handler)},one:function(event,handler){var wrapper=function wrapper(){handler.apply(this,arguments),this.off(event,wrapper)};this.getHandlers(event).push(wrapper)},off:function(event,handler){var handlers=this.getHandlers(event),index=handlers.indexOf(handler);index!==-1&&handlers.splice(index,1)}})}}}),System.register("flarum/utils/extract",[],function(_export,_context){function extract(object,property){var value=object[property];return delete object[property],value}return _export("default",extract),{setters:[],execute:function(){}}}),System.register("flarum/utils/extractText",[],function(_export,_context){function extractText(vdom){var text="";return text+=vdom instanceof Array?vdom.map(function(element){return extractText(element)}).join(""):"object"===("undefined"==typeof vdom?"undefined":babelHelpers.typeof(vdom))?extractText(vdom.children):vdom}return _export("default",extractText),{setters:[],execute:function(){}}}),System.register("flarum/utils/formatNumber",[],function(_export,_context){function formatNumber(number){return number.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}return _export("default",formatNumber),{setters:[],execute:function(){}}}),System.register("flarum/utils/History",[],function(_export,_context){var History;return{setters:[],execute:function(){History=function(){function History(defaultRoute){babelHelpers.classCallCheck(this,History),this.stack=[]}return babelHelpers.createClass(History,[{key:"getCurrent",value:function(){return this.stack[this.stack.length-1]}},{key:"getPrevious",value:function(){return this.stack[this.stack.length-2]}},{key:"push",value:function(name,title){var url=arguments.length<=2||void 0===arguments[2]?m.route():arguments[2],secondTop=this.stack[this.stack.length-2];secondTop&&secondTop.name===name&&this.stack.pop();var top=this.getCurrent();top&&top.name===name?babelHelpers.extends(top,{url:url,title:title}):this.stack.push({name:name,url:url,title:title})}},{key:"canGoBack",value:function(){return this.stack.length>1}},{key:"back",value:function(){this.stack.pop(),m.route(this.getCurrent().url)}},{key:"backUrl",value:function(){var secondTop=this.stack[this.stack.length-2];return secondTop.url}},{key:"home",value:function(){this.stack.splice(0),m.route("/")}}]),History}(),_export("default",History)}}}),System.register("flarum/utils/humanTime",[],function(_export,_context){function humanTime(time){var m=moment(time),day=864e5,diff=m.diff(moment()),ago=null;return ago=diff<-30*day?m.year()===moment().year()?m.format("D MMM"):m.format("MMM 'YY"):m.fromNow()}return _export("default",humanTime),{setters:[],execute:function(){}}}),System.register("flarum/utils/ItemList",[],function(_export,_context){var Item,ItemList;return{setters:[],execute:function(){Item=function Item(content,priority){babelHelpers.classCallCheck(this,Item),this.content=content,this.priority=priority},ItemList=function(){function ItemList(){babelHelpers.classCallCheck(this,ItemList),this.items={}}return babelHelpers.createClass(ItemList,[{key:"has",value:function(key){return!!this.items[key]}},{key:"get",value:function(key){return this.items[key].content}},{key:"add",value:function(key,content){var priority=arguments.length<=2||void 0===arguments[2]?0:arguments[2];this.items[key]=new Item(content,priority)}},{key:"replace",value:function(key){var content=arguments.length<=1||void 0===arguments[1]?null:arguments[1],priority=arguments.length<=2||void 0===arguments[2]?null:arguments[2];this.items[key]&&(null!==content&&(this.items[key].content=content),null!==priority&&(this.items[key].priority=priority))}},{key:"remove",value:function(key){delete this.items[key]}},{key:"merge",value:function(items){for(var i in items.items)items.items.hasOwnProperty(i)&&items.items[i]instanceof Item&&(this.items[i]=items.items[i])}},{key:"toArray",value:function(){var items=[];for(var i in this.items)this.items.hasOwnProperty(i)&&this.items[i]instanceof Item&&(this.items[i].content=Object(this.items[i].content),this.items[i].content.itemName=i,items.push(this.items[i]),this.items[i].key=items.length);return items.sort(function(a,b){return a.priority===b.priority?a.key-b.key:a.priority>b.priority?-1:1}).map(function(item){return item.content})}}]),ItemList}(),_export("default",ItemList)}}}),System.register("flarum/utils/mapRoutes",[],function(_export,_context){function mapRoutes(routes){var basePath=arguments.length<=1||void 0===arguments[1]?"":arguments[1],map={};for(var key in routes){var route=routes[key];route.component&&(route.component.props.routeName=key),map[basePath+route.path]=route.component}return map}return _export("default",mapRoutes),{setters:[],execute:function(){}}}),System.register("flarum/utils/mixin",[],function(_export,_context){function mixin(Parent){for(var Mixed=function(_Parent){function Mixed(){return babelHelpers.classCallCheck(this,Mixed),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(Mixed).apply(this,arguments))}return babelHelpers.inherits(Mixed,_Parent),Mixed}(Parent),_len=arguments.length,mixins=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)mixins[_key-1]=arguments[_key];return mixins.forEach(function(object){babelHelpers.extends(Mixed.prototype,object)}),Mixed}return _export("default",mixin),{setters:[],execute:function(){}}}),System.register("flarum/utils/Pane",[],function(_export,_context){var Pane;return{setters:[],execute:function(){Pane=function(){function Pane(element){babelHelpers.classCallCheck(this,Pane),this.pinnedKey="panePinned",this.$element=$(element),this.pinned="true"===localStorage.getItem(this.pinnedKey),this.active=!1,this.showing=!1,this.render()}return babelHelpers.createClass(Pane,[{key:"enable",value:function(){this.active=!0,this.render()}},{key:"disable",value:function(){this.active=!1,this.showing=!1,this.render()}},{key:"show",value:function(){clearTimeout(this.hideTimeout),this.showing=!0,this.render()}},{key:"hide",value:function(){this.showing=!1,this.render()}},{key:"onmouseleave",value:function(){this.hideTimeout=setTimeout(this.hide.bind(this),250)}},{key:"togglePinned",value:function(){this.pinned=!this.pinned,localStorage.setItem(this.pinnedKey,this.pinned?"true":"false"),this.render()}},{key:"render",value:function(){this.$element.toggleClass("panePinned",this.pinned).toggleClass("hasPane",this.active).toggleClass("paneShowing",this.showing)}}]),Pane}(),_export("default",Pane)}}}),System.register("flarum/utils/patchMithril",["../Component"],function(_export,_context){function patchMithril(global){var mo=global.m,m=function m(comp){for(var _len=arguments.length,args=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)args[_key-1]=arguments[_key];if(comp.prototype&&comp.prototype instanceof Component)return comp.component.apply(comp,args);var node=mo.apply(this,arguments);return node.attrs.bidi&&m.bidi(node,node.attrs.bidi),node.attrs.route&&(node.attrs.href=node.attrs.route,node.attrs.config=m.route,delete node.attrs.route),node};Object.keys(mo).forEach(function(key){return m[key]=mo[key]}),m.lazyRedraw=function(){m.startComputation(),m.endComputation()},global.m=m}var Component;return _export("default",patchMithril),{setters:[function(_Component){Component=_Component.default}],execute:function(){}}}),System.register("flarum/utils/PostControls",["flarum/components/EditPostComposer","flarum/components/Button","flarum/components/Separator","flarum/utils/ItemList"],function(_export,_context){var EditPostComposer,Button,Separator,ItemList;return{setters:[function(_flarumComponentsEditPostComposer){EditPostComposer=_flarumComponentsEditPostComposer.default},function(_flarumComponentsButton){Button=_flarumComponentsButton.default},function(_flarumComponentsSeparator){Separator=_flarumComponentsSeparator.default},function(_flarumUtilsItemList){ItemList=_flarumUtilsItemList.default}],execute:function(){_export("default",{controls:function(post,context){var _this=this,items=new ItemList;return["user","moderation","destructive"].forEach(function(section){var controls=_this[section+"Controls"](post,context).toArray();controls.length&&(controls.forEach(function(item){return items.add(item.itemName,item)}),items.add(section+"Separator",Separator.component()))}),items},userControls:function(post,context){return new ItemList},moderationControls:function(post,context){var items=new ItemList;return"comment"===post.contentType()&&post.canEdit()&&(post.isHidden()||items.add("edit",Button.component({icon:"pencil",children:app.translator.trans("core.forum.post_controls.edit_button"),onclick:this.editAction.bind(post)}))),items},destructiveControls:function(post,context){var items=new ItemList;return"comment"!==post.contentType()||post.isHidden()?("comment"===post.contentType()&&post.canEdit()&&items.add("restore",Button.component({icon:"reply",children:app.translator.trans("core.forum.post_controls.restore_button"),onclick:this.restoreAction.bind(post)})),post.canDelete()&&items.add("delete",Button.component({icon:"times",children:app.translator.trans("core.forum.post_controls.delete_forever_button"),onclick:this.deleteAction.bind(post,context)}))):post.canEdit()&&items.add("hide",Button.component({icon:"trash-o",children:app.translator.trans("core.forum.post_controls.delete_button"),onclick:this.hideAction.bind(post)})),items},editAction:function(){app.composer.load(new EditPostComposer({post:this})),app.composer.show()},hideAction:function(){return this.pushAttributes({hideTime:new Date,hideUser:app.session.user}),this.save({isHidden:!0}).then(function(){return m.redraw()})},restoreAction:function(){return this.pushAttributes({hideTime:null,hideUser:null}),this.save({isHidden:!1}).then(function(){return m.redraw()})},deleteAction:function(context){var _this2=this;return context&&(context.loading=!0),this.delete().then(function(){var discussion=_this2.discussion();discussion.removePost(_this2.id()),discussion.postIds().length||(app.cache.discussionList&&app.cache.discussionList.removeDiscussion(discussion),app.viewingDiscussion(discussion)&&app.history.back())}).catch(function(){}).then(function(){context&&(context.loading=!1),m.redraw()})}})}}}),System.register("flarum/utils/RequestError",[],function(_export,_context){var RequestError;return{setters:[],execute:function(){RequestError=function RequestError(status,responseText,options,xhr){babelHelpers.classCallCheck(this,RequestError),this.status=status,this.responseText=responseText,this.options=options,this.xhr=xhr;try{this.response=JSON.parse(responseText)}catch(e){this.response=null}this.alert=null},_export("default",RequestError)}}}),System.register("flarum/utils/ScrollListener",[],function(_export,_context){var scroll,ScrollListener;return{setters:[],execute:function(){scroll=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||function(callback){return window.setTimeout(callback,1e3/60)},ScrollListener=function(){function ScrollListener(callback){babelHelpers.classCallCheck(this,ScrollListener),this.callback=callback,this.lastTop=-1}return babelHelpers.createClass(ScrollListener,[{key:"loop",value:function(){this.active&&(this.update(),scroll(this.loop.bind(this)))}},{key:"update",value:function(force){var top=window.pageYOffset;(this.lastTop!==top||force)&&(this.callback(top),this.lastTop=top)}},{key:"start",value:function(){this.active||(this.active=!0,this.loop())}},{key:"stop",value:function(){this.active=!1}}]),ScrollListener}(),_export("default",ScrollListener)}}}),System.register("flarum/utils/slidable",[],function(_export,_context){function slidable(element){var $element=$(element),threshold=50,$underneathLeft=void 0,$underneathRight=void 0,startX=void 0,startY=void 0,couldBeSliding=!1,isSliding=!1,pos=0,animatePos=function(newPos){var options=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];options.duration=options.duration||"fast",options.step=function(x){$(this).css("transform","translate("+x+"px, 0)")},$element.find(".Slidable-content").animate({"background-position-x":newPos},options)},reset=function(){animatePos(0,{complete:function(){$element.removeClass("sliding"),$underneathLeft.hide(),$underneathRight.hide(),isSliding=!1}})};return $element.find(".Slidable-content").on("touchstart",function(e){$underneathLeft=$element.find(".Slidable-underneath--left:not(.disabled)"),$underneathRight=$element.find(".Slidable-underneath--right:not(.disabled)"),startX=e.originalEvent.targetTouches[0].clientX,startY=e.originalEvent.targetTouches[0].clientY,couldBeSliding=!0,pos=0}).on("touchmove",function(e){var newX=e.originalEvent.targetTouches[0].clientX,newY=e.originalEvent.targetTouches[0].clientY;if(couldBeSliding&&Math.abs(newX-startX)>Math.abs(newY-startY)&&(isSliding=!0),couldBeSliding=!1,isSliding){pos=newX-startX;var toggle=function($underneath,side){if($underneath.length){var active="left"===side?pos>0:pos<0;active&&$underneath.hasClass("Slidable-underneath--elastic")&&(pos-=.5*pos),$underneath.toggle(active);var scale=Math.max(0,Math.min(1,(Math.abs(pos)-25)/threshold));$underneath.find(".icon").css("transform","scale("+scale+")")}else pos=Math["left"===side?"min":"max"](0,pos)};toggle($underneathLeft,"left"),toggle($underneathRight,"right"),$(this).css("transform","translate("+pos+"px, 0)"),$(this).css("background-position-x",pos+"px"),$element.toggleClass("sliding",!!pos),e.preventDefault()}}).on("touchend",function(){var activate=function($underneath){$underneath.click(),$underneath.hasClass("Slidable-underneath--elastic")?reset():animatePos((pos>0?1:-1)*$element.width())};$underneathRight.length&&pos<-threshold?activate($underneathRight):$underneathLeft.length&&pos>threshold?activate($underneathLeft):reset(),couldBeSliding=!1,isSliding=!1}),{reset:reset}}return _export("default",slidable),{setters:[],execute:function(){}}}),System.register("flarum/utils/string",[],function(_export,_context){return{setters:[],execute:function(){function truncate(string,length){var start=arguments.length<=2||void 0===arguments[2]?0:arguments[2];return(start>0?"...":"")+string.substring(start,start+length)+(string.length>start+length?"...":"")}function slug(string){return string.toLowerCase().replace(/[^a-z0-9]/gi,"-").replace(/-+/g,"-").replace(/-$|^-/g,"")||"-"}function getPlainContent(string){var dom=$("<div/>").html(string.replace(/(<\/p>|<br>)/g,"$1 &nbsp;"));return dom.find(getPlainContent.removeSelectors.join(",")).remove(),dom.text()}function ucfirst(string){return string.substr(0,1).toUpperCase()+string.substr(1)}_export("truncate",truncate),_export("slug",slug),_export("getPlainContent",getPlainContent),getPlainContent.removeSelectors=["blockquote","script"],_export("ucfirst",ucfirst)}}}),System.register("flarum/utils/stringToColor",[],function(_export,_context){function hsvToRgb(h,s,v){var r=void 0,g=void 0,b=void 0,i=Math.floor(6*h),f=6*h-i,p=v*(1-s),q=v*(1-f*s),t=v*(1-(1-f)*s);switch(i%6){case 0:r=v,g=t,b=p;break;case 1:r=q,g=v,b=p;break;case 2:r=p,g=v,b=t;break;case 3:r=p,g=q,b=v;break;case 4:r=t,g=p,b=v;break;case 5:r=v,g=p,b=q}return{r:Math.floor(255*r),g:Math.floor(255*g),b:Math.floor(255*b)}}function stringToColor(string){for(var num=0,i=0;i<string.length;i++)num+=string.charCodeAt(i);var hue=num%360,rgb=hsvToRgb(hue/360,.3,.9);return""+rgb.r.toString(16)+rgb.g.toString(16)+rgb.b.toString(16)}return _export("default",stringToColor),{setters:[],execute:function(){}}}),System.register("flarum/utils/SubtreeRetainer",[],function(_export,_context){var SubtreeRetainer;return{setters:[],execute:function(){SubtreeRetainer=function(){function SubtreeRetainer(){babelHelpers.classCallCheck(this,SubtreeRetainer);for(var _len=arguments.length,callbacks=Array(_len),_key=0;_key<_len;_key++)callbacks[_key]=arguments[_key];this.callbacks=callbacks,this.data={}}return babelHelpers.createClass(SubtreeRetainer,[{key:"retain",value:function(){var _this=this,needsRebuild=!1;return this.callbacks.forEach(function(callback,i){var result=callback();result!==_this.data[i]&&(_this.data[i]=result,needsRebuild=!0)}),!needsRebuild&&{subtree:"retain"}}},{key:"check",value:function(){for(var _len2=arguments.length,callbacks=Array(_len2),_key2=0;_key2<_len2;_key2++)callbacks[_key2]=arguments[_key2];this.callbacks=this.callbacks.concat(callbacks)}},{key:"invalidate",value:function(){this.data={}}}]),SubtreeRetainer}(),_export("default",SubtreeRetainer)}}}),System.register("flarum/utils/UserControls",["flarum/components/Button","flarum/components/Separator","flarum/components/EditUserModal","flarum/components/UserPage","flarum/utils/ItemList"],function(_export,_context){var Button,Separator,EditUserModal,UserPage,ItemList;return{setters:[function(_flarumComponentsButton){Button=_flarumComponentsButton.default},function(_flarumComponentsSeparator){Separator=_flarumComponentsSeparator.default},function(_flarumComponentsEditUserModal){EditUserModal=_flarumComponentsEditUserModal.default},function(_flarumComponentsUserPage){UserPage=_flarumComponentsUserPage.default},function(_flarumUtilsItemList){ItemList=_flarumUtilsItemList.default}],execute:function(){_export("default",{controls:function(discussion,context){var _this=this,items=new ItemList;return["user","moderation","destructive"].forEach(function(section){var controls=_this[section+"Controls"](discussion,context).toArray();controls.length&&(controls.forEach(function(item){return items.add(item.itemName,item)}),items.add(section+"Separator",Separator.component()))}),items},userControls:function(){return new ItemList},moderationControls:function(user){var items=new ItemList;return user.canEdit()&&items.add("edit",Button.component({icon:"pencil",children:app.translator.trans("core.forum.user_controls.edit_button"),onclick:this.editAction.bind(user)})),items},destructiveControls:function(user){var items=new ItemList;return"1"!==user.id()&&user.canDelete()&&items.add("delete",Button.component({icon:"times",children:app.translator.trans("core.forum.user_controls.delete_button"),onclick:this.deleteAction.bind(user)})),items},deleteAction:function(){var _this2=this;confirm(app.translator.trans("core.forum.user_controls.delete_confirmation"))&&this.delete().then(function(){app.current instanceof UserPage&&app.current.user===_this2?app.history.back():window.location.reload()})},editAction:function(){app.modal.show(new EditUserModal({user:this}))}})}}}),function(){function getCaretCoordinates(element,position,options){if(!isBrowser)throw new Error("textarea-caret-position#getCaretCoordinates should only be called in a browser");var debug=options&&options.debug||!1;if(debug){var el=document.querySelector("#input-textarea-caret-position-mirror-div");el&&el.parentNode.removeChild(el)}var div=document.createElement("div");div.id="input-textarea-caret-position-mirror-div",document.body.appendChild(div);var style=div.style,computed=window.getComputedStyle?getComputedStyle(element):element.currentStyle;style.whiteSpace="pre-wrap","INPUT"!==element.nodeName&&(style.wordWrap="break-word"),style.position="absolute",debug||(style.visibility="hidden"),properties.forEach(function(prop){style[prop]=computed[prop]}),isFirefox?element.scrollHeight>parseInt(computed.height)&&(style.overflowY="scroll"):style.overflow="hidden",div.textContent=element.value.substring(0,position),"INPUT"===element.nodeName&&(div.textContent=div.textContent.replace(/\s/g," "));var span=document.createElement("span");span.textContent=element.value.substring(position)||".",div.appendChild(span);var coordinates={top:span.offsetTop+parseInt(computed.borderTopWidth),left:span.offsetLeft+parseInt(computed.borderLeftWidth)};return debug?span.style.backgroundColor="#aaa":document.body.removeChild(div),coordinates}var properties=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize"],isBrowser="undefined"!=typeof window,isFirefox=isBrowser&&null!=window.mozInnerScreenX;"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=getCaretCoordinates:isBrowser&&(window.getCaretCoordinates=getCaretCoordinates)}(),System.register("flarum/emoji/addComposerAutocomplete",["flarum/extend","flarum/components/ComposerBody","flarum/emoji/components/AutocompleteDropdown"],function(_export,_context){function addComposerAutocomplete(){var emojiMap={"-1":"1f44e","+1":"1f44d","8ball":"1f3b1",a:"1f170",ab:"1f18e",abc:"1f524",abcd:"1f521",accept:"1f251",aerial_tramway:"1f6a1",airplane:"2708",alarm_clock:"23f0",alien:"1f47d",ambulance:"1f691",anchor:"2693",angel:"1f47c",anger:"1f4a2",angry:"1f620",anguished:"1f627",ant:"1f41c",apple:"1f34e",aquarius:"2652",aries:"2648",arrow_backward:"25c0",arrow_double_down:"23ec",arrow_double_up:"23eb",arrow_down:"2b07",arrow_down_small:"1f53d",arrow_forward:"25b6",arrow_heading_down:"2935",arrow_heading_up:"2934",arrow_left:"2b05",arrow_lower_left:"2199",arrow_lower_right:"2198",arrow_right:"27a1",arrow_right_hook:"21aa",arrow_up:"2b06",arrow_up_down:"2195",arrow_up_small:"1f53c",arrow_upper_left:"2196",arrow_upper_right:"2197",arrows_clockwise:"1f503",arrows_counterclockwise:"1f504",art:"1f3a8",articulated_lorry:"1f69b",astonished:"1f632",athletic_shoe:"1f45f",atm:"1f3e7",b:"1f171",baby:"1f476",baby_bottle:"1f37c",baby_chick:"1f424",baby_symbol:"1f6bc",back:"1f519",baggage_claim:"1f6c4",balloon:"1f388",ballot_box_with_check:"2611",bamboo:"1f38d",banana:"1f34c",bangbang:"203c",bank:"1f3e6",bar_chart:"1f4ca",barber:"1f488",baseball:"26be",basketball:"1f3c0",bath:"1f6c0",bathtub:"1f6c1",battery:"1f50b",bear:"1f43b",bee:"1f41d",beer:"1f37a",beers:"1f37b",beetle:"1f41e",beginner:"1f530",bell:"1f514",bento:"1f371",bicyclist:"1f6b4",bike:"1f6b2",bikini:"1f459",bird:"1f426",birthday:"1f382",black_circle:"26ab",black_joker:"1f0cf",black_large_square:"2b1b",black_medium_small_square:"25fe",black_medium_square:"25fc",black_nib:"2712",black_small_square:"25aa",black_square_button:"1f532",blossom:"1f33c",blowfish:"1f421",blue_book:"1f4d8",blue_car:"1f699",blue_heart:"1f499",blush:"1f60a",boar:"1f417",boat:"26f5",bomb:"1f4a3",book:"1f4d6",bookmark:"1f516",bookmark_tabs:"1f4d1",books:"1f4da",boom:"1f4a5",boot:"1f462",bouquet:"1f490",bow:"1f647",bowling:"1f3b3",boy:"1f466",bread:"1f35e",bride_with_veil:"1f470",bridge_at_night:"1f309",briefcase:"1f4bc",broken_heart:"1f494",bug:"1f41b",bulb:"1f4a1",bullettrain_front:"1f685",bullettrain_side:"1f684",bus:"1f68c",busstop:"1f68f",bust_in_silhouette:"1f464",busts_in_silhouette:"1f465",cactus:"1f335",cake:"1f370",calendar:"1f4c6",calling:"1f4f2",camel:"1f42b",camera:"1f4f7",cancer:"264b",candy:"1f36c",capital_abcd:"1f520",capricorn:"2651",car:"1f697",card_index:"1f4c7",carousel_horse:"1f3a0",cat:"1f431",cat2:"1f408",cd:"1f4bf",chart:"1f4b9",chart_with_downwards_trend:"1f4c9",chart_with_upwards_trend:"1f4c8",checkered_flag:"1f3c1",cherries:"1f352",cherry_blossom:"1f338",chestnut:"1f330",chicken:"1f414",children_crossing:"1f6b8",chocolate_bar:"1f36b",christmas_tree:"1f384",church:"26ea",cinema:"1f3a6",circus_tent:"1f3aa",city_sunrise:"1f307",city_sunset:"1f306",cl:"1f191",clap:"1f44f",clapper:"1f3ac",clipboard:"1f4cb",clock1:"1f550",clock10:"1f559",clock1030:"1f565",clock11:"1f55a",clock1130:"1f566",clock12:"1f55b",clock1230:"1f567",clock130:"1f55c",clock2:"1f551",clock230:"1f55d",clock3:"1f552",clock330:"1f55e",clock4:"1f553",clock430:"1f55f",clock5:"1f554",clock530:"1f560",clock6:"1f555",clock630:"1f561",clock7:"1f556",clock730:"1f562",clock8:"1f557",clock830:"1f563",clock9:"1f558",clock930:"1f564",closed_book:"1f4d5",closed_lock_with_key:"1f510",closed_umbrella:"1f302",cloud:"2601",clubs:"2663",cn:"1f1e8-1f1f3",cocktail:"1f378",coffee:"2615",cold_sweat:"1f630",collision:"1f4a5",computer:"1f4bb",confetti_ball:"1f38a",confounded:"1f616",confused:"1f615",congratulations:"3297",construction:"1f6a7",construction_worker:"1f477",convenience_store:"1f3ea",cookie:"1f36a",cool:"1f192",cop:"1f46e",copyright:"a9",corn:"1f33d",couple:"1f46b",couple_with_heart:"1f491",couplekiss:"1f48f",cow:"1f42e",cow2:"1f404",credit_card:"1f4b3",crescent_moon:"1f319",crocodile:"1f40a",crossed_flags:"1f38c",crown:"1f451",cry:"1f622",crying_cat_face:"1f63f",crystal_ball:"1f52e",cupid:"1f498",curly_loop:"27b0",currency_exchange:"1f4b1",curry:"1f35b",custard:"1f36e",customs:"1f6c3",cyclone:"1f300",dancer:"1f483",dancers:"1f46f",dango:"1f361",dart:"1f3af",dash:"1f4a8",date:"1f4c5",de:"1f1e9-1f1ea",deciduous_tree:"1f333",department_store:"1f3ec",diamond_shape_with_a_dot_inside:"1f4a0",diamonds:"2666",disappointed:"1f61e",disappointed_relieved:"1f625",dizzy:"1f4ab",dizzy_face:"1f635",do_not_litter:"1f6af",dog:"1f436",dog2:"1f415",dollar:"1f4b5",dolls:"1f38e",dolphin:"1f42c",door:"1f6aa",doughnut:"1f369",dragon:"1f409",dragon_face:"1f432",dress:"1f457",dromedary_camel:"1f42a",droplet:"1f4a7",dvd:"1f4c0","e-mail":"1f4e7",ear:"1f442",ear_of_rice:"1f33e",earth_africa:"1f30d",earth_americas:"1f30e",earth_asia:"1f30f",egg:"1f373",eggplant:"1f346",eight:"38-20e3",eight_pointed_black_star:"2734",eight_spoked_asterisk:"2733",electric_plug:"1f50c",elephant:"1f418",email:"2709",end:"1f51a",envelope:"2709",envelope_with_arrow:"1f4e9",es:"1f1ea-1f1f8",euro:"1f4b6",european_castle:"1f3f0",european_post_office:"1f3e4",evergreen_tree:"1f332",exclamation:"2757",expressionless:"1f611",eyeglasses:"1f453",eyes:"1f440",facepunch:"1f44a",factory:"1f3ed",fallen_leaf:"1f342",family:"1f46a",fast_forward:"23e9",fax:"1f4e0",fearful:"1f628",feet:"1f43e",ferris_wheel:"1f3a1",file_folder:"1f4c1",fire:"1f525",fire_engine:"1f692",fireworks:"1f386",first_quarter_moon:"1f313",first_quarter_moon_with_face:"1f31b",fish:"1f41f",fish_cake:"1f365",fishing_pole_and_fish:"1f3a3",fist:"270a",five:"35-20e3",flags:"1f38f",flashlight:"1f526",flipper:"1f42c",floppy_disk:"1f4be",flower_playing_cards:"1f3b4",flushed:"1f633",foggy:"1f301",football:"1f3c8",footprints:"1f463",fork_and_knife:"1f374",fountain:"26f2",four:"34-20e3",four_leaf_clover:"1f340",fr:"1f1eb-1f1f7",free:"1f193",fried_shrimp:"1f364",fries:"1f35f",frog:"1f438",frowning:"1f626",fuelpump:"26fd",full_moon:"1f315",full_moon_with_face:"1f31d",game_die:"1f3b2",gb:"1f1ec-1f1e7",gem:"1f48e",gemini:"264a",ghost:"1f47b",gift:"1f381",gift_heart:"1f49d",girl:"1f467",globe_with_meridians:"1f310",goat:"1f410",golf:"26f3",grapes:"1f347",green_apple:"1f34f",green_book:"1f4d7",green_heart:"1f49a",grey_exclamation:"2755",grey_question:"2754",grimacing:"1f62c",grin:"1f601",grinning:"1f600",guardsman:"1f482",guitar:"1f3b8",gun:"1f52b",haircut:"1f487",hamburger:"1f354",hammer:"1f528",hamster:"1f439",hand:"270b",handbag:"1f45c",hankey:"1f4a9",hash:"23-20e3",hatched_chick:"1f425",hatching_chick:"1f423",headphones:"1f3a7",
hear_no_evil:"1f649",heart:"2764",heart_decoration:"1f49f",heart_eyes:"1f60d",heart_eyes_cat:"1f63b",heartbeat:"1f493",heartpulse:"1f497",hearts:"2665",heavy_check_mark:"2714",heavy_division_sign:"2797",heavy_dollar_sign:"1f4b2",heavy_exclamation_mark:"2757",heavy_minus_sign:"2796",heavy_multiplication_x:"2716",heavy_plus_sign:"2795",helicopter:"1f681",herb:"1f33f",hibiscus:"1f33a",high_brightness:"1f506",high_heel:"1f460",hocho:"1f52a",honey_pot:"1f36f",honeybee:"1f41d",horse:"1f434",horse_racing:"1f3c7",hospital:"1f3e5",hotel:"1f3e8",hotsprings:"2668",hourglass:"231b",hourglass_flowing_sand:"23f3",house:"1f3e0",house_with_garden:"1f3e1",hushed:"1f62f",ice_cream:"1f368",icecream:"1f366",id:"1f194",ideograph_advantage:"1f250",imp:"1f47f",inbox_tray:"1f4e5",incoming_envelope:"1f4e8",information_desk_person:"1f481",information_source:"2139",innocent:"1f607",interrobang:"2049",iphone:"1f4f1",it:"1f1ee-1f1f9",izakaya_lantern:"1f3ee",jack_o_lantern:"1f383",japan:"1f5fe",japanese_castle:"1f3ef",japanese_goblin:"1f47a",japanese_ogre:"1f479",jeans:"1f456",joy:"1f602",joy_cat:"1f639",jp:"1f1ef-1f1f5",key:"1f511",keycap_ten:"1f51f",kimono:"1f458",kiss:"1f48b",kissing:"1f617",kissing_cat:"1f63d",kissing_closed_eyes:"1f61a",kissing_heart:"1f618",kissing_smiling_eyes:"1f619",knife:"1f52a",koala:"1f428",koko:"1f201",kr:"1f1f0-1f1f7",lantern:"1f3ee",large_blue_circle:"1f535",large_blue_diamond:"1f537",large_orange_diamond:"1f536",last_quarter_moon:"1f317",last_quarter_moon_with_face:"1f31c",laughing:"1f606",leaves:"1f343",ledger:"1f4d2",left_luggage:"1f6c5",left_right_arrow:"2194",leftwards_arrow_with_hook:"21a9",lemon:"1f34b",leo:"264c",leopard:"1f406",libra:"264e",light_rail:"1f688",link:"1f517",lips:"1f444",lipstick:"1f484",lock:"1f512",lock_with_ink_pen:"1f50f",lollipop:"1f36d",loop:"27bf",loud_sound:"1f50a",loudspeaker:"1f4e2",love_hotel:"1f3e9",love_letter:"1f48c",low_brightness:"1f505",m:"24c2",mag:"1f50d",mag_right:"1f50e",mahjong:"1f004",mailbox:"1f4eb",mailbox_closed:"1f4ea",mailbox_with_mail:"1f4ec",mailbox_with_no_mail:"1f4ed",man:"1f468",man_with_gua_pi_mao:"1f472",man_with_turban:"1f473",mans_shoe:"1f45e",maple_leaf:"1f341",mask:"1f637",massage:"1f486",meat_on_bone:"1f356",mega:"1f4e3",melon:"1f348",memo:"1f4dd",mens:"1f6b9",metro:"1f687",microphone:"1f3a4",microscope:"1f52c",milky_way:"1f30c",minibus:"1f690",minidisc:"1f4bd",mobile_phone_off:"1f4f4",money_with_wings:"1f4b8",moneybag:"1f4b0",monkey:"1f412",monkey_face:"1f435",monorail:"1f69d",moon:"1f314",mortar_board:"1f393",mount_fuji:"1f5fb",mountain_bicyclist:"1f6b5",mountain_cableway:"1f6a0",mountain_railway:"1f69e",mouse:"1f42d",mouse2:"1f401",movie_camera:"1f3a5",moyai:"1f5ff",muscle:"1f4aa",mushroom:"1f344",musical_keyboard:"1f3b9",musical_note:"1f3b5",musical_score:"1f3bc",mute:"1f507",nail_care:"1f485",name_badge:"1f4db",necktie:"1f454",negative_squared_cross_mark:"274e",neutral_face:"1f610",new:"1f195",new_moon:"1f311",new_moon_with_face:"1f31a",newspaper:"1f4f0",ng:"1f196",ng_woman:"1f645",night_with_stars:"1f303",nine:"39-20e3",no_bell:"1f515",no_bicycles:"1f6b3",no_entry:"26d4",no_entry_sign:"1f6ab",no_good:"1f645",no_mobile_phones:"1f4f5",no_mouth:"1f636",no_pedestrians:"1f6b7",no_smoking:"1f6ad","non-potable_water":"1f6b1",nose:"1f443",notebook:"1f4d3",notebook_with_decorative_cover:"1f4d4",notes:"1f3b6",nut_and_bolt:"1f529",o:"2b55",o2:"1f17e",ocean:"1f30a",octopus:"1f419",oden:"1f362",office:"1f3e2",ok:"1f197",ok_hand:"1f44c",ok_woman:"1f646",older_man:"1f474",older_woman:"1f475",on:"1f51b",oncoming_automobile:"1f698",oncoming_bus:"1f68d",oncoming_police_car:"1f694",oncoming_taxi:"1f696",one:"31-20e3",open_book:"1f4d6",open_file_folder:"1f4c2",open_hands:"1f450",open_mouth:"1f62e",ophiuchus:"26ce",orange_book:"1f4d9",outbox_tray:"1f4e4",ox:"1f402",package:"1f4e6",page_facing_up:"1f4c4",page_with_curl:"1f4c3",pager:"1f4df",palm_tree:"1f334",panda_face:"1f43c",paperclip:"1f4ce",parking:"1f17f",part_alternation_mark:"303d",partly_sunny:"26c5",passport_control:"1f6c2",paw_prints:"1f43e",peach:"1f351",pear:"1f350",pencil:"1f4dd",pencil2:"270f",penguin:"1f427",pensive:"1f614",performing_arts:"1f3ad",persevere:"1f623",person_frowning:"1f64d",person_with_blond_hair:"1f471",person_with_pouting_face:"1f64e",phone:"260e",pig:"1f437",pig2:"1f416",pig_nose:"1f43d",pill:"1f48a",pineapple:"1f34d",pisces:"2653",pizza:"1f355",point_down:"1f447",point_left:"1f448",point_right:"1f449",point_up:"261d",point_up_2:"1f446",police_car:"1f693",poodle:"1f429",poop:"1f4a9",post_office:"1f3e3",postal_horn:"1f4ef",postbox:"1f4ee",potable_water:"1f6b0",pouch:"1f45d",poultry_leg:"1f357",pound:"1f4b7",pout:"1f621",pouting_cat:"1f63e",pray:"1f64f",princess:"1f478",punch:"1f44a",purple_heart:"1f49c",purse:"1f45b",pushpin:"1f4cc",put_litter_in_its_place:"1f6ae",question:"2753",rabbit:"1f430",rabbit2:"1f407",racehorse:"1f40e",radio:"1f4fb",radio_button:"1f518",rage:"1f621",railway_car:"1f683",rainbow:"1f308",raised_hand:"270b",raised_hands:"1f64c",raising_hand:"1f64b",ram:"1f40f",ramen:"1f35c",rat:"1f400",recycle:"267b",red_car:"1f697",red_circle:"1f534",registered:"ae",relaxed:"263a",relieved:"1f60c",repeat:"1f501",repeat_one:"1f502",restroom:"1f6bb",revolving_hearts:"1f49e",rewind:"23ea",ribbon:"1f380",rice:"1f35a",rice_ball:"1f359",rice_cracker:"1f358",rice_scene:"1f391",ring:"1f48d",rocket:"1f680",roller_coaster:"1f3a2",rooster:"1f413",rose:"1f339",rotating_light:"1f6a8",round_pushpin:"1f4cd",rowboat:"1f6a3",ru:"1f1f7-1f1fa",rugby_football:"1f3c9",runner:"1f3c3",running:"1f3c3",running_shirt_with_sash:"1f3bd",sa:"1f202",sagittarius:"2650",sailboat:"26f5",sake:"1f376",sandal:"1f461",santa:"1f385",satellite:"1f4e1",satisfied:"1f606",saxophone:"1f3b7",school:"1f3eb",school_satchel:"1f392",scissors:"2702",scorpius:"264f",scream:"1f631",scream_cat:"1f640",scroll:"1f4dc",seat:"1f4ba",secret:"3299",see_no_evil:"1f648",seedling:"1f331",seven:"37-20e3",shaved_ice:"1f367",sheep:"1f411",shell:"1f41a",ship:"1f6a2",shirt:"1f455",shit:"1f4a9",shoe:"1f45e",shower:"1f6bf",signal_strength:"1f4f6",six:"36-20e3",six_pointed_star:"1f52f",ski:"1f3bf",skull:"1f480",sleeping:"1f634",sleepy:"1f62a",slot_machine:"1f3b0",small_blue_diamond:"1f539",small_orange_diamond:"1f538",small_red_triangle:"1f53a",small_red_triangle_down:"1f53b",smile:"1f604",smile_cat:"1f638",smiley:"1f603",smiley_cat:"1f63a",smiling_imp:"1f608",smirk:"1f60f",smirk_cat:"1f63c",smoking:"1f6ac",snail:"1f40c",snake:"1f40d",snowboarder:"1f3c2",snowflake:"2744",snowman:"26c4",sob:"1f62d",soccer:"26bd",soon:"1f51c",sos:"1f198",sound:"1f509",space_invader:"1f47e",spades:"2660",spaghetti:"1f35d",sparkle:"2747",sparkler:"1f387",sparkles:"2728",sparkling_heart:"1f496",speak_no_evil:"1f64a",speaker:"1f508",speech_balloon:"1f4ac",speedboat:"1f6a4",star:"2b50",star2:"1f31f",stars:"1f320",station:"1f689",statue_of_liberty:"1f5fd",steam_locomotive:"1f682",stew:"1f372",straight_ruler:"1f4cf",strawberry:"1f353",stuck_out_tongue:"1f61b",stuck_out_tongue_closed_eyes:"1f61d",stuck_out_tongue_winking_eye:"1f61c",sun_with_face:"1f31e",sunflower:"1f33b",sunglasses:"1f60e",sunny:"2600",sunrise:"1f305",sunrise_over_mountains:"1f304",surfer:"1f3c4",sushi:"1f363",suspension_railway:"1f69f",sweat:"1f613",sweat_drops:"1f4a6",sweat_smile:"1f605",sweet_potato:"1f360",swimmer:"1f3ca",symbols:"1f523",syringe:"1f489",tada:"1f389",tanabata_tree:"1f38b",tangerine:"1f34a",taurus:"2649",taxi:"1f695",tea:"1f375",telephone:"260e",telephone_receiver:"1f4de",telescope:"1f52d",tennis:"1f3be",tent:"26fa",thought_balloon:"1f4ad",three:"33-20e3",thumbsdown:"1f44e",thumbsup:"1f44d",ticket:"1f3ab",tiger:"1f42f",tiger2:"1f405",tired_face:"1f62b",tm:"2122",toilet:"1f6bd",tokyo_tower:"1f5fc",tomato:"1f345",tongue:"1f445",top:"1f51d",tophat:"1f3a9",tractor:"1f69c",traffic_light:"1f6a5",train:"1f68b",train2:"1f686",tram:"1f68a",triangular_flag_on_post:"1f6a9",triangular_ruler:"1f4d0",trident:"1f531",triumph:"1f624",trolleybus:"1f68e",trophy:"1f3c6",tropical_drink:"1f379",tropical_fish:"1f420",truck:"1f69a",trumpet:"1f3ba",tshirt:"1f455",tulip:"1f337",turtle:"1f422",tv:"1f4fa",twisted_rightwards_arrows:"1f500",two:"32-20e3",two_hearts:"1f495",two_men_holding_hands:"1f46c",two_women_holding_hands:"1f46d",u5272:"1f239",u5408:"1f234",u55b6:"1f23a",u6307:"1f22f",u6708:"1f237",u6709:"1f236",u6e80:"1f235",u7121:"1f21a",u7533:"1f238",u7981:"1f232",u7a7a:"1f233",uk:"1f1ec-1f1e7",umbrella:"2614",unamused:"1f612",underage:"1f51e",unlock:"1f513",up:"1f199",us:"1f1fa-1f1f8",v:"270c",vertical_traffic_light:"1f6a6",vhs:"1f4fc",vibration_mode:"1f4f3",video_camera:"1f4f9",video_game:"1f3ae",violin:"1f3bb",virgo:"264d",volcano:"1f30b",vs:"1f19a",walking:"1f6b6",waning_crescent_moon:"1f318",waning_gibbous_moon:"1f316",warning:"26a0",watch:"231a",water_buffalo:"1f403",watermelon:"1f349",wave:"1f44b",wavy_dash:"3030",waxing_crescent_moon:"1f312",waxing_gibbous_moon:"1f314",wc:"1f6be",weary:"1f629",wedding:"1f492",whale:"1f433",whale2:"1f40b",wheelchair:"267f",white_check_mark:"2705",white_circle:"26aa",white_flower:"1f4ae",white_large_square:"2b1c",white_medium_small_square:"25fd",white_medium_square:"25fb",white_small_square:"25ab",white_square_button:"1f533",wind_chime:"1f390",wine_glass:"1f377",wink:"1f609",wolf:"1f43a",woman:"1f469",womans_clothes:"1f45a",womans_hat:"1f452",womens:"1f6ba",worried:"1f61f",wrench:"1f527",x:"274c",yellow_heart:"1f49b",yen:"1f4b4",yum:"1f60b",zap:"26a1",zero:"30-20e3",zzz:"1f4a4",100:"1f4af",1234:"1f522"},emojiKeys=Object.keys(emojiMap);extend(ComposerBody.prototype,"config",function(original,isInitialized){if(!isInitialized){var composer=this,$container=$('<div class="ComposerBody-emojiDropdownContainer"></div>'),dropdown=new AutocompleteDropdown({items:[]}),$textarea=this.$("textarea").wrap('<div class="ComposerBody-emojiWrapper"></div>'),emojiStart=void 0,typed=void 0,applySuggestion=function(replacement){var insert=replacement+" ",content=composer.content();composer.editor.setValue(content.substring(0,emojiStart-1)+insert+content.substr($textarea[0].selectionStart));var index=emojiStart-1+insert.length;composer.editor.setSelectionRange(index,index),dropdown.hide()};$textarea.after($container).on("keydown",dropdown.navigate.bind(dropdown)).on("click keyup",function(e){var _this=this;if([9,13,27,40,38,37,39].indexOf(e.which)===-1){var cursor=this.selectionStart;if(!(this.selectionEnd-cursor>0)){var value=this.value;emojiStart=0;for(var i=cursor-1;i>=0;i--){var character=value.substr(i,1);if(!/[a-z0-9]|\+|\-|_|\:/.test(character))break;if(":"===character&&(0==i||/\s/.test(value.substr(i-1,1)))){emojiStart=i+1;break}}dropdown.hide(),dropdown.active=!1,emojiStart&&!function(){typed=value.substring(emojiStart,cursor).toLowerCase();var makeSuggestion=function(key){var code=":"+key+":",imageName=(emojiMap[key].indexOf("-20e3")!=-1||"a9"==emojiMap[key]||"ae"==emojiMap[key]?"00":"")+emojiMap[key];return m("button",{key:key,onclick:function(){return applySuggestion(code)},onmouseenter:function(){dropdown.setIndex($(this).parent().index())}},m("img",{alt:code,class:"emoji",draggable:"false",src:"//cdn.jsdelivr.net/emojione/assets/png/"+imageName+".png"}),key)},buildSuggestions=function(){for(var suggestions=[],similarEmoji=[],fuzzyRegexp=function(str){var reEscape=new RegExp("\\((["+"+.*?[]{}()^$|\\".replace(/(.)/g,"\\$1")+"])\\)","g");return new RegExp("(.*)"+str.toLowerCase().replace(/(.)/g,"($1)(.*?)").replace(reEscape,"(\\$1)")+"$","i")},regTyped=fuzzyRegexp(typed),i=0,maxSuggestions=7;i<emojiKeys.length&&maxSuggestions>0;i++)regTyped.test(emojiKeys[i])&&(--maxSuggestions,similarEmoji.push(emojiKeys[i]));similarEmoji=similarEmoji.sort(function(a,b){return a.length-b.length});var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=similarEmoji[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var key=_step.value;suggestions.push(makeSuggestion(key))}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{!_iteratorNormalCompletion&&_iterator.return&&_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}if(suggestions.length){dropdown.props.items=suggestions,m.render($container[0],dropdown.render()),dropdown.show();var coordinates=getCaretCoordinates(_this,emojiStart),width=dropdown.$().outerWidth(),height=dropdown.$().outerHeight(),parent=dropdown.$().offsetParent(),left=coordinates.left,top=coordinates.top+15;top+height>parent.height()&&(top=coordinates.top-height-15),left+width>parent.width()&&(left=parent.width()-width),dropdown.show(left,top)}};buildSuggestions(),dropdown.setIndex(0),dropdown.$().scrollTop(0),dropdown.active=!0}()}}})}})}var extend,ComposerBody,AutocompleteDropdown;return _export("default",addComposerAutocomplete),{setters:[function(_flarumExtend){extend=_flarumExtend.extend},function(_flarumComponentsComposerBody){ComposerBody=_flarumComponentsComposerBody.default},function(_flarumEmojiComponentsAutocompleteDropdown){AutocompleteDropdown=_flarumEmojiComponentsAutocompleteDropdown.default}],execute:function(){}}}),System.register("flarum/emoji/components/AutocompleteDropdown",["flarum/Component"],function(_export,_context){var Component,AutocompleteDropdown;return{setters:[function(_flarumComponent){Component=_flarumComponent.default}],execute:function(){AutocompleteDropdown=function(_Component){function AutocompleteDropdown(){return babelHelpers.classCallCheck(this,AutocompleteDropdown),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(AutocompleteDropdown).apply(this,arguments))}return babelHelpers.inherits(AutocompleteDropdown,_Component),babelHelpers.createClass(AutocompleteDropdown,[{key:"init",value:function(){this.active=!1,this.index=0,this.keyWasJustPressed=!1}},{key:"view",value:function(){return m("ul",{className:"Dropdown-menu EmojiDropdown"},this.props.items.map(function(item){return m("li",{key:item.attrs.key},item)}))}},{key:"show",value:function(left,top){this.$().show().css({left:left+"px",top:top+"px"}),this.active=!0}},{key:"hide",value:function(){this.$().hide(),this.active=!1}},{key:"navigate",value:function(e){var _this2=this;if(this.active)switch(e.which){case 40:case 38:this.keyWasJustPressed=!0,this.setIndex(this.index+(40===e.which?1:-1),!0),clearTimeout(this.keyWasJustPressedTimeout),this.keyWasJustPressedTimeout=setTimeout(function(){return _this2.keyWasJustPressed=!1},500),e.preventDefault();break;case 13:case 9:this.$("li").eq(this.index).find("button").click(),e.preventDefault();break;case 27:this.hide(),e.stopPropagation(),e.preventDefault()}}},{key:"setIndex",value:function(index,scrollToItem){if(!this.keyWasJustPressed||scrollToItem){var $dropdown=this.$(),$items=$dropdown.find("li"),rangedIndex=index;rangedIndex<0?rangedIndex=$items.length-1:rangedIndex>=$items.length&&(rangedIndex=0),this.index=rangedIndex;var $item=$items.removeClass("active").eq(rangedIndex).addClass("active");if(scrollToItem){var dropdownScroll=$dropdown.scrollTop(),dropdownTop=$dropdown.offset().top,dropdownBottom=dropdownTop+$dropdown.outerHeight(),itemTop=$item.offset().top,itemBottom=itemTop+$item.outerHeight(),scrollTop=void 0;itemTop<dropdownTop?scrollTop=dropdownScroll-dropdownTop+itemTop-parseInt($dropdown.css("padding-top"),10):itemBottom>dropdownBottom&&(scrollTop=dropdownScroll-dropdownBottom+itemBottom+parseInt($dropdown.css("padding-bottom"),10)),"undefined"!=typeof scrollTop&&$dropdown.stop(!0).animate({scrollTop:scrollTop},100)}}}}]),AutocompleteDropdown}(Component),_export("default",AutocompleteDropdown)}}}),System.register("flarum/emoji/main",["flarum/extend","flarum/app","flarum/models/Post","flarum/emoji/addComposerAutocomplete"],function(_export,_context){var override,app,Post,addComposerAutocomplete;return{setters:[function(_flarumExtend){override=_flarumExtend.override},function(_flarumApp){app=_flarumApp.default},function(_flarumModelsPost){Post=_flarumModelsPost.default},function(_flarumEmojiAddComposerAutocomplete){addComposerAutocomplete=_flarumEmojiAddComposerAutocomplete.default}],execute:function(){app.initializers.add("flarum-emoji",function(){addComposerAutocomplete()})}}}),System.register("flagrow/image-upload/components/UploadButton",["flarum/Component","flarum/helpers/icon","flarum/components/LoadingIndicator"],function(_export){"use strict";var Component,icon,LoadingIndicator,UploadButton;return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumHelpersIcon){icon=_flarumHelpersIcon.default},function(_flarumComponentsLoadingIndicator){LoadingIndicator=_flarumComponentsLoadingIndicator.default}],execute:function(){UploadButton=function(_Component){function UploadButton(){babelHelpers.classCallCheck(this,UploadButton),babelHelpers.get(Object.getPrototypeOf(UploadButton.prototype),"constructor",this).apply(this,arguments)}return babelHelpers.inherits(UploadButton,_Component),babelHelpers.createClass(UploadButton,[{key:"init",value:function(){this.textAreaObj=null,this.loading=!1}},{key:"view",value:function(){return m("div",{className:"Button hasIcon flagrow-image-upload-button Button--icon"},[this.loading?LoadingIndicator.component({className:"Button-icon"}):icon("picture-o",{className:"Button-icon"}),m("span",{className:"Button-label"},this.loading?app.translator.trans("flagrow-image-upload.forum.states.loading"):app.translator.trans("flagrow-image-upload.forum.buttons.attach")),m("form#flagrow-image-upload-form",[m("input",{type:"file",accept:"image/*",name:"flagrow-image-upload-input",onchange:this.process.bind(this)})])])}},{key:"process",value:function(e){var data=new FormData;data.append("image",$(e.target)[0].files[0]),this.loading=!0,m.redraw(),app.request({method:"POST",url:app.forum.attribute("apiUrl")+"/image/upload",serialize:function(raw){return raw},data:data}).then(this.success.bind(this),this.failure.bind(this))}},{key:"failure",value:function(message){}},{key:"success",value:function(image){var _this=this,link=image.data.attributes.url,markdownString="\n![image "+link+"]("+link+")\n";this.textAreaObj.insertAtCursor(markdownString),"undefined"!=typeof this.textAreaObj.props.preview&&this.textAreaObj.props.preview(),setTimeout(function(){document.getElementById("flagrow-image-upload-form").reset(),_this.loading=!1},1e3)}}]),UploadButton}(Component),_export("default",UploadButton)}}}),System.register("flagrow/image-upload/main",["flarum/extend","flarum/components/TextEditor","flagrow/image-upload/components/UploadButton"],function(_export){"use strict";var extend,TextEditor,UploadButton;return{setters:[function(_flarumExtend){extend=_flarumExtend.extend},function(_flarumComponentsTextEditor){TextEditor=_flarumComponentsTextEditor.default},function(_flagrowImageUploadComponentsUploadButton){UploadButton=_flagrowImageUploadComponentsUploadButton.default}],execute:function(){app.initializers.add("flagrow-image-upload",function(app){extend(TextEditor.prototype,"controlItems",function(items){if(app.forum.attribute("canUploadImages")){var uploadButton=new UploadButton;uploadButton.textAreaObj=this,items.add("flagrow-image-upload",uploadButton,0),$(".Button-label",".item-flagrow-image-upload > div").hide(),$(".item-flagrow-image-upload > div").hover(function(){$(".Button-label",this).show(),$(this).removeClass("Button--icon")},function(){$(".Button-label",this).hide(),$(this).addClass("Button--icon")})}})})}}}),System.register("flagrow/latex/main",["flarum/extend","flarum/components/CommentPost"],function(_export,_context){var extend,CommentPost;return{setters:[function(_flarumExtend){extend=_flarumExtend.extend},function(_flarumComponentsCommentPost){CommentPost=_flarumComponentsCommentPost.default}],execute:function(){app.initializers.add("flagrow/latex",function(){extend(CommentPost.prototype,"config",function(){renderMathInElement($(".Post-body",this.element)[0],{ignoredTags:["script","noscript","style","textarea","pre"],delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})})}}}),System.register("flarum/likes/addLikeAction",["flarum/extend","flarum/app","flarum/components/Button","flarum/components/CommentPost"],function(_export,_context){var extend,app,Button,CommentPost;return _export("default",function(){extend(CommentPost.prototype,"actionItems",function(items){var post=this.props.post;if(!post.isHidden()&&post.canLike()){var isLiked=app.session.user&&post.likes().some(function(user){return user===app.session.user});items.add("like",Button.component({children:app.translator.trans(isLiked?"flarum-likes.forum.post.unlike_link":"flarum-likes.forum.post.like_link"),className:"Button Button--link",onclick:function(){isLiked=!isLiked,post.save({isLiked:isLiked});var data=post.data.relationships.likes.data;data.some(function(like,i){if(like.id===app.session.user.id())return data.splice(i,1),!0}),isLiked&&data.unshift({type:"users",id:app.session.user.id()})}}))}})}),{setters:[function(_flarumExtend){extend=_flarumExtend.extend},function(_flarumApp){app=_flarumApp.default},function(_flarumComponentsButton){Button=_flarumComponentsButton.default},function(_flarumComponentsCommentPost){CommentPost=_flarumComponentsCommentPost.default}],execute:function(){}}}),System.register("flarum/likes/addLikesList",["flarum/extend","flarum/app","flarum/components/CommentPost","flarum/helpers/punctuateSeries","flarum/helpers/username","flarum/helpers/icon","flarum/likes/components/PostLikesModal"],function(_export,_context){var extend,app,CommentPost,punctuateSeries,username,icon,PostLikesModal;return _export("default",function(){extend(CommentPost.prototype,"footerItems",function(items){var post=this.props.post,likes=post.likes();if(likes&&likes.length){var limit=4,overLimit=likes.length>limit,names=likes.sort(function(a){return a===app.session.user?-1:1}).slice(0,overLimit?limit-1:limit).map(function(user){return m("a",{href:app.route.user(user),config:m.route},user===app.session.user?app.translator.trans("flarum-likes.forum.post.you_text"):username(user))});if(overLimit){var count=likes.length-names.length;names.push(m("a",{href:"#",onclick:function(e){e.preventDefault(),app.modal.show(new PostLikesModal({post:post}))}},app.translator.transChoice("flarum-likes.forum.post.others_link",count,{count:count})))}items.add("liked",m("div",{className:"Post-likedBy"},icon("thumbs-o-up"),app.translator.transChoice("flarum-likes.forum.post.liked_by"+(likes[0]===app.session.user?"_self":"")+"_text",names.length,{count:names.length,users:punctuateSeries(names)})))}})}),{setters:[function(_flarumExtend){extend=_flarumExtend.extend},function(_flarumApp){app=_flarumApp.default},function(_flarumComponentsCommentPost){CommentPost=_flarumComponentsCommentPost.default},function(_flarumHelpersPunctuateSeries){punctuateSeries=_flarumHelpersPunctuateSeries.default},function(_flarumHelpersUsername){username=_flarumHelpersUsername.default},function(_flarumHelpersIcon){icon=_flarumHelpersIcon.default},function(_flarumLikesComponentsPostLikesModal){PostLikesModal=_flarumLikesComponentsPostLikesModal.default}],execute:function(){}}}),System.register("flarum/likes/components/PostLikedNotification",["flarum/components/Notification","flarum/helpers/username","flarum/helpers/punctuateSeries"],function(_export,_context){var Notification,username,punctuateSeries,PostLikedNotification;return{setters:[function(_flarumComponentsNotification){Notification=_flarumComponentsNotification.default},function(_flarumHelpersUsername){username=_flarumHelpersUsername.default},function(_flarumHelpersPunctuateSeries){punctuateSeries=_flarumHelpersPunctuateSeries.default}],execute:function(){PostLikedNotification=function(_Notification){function PostLikedNotification(){return babelHelpers.classCallCheck(this,PostLikedNotification),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(PostLikedNotification).apply(this,arguments))}return babelHelpers.inherits(PostLikedNotification,_Notification),babelHelpers.createClass(PostLikedNotification,[{key:"icon",value:function(){return"thumbs-o-up"}},{key:"href",value:function(){return app.route.post(this.props.notification.subject())}},{key:"content",value:function(){var notification=this.props.notification,user=notification.sender(),auc=notification.additionalUnreadCount();return app.translator.transChoice("flarum-likes.forum.notifications.post_liked_text",auc+1,{user:user,username:auc?punctuateSeries([username(user),app.translator.transChoice("flarum-likes.forum.notifications.others_text",auc,{count:auc})]):void 0})}},{key:"excerpt",value:function(){return this.props.notification.subject().contentPlain()}}]),PostLikedNotification}(Notification),_export("default",PostLikedNotification)}}}),System.register("flarum/likes/components/PostLikesModal",["flarum/components/Modal","flarum/helpers/avatar","flarum/helpers/username"],function(_export,_context){var Modal,avatar,username,PostLikesModal;return{setters:[function(_flarumComponentsModal){Modal=_flarumComponentsModal.default},function(_flarumHelpersAvatar){avatar=_flarumHelpersAvatar.default},function(_flarumHelpersUsername){username=_flarumHelpersUsername.default}],execute:function(){PostLikesModal=function(_Modal){function PostLikesModal(){return babelHelpers.classCallCheck(this,PostLikesModal),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(PostLikesModal).apply(this,arguments))}return babelHelpers.inherits(PostLikesModal,_Modal),babelHelpers.createClass(PostLikesModal,[{key:"className",value:function(){return"PostLikesModal Modal--small"}},{key:"title",value:function(){return app.translator.trans("flarum-likes.forum.post_likes.title")}},{key:"content",value:function(){return m("div",{className:"Modal-body"},m("ul",{className:"PostLikesModal-list"},this.props.post.likes().map(function(user){return m("li",null,m("a",{href:app.route.user(user),config:m.route},avatar(user)," "," ",username(user)))})))}}]),PostLikesModal}(Modal),_export("default",PostLikesModal)}}}),System.register("flarum/likes/main",["flarum/extend","flarum/app","flarum/models/Post","flarum/Model","flarum/components/NotificationGrid","flarum/likes/addLikeAction","flarum/likes/addLikesList","flarum/likes/components/PostLikedNotification"],function(_export,_context){var extend,app,Post,Model,NotificationGrid,addLikeAction,addLikesList,PostLikedNotification;return{setters:[function(_flarumExtend){extend=_flarumExtend.extend},function(_flarumApp){app=_flarumApp.default},function(_flarumModelsPost){Post=_flarumModelsPost.default},function(_flarumModel){Model=_flarumModel.default},function(_flarumComponentsNotificationGrid){NotificationGrid=_flarumComponentsNotificationGrid.default},function(_flarumLikesAddLikeAction){addLikeAction=_flarumLikesAddLikeAction.default},function(_flarumLikesAddLikesList){addLikesList=_flarumLikesAddLikesList.default},function(_flarumLikesComponentsPostLikedNotification){PostLikedNotification=_flarumLikesComponentsPostLikedNotification.default}],execute:function(){app.initializers.add("flarum-likes",function(){app.notificationComponents.postLiked=PostLikedNotification,Post.prototype.canLike=Model.attribute("canLike"),Post.prototype.likes=Model.hasMany("likes"),addLikeAction(),addLikesList(),extend(NotificationGrid.prototype,"notificationTypes",function(items){items.add("postLiked",{name:"postLiked",icon:"thumbs-o-up",label:app.translator.trans("flarum-likes.forum.settings.notify_post_liked_label")})})})}}}),System.register("flarum/lock/addLockBadge",["flarum/extend","flarum/models/Discussion","flarum/components/Badge"],function(_export,_context){function addLockBadge(){extend(Discussion.prototype,"badges",function(badges){this.isLocked()&&badges.add("locked",Badge.component({type:"locked",label:app.translator.trans("flarum-lock.forum.badge.locked_tooltip"),icon:"lock"}))})}var extend,Discussion,Badge;return _export("default",addLockBadge),{setters:[function(_flarumExtend){extend=_flarumExtend.extend},function(_flarumModelsDiscussion){Discussion=_flarumModelsDiscussion.default},function(_flarumComponentsBadge){Badge=_flarumComponentsBadge.default}],execute:function(){}}}),System.register("flarum/lock/addLockControl",["flarum/extend","flarum/utils/DiscussionControls","flarum/components/DiscussionPage","flarum/components/Button"],function(_export,_context){function addLockControl(){extend(DiscussionControls,"moderationControls",function(items,discussion){discussion.canLock()&&items.add("lock",Button.component({children:app.translator.trans(discussion.isLocked()?"flarum-lock.forum.discussion_controls.unlock_button":"flarum-lock.forum.discussion_controls.lock_button"),icon:"lock",onclick:this.lockAction.bind(discussion)}))}),DiscussionControls.lockAction=function(){this.save({isLocked:!this.isLocked()}).then(function(){app.current instanceof DiscussionPage&&app.current.stream.update(),m.redraw()})}}var extend,DiscussionControls,DiscussionPage,Button;return _export("default",addLockControl),{setters:[function(_flarumExtend){extend=_flarumExtend.extend},function(_flarumUtilsDiscussionControls){DiscussionControls=_flarumUtilsDiscussionControls.default},function(_flarumComponentsDiscussionPage){DiscussionPage=_flarumComponentsDiscussionPage.default},function(_flarumComponentsButton){Button=_flarumComponentsButton.default}],execute:function(){}}}),System.register("flarum/lock/components/DiscussionLockedNotification",["flarum/components/Notification"],function(_export,_context){var Notification,DiscussionLockedNotification;return{setters:[function(_flarumComponentsNotification){Notification=_flarumComponentsNotification.default}],execute:function(){DiscussionLockedNotification=function(_Notification){function DiscussionLockedNotification(){return babelHelpers.classCallCheck(this,DiscussionLockedNotification),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(DiscussionLockedNotification).apply(this,arguments))}return babelHelpers.inherits(DiscussionLockedNotification,_Notification),babelHelpers.createClass(DiscussionLockedNotification,[{key:"icon",value:function(){return"lock"}},{key:"href",value:function(){var notification=this.props.notification;return app.route.discussion(notification.subject(),notification.content().postNumber)}},{key:"content",value:function(){return app.translator.trans("flarum-lock.forum.notifications.discussion_locked_text",{user:this.props.notification.sender()})}}]),DiscussionLockedNotification}(Notification),_export("default",DiscussionLockedNotification)}}}),System.register("flarum/lock/components/DiscussionLockedPost",["flarum/components/EventPost"],function(_export,_context){var EventPost,DiscussionLockedPost;return{setters:[function(_flarumComponentsEventPost){EventPost=_flarumComponentsEventPost.default}],execute:function(){DiscussionLockedPost=function(_EventPost){function DiscussionLockedPost(){return babelHelpers.classCallCheck(this,DiscussionLockedPost),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(DiscussionLockedPost).apply(this,arguments))}return babelHelpers.inherits(DiscussionLockedPost,_EventPost),babelHelpers.createClass(DiscussionLockedPost,[{key:"icon",value:function(){return this.props.post.content().locked?"lock":"unlock"}},{key:"descriptionKey",value:function(){return this.props.post.content().locked?"flarum-lock.forum.post_stream.discussion_locked_text":"flarum-lock.forum.post_stream.discussion_unlocked_text"}}]),DiscussionLockedPost}(EventPost),_export("default",DiscussionLockedPost)}}}),System.register("flarum/lock/main",["flarum/extend","flarum/app","flarum/Model","flarum/models/Discussion","flarum/components/NotificationGrid","flarum/lock/components/DiscussionLockedPost","flarum/lock/components/DiscussionLockedNotification","flarum/lock/addLockBadge","flarum/lock/addLockControl"],function(_export,_context){var extend,app,Model,Discussion,NotificationGrid,DiscussionLockedPost,DiscussionLockedNotification,addLockBadge,addLockControl;return{setters:[function(_flarumExtend){extend=_flarumExtend.extend},function(_flarumApp){app=_flarumApp.default},function(_flarumModel){
Model=_flarumModel.default},function(_flarumModelsDiscussion){Discussion=_flarumModelsDiscussion.default},function(_flarumComponentsNotificationGrid){NotificationGrid=_flarumComponentsNotificationGrid.default},function(_flarumLockComponentsDiscussionLockedPost){DiscussionLockedPost=_flarumLockComponentsDiscussionLockedPost.default},function(_flarumLockComponentsDiscussionLockedNotification){DiscussionLockedNotification=_flarumLockComponentsDiscussionLockedNotification.default},function(_flarumLockAddLockBadge){addLockBadge=_flarumLockAddLockBadge.default},function(_flarumLockAddLockControl){addLockControl=_flarumLockAddLockControl.default}],execute:function(){app.initializers.add("flarum-lock",function(){app.postComponents.discussionLocked=DiscussionLockedPost,app.notificationComponents.discussionLocked=DiscussionLockedNotification,Discussion.prototype.isLocked=Model.attribute("isLocked"),Discussion.prototype.canLock=Model.attribute("canLock"),addLockBadge(),addLockControl(),extend(NotificationGrid.prototype,"notificationTypes",function(items){items.add("discussionLocked",{name:"discussionLocked",icon:"lock",label:app.translator.trans("flarum-lock.forum.settings.notify_discussion_locked_label")})})})}}}),function(){function getCaretCoordinates(element,position,options){if(!isBrowser)throw new Error("textarea-caret-position#getCaretCoordinates should only be called in a browser");var debug=options&&options.debug||!1;if(debug){var el=document.querySelector("#input-textarea-caret-position-mirror-div");el&&el.parentNode.removeChild(el)}var div=document.createElement("div");div.id="input-textarea-caret-position-mirror-div",document.body.appendChild(div);var style=div.style,computed=window.getComputedStyle?getComputedStyle(element):element.currentStyle;style.whiteSpace="pre-wrap","INPUT"!==element.nodeName&&(style.wordWrap="break-word"),style.position="absolute",debug||(style.visibility="hidden"),properties.forEach(function(prop){style[prop]=computed[prop]}),isFirefox?element.scrollHeight>parseInt(computed.height)&&(style.overflowY="scroll"):style.overflow="hidden",div.textContent=element.value.substring(0,position),"INPUT"===element.nodeName&&(div.textContent=div.textContent.replace(/\s/g," "));var span=document.createElement("span");span.textContent=element.value.substring(position)||".",div.appendChild(span);var coordinates={top:span.offsetTop+parseInt(computed.borderTopWidth),left:span.offsetLeft+parseInt(computed.borderLeftWidth)};return debug?span.style.backgroundColor="#aaa":document.body.removeChild(div),coordinates}var properties=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize"],isBrowser="undefined"!=typeof window,isFirefox=isBrowser&&null!=window.mozInnerScreenX;"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=getCaretCoordinates:isBrowser&&(window.getCaretCoordinates=getCaretCoordinates)}(),System.register("flarum/mentions/addComposerAutocomplete",["flarum/extend","flarum/components/ComposerBody","flarum/helpers/avatar","flarum/helpers/username","flarum/helpers/highlight","flarum/utils/string","flarum/mentions/components/AutocompleteDropdown"],function(_export,_context){function addComposerAutocomplete(){extend(ComposerBody.prototype,"config",function(original,isInitialized){if(!isInitialized){var composer=this,$container=$('<div class="ComposerBody-mentionsDropdownContainer"></div>'),dropdown=new AutocompleteDropdown({items:[]}),$textarea=this.$("textarea").wrap('<div class="ComposerBody-mentionsWrapper"></div>'),searched=[],mentionStart=void 0,typed=void 0,searchTimeout=void 0,applySuggestion=function(replacement){var insert=replacement+" ",content=composer.content();composer.editor.setValue(content.substring(0,mentionStart-1)+insert+content.substr($textarea[0].selectionStart));var index=mentionStart-1+insert.length;composer.editor.setSelectionRange(index,index),dropdown.hide()};$textarea.after($container).on("keydown",dropdown.navigate.bind(dropdown)).on("click keyup",function(e){var _this=this;if([9,13,27,40,38,37,39].indexOf(e.which)===-1){var cursor=this.selectionStart;if(!(this.selectionEnd-cursor>0)){var value=this.value;mentionStart=0;for(var i=cursor-1;i>=0;i--){var character=value.substr(i,1);if(/\s/.test(character))break;if("@"===character){mentionStart=i+1;break}}dropdown.hide(),dropdown.active=!1,mentionStart&&!function(){typed=value.substring(mentionStart,cursor).toLowerCase();var makeSuggestion=function(user,replacement,content){var className=arguments.length<=3||void 0===arguments[3]?"":arguments[3],username=usernameHelper(user);return typed&&(username.children[0]=highlight(username.children[0],typed)),m("button",{className:"PostPreview "+className,onclick:function(){return applySuggestion(replacement)},onmouseenter:function(){dropdown.setIndex($(this).parent().index())}},m("span",{className:"PostPreview-content"},avatar(user),username," "," ",content))},buildSuggestions=function(){var suggestions=[],composerPost=composer.props.post,discussion=composerPost&&composerPost.discussion()||composer.props.discussion;if(discussion&&discussion.posts().filter(function(post){return post&&"comment"===post.contentType()&&(!composerPost||post.number()<composerPost.number())}).sort(function(a,b){return b.time()-a.time()}).filter(function(post){var user=post.user();return user&&user.username().toLowerCase().substr(0,typed.length)===typed}).splice(0,5).forEach(function(post){var user=post.user();suggestions.push(makeSuggestion(user,"@"+user.username()+"#"+post.id(),[app.translator.trans("flarum-mentions.forum.composer.reply_to_post_text",{number:post.number()})," — ",truncate(post.contentPlain(),200)],"MentionsDropdown-post"))}),typed&&app.store.all("users").forEach(function(user){user.username().toLowerCase().substr(0,typed.length)===typed&&suggestions.push(makeSuggestion(user,"@"+user.username(),"","MentionsDropdown-user"))}),suggestions.length){dropdown.props.items=suggestions,m.render($container[0],dropdown.render()),dropdown.show();var coordinates=getCaretCoordinates(_this,mentionStart),width=dropdown.$().outerWidth(),height=dropdown.$().outerHeight(),parent=dropdown.$().offsetParent(),left=coordinates.left,top=coordinates.top+15;top+height>parent.height()&&(top=coordinates.top-height-15),left+width>parent.width()&&(left=parent.width()-width),dropdown.show(left,top)}};buildSuggestions(),dropdown.setIndex(0),dropdown.$().scrollTop(0),dropdown.active=!0,clearTimeout(searchTimeout),typed&&(searchTimeout=setTimeout(function(){var typedLower=typed.toLowerCase();searched.indexOf(typedLower)===-1&&(app.store.find("users",{q:typed,page:{limit:5}}).then(function(){dropdown.active&&buildSuggestions()}),searched.push(typedLower))},250))}()}}})}})}var extend,ComposerBody,avatar,usernameHelper,highlight,truncate,AutocompleteDropdown;return _export("default",addComposerAutocomplete),{setters:[function(_flarumExtend){extend=_flarumExtend.extend},function(_flarumComponentsComposerBody){ComposerBody=_flarumComponentsComposerBody.default},function(_flarumHelpersAvatar){avatar=_flarumHelpersAvatar.default},function(_flarumHelpersUsername){usernameHelper=_flarumHelpersUsername.default},function(_flarumHelpersHighlight){highlight=_flarumHelpersHighlight.default},function(_flarumUtilsString){truncate=_flarumUtilsString.truncate},function(_flarumMentionsComponentsAutocompleteDropdown){AutocompleteDropdown=_flarumMentionsComponentsAutocompleteDropdown.default}],execute:function(){}}}),System.register("flarum/mentions/addMentionedByList",["flarum/extend","flarum/Model","flarum/models/Post","flarum/components/CommentPost","flarum/components/PostPreview","flarum/helpers/punctuateSeries","flarum/helpers/username","flarum/helpers/icon"],function(_export,_context){function addMentionedByList(){Post.prototype.mentionedBy=Model.hasMany("mentionedBy"),extend(CommentPost.prototype,"footerItems",function(items){var _this=this,post=this.props.post,replies=post.mentionedBy();if(replies&&replies.length){var _ret=function(){if(1===replies.length&&replies[0].number()===post.number()+1)return{v:void 0};var hidePreview=function(){_this.$(".Post-mentionedBy-preview").removeClass("in").one("transitionend",function(){$(this).hide()})},config=function(element,isInitialized){if(!isInitialized){var $this=$(element),timeout=void 0,$preview=$('<ul class="Dropdown-menu Post-mentionedBy-preview fade"/>');$this.append($preview),$this.children().hover(function(){clearTimeout(timeout),timeout=setTimeout(function(){!$preview.hasClass("in")&&$preview.is(":visible")||(m.render($preview[0],replies.map(function(reply){return m("li",{"data-number":reply.number()},PostPreview.component({post:reply,onclick:hidePreview}))})),$preview.show(),setTimeout(function(){return $preview.off("transitionend").addClass("in")}))},500)},function(){clearTimeout(timeout),timeout=setTimeout(hidePreview,250)}),$this.find(".Post-mentionedBy-summary a").hover(function(){$preview.find('[data-number="'+$(this).data("number")+'"]').addClass("active")},function(){$preview.find("[data-number]").removeClass("active")})}},users=[],repliers=replies.sort(function(reply){return reply.user()===app.session.user?-1:0}).filter(function(reply){var user=reply.user();if(users.indexOf(user)===-1)return users.push(user),!0}),limit=4,overLimit=repliers.length>limit,names=repliers.slice(0,overLimit?limit-1:limit).map(function(reply){var user=reply.user();return m("a",{href:app.route.post(reply),config:m.route,onclick:hidePreview,"data-number":reply.number()},app.session.user===user?app.translator.trans("flarum-mentions.forum.post.you_text"):username(user))});if(overLimit){var count=repliers.length-names.length;names.push(app.translator.transChoice("flarum-mentions.forum.post.others_text",count,{count:count}))}items.add("replies",m("div",{className:"Post-mentionedBy",config:config},m("span",{className:"Post-mentionedBy-summary"},icon("reply"),app.translator.transChoice("flarum-mentions.forum.post.mentioned_by"+(replies[0]===app.session.user?"_self":"")+"_text",names.length,{count:names.length,users:punctuateSeries(names)}))))}();if("object"===("undefined"==typeof _ret?"undefined":babelHelpers.typeof(_ret)))return _ret.v}})}var extend,Model,Post,CommentPost,PostPreview,punctuateSeries,username,icon;return _export("default",addMentionedByList),{setters:[function(_flarumExtend){extend=_flarumExtend.extend},function(_flarumModel){Model=_flarumModel.default},function(_flarumModelsPost){Post=_flarumModelsPost.default},function(_flarumComponentsCommentPost){CommentPost=_flarumComponentsCommentPost.default},function(_flarumComponentsPostPreview){PostPreview=_flarumComponentsPostPreview.default},function(_flarumHelpersPunctuateSeries){punctuateSeries=_flarumHelpersPunctuateSeries.default},function(_flarumHelpersUsername){username=_flarumHelpersUsername.default},function(_flarumHelpersIcon){icon=_flarumHelpersIcon.default}],execute:function(){}}}),System.register("flarum/mentions/addPostMentionPreviews",["flarum/extend","flarum/components/CommentPost","flarum/components/PostPreview","flarum/components/LoadingIndicator"],function(_export,_context){function addPostMentionPreviews(){extend(CommentPost.prototype,"config",function(){var contentHtml=this.props.post.contentHtml();if(contentHtml!==this.oldPostContentHtml&&!this.isEditing()){this.oldPostContentHtml=contentHtml;var parentPost=this.props.post,$parentPost=this.$();this.$(".UserMention, .PostMention").each(function(){m.route.call(this,this,!1,{},{attrs:{href:this.getAttribute("href")}})}),this.$(".PostMention").each(function(){var $this=$(this),id=$this.data("id"),timeout=void 0,$preview=$('<ul class="Dropdown-menu PostMention-preview fade"/>');$parentPost.append($preview);var getPostElement=function(){return $('.PostStream-item[data-id="'+id+'"]')},showPreview=function(){var $post=getPostElement(),visible=!1;if($post.length){var top=$post.offset().top,scrollTop=window.pageYOffset;top>scrollTop&&top+$post.height()<scrollTop+$(window).height()&&($post.addClass("pulsate"),visible=!0)}visible||!function(){var positionPreview=function(){var previewHeight=$preview.outerHeight(!0),offset=0;$this.offset().top-previewHeight<$(window).scrollTop()+$("#header").outerHeight()?offset+=$this.outerHeight(!0):offset-=previewHeight,$preview.show().css("top",$this.offset().top-$parentPost.offset().top+offset).css("left",$this.offsetParent().offset().left-$parentPost.offset().left).css("max-width",$this.offsetParent().width())},showPost=function(post){var discussion=post.discussion();m.render($preview[0],[discussion!==parentPost.discussion()?m("li",null,m("span",{className:"PostMention-preview-discussion"},discussion.title())):"",m("li",null,PostPreview.component({post:post}))]),positionPreview()},post=app.store.getById("posts",id);post&&post.discussion()?showPost(post):(m.render($preview[0],LoadingIndicator.component()),app.store.find("posts",id).then(showPost),positionPreview()),setTimeout(function(){return $preview.off("transitionend").addClass("in")})}()},hidePreview=function(){getPostElement().removeClass("pulsate"),$preview.hasClass("in")&&$preview.removeClass("in").one("transitionend",function(){return $preview.hide()})};$this.on("touchstart",function(e){return e.preventDefault()}),$this.add($preview).hover(function(){clearTimeout(timeout),timeout=setTimeout(showPreview,250)},function(){clearTimeout(timeout),getPostElement().removeClass("pulsate"),timeout=setTimeout(hidePreview,250)}).on("touchend",function(e){showPreview(),e.stopPropagation()}),$(document).on("touchend",hidePreview)})}})}var extend,CommentPost,PostPreview,LoadingIndicator;return _export("default",addPostMentionPreviews),{setters:[function(_flarumExtend){extend=_flarumExtend.extend},function(_flarumComponentsCommentPost){CommentPost=_flarumComponentsCommentPost.default},function(_flarumComponentsPostPreview){PostPreview=_flarumComponentsPostPreview.default},function(_flarumComponentsLoadingIndicator){LoadingIndicator=_flarumComponentsLoadingIndicator.default}],execute:function(){}}}),System.register("flarum/mentions/addPostReplyAction",["flarum/extend","flarum/components/Button","flarum/components/CommentPost","flarum/utils/DiscussionControls"],function(_export,_context){var extend,Button,CommentPost,DiscussionControls;return _export("default",function(){extend(CommentPost.prototype,"actionItems",function(items){function insertMention(component,quote){var user=post.user(),mention="@"+(user?user.username():post.number())+"#"+post.id()+" ";component.content()||(component.props.originalContent=mention);var cursorPosition=component.editor.getSelectionRange()[0],preceding=component.editor.value().slice(0,cursorPosition),precedingNewlines=0==preceding.length?0:3-preceding.match(/(\n{0,2})$/)[0].length;component.editor.insertAtCursor(Array(precedingNewlines).join("\n")+(quote?"> "+mention+quote.trim().replace(/\n/g,"\n> ")+"\n\n":mention))}var post=this.props.post;post.isHidden()||app.session.user&&!post.discussion().canReply()||items.add("reply",Button.component({className:"Button Button--link",children:app.translator.trans("flarum-mentions.forum.post.reply_link"),onclick:function(){var quote=window.getSelection().toString(),component=app.composer.component;component&&component.props.post&&component.props.post.discussion()===post.discussion()?insertMention(component,quote):DiscussionControls.replyAction.call(post.discussion()).then(function(newComponent){return insertMention(newComponent,quote)})}}))})}),{setters:[function(_flarumExtend){extend=_flarumExtend.extend},function(_flarumComponentsButton){Button=_flarumComponentsButton.default},function(_flarumComponentsCommentPost){CommentPost=_flarumComponentsCommentPost.default},function(_flarumUtilsDiscussionControls){DiscussionControls=_flarumUtilsDiscussionControls.default}],execute:function(){}}}),System.register("flarum/mentions/components/AutocompleteDropdown",["flarum/Component"],function(_export,_context){var Component,AutocompleteDropdown;return{setters:[function(_flarumComponent){Component=_flarumComponent.default}],execute:function(){AutocompleteDropdown=function(_Component){function AutocompleteDropdown(){return babelHelpers.classCallCheck(this,AutocompleteDropdown),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(AutocompleteDropdown).apply(this,arguments))}return babelHelpers.inherits(AutocompleteDropdown,_Component),babelHelpers.createClass(AutocompleteDropdown,[{key:"init",value:function(){this.active=!1,this.index=0,this.keyWasJustPressed=!1}},{key:"view",value:function(){return m("ul",{className:"Dropdown-menu MentionsDropdown"},this.props.items.map(function(item){return m("li",null,item)}))}},{key:"show",value:function(left,top){this.$().show().css({left:left+"px",top:top+"px"}),this.active=!0}},{key:"hide",value:function(){this.$().hide(),this.active=!1}},{key:"navigate",value:function(e){var _this2=this;if(this.active)switch(e.which){case 40:case 38:this.keyWasJustPressed=!0,this.setIndex(this.index+(40===e.which?1:-1),!0),clearTimeout(this.keyWasJustPressedTimeout),this.keyWasJustPressedTimeout=setTimeout(function(){return _this2.keyWasJustPressed=!1},500),e.preventDefault();break;case 13:case 9:this.$("li").eq(this.index).find("button").click(),e.preventDefault();break;case 27:this.hide(),e.stopPropagation(),e.preventDefault()}}},{key:"setIndex",value:function(index,scrollToItem){if(!this.keyWasJustPressed||scrollToItem){var $dropdown=this.$(),$items=$dropdown.find("li"),rangedIndex=index;rangedIndex<0?rangedIndex=$items.length-1:rangedIndex>=$items.length&&(rangedIndex=0),this.index=rangedIndex;var $item=$items.removeClass("active").eq(rangedIndex).addClass("active");if(scrollToItem){var dropdownScroll=$dropdown.scrollTop(),dropdownTop=$dropdown.offset().top,dropdownBottom=dropdownTop+$dropdown.outerHeight(),itemTop=$item.offset().top,itemBottom=itemTop+$item.outerHeight(),scrollTop=void 0;itemTop<dropdownTop?scrollTop=dropdownScroll-dropdownTop+itemTop-parseInt($dropdown.css("padding-top"),10):itemBottom>dropdownBottom&&(scrollTop=dropdownScroll-dropdownBottom+itemBottom+parseInt($dropdown.css("padding-bottom"),10)),"undefined"!=typeof scrollTop&&$dropdown.stop(!0).animate({scrollTop:scrollTop},100)}}}}]),AutocompleteDropdown}(Component),_export("default",AutocompleteDropdown)}}}),System.register("flarum/mentions/components/MentionsUserPage",["flarum/components/PostsUserPage"],function(_export,_context){var PostsUserPage,MentionsUserPage;return{setters:[function(_flarumComponentsPostsUserPage){PostsUserPage=_flarumComponentsPostsUserPage.default}],execute:function(){MentionsUserPage=function(_PostsUserPage){function MentionsUserPage(){return babelHelpers.classCallCheck(this,MentionsUserPage),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(MentionsUserPage).apply(this,arguments))}return babelHelpers.inherits(MentionsUserPage,_PostsUserPage),babelHelpers.createClass(MentionsUserPage,[{key:"loadResults",value:function(offset){return app.store.find("posts",{filter:{type:"comment",mentioned:this.user.id()},page:{offset:offset,limit:this.loadLimit},sort:"-time"})}}]),MentionsUserPage}(PostsUserPage),_export("default",MentionsUserPage)}}}),System.register("flarum/mentions/components/PostMentionedNotification",["flarum/components/Notification","flarum/helpers/username","flarum/helpers/punctuateSeries"],function(_export,_context){var Notification,username,punctuateSeries,PostMentionedNotification;return{setters:[function(_flarumComponentsNotification){Notification=_flarumComponentsNotification.default},function(_flarumHelpersUsername){username=_flarumHelpersUsername.default},function(_flarumHelpersPunctuateSeries){punctuateSeries=_flarumHelpersPunctuateSeries.default}],execute:function(){PostMentionedNotification=function(_Notification){function PostMentionedNotification(){return babelHelpers.classCallCheck(this,PostMentionedNotification),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(PostMentionedNotification).apply(this,arguments))}return babelHelpers.inherits(PostMentionedNotification,_Notification),babelHelpers.createClass(PostMentionedNotification,[{key:"icon",value:function(){return"reply"}},{key:"href",value:function(){var notification=this.props.notification,post=notification.subject(),auc=notification.additionalUnreadCount(),content=notification.content();return app.route.discussion(post.discussion(),auc?post.number():content&&content.replyNumber)}},{key:"content",value:function(){var notification=this.props.notification,auc=notification.additionalUnreadCount(),user=notification.sender();return app.translator.transChoice("flarum-mentions.forum.notifications.post_mentioned_text",auc+1,{user:user,username:auc?punctuateSeries([username(user),app.translator.transChoice("flarum-mentions.forum.notifications.others_text",auc,{count:auc})]):void 0})}},{key:"excerpt",value:function(){return this.props.notification.subject().contentPlain()}}]),PostMentionedNotification}(Notification),_export("default",PostMentionedNotification)}}}),System.register("flarum/mentions/components/UserMentionedNotification",["flarum/components/Notification"],function(_export,_context){var Notification,UserMentionedNotification;return{setters:[function(_flarumComponentsNotification){Notification=_flarumComponentsNotification.default}],execute:function(){UserMentionedNotification=function(_Notification){function UserMentionedNotification(){return babelHelpers.classCallCheck(this,UserMentionedNotification),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(UserMentionedNotification).apply(this,arguments))}return babelHelpers.inherits(UserMentionedNotification,_Notification),babelHelpers.createClass(UserMentionedNotification,[{key:"icon",value:function(){return"at"}},{key:"href",value:function(){var post=this.props.notification.subject();return app.route.discussion(post.discussion(),post.number())}},{key:"content",value:function(){var user=this.props.notification.sender();return app.translator.trans("flarum-mentions.forum.notifications.user_mentioned_text",{user:user})}},{key:"excerpt",value:function(){return this.props.notification.subject().contentPlain()}}]),UserMentionedNotification}(Notification),_export("default",UserMentionedNotification)}}}),System.register("flarum/mentions/main",["flarum/extend","flarum/app","flarum/components/NotificationGrid","flarum/utils/string","flarum/mentions/addPostMentionPreviews","flarum/mentions/addMentionedByList","flarum/mentions/addPostReplyAction","flarum/mentions/addComposerAutocomplete","flarum/mentions/components/PostMentionedNotification","flarum/mentions/components/UserMentionedNotification","flarum/components/UserPage","flarum/components/LinkButton","flarum/mentions/components/MentionsUserPage"],function(_export,_context){var extend,app,NotificationGrid,getPlainContent,addPostMentionPreviews,addMentionedByList,addPostReplyAction,addComposerAutocomplete,PostMentionedNotification,UserMentionedNotification,UserPage,LinkButton,MentionsUserPage;return{setters:[function(_flarumExtend){extend=_flarumExtend.extend},function(_flarumApp){app=_flarumApp.default},function(_flarumComponentsNotificationGrid){NotificationGrid=_flarumComponentsNotificationGrid.default},function(_flarumUtilsString){getPlainContent=_flarumUtilsString.getPlainContent},function(_flarumMentionsAddPostMentionPreviews){addPostMentionPreviews=_flarumMentionsAddPostMentionPreviews.default},function(_flarumMentionsAddMentionedByList){addMentionedByList=_flarumMentionsAddMentionedByList.default},function(_flarumMentionsAddPostReplyAction){addPostReplyAction=_flarumMentionsAddPostReplyAction.default},function(_flarumMentionsAddComposerAutocomplete){addComposerAutocomplete=_flarumMentionsAddComposerAutocomplete.default},function(_flarumMentionsComponentsPostMentionedNotification){PostMentionedNotification=_flarumMentionsComponentsPostMentionedNotification.default},function(_flarumMentionsComponentsUserMentionedNotification){UserMentionedNotification=_flarumMentionsComponentsUserMentionedNotification.default},function(_flarumComponentsUserPage){UserPage=_flarumComponentsUserPage.default},function(_flarumComponentsLinkButton){LinkButton=_flarumComponentsLinkButton.default},function(_flarumMentionsComponentsMentionsUserPage){MentionsUserPage=_flarumMentionsComponentsMentionsUserPage.default}],execute:function(){app.initializers.add("flarum-mentions",function(){addPostMentionPreviews(),addMentionedByList(),addPostReplyAction(),addComposerAutocomplete(),app.notificationComponents.postMentioned=PostMentionedNotification,app.notificationComponents.userMentioned=UserMentionedNotification,extend(NotificationGrid.prototype,"notificationTypes",function(items){items.add("postMentioned",{name:"postMentioned",icon:"reply",label:app.translator.trans("flarum-mentions.forum.settings.notify_post_mentioned_label")}),items.add("userMentioned",{name:"userMentioned",icon:"at",label:app.translator.trans("flarum-mentions.forum.settings.notify_user_mentioned_label")})}),app.routes["user.mentions"]={path:"/u/:username/mentions",component:MentionsUserPage.component()},extend(UserPage.prototype,"navItems",function(items){var user=this.user;items.add("mentions",LinkButton.component({href:app.route("user.mentions",{username:user.username()}),name:"mentions",children:[app.translator.trans("flarum-mentions.forum.user.mentions_link")],icon:"at"}),80)}),getPlainContent.removeSelectors.push("a.PostMention")})}}}),System.register("flarum/sticky/addStickyBadge",["flarum/extend","flarum/models/Discussion","flarum/components/Badge"],function(_export,_context){function addStickyBadge(){extend(Discussion.prototype,"badges",function(badges){this.isSticky()&&badges.add("sticky",Badge.component({type:"sticky",label:app.translator.trans("flarum-sticky.forum.badge.sticky_tooltip"),icon:"thumb-tack"}),10)})}var extend,Discussion,Badge;return _export("default",addStickyBadge),{setters:[function(_flarumExtend){extend=_flarumExtend.extend},function(_flarumModelsDiscussion){Discussion=_flarumModelsDiscussion.default},function(_flarumComponentsBadge){Badge=_flarumComponentsBadge.default}],execute:function(){}}}),System.register("flarum/sticky/addStickyControl",["flarum/extend","flarum/utils/DiscussionControls","flarum/components/DiscussionPage","flarum/components/Button"],function(_export,_context){function addStickyControl(){extend(DiscussionControls,"moderationControls",function(items,discussion){discussion.canSticky()&&items.add("sticky",Button.component({children:app.translator.trans(discussion.isSticky()?"flarum-sticky.forum.discussion_controls.unsticky_button":"flarum-sticky.forum.discussion_controls.sticky_button"),icon:"thumb-tack",onclick:this.stickyAction.bind(discussion)}))}),DiscussionControls.stickyAction=function(){this.save({isSticky:!this.isSticky()}).then(function(){app.current instanceof DiscussionPage&&app.current.stream.update(),m.redraw()})}}var extend,DiscussionControls,DiscussionPage,Button;return _export("default",addStickyControl),{setters:[function(_flarumExtend){extend=_flarumExtend.extend},function(_flarumUtilsDiscussionControls){DiscussionControls=_flarumUtilsDiscussionControls.default},function(_flarumComponentsDiscussionPage){DiscussionPage=_flarumComponentsDiscussionPage.default},function(_flarumComponentsButton){Button=_flarumComponentsButton.default}],execute:function(){}}}),System.register("flarum/sticky/addStickyExcerpt",["flarum/extend","flarum/components/DiscussionList","flarum/components/DiscussionListItem","flarum/utils/string"],function(_export,_context){function addStickyControl(){extend(DiscussionList.prototype,"requestParams",function(params){params.include.push("startPost")}),extend(DiscussionListItem.prototype,"infoItems",function(items){var discussion=this.props.discussion;if(discussion.isSticky()){var startPost=discussion.startPost();if(startPost){var excerpt=m("span",null,truncate(startPost.contentPlain(),200));items.add("excerpt",excerpt,-100)}}})}var extend,DiscussionList,DiscussionListItem,truncate;return _export("default",addStickyControl),{setters:[function(_flarumExtend){extend=_flarumExtend.extend},function(_flarumComponentsDiscussionList){DiscussionList=_flarumComponentsDiscussionList.default},function(_flarumComponentsDiscussionListItem){DiscussionListItem=_flarumComponentsDiscussionListItem.default},function(_flarumUtilsString){truncate=_flarumUtilsString.truncate}],execute:function(){}}}),System.register("flarum/sticky/components/DiscussionStickiedPost",["flarum/components/EventPost"],function(_export,_context){var EventPost,DiscussionStickiedPost;return{setters:[function(_flarumComponentsEventPost){EventPost=_flarumComponentsEventPost.default}],execute:function(){DiscussionStickiedPost=function(_EventPost){function DiscussionStickiedPost(){return babelHelpers.classCallCheck(this,DiscussionStickiedPost),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(DiscussionStickiedPost).apply(this,arguments))}return babelHelpers.inherits(DiscussionStickiedPost,_EventPost),babelHelpers.createClass(DiscussionStickiedPost,[{key:"icon",value:function(){return"thumb-tack"}},{key:"descriptionKey",value:function(){return this.props.post.content().sticky?"flarum-sticky.forum.post_stream.discussion_stickied_text":"flarum-sticky.forum.post_stream.discussion_unstickied_text"}}]),DiscussionStickiedPost}(EventPost),_export("default",DiscussionStickiedPost)}}}),System.register("flarum/sticky/main",["flarum/extend","flarum/app","flarum/Model","flarum/models/Discussion","flarum/sticky/components/DiscussionStickiedPost","flarum/sticky/addStickyBadge","flarum/sticky/addStickyControl","flarum/sticky/addStickyExcerpt"],function(_export,_context){var extend,notificationType,app,Model,Discussion,DiscussionStickiedPost,addStickyBadge,addStickyControl,addStickyExcerpt;return{setters:[function(_flarumExtend){extend=_flarumExtend.extend,notificationType=_flarumExtend.notificationType},function(_flarumApp){app=_flarumApp.default},function(_flarumModel){Model=_flarumModel.default},function(_flarumModelsDiscussion){Discussion=_flarumModelsDiscussion.default},function(_flarumStickyComponentsDiscussionStickiedPost){DiscussionStickiedPost=_flarumStickyComponentsDiscussionStickiedPost.default},function(_flarumStickyAddStickyBadge){addStickyBadge=_flarumStickyAddStickyBadge.default},function(_flarumStickyAddStickyControl){addStickyControl=_flarumStickyAddStickyControl.default},function(_flarumStickyAddStickyExcerpt){addStickyExcerpt=_flarumStickyAddStickyExcerpt.default}],execute:function(){app.initializers.add("flarum-sticky",function(){app.postComponents.discussionStickied=DiscussionStickiedPost,Discussion.prototype.isSticky=Model.attribute("isSticky"),Discussion.prototype.canSticky=Model.attribute("canSticky"),addStickyBadge(),addStickyControl(),addStickyExcerpt()})}}}),System.register("flarum/tags/addTagComposer",["flarum/extend","flarum/components/IndexPage","flarum/components/DiscussionComposer","flarum/tags/components/TagDiscussionModal","flarum/tags/helpers/tagsLabel"],function(_export,_context){var extend,override,IndexPage,DiscussionComposer,TagDiscussionModal,tagsLabel;return _export("default",function(){extend(IndexPage.prototype,"composeNewDiscussion",function(promise){var tag=app.store.getBy("tags","slug",this.params().tags);tag&&!function(){var parent=tag.parent(),tags=parent?[parent,tag]:[tag];promise.then(function(component){return component.tags=tags})}()}),DiscussionComposer.prototype.tags=[],DiscussionComposer.prototype.chooseTags=function(){var _this=this;app.modal.show(new TagDiscussionModal({selectedTags:this.tags.slice(0),onsubmit:function(tags){_this.tags=tags,_this.$("textarea").focus();
}}))},extend(DiscussionComposer.prototype,"headerItems",function(items){items.add("tags",m("a",{className:"DiscussionComposer-changeTags",onclick:this.chooseTags.bind(this)},this.tags.length?tagsLabel(this.tags):m("span",{className:"TagLabel untagged"},app.translator.trans("flarum-tags.forum.composer_discussion.choose_tags_link"))),10)}),override(DiscussionComposer.prototype,"onsubmit",function(original){var _this2=this;this.tags.length?original():app.modal.show(new TagDiscussionModal({selectedTags:[],onsubmit:function(tags){_this2.tags=tags,original()}}))}),extend(DiscussionComposer.prototype,"data",function(data){data.relationships=data.relationships||{},data.relationships.tags=this.tags})}),{setters:[function(_flarumExtend){extend=_flarumExtend.extend,override=_flarumExtend.override},function(_flarumComponentsIndexPage){IndexPage=_flarumComponentsIndexPage.default},function(_flarumComponentsDiscussionComposer){DiscussionComposer=_flarumComponentsDiscussionComposer.default},function(_flarumTagsComponentsTagDiscussionModal){TagDiscussionModal=_flarumTagsComponentsTagDiscussionModal.default},function(_flarumTagsHelpersTagsLabel){tagsLabel=_flarumTagsHelpersTagsLabel.default}],execute:function(){}}}),System.register("flarum/tags/addTagControl",["flarum/extend","flarum/utils/DiscussionControls","flarum/components/Button","flarum/tags/components/TagDiscussionModal"],function(_export,_context){var extend,DiscussionControls,Button,TagDiscussionModal;return _export("default",function(){extend(DiscussionControls,"moderationControls",function(items,discussion){discussion.canTag()&&items.add("tags",Button.component({children:app.translator.trans("flarum-tags.forum.discussion_controls.edit_tags_button"),icon:"tag",onclick:function(){return app.modal.show(new TagDiscussionModal({discussion:discussion}))}}))})}),{setters:[function(_flarumExtend){extend=_flarumExtend.extend},function(_flarumUtilsDiscussionControls){DiscussionControls=_flarumUtilsDiscussionControls.default},function(_flarumComponentsButton){Button=_flarumComponentsButton.default},function(_flarumTagsComponentsTagDiscussionModal){TagDiscussionModal=_flarumTagsComponentsTagDiscussionModal.default}],execute:function(){}}}),System.register("flarum/tags/addTagFilter",["flarum/extend","flarum/components/IndexPage","flarum/components/DiscussionList","flarum/tags/components/TagHero"],function(_export,_context){var extend,override,IndexPage,DiscussionList,TagHero;return _export("default",function(){IndexPage.prototype.currentTag=function(){var slug=this.params().tags;if(slug)return app.store.getBy("tags","slug",slug)},override(IndexPage.prototype,"hero",function(original){var tag=this.currentTag();return tag?TagHero.component({tag:tag}):original()}),extend(IndexPage.prototype,"sidebarItems",function(items){var tag=this.currentTag();if(tag){var color=tag.color();color&&(items.get("newDiscussion").props.style={backgroundColor:color})}}),extend(IndexPage.prototype,"params",function(params){params.tags=m.route.param("tags")}),extend(DiscussionList.prototype,"requestParams",function(params){params.include.push("tags"),this.props.params.tags&&(params.filter.q=(params.filter.q||"")+" tag:"+this.props.params.tags)})}),{setters:[function(_flarumExtend){extend=_flarumExtend.extend,override=_flarumExtend.override},function(_flarumComponentsIndexPage){IndexPage=_flarumComponentsIndexPage.default},function(_flarumComponentsDiscussionList){DiscussionList=_flarumComponentsDiscussionList.default},function(_flarumTagsComponentsTagHero){TagHero=_flarumTagsComponentsTagHero.default}],execute:function(){}}}),System.register("flarum/tags/addTagLabels",["flarum/extend","flarum/components/DiscussionListItem","flarum/components/DiscussionPage","flarum/components/DiscussionHero","flarum/tags/helpers/tagsLabel","flarum/tags/utils/sortTags"],function(_export,_context){var extend,DiscussionListItem,DiscussionPage,DiscussionHero,tagsLabel,sortTags;return _export("default",function(){extend(DiscussionListItem.prototype,"infoItems",function(items){var tags=this.props.discussion.tags();tags&&tags.length&&items.add("tags",tagsLabel(tags),10)}),extend(DiscussionPage.prototype,"params",function(params){params.include.push("tags")}),extend(DiscussionHero.prototype,"view",function(view){var tags=sortTags(this.props.discussion.tags());if(tags&&tags.length){var color=tags[0].color();color&&(view.attrs.style={backgroundColor:color},view.attrs.className+=" DiscussionHero--colored")}}),extend(DiscussionHero.prototype,"items",function(items){var tags=this.props.discussion.tags();tags&&tags.length&&items.add("tags",tagsLabel(tags,{link:!0}),5)})}),{setters:[function(_flarumExtend){extend=_flarumExtend.extend},function(_flarumComponentsDiscussionListItem){DiscussionListItem=_flarumComponentsDiscussionListItem.default},function(_flarumComponentsDiscussionPage){DiscussionPage=_flarumComponentsDiscussionPage.default},function(_flarumComponentsDiscussionHero){DiscussionHero=_flarumComponentsDiscussionHero.default},function(_flarumTagsHelpersTagsLabel){tagsLabel=_flarumTagsHelpersTagsLabel.default},function(_flarumTagsUtilsSortTags){sortTags=_flarumTagsUtilsSortTags.default}],execute:function(){}}}),System.register("flarum/tags/addTagList",["flarum/extend","flarum/components/IndexPage","flarum/components/Separator","flarum/components/LinkButton","flarum/tags/components/TagLinkButton","flarum/tags/components/TagsPage","flarum/tags/utils/sortTags"],function(_export,_context){var extend,IndexPage,Separator,LinkButton,TagLinkButton,TagsPage,sortTags;return _export("default",function(){extend(IndexPage.prototype,"navItems",function(items){if(items.add("tags",LinkButton.component({icon:"th-large",children:app.translator.trans("flarum-tags.forum.index.tags_link"),href:app.route("tags")}),-10),!(app.current instanceof TagsPage)){items.add("separator",Separator.component(),-10);var params=this.stickyParams(),tags=app.store.all("tags"),currentTag=this.currentTag(),addTag=function(tag){var active=currentTag===tag;!active&&currentTag&&(active=currentTag.parent()===tag),items.add("tag"+tag.id(),TagLinkButton.component({tag:tag,params:params,active:active}),-10)};sortTags(tags).filter(function(tag){return null!==tag.position()&&(!tag.isChild()||currentTag&&(tag.parent()===currentTag||tag.parent()===currentTag.parent()))}).forEach(addTag);var more=tags.filter(function(tag){return null===tag.position()}).sort(function(a,b){return b.discussionsCount()-a.discussionsCount()});more.splice(0,3).forEach(addTag),more.length&&items.add("moreTags",LinkButton.component({children:app.translator.trans("flarum-tags.forum.index.more_link"),href:app.route("tags")}),-10)}})}),{setters:[function(_flarumExtend){extend=_flarumExtend.extend},function(_flarumComponentsIndexPage){IndexPage=_flarumComponentsIndexPage.default},function(_flarumComponentsSeparator){Separator=_flarumComponentsSeparator.default},function(_flarumComponentsLinkButton){LinkButton=_flarumComponentsLinkButton.default},function(_flarumTagsComponentsTagLinkButton){TagLinkButton=_flarumTagsComponentsTagLinkButton.default},function(_flarumTagsComponentsTagsPage){TagsPage=_flarumTagsComponentsTagsPage.default},function(_flarumTagsUtilsSortTags){sortTags=_flarumTagsUtilsSortTags.default}],execute:function(){}}}),System.register("flarum/tags/components/DiscussionTaggedPost",["flarum/components/EventPost","flarum/helpers/punctuateSeries","flarum/tags/helpers/tagsLabel"],function(_export,_context){var EventPost,punctuateSeries,tagsLabel,DiscussionTaggedPost;return{setters:[function(_flarumComponentsEventPost){EventPost=_flarumComponentsEventPost.default},function(_flarumHelpersPunctuateSeries){punctuateSeries=_flarumHelpersPunctuateSeries.default},function(_flarumTagsHelpersTagsLabel){tagsLabel=_flarumTagsHelpersTagsLabel.default}],execute:function(){DiscussionTaggedPost=function(_EventPost){function DiscussionTaggedPost(){return babelHelpers.classCallCheck(this,DiscussionTaggedPost),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(DiscussionTaggedPost).apply(this,arguments))}return babelHelpers.inherits(DiscussionTaggedPost,_EventPost),babelHelpers.createClass(DiscussionTaggedPost,[{key:"icon",value:function(){return"tag"}},{key:"descriptionKey",value:function(){return this.props.tagsAdded.length?this.props.tagsRemoved.length?"flarum-tags.forum.post_stream.added_and_removed_tags_text":"flarum-tags.forum.post_stream.added_tags_text":"flarum-tags.forum.post_stream.removed_tags_text"}},{key:"descriptionData",value:function(){var data={};return this.props.tagsAdded.length&&(data.tagsAdded=app.translator.transChoice("flarum-tags.forum.post_stream.tags_text",this.props.tagsAdded.length,{tags:tagsLabel(this.props.tagsAdded,{link:!0}),count:this.props.tagsAdded.length})),this.props.tagsRemoved.length&&(data.tagsRemoved=app.translator.transChoice("flarum-tags.forum.post_stream.tags_text",this.props.tagsRemoved.length,{tags:tagsLabel(this.props.tagsRemoved,{link:!0}),count:this.props.tagsRemoved.length})),data}}],[{key:"initProps",value:function(props){function diffTags(tags1,tags2){return tags1.filter(function(tag){return tags2.indexOf(tag)===-1}).map(function(id){return app.store.getById("tags",id)})}babelHelpers.get(Object.getPrototypeOf(DiscussionTaggedPost),"initProps",this).call(this,props);var oldTags=props.post.content()[0],newTags=props.post.content()[1];props.tagsAdded=diffTags(newTags,oldTags),props.tagsRemoved=diffTags(oldTags,newTags)}}]),DiscussionTaggedPost}(EventPost),_export("default",DiscussionTaggedPost)}}}),System.register("flarum/tags/components/TagDiscussionModal",["flarum/components/Modal","flarum/components/DiscussionPage","flarum/components/Button","flarum/helpers/highlight","flarum/utils/classList","flarum/utils/extractText","flarum/tags/helpers/tagLabel","flarum/tags/helpers/tagIcon","flarum/tags/utils/sortTags"],function(_export,_context){var Modal,DiscussionPage,Button,highlight,classList,extractText,tagLabel,tagIcon,sortTags,TagDiscussionModal;return{setters:[function(_flarumComponentsModal){Modal=_flarumComponentsModal.default},function(_flarumComponentsDiscussionPage){DiscussionPage=_flarumComponentsDiscussionPage.default},function(_flarumComponentsButton){Button=_flarumComponentsButton.default},function(_flarumHelpersHighlight){highlight=_flarumHelpersHighlight.default},function(_flarumUtilsClassList){classList=_flarumUtilsClassList.default},function(_flarumUtilsExtractText){extractText=_flarumUtilsExtractText.default},function(_flarumTagsHelpersTagLabel){tagLabel=_flarumTagsHelpersTagLabel.default},function(_flarumTagsHelpersTagIcon){tagIcon=_flarumTagsHelpersTagIcon.default},function(_flarumTagsUtilsSortTags){sortTags=_flarumTagsUtilsSortTags.default}],execute:function(){TagDiscussionModal=function(_Modal){function TagDiscussionModal(){return babelHelpers.classCallCheck(this,TagDiscussionModal),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(TagDiscussionModal).apply(this,arguments))}return babelHelpers.inherits(TagDiscussionModal,_Modal),babelHelpers.createClass(TagDiscussionModal,[{key:"init",value:function(){babelHelpers.get(Object.getPrototypeOf(TagDiscussionModal.prototype),"init",this).call(this),this.tags=sortTags(app.store.all("tags").filter(function(tag){return tag.canStartDiscussion()})),this.selected=[],this.filter=m.prop(""),this.index=this.tags[0].id(),this.focused=!1,this.props.selectedTags?this.props.selectedTags.map(this.addTag.bind(this)):this.props.discussion&&this.props.discussion.tags().map(this.addTag.bind(this)),this.minPrimary=app.forum.attribute("minPrimaryTags"),this.maxPrimary=app.forum.attribute("maxPrimaryTags"),this.minSecondary=app.forum.attribute("minSecondaryTags"),this.maxSecondary=app.forum.attribute("maxSecondaryTags")}},{key:"primaryCount",value:function(){return this.selected.filter(function(tag){return tag.isPrimary()}).length}},{key:"secondaryCount",value:function(){return this.selected.filter(function(tag){return!tag.isPrimary()}).length}},{key:"addTag",value:function(tag){if(tag.canStartDiscussion()){var parent=tag.parent();if(parent){var index=this.selected.indexOf(parent);index===-1&&this.selected.push(parent)}this.selected.push(tag)}}},{key:"removeTag",value:function(tag){var index=this.selected.indexOf(tag);index!==-1&&(this.selected.splice(index,1),this.selected.filter(function(selected){return selected.parent()===tag}).forEach(this.removeTag.bind(this)))}},{key:"className",value:function(){return"TagDiscussionModal"}},{key:"title",value:function(){return this.props.discussion?app.translator.trans("flarum-tags.forum.choose_tags.edit_title",{title:m("em",null,this.props.discussion.title())}):app.translator.trans("flarum-tags.forum.choose_tags.title")}},{key:"getInstruction",value:function(primaryCount,secondaryCount){if(primaryCount<this.minPrimary){var remaining=this.minPrimary-primaryCount;return app.translator.transChoice("flarum-tags.forum.choose_tags.choose_primary_placeholder",remaining,{count:remaining})}if(secondaryCount<this.minSecondary){var _remaining=this.minSecondary-secondaryCount;return app.translator.transChoice("flarum-tags.forum.choose_tags.choose_secondary_placeholder",_remaining,{count:_remaining})}return""}},{key:"content",value:function(){var _this2=this,tags=this.tags,filter=this.filter().toLowerCase(),primaryCount=this.primaryCount(),secondaryCount=this.secondaryCount();return tags=tags.filter(function(tag){var parent=tag.parent();return parent===!1||_this2.selected.indexOf(parent)!==-1}),primaryCount>=app.forum.attribute("maxPrimaryTags")&&(tags=tags.filter(function(tag){return!tag.isPrimary()||_this2.selected.indexOf(tag)!==-1})),secondaryCount>=app.forum.attribute("maxSecondaryTags")&&(tags=tags.filter(function(tag){return tag.isPrimary()||_this2.selected.indexOf(tag)!==-1})),filter&&(tags=tags.filter(function(tag){return tag.name().substr(0,filter.length).toLowerCase()===filter})),tags.indexOf(this.index)===-1&&(this.index=tags[0]),[m("div",{className:"Modal-body"},m("div",{className:"TagDiscussionModal-form"},m("div",{className:"TagDiscussionModal-form-input"},m("div",{className:"TagsInput FormControl "+(this.focused?"focus":"")},m("span",{className:"TagsInput-selected"},this.selected.map(function(tag){return m("span",{className:"TagsInput-tag",onclick:function(){_this2.removeTag(tag),_this2.onready()}},tagLabel(tag))})),m("input",{className:"FormControl",placeholder:extractText(this.getInstruction(primaryCount,secondaryCount)),value:this.filter(),oninput:m.withAttr("value",this.filter),onkeydown:this.onkeydown.bind(this),onfocus:function(){return _this2.focused=!0},onblur:function(){return _this2.focused=!1}}))),m("div",{className:"TagDiscussionModal-form-submit App-primaryControl"},Button.component({type:"submit",className:"Button Button--primary",disabled:primaryCount<this.minPrimary||secondaryCount<this.minSecondary,icon:"check",children:app.translator.trans("flarum-tags.forum.choose_tags.submit_button")})))),m("div",{className:"Modal-footer"},m("ul",{className:"TagDiscussionModal-list SelectTagList"},tags.filter(function(tag){return filter||!tag.parent()||_this2.selected.indexOf(tag.parent())!==-1}).map(function(tag){return m("li",{"data-index":tag.id(),className:classList({pinned:null!==tag.position(),child:!!tag.parent(),colored:!!tag.color(),selected:_this2.selected.indexOf(tag)!==-1,active:_this2.index===tag}),style:{color:tag.color()},onmouseover:function(){return _this2.index=tag},onclick:_this2.toggleTag.bind(_this2,tag)},tagIcon(tag),m("span",{className:"SelectTagListItem-name"},highlight(tag.name(),filter)),tag.description()?m("span",{className:"SelectTagListItem-description"},tag.description()):"")})))]}},{key:"toggleTag",value:function(tag){var index=this.selected.indexOf(tag);index!==-1?this.removeTag(tag):this.addTag(tag),this.filter()&&(this.filter(""),this.index=this.tags[0]),this.onready()}},{key:"onkeydown",value:function(e){switch(e.which){case 40:case 38:e.preventDefault(),this.setIndex(this.getCurrentNumericIndex()+(40===e.which?1:-1),!0);break;case 13:e.preventDefault(),e.metaKey||e.ctrlKey||this.selected.indexOf(this.index)!==-1?this.selected.length&&this.$("form").submit():this.getItem(this.index)[0].dispatchEvent(new Event("click"));break;case 8:0===e.target.selectionStart&&0===e.target.selectionEnd&&(e.preventDefault(),this.selected.splice(this.selected.length-1,1))}}},{key:"selectableItems",value:function(){return this.$(".TagDiscussionModal-list > li")}},{key:"getCurrentNumericIndex",value:function(){return this.selectableItems().index(this.getItem(this.index))}},{key:"getItem",value:function(index){return this.selectableItems().filter('[data-index="'+index.id()+'"]')}},{key:"setIndex",value:function(index,scrollToItem){var $items=this.selectableItems(),$dropdown=$items.parent();index<0?index=$items.length-1:index>=$items.length&&(index=0);var $item=$items.eq(index);if(this.index=app.store.getById("tags",$item.attr("data-index")),m.redraw(),scrollToItem){var dropdownScroll=$dropdown.scrollTop(),dropdownTop=$dropdown.offset().top,dropdownBottom=dropdownTop+$dropdown.outerHeight(),itemTop=$item.offset().top,itemBottom=itemTop+$item.outerHeight(),scrollTop=void 0;itemTop<dropdownTop?scrollTop=dropdownScroll-dropdownTop+itemTop-parseInt($dropdown.css("padding-top"),10):itemBottom>dropdownBottom&&(scrollTop=dropdownScroll-dropdownBottom+itemBottom+parseInt($dropdown.css("padding-bottom"),10)),"undefined"!=typeof scrollTop&&$dropdown.stop(!0).animate({scrollTop:scrollTop},100)}}},{key:"onsubmit",value:function(e){e.preventDefault();var discussion=this.props.discussion,tags=this.selected;discussion&&discussion.save({relationships:{tags:tags}}).then(function(){app.current instanceof DiscussionPage&&app.current.stream.update(),m.redraw()}),this.props.onsubmit&&this.props.onsubmit(tags),app.modal.close(),m.redraw.strategy("none")}}]),TagDiscussionModal}(Modal),_export("default",TagDiscussionModal)}}}),System.register("flarum/tags/components/TagHero",["flarum/Component"],function(_export,_context){var Component,TagHero;return{setters:[function(_flarumComponent){Component=_flarumComponent.default}],execute:function(){TagHero=function(_Component){function TagHero(){return babelHelpers.classCallCheck(this,TagHero),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(TagHero).apply(this,arguments))}return babelHelpers.inherits(TagHero,_Component),babelHelpers.createClass(TagHero,[{key:"view",value:function(){var tag=this.props.tag,color=tag.color();return m("header",{className:"Hero TagHero"+(color?" TagHero--colored":""),style:color?{color:"#fff",backgroundColor:color}:""},m("div",{className:"container"},m("div",{className:"containerNarrow"},m("h2",{className:"Hero-title"},tag.name()),m("div",{className:"Hero-subtitle"},tag.description()))))}}]),TagHero}(Component),_export("default",TagHero)}}}),System.register("flarum/tags/components/TagLinkButton",["flarum/components/LinkButton","flarum/tags/helpers/tagIcon"],function(_export,_context){var LinkButton,tagIcon,TagLinkButton;return{setters:[function(_flarumComponentsLinkButton){LinkButton=_flarumComponentsLinkButton.default},function(_flarumTagsHelpersTagIcon){tagIcon=_flarumTagsHelpersTagIcon.default}],execute:function(){TagLinkButton=function(_LinkButton){function TagLinkButton(){return babelHelpers.classCallCheck(this,TagLinkButton),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(TagLinkButton).apply(this,arguments))}return babelHelpers.inherits(TagLinkButton,_LinkButton),babelHelpers.createClass(TagLinkButton,[{key:"view",value:function(){var tag=this.props.tag,active=this.constructor.isActive(this.props),description=tag&&tag.description();return m("a",{className:"TagLinkButton hasIcon "+(tag.isChild()?"child":""),href:this.props.href,config:m.route,style:active&&tag?{color:tag.color()}:"",title:description||""},tagIcon(tag,{className:"Button-icon"}),this.props.children)}}],[{key:"initProps",value:function(props){var tag=props.tag;props.params.tags=tag?tag.slug():"untagged",props.href=app.route("tag",props.params),props.children=tag?tag.name():app.translator.trans("flarum-tags.forum.index.untagged_link")}}]),TagLinkButton}(LinkButton),_export("default",TagLinkButton)}}}),System.register("flarum/tags/components/TagsPage",["flarum/Component","flarum/components/IndexPage","flarum/helpers/listItems","flarum/helpers/humanTime","flarum/helpers/icon","flarum/tags/helpers/tagLabel","flarum/tags/utils/sortTags"],function(_export,_context){var Component,IndexPage,listItems,humanTime,icon,tagLabel,sortTags,TagsPage;return{setters:[function(_flarumComponent){Component=_flarumComponent.default},function(_flarumComponentsIndexPage){IndexPage=_flarumComponentsIndexPage.default},function(_flarumHelpersListItems){listItems=_flarumHelpersListItems.default},function(_flarumHelpersHumanTime){humanTime=_flarumHelpersHumanTime.default},function(_flarumHelpersIcon){icon=_flarumHelpersIcon.default},function(_flarumTagsHelpersTagLabel){tagLabel=_flarumTagsHelpersTagLabel.default},function(_flarumTagsUtilsSortTags){sortTags=_flarumTagsUtilsSortTags.default}],execute:function(){TagsPage=function(_Component){function TagsPage(){return babelHelpers.classCallCheck(this,TagsPage),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(TagsPage).apply(this,arguments))}return babelHelpers.inherits(TagsPage,_Component),babelHelpers.createClass(TagsPage,[{key:"init",value:function(){this.tags=sortTags(app.store.all("tags").filter(function(tag){return!tag.parent()})),app.current=this,app.history.push("tags",icon("th-large")),app.drawer.hide(),app.modal.close()}},{key:"view",value:function(){var pinned=this.tags.filter(function(tag){return null!==tag.position()}),cloud=this.tags.filter(function(tag){return null===tag.position()});return m("div",{className:"TagsPage"},IndexPage.prototype.hero(),m("div",{className:"container"},m("nav",{className:"TagsPage-nav IndexPage-nav sideNav",config:IndexPage.prototype.affixSidebar},m("ul",null,listItems(IndexPage.prototype.sidebarItems().toArray()))),m("div",{className:"TagsPage-content sideNavOffset"},m("ul",{className:"TagTiles"},pinned.map(function(tag){var lastDiscussion=tag.lastDiscussion(),children=sortTags(app.store.all("tags").filter(function(child){return child.parent()===tag}));return m("li",{className:"TagTile "+(tag.color()?"colored":""),style:{backgroundColor:tag.color()}},m("a",{className:"TagTile-info",href:app.route.tag(tag),config:m.route},m("h3",{className:"TagTile-name"},tag.name()),m("p",{className:"TagTile-description"},tag.description()),children?m("div",{className:"TagTile-children"},children.map(function(child){return[m("a",{href:app.route.tag(child),config:function(element,isInitialized){isInitialized||($(element).on("click",function(e){return e.stopPropagation()}),m.route.apply(this,arguments))}},child.name())," "]})):""),lastDiscussion?m("a",{className:"TagTile-lastDiscussion",href:app.route.discussion(lastDiscussion,lastDiscussion.lastPostNumber()),config:m.route},m("span",{className:"TagTile-lastDiscussion-title"},lastDiscussion.title()),humanTime(lastDiscussion.lastTime())):m("span",{className:"TagTile-lastDiscussion"}))})),cloud.length?m("div",{className:"TagCloud"},cloud.map(function(tag){tag.color();return[tagLabel(tag,{link:!0})," "]})):"")))}}]),TagsPage}(Component),_export("default",TagsPage)}}}),System.register("flarum/tags/helpers/tagIcon",[],function(_export,_context){function tagIcon(tag){var attrs=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return attrs.className="icon TagIcon "+(attrs.className||""),tag?(attrs.style=attrs.style||{},attrs.style.backgroundColor=tag.color()):attrs.className+=" untagged",m("span",attrs)}return _export("default",tagIcon),{setters:[],execute:function(){}}}),System.register("flarum/tags/helpers/tagLabel",["flarum/utils/extract"],function(_export,_context){function tagLabel(tag){var attrs=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];attrs.style=attrs.style||{},attrs.className="TagLabel "+(attrs.className||"");var link=extract(attrs,"link");if(tag){var color=tag.color();color&&(attrs.style.backgroundColor=attrs.style.color=color,attrs.className+=" colored"),link&&(attrs.title=tag.description()||"",attrs.href=app.route("tag",{tags:tag.slug()}),attrs.config=m.route)}else attrs.className+=" untagged";return m(link?"a":"span",attrs,m("span",{className:"TagLabel-text"},tag?tag.name():app.translator.trans("flarum-tags.lib.deleted_tag_text")))}var extract;return _export("default",tagLabel),{setters:[function(_flarumUtilsExtract){extract=_flarumUtilsExtract.default}],execute:function(){}}}),System.register("flarum/tags/helpers/tagsLabel",["flarum/utils/extract","flarum/tags/helpers/tagLabel","flarum/tags/utils/sortTags"],function(_export,_context){function tagsLabel(tags){var attrs=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],children=[],link=extract(attrs,"link");return attrs.className="TagsLabel "+(attrs.className||""),tags?sortTags(tags).forEach(function(tag){(tag||1===tags.length)&&children.push(tagLabel(tag,{link:link}))}):children.push(tagLabel()),m("span",attrs,children)}var extract,tagLabel,sortTags;return _export("default",tagsLabel),{setters:[function(_flarumUtilsExtract){extract=_flarumUtilsExtract.default},function(_flarumTagsHelpersTagLabel){tagLabel=_flarumTagsHelpersTagLabel.default},function(_flarumTagsUtilsSortTags){sortTags=_flarumTagsUtilsSortTags.default}],execute:function(){}}}),System.register("flarum/tags/main",["flarum/Model","flarum/models/Discussion","flarum/components/IndexPage","flarum/tags/models/Tag","flarum/tags/components/TagsPage","flarum/tags/components/DiscussionTaggedPost","flarum/tags/addTagList","flarum/tags/addTagFilter","flarum/tags/addTagLabels","flarum/tags/addTagControl","flarum/tags/addTagComposer"],function(_export,_context){var Model,Discussion,IndexPage,Tag,TagsPage,DiscussionTaggedPost,addTagList,addTagFilter,addTagLabels,addTagControl,addTagComposer;return{setters:[function(_flarumModel){Model=_flarumModel.default},function(_flarumModelsDiscussion){Discussion=_flarumModelsDiscussion.default},function(_flarumComponentsIndexPage){IndexPage=_flarumComponentsIndexPage.default},function(_flarumTagsModelsTag){Tag=_flarumTagsModelsTag.default},function(_flarumTagsComponentsTagsPage){TagsPage=_flarumTagsComponentsTagsPage.default},function(_flarumTagsComponentsDiscussionTaggedPost){DiscussionTaggedPost=_flarumTagsComponentsDiscussionTaggedPost.default},function(_flarumTagsAddTagList){addTagList=_flarumTagsAddTagList.default},function(_flarumTagsAddTagFilter){addTagFilter=_flarumTagsAddTagFilter.default},function(_flarumTagsAddTagLabels){addTagLabels=_flarumTagsAddTagLabels.default},function(_flarumTagsAddTagControl){addTagControl=_flarumTagsAddTagControl.default},function(_flarumTagsAddTagComposer){addTagComposer=_flarumTagsAddTagComposer.default}],execute:function(){app.initializers.add("flarum-tags",function(app){app.routes.tags={path:"/tags",component:TagsPage.component()},app.routes.tag={path:"/t/:tags",component:IndexPage.component()},app.route.tag=function(tag){return app.route("tag",{tags:tag.slug()})},app.postComponents.discussionTagged=DiscussionTaggedPost,app.store.models.tags=Tag,Discussion.prototype.tags=Model.hasMany("tags"),Discussion.prototype.canTag=Model.attribute("canTag"),addTagList(),addTagFilter(),addTagLabels(),addTagControl(),addTagComposer()})}}}),System.register("flarum/tags/models/Tag",["flarum/Model","flarum/utils/mixin","flarum/utils/computed"],function(_export,_context){var Model,mixin,computed,Tag;return{setters:[function(_flarumModel){Model=_flarumModel.default},function(_flarumUtilsMixin){mixin=_flarumUtilsMixin.default},function(_flarumUtilsComputed){computed=_flarumUtilsComputed.default}],execute:function(){Tag=function(_mixin){function Tag(){return babelHelpers.classCallCheck(this,Tag),babelHelpers.possibleConstructorReturn(this,Object.getPrototypeOf(Tag).apply(this,arguments))}return babelHelpers.inherits(Tag,_mixin),Tag}(mixin(Model,{name:Model.attribute("name"),slug:Model.attribute("slug"),description:Model.attribute("description"),color:Model.attribute("color"),backgroundUrl:Model.attribute("backgroundUrl"),backgroundMode:Model.attribute("backgroundMode"),position:Model.attribute("position"),parent:Model.hasOne("parent"),defaultSort:Model.attribute("defaultSort"),isChild:Model.attribute("isChild"),isHidden:Model.attribute("isHidden"),discussionsCount:Model.attribute("discussionsCount"),lastTime:Model.attribute("lastTime",Model.transformDate),lastDiscussion:Model.hasOne("lastDiscussion"),isRestricted:Model.attribute("isRestricted"),canStartDiscussion:Model.attribute("canStartDiscussion"),isPrimary:computed("position","parent",function(position,parent){return null!==position&&parent===!1})})),_export("default",Tag)}}}),System.register("flarum/tags/utils/sortTags",[],function(_export,_context){function sortTags(tags){return tags.slice(0).sort(function(a,b){var aPos=a.position(),bPos=b.position();if(null===aPos&&null===bPos)return b.discussionsCount()-a.discussionsCount();if(null===bPos)return-1;if(null===aPos)return 1;var aParent=a.parent(),bParent=b.parent();return aParent===bParent?aPos-bPos:aParent&&bParent?aParent.position()-bParent.position():aParent?aParent===b?1:aParent.position()-bPos:bParent?bParent===a?-1:aPos-bParent.position():0})}return _export("default",sortTags),{setters:[],execute:function(){}}}),function(){function html_entity_decode(str){var b=document.createElement("b");return(html_entity_decode=function(str){return b.innerHTML=str.replace(/</g,"&lt;"),b.textContent})(str)}function htmlspecialchars_compat(str){var t={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;"};return str.replace(/[<>&"]/g,function(c){return t[c]})}function htmlspecialchars_noquotes(str){var t={"<":"&lt;",">":"&gt;","&":"&amp;"};return str.replace(/[<>&]/g,function(c){return t[c]})}function rawurlencode(str){return encodeURIComponent(str).replace(/[!'()*]/g,function(c){return"%"+c.charCodeAt(0).toString(16).toUpperCase()})}function Logger(){}function Tag(type,name,pos,len){this.type=type,this.name=name,this.pos=pos,this.len=len,this.attributes={},this.cascade=[],isNaN(type+pos+len)&&this.invalidate()}function parse(_text){reset(_text);var _uid=uid;if(executePluginParsers(),processTags(),gc(),finalizeOutput(),uid!==_uid)throw"The parser has been reset during execution";return currentFixingCost>maxFixingCost&&logger.warn("Fixing cost limit exceeded"),output}function gc(){createdTags.forEach(function(tag){tag.gc()}),createdTags=[]}function reset(_text){_text=_text.replace(/\r\n?/g,"\n"),_text=_text.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F]+/g,""),logger.clear(),cntOpen={},cntTotal={},createdTags=[],currentFixingCost=0,currentTag=null,isRich=!1,namespaces={},openTags=[],output="",pos=0,tagStack=[],tagStackIsSorted=!0,text=_text,textLen=text.length,wsPos=0,context=rootContext,context.inParagraph=!1,++uid}function filterAttributes(tag,tagConfig,registeredVars,logger){if(!tagConfig.attributes)return tag.setAttributes({}),!0;var attrName,attrConfig;if(HINT.attributeGenerator)for(attrName in tagConfig.attributes)attrConfig=tagConfig.attributes[attrName],attrConfig.generator&&tag.setAttribute(attrName,attrConfig.generator(attrName));var attributes=tag.getAttributes();for(attrName in attributes){var attrValue=attributes[attrName];if(tagConfig.attributes[attrName]){if(attrConfig=tagConfig.attributes[attrName],attrConfig.filterChain){logger.setAttribute(attrName);for(var i=0;i<attrConfig.filterChain.length;++i)if(attrValue=attrConfig.filterChain[i](attrValue,attrName),attrValue===!1){tag.removeAttribute(attrName);break}attrValue!==!1&&tag.setAttribute(attrName,attrValue),logger.unsetAttribute()}}else tag.removeAttribute(attrName)}for(attrName in tagConfig.attributes)if(attrConfig=tagConfig.attributes[attrName],!tag.hasAttribute(attrName))if(HINT.attributeDefaultValue&&void 0!==attrConfig.defaultValue)tag.setAttribute(attrName,attrConfig.defaultValue);else if(attrConfig.required)return!1;
return!0}function filterTag(tag){var tagName=tag.getName(),tagConfig=tagsConfig[tagName],isValid=!0;if(tagConfig.filterChain){logger.setTag(tag);for(var i=0;i<tagConfig.filterChain.length;++i)if(!tagConfig.filterChain[i](tag,tagConfig)){isValid=!1;break}logger.unsetTag()}return isValid}function encodeUnicodeSupplementaryCharacters(){output=output.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,encodeUnicodeSupplementaryCharactersCallback)}function encodeUnicodeSupplementaryCharactersCallback(pair){var cp=(pair.charCodeAt(0)<<10)+pair.charCodeAt(1)-56613888;return"&#"+cp+";"}function finalizeOutput(){var tmp;outputText(textLen,0,!0);do tmp=output,output=output.replace(/<([^ \/>]+)><\/\1>/g,"");while(output!==tmp);output=output.replace(/<\/i><i>/g,"",output),encodeUnicodeSupplementaryCharacters();var tagName=isRich?"r":"t";if(tmp="<"+tagName,HINT.namespaces)for(var prefix in namespaces)tmp+=" xmlns:"+prefix+'="urn:s9e:TextFormatter:'+prefix+'"';output=tmp+">"+output+"</"+tagName+">"}function outputTag(tag){isRich=!0;var tagName=tag.getName(),tagPos=tag.getPos(),tagLen=tag.getLen(),tagFlags=tag.getFlags(),skipBefore=0,skipAfter=0;HINT.RULE_IGNORE_WHITESPACE&&tagFlags&RULE_IGNORE_WHITESPACE&&(skipBefore=1,skipAfter=tag.isEndTag()?2:1);var closeParagraph=!1;tag.isStartTag()?HINT.RULE_BREAK_PARAGRAPH&&tagFlags&RULE_BREAK_PARAGRAPH&&(closeParagraph=!0):closeParagraph=!0,outputText(tagPos,skipBefore,closeParagraph);var tagText=tagLen?htmlspecialchars_noquotes(text.substr(tagPos,tagLen)):"";if(tag.isStartTag()){if(HINT.RULE_BREAK_PARAGRAPH&&tagFlags&RULE_BREAK_PARAGRAPH||outputParagraphStart(tagPos),HINT.namespaces){var colonPos=tagName.indexOf(":");colonPos>0&&(namespaces[tagName.substr(0,colonPos)]=0)}output+="<"+tagName;var attributes=tag.getAttributes(),attributeNames=[];for(var attrName in attributes)attributeNames.push(attrName);attributeNames.sort(function(a,b){return a>b?1:-1}),attributeNames.forEach(function(attrName){output+=" "+attrName+'="'+htmlspecialchars_compat(attributes[attrName].toString())+'"'}),output+=tag.isSelfClosingTag()?tagLen?">"+tagText+"</"+tagName+">":"/>":tagLen?"><s>"+tagText+"</s>":">"}else tagLen&&(output+="<e>"+tagText+"</e>"),output+="</"+tagName+">";for(pos=tagPos+tagLen,wsPos=pos;skipAfter&&wsPos<textLen&&"\n"===text.charAt(wsPos);)--skipAfter,++wsPos}function outputText(catchupPos,maxLines,closeParagraph){if(closeParagraph&&(context.flags&RULE_CREATE_PARAGRAPHS?maxLines=-1:closeParagraph=!1),pos>=catchupPos&&closeParagraph&&outputParagraphEnd(),wsPos>pos){var skipPos=Math.min(catchupPos,wsPos);output+=text.substr(pos,skipPos-pos),pos=skipPos,pos>=catchupPos&&closeParagraph&&outputParagraphEnd()}var catchupLen,catchupText;if(HINT.RULE_IGNORE_TEXT&&context.flags&RULE_IGNORE_TEXT)return catchupLen=catchupPos-pos,catchupText=text.substr(pos,catchupLen),/^[ \n\t]*$/.test(catchupText)||(catchupText="<i>"+catchupText+"</i>"),output+=catchupText,pos=catchupPos,void(closeParagraph&&outputParagraphEnd());for(var ignorePos=catchupPos,ignoreLen=0;maxLines&&--ignorePos>=pos;){var c=text.charAt(ignorePos);if(" "!==c&&"\n"!==c&&"\t"!==c)break;"\n"===c&&--maxLines,++ignoreLen}if(catchupPos-=ignoreLen,HINT.RULE_CREATE_PARAGRAPHS&&context.flags&RULE_CREATE_PARAGRAPHS){context.inParagraph||(outputWhitespace(catchupPos),catchupPos>pos&&outputParagraphStart(catchupPos));for(var pbPos=text.indexOf("\n\n",pos);pbPos>-1&&pbPos<catchupPos;)outputText(pbPos,0,!0),outputParagraphStart(catchupPos),pbPos=text.indexOf("\n\n",pos)}catchupPos>pos&&(catchupText=htmlspecialchars_noquotes(text.substr(pos,catchupPos-pos)),HINT.RULE_ENABLE_AUTO_BR&&(context.flags&RULES_AUTO_LINEBREAKS)===RULE_ENABLE_AUTO_BR&&(catchupText=catchupText.replace(/\n/g,"<br/>\n")),output+=catchupText),closeParagraph&&outputParagraphEnd(),ignoreLen&&(output+=text.substr(catchupPos,ignoreLen)),pos=catchupPos+ignoreLen}function outputBrTag(tag){outputText(tag.getPos(),0,!1),output+="<br/>"}function outputIgnoreTag(tag){var tagPos=tag.getPos(),tagLen=tag.getLen(),ignoreText=text.substr(tagPos,tagLen);outputText(tagPos,0,!1),output+="<i>"+htmlspecialchars_noquotes(ignoreText)+"</i>",isRich=!0,pos=tagPos+tagLen}function outputParagraphStart(maxPos){HINT.RULE_CREATE_PARAGRAPHS&&!context.inParagraph&&context.flags&RULE_CREATE_PARAGRAPHS&&(outputWhitespace(maxPos),pos<textLen&&(output+="<p>",context.inParagraph=!0))}function outputParagraphEnd(){context.inParagraph&&(output+="</p>",context.inParagraph=!1)}function outputVerbatim(tag){var flags=context.flags;context.flags=tag.getFlags(),outputText(currentTag.getPos()+currentTag.getLen(),0,!1),context.flags=flags}function outputWhitespace(maxPos){for(;pos<maxPos&&" \n\t".indexOf(text.charAt(pos))>-1;)output+=text.charAt(pos),++pos}function executePluginParser(pluginName){var pluginConfig=plugins[pluginName];if(!(pluginConfig.quickMatch&&text.indexOf(pluginConfig.quickMatch)<0)){var matches=[];pluginConfig.regexp&&(matches=getMatches(pluginConfig.regexp,pluginConfig.regexpLimit),!matches.length)||getPluginParser(pluginName)(text,matches)}}function executePluginParsers(){for(var pluginName in plugins)plugins[pluginName].isDisabled||executePluginParser(pluginName)}function getMatches(regexp,limit){regexp.lastIndex=0;for(var m,matches=[],cnt=0;++cnt<=limit&&(m=regexp.exec(text));){for(var pos=+m.index,match=[[m[0],pos]],i=0;++i<m.length;){var str=m[i];void 0===str?match.push(["",-1]):(match.push([str,text.indexOf(str,pos)]),pos+=str.length)}matches.push(match)}return matches}function getPluginParser(pluginName){return plugins[pluginName].parser}function closeAncestor(tag){if(!HINT.closeAncestor)return!1;if(openTags.length){var tagName=tag.getName(),tagConfig=tagsConfig[tagName];if(tagConfig.rules.closeAncestor)for(var i=openTags.length;--i>=0;){var ancestor=openTags[i],ancestorName=ancestor.getName();if(tagConfig.rules.closeAncestor[ancestorName])return tagStack.push(tag),addMagicEndTag(ancestor,tag.getPos()),!0}}return!1}function closeParent(tag){if(!HINT.closeParent)return!1;if(openTags.length){var tagName=tag.getName(),tagConfig=tagsConfig[tagName];if(tagConfig.rules.closeParent){var parent=openTags[openTags.length-1],parentName=parent.getName();if(tagConfig.rules.closeParent[parentName])return tagStack.push(tag),addMagicEndTag(parent,tag.getPos()),!0}}return!1}function fosterParent(tag){if(!HINT.fosterParent)return!1;if(openTags.length){var tagName=tag.getName(),tagConfig=tagsConfig[tagName];if(tagConfig.rules.fosterParent){var parent=openTags[openTags.length-1],parentName=parent.getName();if(tagConfig.rules.fosterParent[parentName]){if(parentName!==tagName&&currentFixingCost<maxFixingCost){var child=addCopyTag(parent,tag.getPos()+tag.getLen(),0);tag.cascadeInvalidationTo(child),child.setSortPriority(tag.getSortPriority()+1)}return tagStack.push(tag),addMagicEndTag(parent,tag.getPos()).setSortPriority(tag.getSortPriority()-1),currentFixingCost+=tagStack.length,!0}}}return!1}function requireAncestor(tag){if(!HINT.requireAncestor)return!1;var tagName=tag.getName(),tagConfig=tagsConfig[tagName];if(tagConfig.rules.requireAncestor){for(var i=tagConfig.rules.requireAncestor.length;--i>=0;){var ancestorName=tagConfig.rules.requireAncestor[i];if(cntOpen[ancestorName])return!1}return logger.err("Tag requires an ancestor",{requireAncestor:tagConfig.rules.requireAncestor.join(", "),tag:tag}),!0}return!1}function addMagicEndTag(startTag,tagPos){var tagName=startTag.getName();HINT.RULE_IGNORE_WHITESPACE&&startTag.getFlags()&RULE_IGNORE_WHITESPACE&&(tagPos=getMagicPos(tagPos));var endTag=addEndTag(tagName,tagPos,0);return endTag.pairWith(startTag),endTag}function getMagicPos(tagPos){for(;tagPos>pos&&WHITESPACE.indexOf(text.charAt(tagPos-1))>-1;)--tagPos;return tagPos}function isFollowedByClosingTag(tag){return!!tagStack.length&&tagStack[tagStack.length-1].canClose(tag)}function processTags(){if(tagStack.length){for(var tagName in tagsConfig)cntOpen[tagName]=0,cntTotal[tagName]=0;do{for(;tagStack.length;)tagStackIsSorted||sortTags(),currentTag=tagStack.pop(),context.flags&RULE_IGNORE_TAGS&&!currentTag.canClose(openTags[openTags.length-1])&&!currentTag.isSystemTag()||processCurrentTag();openTags.forEach(function(startTag){addMagicEndTag(startTag,textLen)})}while(tagStack.length)}}function processCurrentTag(){if(!currentTag.isInvalid()){var tagPos=currentTag.getPos(),tagLen=currentTag.getLen();if(pos>tagPos){var startTag=currentTag.getStartTag();if(startTag&&openTags.indexOf(startTag)>=0)return void addEndTag(startTag.getName(),pos,Math.max(0,tagPos+tagLen-pos)).pairWith(startTag);if(currentTag.isIgnoreTag()){var ignoreLen=tagPos+tagLen-pos;if(ignoreLen>0)return void addIgnoreTag(pos,ignoreLen)}return void currentTag.invalidate()}currentTag.isIgnoreTag()?outputIgnoreTag(currentTag):currentTag.isBrTag()?HINT.RULE_PREVENT_BR&&context.flags&RULE_PREVENT_BR||outputBrTag(currentTag):currentTag.isParagraphBreak()?outputText(currentTag.getPos(),0,!0):currentTag.isVerbatim()?outputVerbatim(currentTag):currentTag.isStartTag()?processStartTag(currentTag):processEndTag(currentTag)}}function processStartTag(tag){var tagName=tag.getName(),tagConfig=tagsConfig[tagName];if(cntTotal[tagName]>=tagConfig.tagLimit)return logger.err("Tag limit exceeded",{tag:tag,tagName:tagName,tagLimit:tagConfig.tagLimit}),void tag.invalidate();if(!filterTag(tag))return void tag.invalidate();if(!(fosterParent(tag)||closeParent(tag)||closeAncestor(tag))){if(cntOpen[tagName]>=tagConfig.nestingLimit)return logger.err("Nesting limit exceeded",{tag:tag,tagName:tagName,nestingLimit:tagConfig.nestingLimit}),void tag.invalidate();if(!tagIsAllowed(tagName)){var msg="Tag is not allowed in this context",context={tag:tag,tagName:tagName};return tag.getLen()>0?logger.warn(msg,context):logger.debug(msg,context),void tag.invalidate()}if(requireAncestor(tag))return void tag.invalidate();if(HINT.RULE_AUTO_CLOSE&&tag.getFlags()&RULE_AUTO_CLOSE&&!tag.getEndTag()&&!isFollowedByClosingTag(tag)){var newTag=new Tag(Tag.SELF_CLOSING_TAG,tagName,tag.getPos(),tag.getLen());newTag.setAttributes(tag.getAttributes()),newTag.setFlags(tag.getFlags()),tag=newTag}HINT.RULE_TRIM_FIRST_LINE&&tag.getFlags()&RULE_TRIM_FIRST_LINE&&!tag.getEndTag()&&"\n"===text.charAt(tag.getPos()+tag.getLen())&&addIgnoreTag(tag.getPos()+tag.getLen(),1),outputTag(tag),pushContext(tag)}}function processEndTag(tag){var tagName=tag.getName();if(cntOpen[tagName]){for(var closeTags=[],i=openTags.length;--i>=0;){var openTag=openTags[i];if(tag.canClose(openTag))break;closeTags.push(openTag),++currentFixingCost}if(i<0)return void logger.debug("Skipping end tag with no start tag",{tag:tag});var keepReopening=HINT.RULE_AUTO_REOPEN&&currentFixingCost<maxFixingCost,reopenTags=[];if(closeTags.forEach(function(openTag){var openTagName=openTag.getName();keepReopening&&(openTag.getFlags()&RULE_AUTO_REOPEN?reopenTags.push(openTag):keepReopening=!1);var tagPos=tag.getPos();HINT.RULE_IGNORE_WHITESPACE&&openTag.getFlags()&RULE_IGNORE_WHITESPACE&&(tagPos=getMagicPos(tagPos));var endTag=new Tag(Tag.END_TAG,openTagName,tagPos,0);endTag.setFlags(openTag.getFlags()),outputTag(endTag),popContext()}),outputTag(tag),popContext(),closeTags.length&&currentFixingCost<maxFixingCost){var ignorePos=pos;for(i=tagStack.length;--i>=0&&++currentFixingCost<maxFixingCost;){var upcomingTag=tagStack[i];if(upcomingTag.getPos()>ignorePos||upcomingTag.isStartTag())break;for(var j=closeTags.length;--j>=0&&++currentFixingCost<maxFixingCost;)if(upcomingTag.canClose(closeTags[j])){closeTags.splice(j,1),reopenTags[j]&&reopenTags.splice(j,1),ignorePos=Math.max(ignorePos,upcomingTag.getPos()+upcomingTag.getLen());break}}ignorePos>pos&&outputIgnoreTag(new Tag(Tag.SELF_CLOSING_TAG,"i",pos,ignorePos-pos))}reopenTags.forEach(function(startTag){var newTag=addCopyTag(startTag,pos,0),endTag=startTag.getEndTag();endTag&&newTag.pairWith(endTag)})}}function popContext(){var tag=openTags.pop();--cntOpen[tag.getName()],context=context.parentContext}function pushContext(tag){var tagName=tag.getName(),tagFlags=tag.getFlags(),tagConfig=tagsConfig[tagName];if(++cntTotal[tagName],!tag.isSelfClosingTag()){var allowed=[];HINT.RULE_IS_TRANSPARENT&&tagFlags&RULE_IS_TRANSPARENT?context.allowed.forEach(function(v,k){allowed.push(tagConfig.allowed[k]&v)}):context.allowed.forEach(function(v,k){allowed.push(tagConfig.allowed[k]&(65280&v|v>>8))});var flags=tagFlags|context.flags&RULES_INHERITANCE;flags&RULE_DISABLE_AUTO_BR&&(flags&=-33),++cntOpen[tagName],openTags.push(tag),context={allowed:allowed,flags:flags,parentContext:context}}}function tagIsAllowed(tagName){var n=tagsConfig[tagName].bitNumber;return!!(context.allowed[n>>3]&1<<(7&n))}function addStartTag(name,pos,len){return addTag(Tag.START_TAG,name,pos,len)}function addEndTag(name,pos,len){return addTag(Tag.END_TAG,name,pos,len)}function addSelfClosingTag(name,pos,len){return addTag(Tag.SELF_CLOSING_TAG,name,pos,len)}function addBrTag(pos){return addTag(Tag.SELF_CLOSING_TAG,"br",pos,0)}function addIgnoreTag(pos,len){return addTag(Tag.SELF_CLOSING_TAG,"i",pos,Math.min(len,textLen-pos))}function addParagraphBreak(pos){return addTag(Tag.SELF_CLOSING_TAG,"pb",pos,0)}function addCopyTag(tag,pos,len){var copy=addTag(tag.getType(),tag.getName(),pos,len);return copy.setAttributes(tag.getAttributes()),copy.setSortPriority(tag.getSortPriority()),copy}function addTag(type,name,pos,len){var tag=new Tag(type,name,pos,len);return createdTags.push(tag),tagsConfig[name]&&tag.setFlags(tagsConfig[name].rules.flags),tagsConfig[name]||tag.isSystemTag()?tagsConfig[name]&&tagsConfig[name].isDisabled?(logger.warn("Tag is disabled",{tag:tag,tagName:name}),tag.invalidate()):len<0||pos<0||pos+len>textLen?tag.invalidate():(tagStackIsSorted&&tagStack.length&&tag.getPos()>=tagStack[tagStack.length-1].getPos()&&(tagStackIsSorted=!1),tagStack.push(tag)):tag.invalidate(),tag}function addTagPair(name,startPos,startLen,endPos,endLen){var tag=addStartTag(name,startPos,startLen);return tag.pairWith(addEndTag(name,endPos,endLen)),tag}function sortTags(){tagStack.sort(compareTags),tagStackIsSorted=!0}function compareTags(a,b){var aPos=a.getPos(),bPos=b.getPos();if(aPos!==bPos)return bPos-aPos;if(a.getSortPriority()!==b.getSortPriority())return b.getSortPriority()-a.getSortPriority();var aLen=a.getLen(),bLen=b.getLen();if(!aLen||!bLen){if(!aLen&&!bLen){var order={};return order[Tag.END_TAG]=0,order[Tag.SELF_CLOSING_TAG]=1,order[Tag.START_TAG]=2,order[b.getType()]-order[a.getType()]}return aLen?-1:1}return aLen-bLen}function preview(text,target){function refreshElementContent(oldEl,newEl){for(var oldNode,newNode,oldNodes=oldEl.childNodes,newNodes=newEl.childNodes,oldCnt=oldNodes.length,newCnt=newNodes.length,left=0,right=0;left<oldCnt&&left<newCnt&&(oldNode=oldNodes[left],newNode=newNodes[left],refreshNode(oldNode,newNode));)++left;for(var maxRight=Math.min(oldCnt-left,newCnt-left);right<maxRight&&(oldNode=oldNodes[oldCnt-(right+1)],newNode=newNodes[newCnt-(right+1)],refreshNode(oldNode,newNode));)++right;for(var newNodesFragment=targetDoc.createDocumentFragment(),i=left;i<newCnt-right;)newNode=newNodes[i].cloneNode(!0),newNodesFragment.appendChild(newNode),++i;for(i=oldCnt-right;--i>=left;)oldEl.removeChild(oldNodes[i]);right?oldEl.insertBefore(newNodesFragment,oldEl.childNodes[left]):oldEl.appendChild(newNodesFragment)}function refreshNode(oldNode,newNode){return oldNode.nodeName===newNode.nodeName&&oldNode.nodeType===newNode.nodeType&&(3===oldNode.nodeType||8===oldNode.nodeType?(oldNode.nodeValue!==newNode.nodeValue&&(oldNode.nodeValue=newNode.nodeValue),!0):!(!oldNode.isEqualNode||!oldNode.isEqualNode(newNode))||(syncElementAttributes(oldNode,newNode),refreshElementContent(oldNode,newNode),!0))}function syncElementAttributes(oldEl,newEl){for(var oldAttributes=oldEl.attributes,newAttributes=newEl.attributes,oldCnt=oldAttributes.length,newCnt=newAttributes.length,i=oldCnt;--i>=0;){var oldAttr=oldAttributes[i],namespaceURI=oldAttr.namespaceURI,attrName=oldAttr.name;newEl.hasAttributeNS(namespaceURI,attrName)||oldEl.removeAttributeNS(namespaceURI,attrName)}for(i=newCnt;--i>=0;){var newAttr=newAttributes[i],namespaceURI=newAttr.namespaceURI,attrName=newAttr.name,attrValue=newAttr.value;attrValue!==oldEl.getAttributeNS(namespaceURI,attrName)&&oldEl.setAttributeNS(namespaceURI,attrName,attrValue)}}var targetDoc=target.ownerDocument,resultFragment=xslt.transformToFragment(parse(text),targetDoc);if(HINT.postProcessing)for(var nodes=resultFragment.querySelectorAll("[data-s9e-livepreview-postprocess]"),i=nodes.length;--i>=0;){var code=nodes[i].getAttribute("data-s9e-livepreview-postprocess");postProcessFunctions[code]||(postProcessFunctions[code]=new Function(code)),postProcessFunctions[code].call(nodes[i])}refreshElementContent(target,resultFragment)}var HINT={};HINT.EMOJI_HAS_ALIASES=!0,HINT.EMOJI_HAS_ALIAS_QUICKMATCH=!1,HINT.LITEDOWN_DECODE_HTML_ENTITIES=0,HINT.PREG_HAS_PASSTHROUGH=!1,HINT.RULE_AUTO_CLOSE=1,HINT.RULE_AUTO_REOPEN=1,HINT.RULE_BREAK_PARAGRAPH=1,HINT.RULE_CREATE_PARAGRAPHS=1,HINT.RULE_DISABLE_AUTO_BR=1,HINT.RULE_ENABLE_AUTO_BR=1,HINT.RULE_IGNORE_TAGS=1,HINT.RULE_IGNORE_TEXT=1,HINT.RULE_IGNORE_WHITESPACE=1,HINT.RULE_IS_TRANSPARENT=1,HINT.RULE_PREVENT_BR=1,HINT.RULE_SUSPEND_AUTO_BR=1,HINT.RULE_TRIM_FIRST_LINE=1,HINT.attributeDefaultValue=0,HINT.attributeGenerator=0,HINT.closeAncestor=0,HINT.closeParent=1,HINT.fosterParent=1,HINT.namespaces=0,HINT.postProcessing=0,HINT.requireAncestor=0;var o553403F9=[0],o8B7A8F1F=[7943],oEA595C9E=[7937],o18338443=[7437],oB88E87AA=[7951],o939F1698={flags:514},o59B1287B={flags:3073},oD62CC35F={required:!1},oCF37F21E={required:!0},o971EB514={C:1,EM:1,EMAIL:1,STRONG:1,URL:1},o3CC2AFB8=[function(attrValue,attrName){return BuiltInFilters.filterUint(attrValue)}],oD76D04BF=function(tag,tagConfig){return filterAttributes(tag,tagConfig,registeredVars,logger)},o1B3CF9D3=[oD76D04BF],o16EF6CF6={filterChain:o3CC2AFB8,required:!1},oBA76F51D={filterChain:[function(attrValue,attrName){return BuiltInFilters.filterSimpletext(attrValue)}],required:!1},o374BDE7B={filterChain:[function(attrValue,attrName){return BuiltInFilters.filterUrl(attrValue,registeredVars.urlConfig,logger)}],required:!0},oE4DC5376={allowed:o8B7A8F1F,bitNumber:2,filterChain:o1B3CF9D3,nestingLimit:10,rules:{flags:2},tagLimit:1e3},o84B44B22={allowed:o8B7A8F1F,bitNumber:3,filterChain:o1B3CF9D3,nestingLimit:10,rules:{flags:260,fosterParent:o971EB514},tagLimit:1e3},xsl='<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"><xsl:output method="html" encoding="utf-8" indent="no"/><xsl:param$gDISCUSSION_URL"/><xsl:param$gPROFILE_URL"/>$aC"><code>$c</code>$b$aCODE"><pre><code><xsl:if test="@lang"><$e$gclass">language-$d@lang"/></$e></xsl:if>$c</code></pre>$b$aDEL|EM|H1|H2|H3|H4|H5|H6|LI|STRONG|SUP|p"><xsl:element$g{translate(name(),\'DEGHILMNOPRSTU\',\'deghilmnoprstu\')}">$c</xsl:element>$b$aEMAIL"><a href="mailto:{@email}">$c</a>$b$aEMOJI"><img alt="{.}" class="emoji" draggable="false"><$e$gsrc">//cdn.jsdelivr.net/emojione/assets/png/<xsl:if test="contains(@seq,\'-20e3\')or@seq=\'a9\'or@seq=\'ae\'">00</xsl:if>$dtranslate(@seq,\'abcdef\',\'ABCDEF\')"/>.png</$e></img>$b$aESC">$c$b$aHR"><hr/>$b$aIMG"><img src="{@src}">$falt|@title"/></img>$b$aLIST"><xsl:choose><xsl:when test="not(@type)"><ul>$c</ul></xsl:when><xsl:otherwise><ol>$fstart"/>$c</ol></xsl:otherwise></xsl:choose>$b$aPOSTMENTION"><a href="{$DISCUSSION_URL}{@discussionid}/{@number}" class="PostMention" data-id="{@id}">$d@username"/></a>$b$aQUOTE"><blockquote>$c</blockquote>$b$aURL"><a href="{@url}" target="_blank" rel="nofollow noreferrer">$c</a>$b$aUSERMENTION"><a href="{$PROFILE_URL}{@username}" class="UserMention">@$d@username"/></a>$b$abr"><br/>$b$ae|i|s"/></xsl:stylesheet>'.replace(/\$[a-g]/g,function(k){return{$a:'<xsl:template match="',$b:"</xsl:template>",$c:"<xsl:apply-templates/>",$d:'<xsl:value-of select="',$e:"xsl:attribute",$f:'<xsl:copy-of select="@',$g:' name="'}[k]}),BuiltInFilters={filterAlnum:function(attrValue){return!!/^[0-9A-Za-z]+$/.test(attrValue)&&attrValue},filterColor:function(attrValue){return!!/^(?:#[0-9a-f]{3,6}|rgb\(\d{1,3}, *\d{1,3}, *\d{1,3}\)|[a-z]+)$/i.test(attrValue)&&attrValue},filterEmail:function(attrValue){return!!/^[-\w.+]+@[-\w.]+$/.test(attrValue)&&attrValue},filterFalse:function(attrValue){return!1},filterFloat:function(attrValue){return!!/^(?:0|-?[1-9]\d*)(?:\.\d+)?(?:e[1-9]\d*)?$/i.test(attrValue)&&attrValue},filterHashmap:function(attrValue,map,strict){return attrValue in map?map[attrValue]:!strict&&attrValue},filterIdentifier:function(attrValue){return!!/^[-\w]+$/.test(attrValue)&&attrValue},filterInt:function(attrValue){return!!/^(?:0|-?[1-9]\d*)$/.test(attrValue)&&attrValue},filterIp:function(attrValue){return/^[\d.]+$/.test(attrValue)?BuiltInFilters.filterIpv4(attrValue):!!/^[\da-f:]+$/i.test(attrValue)&&BuiltInFilters.filterIpv6(attrValue)},filterIpport:function(attrValue){var m,ip;return(m=/^\[([\da-f:]+)(\]:[1-9]\d*)$/i.exec(attrValue))?(ip=BuiltInFilters.filterIpv6(m[1]),ip!==!1&&"["+ip+m[2]):!!(m=/^([\d.]+)(:[1-9]\d*)$/.exec(attrValue))&&(ip=BuiltInFilters.filterIpv4(m[1]),ip!==!1&&ip+m[2])},filterIpv4:function(attrValue){if(!/^\d+\.\d+\.\d+\.\d+$/.test(attrValue))return!1;for(var i=4,p=attrValue.split(".");--i>=0;)if("0"===p[i].charAt(0)||p[i]>255)return!1;return attrValue},filterIpv6:function(attrValue){return!!/^(\d*:){2,7}\d+(?:\.\d+\.\d+\.\d+)?$/.test(attrValue)&&attrValue},filterMap:function(attrValue,map){for(var i=-1,cnt=map.length;++i<cnt;)if(map[i][0].test(attrValue))return map[i][1];return attrValue},filterNumber:function(attrValue){return!!/^\d+$/.test(attrValue)&&attrValue},filterRange:function(attrValue,min,max,logger){return!!/^(?:0|-?[1-9]\d*)$/.test(attrValue)&&(attrValue=parseInt(attrValue,10),attrValue<min?(logger&&logger.warn("Value outside of range, adjusted up to min value",{attrValue:attrValue,min:min,max:max}),min):attrValue>max?(logger&&logger.warn("Value outside of range, adjusted down to max value",{attrValue:attrValue,min:min,max:max}),max):attrValue)},filterRegexp:function(attrValue,regexp){return!!regexp.test(attrValue)&&attrValue},filterSimpletext:function(attrValue){return!!/^[-\w+., ]+$/.test(attrValue)&&attrValue},filterUint:function(attrValue){return!!/^(?:0|[1-9]\d*)$/.test(attrValue)&&attrValue},filterUrl:function(attrValue,urlConfig,logger){var p=BuiltInFilters.parseUrl(attrValue.replace(/^\s+/,"").replace(/\s+$/,"")),error=BuiltInFilters.validateUrl(urlConfig,p);return error?(logger&&(p.attrValue=attrValue,logger.err(error,p)),!1):BuiltInFilters.rebuildUrl(urlConfig,p)},parseUrl:function(url){var regexp=/^(?:([a-z][-+.\w]*):)?(?:\/\/(?:([^:\/?#]*)(?::([^\/?#]*)?)?@)?(?:(\[[a-f\d:]+\]|[^:\/?#]+)(?::(\d*))?)?(?![^\/?#]))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?$/i,m=regexp.exec(url),parts={},tokens=["scheme","user","pass","host","port","path","query","fragment"];return tokens.forEach(function(name,i){parts[name]=m[i+1]>""?m[i+1]:""}),parts.scheme=parts.scheme.toLowerCase(),parts.host=parts.host.replace(/[\u3002\uff0e\uff61]/g,".").replace(/\.+$/g,""),/[^\x00-\x7F]/.test(parts.host)&&punycode&&(parts.host=punycode.toASCII(parts.host)),parts},rebuildUrl:function(urlConfig,p){var url="";""!==p.scheme&&(url+=p.scheme+":"),""===p.host?"file"===p.scheme&&(url+="//"):(url+="//",""!==p.user&&(url+=rawurlencode(decodeURIComponent(p.user)),""!==p.pass&&(url+=":"+rawurlencode(decodeURIComponent(p.pass))),url+="@"),url+=p.host,""!==p.port&&(url+=":"+p.port));var path=p.path;return""!==p.query&&(path+="?"+p.query),""!==p.fragment&&(path+="#"+p.fragment),path=path.replace(/%.?[a-f]/,function(m){return m[0].toUpperCase()},path),url+=BuiltInFilters.sanitizeUrl(path),p.scheme||(url=url.replace(/^([^\/]*):/,"$1%3A",url)),url},sanitizeUrl:function(url){return url.replace(/[^\u0020-\u007E]+/g,encodeURIComponent).replace(/%(?![0-9A-Fa-f]{2})|[^!#-&*-;=?-Z_a-z]/g,escape)},validateUrl:function(urlConfig,p){if(""!==p.scheme&&!urlConfig.allowedSchemes.test(p.scheme))return"URL scheme is not allowed";if(""===p.host){if("file"!==p.scheme&&""!==p.scheme)return"Missing host"}else{var regexp=/^(?!-)[-a-z0-9]{0,62}[a-z0-9](?:\.(?!-)[-a-z0-9]{0,62}[a-z0-9])*$/i;if(!regexp.test(p.host)&&!BuiltInFilters.filterIpv4(p.host)&&!BuiltInFilters.filterIpv6(p.host.replace(/^\[(.*)\]$/,"$1",p.host)))return"URL host is invalid";if(urlConfig.disallowedHosts&&urlConfig.disallowedHosts.test(p.host)||urlConfig.restrictedHosts&&!urlConfig.restrictedHosts.test(p.host))return"URL host is not allowed"}}};Logger.prototype={add:function(type,msg,context){},clear:function(){},setAttribute:function(attrName){},setTag:function(tag){},unsetAttribute:function(){},unsetTag:function(){},debug:function(msg,context){},err:function(msg,context){},info:function(msg,context){},warn:function(msg,context){}},Tag.START_TAG=1,Tag.END_TAG=2,Tag.SELF_CLOSING_TAG=3,Tag.prototype.attributes,Tag.prototype.cascade,Tag.prototype.endTag,Tag.prototype.invalid=!1,Tag.prototype.len,Tag.prototype.name,Tag.prototype.pos,Tag.prototype.sortPriority=0,Tag.prototype.startTag,Tag.prototype.type,Tag.prototype.addFlags=function(flags){this.flags|=flags},Tag.prototype.cascadeInvalidationTo=function(tag){this.cascade.push(tag),this.invalid&&tag.invalidate()},Tag.prototype.gc=function(){this.cascade=[],delete this.endTag,delete this.startTag},Tag.prototype.invalidate=function(){this.invalid||(this.invalid=!0,this.cascade.forEach(function(tag){tag.invalidate()}))},Tag.prototype.pairWith=function(tag){this.name===tag.name&&(this.type===Tag.START_TAG&&tag.type===Tag.END_TAG&&tag.pos>=this.pos?(this.endTag=tag,tag.startTag=this,this.cascadeInvalidationTo(tag)):this.type===Tag.END_TAG&&tag.type===Tag.START_TAG&&tag.pos<=this.pos&&(this.startTag=tag,tag.endTag=this))},Tag.prototype.removeFlags=function(flags){this.flags&=~flags},Tag.prototype.setFlags=function(flags){this.flags=flags},Tag.prototype.setSortPriority=function(sortPriority){this.sortPriority=sortPriority},Tag.prototype.getAttributes=function(){var attributes={};for(var attrName in this.attributes)attributes[attrName]=this.attributes[attrName];return attributes},Tag.prototype.getEndTag=function(){return this.endTag},Tag.prototype.getFlags=function(){return this.flags},Tag.prototype.getLen=function(){return this.len},Tag.prototype.getName=function(){return this.name},Tag.prototype.getPos=function(){return this.pos},Tag.prototype.getSortPriority=function(){return this.sortPriority},Tag.prototype.getStartTag=function(){return this.startTag},Tag.prototype.getType=function(){return this.type},Tag.prototype.canClose=function(startTag){return!(this.invalid||this.name!==startTag.name||startTag.type!==Tag.START_TAG||this.type!==Tag.END_TAG||this.pos<startTag.pos||this.startTag&&this.startTag!==startTag||startTag.endTag&&startTag.endTag!==this)},Tag.prototype.isBrTag=function(){return"br"===this.name},Tag.prototype.isEndTag=function(){return!!(this.type&Tag.END_TAG)},Tag.prototype.isIgnoreTag=function(){return"i"===this.name},Tag.prototype.isInvalid=function(){return this.invalid},Tag.prototype.isParagraphBreak=function(){return"pb"===this.name},Tag.prototype.isSelfClosingTag=function(){return this.type===Tag.SELF_CLOSING_TAG},Tag.prototype.isSystemTag=function(){return"br i pb v".indexOf(this.name)>-1},Tag.prototype.isStartTag=function(){return!!(this.type&Tag.START_TAG)},Tag.prototype.isVerbatim=function(){return"v"===this.name},Tag.prototype.getAttribute=function(attrName){return this.attributes[attrName]},Tag.prototype.hasAttribute=function(attrName){return attrName in this.attributes},Tag.prototype.removeAttribute=function(attrName){delete this.attributes[attrName]},Tag.prototype.setAttribute=function(attrName,attrValue){this.attributes[attrName]=attrValue},Tag.prototype.setAttributes=function(attributes){this.attributes={};for(var attrName in attributes)this.attributes[attrName]=attributes[attrName]};var createdTags,cntOpen,cntTotal,context,currentFixingCost,currentTag,isRich,namespaces,openTags,output,pos,tagStack,tagStackIsSorted,text,textLen,wsPos,RULE_AUTO_CLOSE=1,RULE_AUTO_REOPEN=2,RULE_BREAK_PARAGRAPH=4,RULE_CREATE_PARAGRAPHS=8,RULE_DISABLE_AUTO_BR=16,RULE_ENABLE_AUTO_BR=32,RULE_IGNORE_TAGS=64,RULE_IGNORE_TEXT=128,RULE_IGNORE_WHITESPACE=256,RULE_IS_TRANSPARENT=512,RULE_PREVENT_BR=1024,RULE_TRIM_FIRST_LINE=4096,RULES_AUTO_LINEBREAKS=2096,RULES_INHERITANCE=RULE_ENABLE_AUTO_BR,WHITESPACE=" \n\t",logger=new Logger,maxFixingCost=1e3,plugins={Autoemail:{parser:function(text,matches){var config={attrName:"email",tagName:"EMAIL"},tagName=config.tagName,attrName=config.attrName;matches.forEach(function(m){var startTag=addStartTag(tagName,m[0][1],0);startTag.setAttribute(attrName,m[0][0]);var endTag=addEndTag(tagName,m[0][1]+m[0][0].length,0);startTag.pairWith(endTag)})},quickMatch:"@",regexp:/\b[-a-z0-9_+.]+@[-a-z0-9.]*[a-z0-9]/gi,regexpLimit:1e4},Autolink:{parser:function(text,matches){function linkifyUrl(tagPos,url){if(/^www\.|^[^:]+:/i.test(url)){var endTag=addEndTag(config.tagName,tagPos+url.length,0);"."===url.charAt(3)&&(url="http://"+url);var startTag=addStartTag(config.tagName,tagPos,0);startTag.setAttribute(config.attrName,url),startTag.setSortPriority(1),startTag.pairWith(endTag)}}function trimUrl(url){for(;;){url=url.replace(/[\s!"',.<>?]+$/,"");{if(!(")"===url.substr(-1)&&url.replace(/[^(]+/g,"").length<url.replace(/[^)]+/g,"").length))break;url=url.substr(0,url.length-1)}}return url}var config={attrName:"url",tagName:"URL"},chars="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";matches.forEach(function(m){var matchPos=m[0][1];matchPos>0&&chars.indexOf(text.charAt(matchPos-1))>-1||linkifyUrl(matchPos,trimUrl(m[0][0]))})},quickMatch:"://",regexp:/https?:\/\/\S(?:[^\s\[\]]*(?:\[\w*\])?)+/gi,regexpLimit:1e4},Emoji:{parser:function(text,matches){function addTag(tagPos,tagLen,seq){var tag=addSelfClosingTag(config.tagName,tagPos,tagLen);tag.setSortPriority(10),tag.setAttribute(config.attrName,seq)}function getSequence(str){str=str.replace(/\uFE0F/g,"");var seq=[],i=0;do{var cp=str.charCodeAt(i);cp>=55296&&(cp=(cp<<10)+str.charCodeAt(++i)-56613888),seq.push(cp.toString(16))}while(++i<str.length);return seq.join("-")}function parseAliases(text){if(HINT.EMOJI_HAS_ALIASES&&config.aliases){var m,matchPos=0;if(!(HINT.EMOJI_HAS_ALIAS_QUICKMATCH&&config.aliasesQuickMatch&&(matchPos=text.indexOf(config.aliasesQuickMatch),matchPos<0)))for(config.aliasesRegexp.lastIndex=matchPos;m=config.aliasesRegexp.exec(text);){var emoji,alias=m[0],tagPos=m.index;config.aliases[alias]&&(emoji=config.aliases[alias],addTag(tagPos,alias.length,getSequence(emoji)))}}}function parseAsciiEmoji(text){var m,matchPos=text.indexOf(":");if(!(matchPos<0))for(asciiRegexp.lastIndex=matchPos;m=asciiRegexp.exec(text);){var shortName=m[0].substr(1),tagPos=m.index;map[shortName]&&addTag(tagPos,2+shortName.length,map[shortName])}}function parseUnicodeEmoji(text){var m;for(unicodeRegexp.lastIndex=0;m=unicodeRegexp.exec(text);){var emoji=m[0],tagPos=m.index;addTag(tagPos,emoji.length,getSequence(emoji))}}var config={aliases:{":'(":"😢",":(":"🙁",":)":"🙂",":D":"😃",":O":"😮",":P":"😛",":|":"😐",";)":"😉",">:(":"😡","B)":"😎"},aliasesRegexp:/(?::(?:[)DOP|]|'?\()|>:\(|[;B]\))/g,attrName:"seq",tagName:"EMOJI"},asciiRegexp=/:[-+_a-z0-9]+(?=:)/g,map={"-1":"1f44e","+1":"1f44d","8ball":"1f3b1",a:"1f170",ab:"1f18e",abc:"1f524",abcd:"1f521",accept:"1f251",aerial_tramway:"1f6a1",airplane:"2708",alarm_clock:"23f0",alien:"1f47d",ambulance:"1f691",anchor:"2693",angel:"1f47c",anger:"1f4a2",angry:"1f620",anguished:"1f627",ant:"1f41c",apple:"1f34e",aquarius:"2652",aries:"2648",arrow_backward:"25c0",arrow_double_down:"23ec",arrow_double_up:"23eb",arrow_down:"2b07",arrow_down_small:"1f53d",arrow_forward:"25b6",arrow_heading_down:"2935",arrow_heading_up:"2934",arrow_left:"2b05",arrow_lower_left:"2199",arrow_lower_right:"2198",arrow_right:"27a1",arrow_right_hook:"21aa",arrow_up:"2b06",arrow_up_down:"2195",arrow_up_small:"1f53c",arrow_upper_left:"2196",arrow_upper_right:"2197",arrows_clockwise:"1f503",arrows_counterclockwise:"1f504",art:"1f3a8",articulated_lorry:"1f69b",astonished:"1f632",
athletic_shoe:"1f45f",atm:"1f3e7",b:"1f171",baby:"1f476",baby_bottle:"1f37c",baby_chick:"1f424",baby_symbol:"1f6bc",back:"1f519",baggage_claim:"1f6c4",balloon:"1f388",ballot_box_with_check:"2611",bamboo:"1f38d",banana:"1f34c",bangbang:"203c",bank:"1f3e6",bar_chart:"1f4ca",barber:"1f488",baseball:"26be",basketball:"1f3c0",bath:"1f6c0",bathtub:"1f6c1",battery:"1f50b",bear:"1f43b",bee:"1f41d",beer:"1f37a",beers:"1f37b",beetle:"1f41e",beginner:"1f530",bell:"1f514",bento:"1f371",bicyclist:"1f6b4",bike:"1f6b2",bikini:"1f459",bird:"1f426",birthday:"1f382",black_circle:"26ab",black_joker:"1f0cf",black_large_square:"2b1b",black_medium_small_square:"25fe",black_medium_square:"25fc",black_nib:"2712",black_small_square:"25aa",black_square_button:"1f532",blossom:"1f33c",blowfish:"1f421",blue_book:"1f4d8",blue_car:"1f699",blue_heart:"1f499",blush:"1f60a",boar:"1f417",boat:"26f5",bomb:"1f4a3",book:"1f4d6",bookmark:"1f516",bookmark_tabs:"1f4d1",books:"1f4da",boom:"1f4a5",boot:"1f462",bouquet:"1f490",bow:"1f647",bowling:"1f3b3",boy:"1f466",bread:"1f35e",bride_with_veil:"1f470",bridge_at_night:"1f309",briefcase:"1f4bc",broken_heart:"1f494",bug:"1f41b",bulb:"1f4a1",bullettrain_front:"1f685",bullettrain_side:"1f684",bus:"1f68c",busstop:"1f68f",bust_in_silhouette:"1f464",busts_in_silhouette:"1f465",cactus:"1f335",cake:"1f370",calendar:"1f4c6",calling:"1f4f2",camel:"1f42b",camera:"1f4f7",cancer:"264b",candy:"1f36c",capital_abcd:"1f520",capricorn:"2651",car:"1f697",card_index:"1f4c7",carousel_horse:"1f3a0",cat:"1f431",cat2:"1f408",cd:"1f4bf",chart:"1f4b9",chart_with_downwards_trend:"1f4c9",chart_with_upwards_trend:"1f4c8",checkered_flag:"1f3c1",cherries:"1f352",cherry_blossom:"1f338",chestnut:"1f330",chicken:"1f414",children_crossing:"1f6b8",chocolate_bar:"1f36b",christmas_tree:"1f384",church:"26ea",cinema:"1f3a6",circus_tent:"1f3aa",city_sunrise:"1f307",city_sunset:"1f306",cl:"1f191",clap:"1f44f",clapper:"1f3ac",clipboard:"1f4cb",clock1:"1f550",clock10:"1f559",clock1030:"1f565",clock11:"1f55a",clock1130:"1f566",clock12:"1f55b",clock1230:"1f567",clock130:"1f55c",clock2:"1f551",clock230:"1f55d",clock3:"1f552",clock330:"1f55e",clock4:"1f553",clock430:"1f55f",clock5:"1f554",clock530:"1f560",clock6:"1f555",clock630:"1f561",clock7:"1f556",clock730:"1f562",clock8:"1f557",clock830:"1f563",clock9:"1f558",clock930:"1f564",closed_book:"1f4d5",closed_lock_with_key:"1f510",closed_umbrella:"1f302",cloud:"2601",clubs:"2663",cn:"1f1e8-1f1f3",cocktail:"1f378",coffee:"2615",cold_sweat:"1f630",collision:"1f4a5",computer:"1f4bb",confetti_ball:"1f38a",confounded:"1f616",confused:"1f615",congratulations:"3297",construction:"1f6a7",construction_worker:"1f477",convenience_store:"1f3ea",cookie:"1f36a",cool:"1f192",cop:"1f46e",copyright:"a9",corn:"1f33d",couple:"1f46b",couple_with_heart:"1f491",couplekiss:"1f48f",cow:"1f42e",cow2:"1f404",credit_card:"1f4b3",crescent_moon:"1f319",crocodile:"1f40a",crossed_flags:"1f38c",crown:"1f451",cry:"1f622",crying_cat_face:"1f63f",crystal_ball:"1f52e",cupid:"1f498",curly_loop:"27b0",currency_exchange:"1f4b1",curry:"1f35b",custard:"1f36e",customs:"1f6c3",cyclone:"1f300",dancer:"1f483",dancers:"1f46f",dango:"1f361",dart:"1f3af",dash:"1f4a8",date:"1f4c5",de:"1f1e9-1f1ea",deciduous_tree:"1f333",department_store:"1f3ec",diamond_shape_with_a_dot_inside:"1f4a0",diamonds:"2666",disappointed:"1f61e",disappointed_relieved:"1f625",dizzy:"1f4ab",dizzy_face:"1f635",do_not_litter:"1f6af",dog:"1f436",dog2:"1f415",dollar:"1f4b5",dolls:"1f38e",dolphin:"1f42c",door:"1f6aa",doughnut:"1f369",dragon:"1f409",dragon_face:"1f432",dress:"1f457",dromedary_camel:"1f42a",droplet:"1f4a7",dvd:"1f4c0","e-mail":"1f4e7",ear:"1f442",ear_of_rice:"1f33e",earth_africa:"1f30d",earth_americas:"1f30e",earth_asia:"1f30f",egg:"1f373",eggplant:"1f346",eight:"38-20e3",eight_pointed_black_star:"2734",eight_spoked_asterisk:"2733",electric_plug:"1f50c",elephant:"1f418",email:"2709",end:"1f51a",envelope:"2709",envelope_with_arrow:"1f4e9",es:"1f1ea-1f1f8",euro:"1f4b6",european_castle:"1f3f0",european_post_office:"1f3e4",evergreen_tree:"1f332",exclamation:"2757",expressionless:"1f611",eyeglasses:"1f453",eyes:"1f440",facepunch:"1f44a",factory:"1f3ed",fallen_leaf:"1f342",family:"1f46a",fast_forward:"23e9",fax:"1f4e0",fearful:"1f628",feet:"1f43e",ferris_wheel:"1f3a1",file_folder:"1f4c1",fire:"1f525",fire_engine:"1f692",fireworks:"1f386",first_quarter_moon:"1f313",first_quarter_moon_with_face:"1f31b",fish:"1f41f",fish_cake:"1f365",fishing_pole_and_fish:"1f3a3",fist:"270a",five:"35-20e3",flags:"1f38f",flashlight:"1f526",flipper:"1f42c",floppy_disk:"1f4be",flower_playing_cards:"1f3b4",flushed:"1f633",foggy:"1f301",football:"1f3c8",footprints:"1f463",fork_and_knife:"1f374",fountain:"26f2",four:"34-20e3",four_leaf_clover:"1f340",fr:"1f1eb-1f1f7",free:"1f193",fried_shrimp:"1f364",fries:"1f35f",frog:"1f438",frowning:"1f626",fuelpump:"26fd",full_moon:"1f315",full_moon_with_face:"1f31d",game_die:"1f3b2",gb:"1f1ec-1f1e7",gem:"1f48e",gemini:"264a",ghost:"1f47b",gift:"1f381",gift_heart:"1f49d",girl:"1f467",globe_with_meridians:"1f310",goat:"1f410",golf:"26f3",grapes:"1f347",green_apple:"1f34f",green_book:"1f4d7",green_heart:"1f49a",grey_exclamation:"2755",grey_question:"2754",grimacing:"1f62c",grin:"1f601",grinning:"1f600",guardsman:"1f482",guitar:"1f3b8",gun:"1f52b",haircut:"1f487",hamburger:"1f354",hammer:"1f528",hamster:"1f439",hand:"270b",handbag:"1f45c",hankey:"1f4a9",hash:"23-20e3",hatched_chick:"1f425",hatching_chick:"1f423",headphones:"1f3a7",hear_no_evil:"1f649",heart:"2764",heart_decoration:"1f49f",heart_eyes:"1f60d",heart_eyes_cat:"1f63b",heartbeat:"1f493",heartpulse:"1f497",hearts:"2665",heavy_check_mark:"2714",heavy_division_sign:"2797",heavy_dollar_sign:"1f4b2",heavy_exclamation_mark:"2757",heavy_minus_sign:"2796",heavy_multiplication_x:"2716",heavy_plus_sign:"2795",helicopter:"1f681",herb:"1f33f",hibiscus:"1f33a",high_brightness:"1f506",high_heel:"1f460",hocho:"1f52a",honey_pot:"1f36f",honeybee:"1f41d",horse:"1f434",horse_racing:"1f3c7",hospital:"1f3e5",hotel:"1f3e8",hotsprings:"2668",hourglass:"231b",hourglass_flowing_sand:"23f3",house:"1f3e0",house_with_garden:"1f3e1",hushed:"1f62f",ice_cream:"1f368",icecream:"1f366",id:"1f194",ideograph_advantage:"1f250",imp:"1f47f",inbox_tray:"1f4e5",incoming_envelope:"1f4e8",information_desk_person:"1f481",information_source:"2139",innocent:"1f607",interrobang:"2049",iphone:"1f4f1",it:"1f1ee-1f1f9",izakaya_lantern:"1f3ee",jack_o_lantern:"1f383",japan:"1f5fe",japanese_castle:"1f3ef",japanese_goblin:"1f47a",japanese_ogre:"1f479",jeans:"1f456",joy:"1f602",joy_cat:"1f639",jp:"1f1ef-1f1f5",key:"1f511",keycap_ten:"1f51f",kimono:"1f458",kiss:"1f48b",kissing:"1f617",kissing_cat:"1f63d",kissing_closed_eyes:"1f61a",kissing_heart:"1f618",kissing_smiling_eyes:"1f619",knife:"1f52a",koala:"1f428",koko:"1f201",kr:"1f1f0-1f1f7",lantern:"1f3ee",large_blue_circle:"1f535",large_blue_diamond:"1f537",large_orange_diamond:"1f536",last_quarter_moon:"1f317",last_quarter_moon_with_face:"1f31c",laughing:"1f606",leaves:"1f343",ledger:"1f4d2",left_luggage:"1f6c5",left_right_arrow:"2194",leftwards_arrow_with_hook:"21a9",lemon:"1f34b",leo:"264c",leopard:"1f406",libra:"264e",light_rail:"1f688",link:"1f517",lips:"1f444",lipstick:"1f484",lock:"1f512",lock_with_ink_pen:"1f50f",lollipop:"1f36d",loop:"27bf",loud_sound:"1f50a",loudspeaker:"1f4e2",love_hotel:"1f3e9",love_letter:"1f48c",low_brightness:"1f505",m:"24c2",mag:"1f50d",mag_right:"1f50e",mahjong:"1f004",mailbox:"1f4eb",mailbox_closed:"1f4ea",mailbox_with_mail:"1f4ec",mailbox_with_no_mail:"1f4ed",man:"1f468",man_with_gua_pi_mao:"1f472",man_with_turban:"1f473",mans_shoe:"1f45e",maple_leaf:"1f341",mask:"1f637",massage:"1f486",meat_on_bone:"1f356",mega:"1f4e3",melon:"1f348",memo:"1f4dd",mens:"1f6b9",metro:"1f687",microphone:"1f3a4",microscope:"1f52c",milky_way:"1f30c",minibus:"1f690",minidisc:"1f4bd",mobile_phone_off:"1f4f4",money_with_wings:"1f4b8",moneybag:"1f4b0",monkey:"1f412",monkey_face:"1f435",monorail:"1f69d",moon:"1f314",mortar_board:"1f393",mount_fuji:"1f5fb",mountain_bicyclist:"1f6b5",mountain_cableway:"1f6a0",mountain_railway:"1f69e",mouse:"1f42d",mouse2:"1f401",movie_camera:"1f3a5",moyai:"1f5ff",muscle:"1f4aa",mushroom:"1f344",musical_keyboard:"1f3b9",musical_note:"1f3b5",musical_score:"1f3bc",mute:"1f507",nail_care:"1f485",name_badge:"1f4db",necktie:"1f454",negative_squared_cross_mark:"274e",neutral_face:"1f610",new:"1f195",new_moon:"1f311",new_moon_with_face:"1f31a",newspaper:"1f4f0",ng:"1f196",ng_woman:"1f645",night_with_stars:"1f303",nine:"39-20e3",no_bell:"1f515",no_bicycles:"1f6b3",no_entry:"26d4",no_entry_sign:"1f6ab",no_good:"1f645",no_mobile_phones:"1f4f5",no_mouth:"1f636",no_pedestrians:"1f6b7",no_smoking:"1f6ad","non-potable_water":"1f6b1",nose:"1f443",notebook:"1f4d3",notebook_with_decorative_cover:"1f4d4",notes:"1f3b6",nut_and_bolt:"1f529",o:"2b55",o2:"1f17e",ocean:"1f30a",octopus:"1f419",oden:"1f362",office:"1f3e2",ok:"1f197",ok_hand:"1f44c",ok_woman:"1f646",older_man:"1f474",older_woman:"1f475",on:"1f51b",oncoming_automobile:"1f698",oncoming_bus:"1f68d",oncoming_police_car:"1f694",oncoming_taxi:"1f696",one:"31-20e3",open_book:"1f4d6",open_file_folder:"1f4c2",open_hands:"1f450",open_mouth:"1f62e",ophiuchus:"26ce",orange_book:"1f4d9",outbox_tray:"1f4e4",ox:"1f402",package:"1f4e6",page_facing_up:"1f4c4",page_with_curl:"1f4c3",pager:"1f4df",palm_tree:"1f334",panda_face:"1f43c",paperclip:"1f4ce",parking:"1f17f",part_alternation_mark:"303d",partly_sunny:"26c5",passport_control:"1f6c2",paw_prints:"1f43e",peach:"1f351",pear:"1f350",pencil:"1f4dd",pencil2:"270f",penguin:"1f427",pensive:"1f614",performing_arts:"1f3ad",persevere:"1f623",person_frowning:"1f64d",person_with_blond_hair:"1f471",person_with_pouting_face:"1f64e",phone:"260e",pig:"1f437",pig2:"1f416",pig_nose:"1f43d",pill:"1f48a",pineapple:"1f34d",pisces:"2653",pizza:"1f355",point_down:"1f447",point_left:"1f448",point_right:"1f449",point_up:"261d",point_up_2:"1f446",police_car:"1f693",poodle:"1f429",poop:"1f4a9",post_office:"1f3e3",postal_horn:"1f4ef",postbox:"1f4ee",potable_water:"1f6b0",pouch:"1f45d",poultry_leg:"1f357",pound:"1f4b7",pout:"1f621",pouting_cat:"1f63e",pray:"1f64f",princess:"1f478",punch:"1f44a",purple_heart:"1f49c",purse:"1f45b",pushpin:"1f4cc",put_litter_in_its_place:"1f6ae",question:"2753",rabbit:"1f430",rabbit2:"1f407",racehorse:"1f40e",radio:"1f4fb",radio_button:"1f518",rage:"1f621",railway_car:"1f683",rainbow:"1f308",raised_hand:"270b",raised_hands:"1f64c",raising_hand:"1f64b",ram:"1f40f",ramen:"1f35c",rat:"1f400",recycle:"267b",red_car:"1f697",red_circle:"1f534",registered:"ae",relaxed:"263a",relieved:"1f60c",repeat:"1f501",repeat_one:"1f502",restroom:"1f6bb",revolving_hearts:"1f49e",rewind:"23ea",ribbon:"1f380",rice:"1f35a",rice_ball:"1f359",rice_cracker:"1f358",rice_scene:"1f391",ring:"1f48d",rocket:"1f680",roller_coaster:"1f3a2",rooster:"1f413",rose:"1f339",rotating_light:"1f6a8",round_pushpin:"1f4cd",rowboat:"1f6a3",ru:"1f1f7-1f1fa",rugby_football:"1f3c9",runner:"1f3c3",running:"1f3c3",running_shirt_with_sash:"1f3bd",sa:"1f202",sagittarius:"2650",sailboat:"26f5",sake:"1f376",sandal:"1f461",santa:"1f385",satellite:"1f4e1",satisfied:"1f606",saxophone:"1f3b7",school:"1f3eb",school_satchel:"1f392",scissors:"2702",scorpius:"264f",scream:"1f631",scream_cat:"1f640",scroll:"1f4dc",seat:"1f4ba",secret:"3299",see_no_evil:"1f648",seedling:"1f331",seven:"37-20e3",shaved_ice:"1f367",sheep:"1f411",shell:"1f41a",ship:"1f6a2",shirt:"1f455",shit:"1f4a9",shoe:"1f45e",shower:"1f6bf",signal_strength:"1f4f6",six:"36-20e3",six_pointed_star:"1f52f",ski:"1f3bf",skull:"1f480",sleeping:"1f634",sleepy:"1f62a",slot_machine:"1f3b0",small_blue_diamond:"1f539",small_orange_diamond:"1f538",small_red_triangle:"1f53a",small_red_triangle_down:"1f53b",smile:"1f604",smile_cat:"1f638",smiley:"1f603",smiley_cat:"1f63a",smiling_imp:"1f608",smirk:"1f60f",smirk_cat:"1f63c",smoking:"1f6ac",snail:"1f40c",snake:"1f40d",snowboarder:"1f3c2",snowflake:"2744",snowman:"26c4",sob:"1f62d",soccer:"26bd",soon:"1f51c",sos:"1f198",sound:"1f509",space_invader:"1f47e",spades:"2660",spaghetti:"1f35d",sparkle:"2747",sparkler:"1f387",sparkles:"2728",sparkling_heart:"1f496",speak_no_evil:"1f64a",speaker:"1f508",speech_balloon:"1f4ac",speedboat:"1f6a4",star:"2b50",star2:"1f31f",stars:"1f320",station:"1f689",statue_of_liberty:"1f5fd",steam_locomotive:"1f682",stew:"1f372",straight_ruler:"1f4cf",strawberry:"1f353",stuck_out_tongue:"1f61b",stuck_out_tongue_closed_eyes:"1f61d",stuck_out_tongue_winking_eye:"1f61c",sun_with_face:"1f31e",sunflower:"1f33b",sunglasses:"1f60e",sunny:"2600",sunrise:"1f305",sunrise_over_mountains:"1f304",surfer:"1f3c4",sushi:"1f363",suspension_railway:"1f69f",sweat:"1f613",sweat_drops:"1f4a6",sweat_smile:"1f605",sweet_potato:"1f360",swimmer:"1f3ca",symbols:"1f523",syringe:"1f489",tada:"1f389",tanabata_tree:"1f38b",tangerine:"1f34a",taurus:"2649",taxi:"1f695",tea:"1f375",telephone:"260e",telephone_receiver:"1f4de",telescope:"1f52d",tennis:"1f3be",tent:"26fa",thought_balloon:"1f4ad",three:"33-20e3",thumbsdown:"1f44e",thumbsup:"1f44d",ticket:"1f3ab",tiger:"1f42f",tiger2:"1f405",tired_face:"1f62b",tm:"2122",toilet:"1f6bd",tokyo_tower:"1f5fc",tomato:"1f345",tongue:"1f445",top:"1f51d",tophat:"1f3a9",tractor:"1f69c",traffic_light:"1f6a5",train:"1f68b",train2:"1f686",tram:"1f68a",triangular_flag_on_post:"1f6a9",triangular_ruler:"1f4d0",trident:"1f531",triumph:"1f624",trolleybus:"1f68e",trophy:"1f3c6",tropical_drink:"1f379",tropical_fish:"1f420",truck:"1f69a",trumpet:"1f3ba",tshirt:"1f455",tulip:"1f337",turtle:"1f422",tv:"1f4fa",twisted_rightwards_arrows:"1f500",two:"32-20e3",two_hearts:"1f495",two_men_holding_hands:"1f46c",two_women_holding_hands:"1f46d",u5272:"1f239",u5408:"1f234",u55b6:"1f23a",u6307:"1f22f",u6708:"1f237",u6709:"1f236",u6e80:"1f235",u7121:"1f21a",u7533:"1f238",u7981:"1f232",u7a7a:"1f233",uk:"1f1ec-1f1e7",umbrella:"2614",unamused:"1f612",underage:"1f51e",unlock:"1f513",up:"1f199",us:"1f1fa-1f1f8",v:"270c",vertical_traffic_light:"1f6a6",vhs:"1f4fc",vibration_mode:"1f4f3",video_camera:"1f4f9",video_game:"1f3ae",violin:"1f3bb",virgo:"264d",volcano:"1f30b",vs:"1f19a",walking:"1f6b6",waning_crescent_moon:"1f318",waning_gibbous_moon:"1f316",warning:"26a0",watch:"231a",water_buffalo:"1f403",watermelon:"1f349",wave:"1f44b",wavy_dash:"3030",waxing_crescent_moon:"1f312",waxing_gibbous_moon:"1f314",wc:"1f6be",weary:"1f629",wedding:"1f492",whale:"1f433",whale2:"1f40b",wheelchair:"267f",white_check_mark:"2705",white_circle:"26aa",white_flower:"1f4ae",white_large_square:"2b1c",white_medium_small_square:"25fd",white_medium_square:"25fb",white_small_square:"25ab",white_square_button:"1f533",wind_chime:"1f390",wine_glass:"1f377",wink:"1f609",wolf:"1f43a",woman:"1f469",womans_clothes:"1f45a",womans_hat:"1f452",womens:"1f6ba",worried:"1f61f",wrench:"1f527",x:"274c",yellow_heart:"1f49b",yen:"1f4b4",yum:"1f60b",zap:"26a1",zero:"30-20e3",zzz:"1f4a4",100:"1f4af",1234:"1f522"},unicodeRegexp=/(?:[\u231A\u231B\u23E9-\u23EC\u23F0\u23F3\u25FD\u25FE\u2614\u2615\u2648-\u2653\u267F\u2693\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26CE\u26D4\u26EA\u26F2\u26F3\u26F5\u26FA\u26FD\u2705\u270A\u270B\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u27B0\u27BF\u2B1B\u2B1C\u2B50\u2B55]|\uD83C(?:[\uDC04\uDCCF\uDD8E\uDD91-\uDD9A\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF30-\uDF35\uDF37-\uDF7C\uDF80-\uDF93\uDFA0-\uDFC4\uDFC6-\uDFCA\uDFE0-\uDFF0]|[\uDDE6-\uDDFF]\uD83C[\uDDE6-\uDDFF])|\uD83D[\uDC00-\uDC3E\uDC40\uDC42-\uDCF7\uDCF9-\uDCFC\uDD00-\uDD3D\uDD50-\uDD67\uDDFB-\uDE40\uDE45-\uDE4F\uDE80-\uDEC5])(?!\uFE0E)\uFE0F?|(?:[\u00A9\u00AE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB\u25FC\u2600\u2601\u260E\u2611\u261D\u263A\u2660\u2663\u2665\u2666\u2668\u267B\u26A0\u2702\u2708\u2709\u270C\u270F\u2712\u2714\u2716\u2733\u2734\u2744\u2747\u2764\u27A1\u2934\u2935\u2B05-\u2B07\u3030\u303D\u3297\u3299]|\uD83C[\uDD70\uDD71\uDD7E\uDD7F\uDE02\uDE37])\uFE0F|[#0-9]\uFE0F?\u20E3/g;parseAsciiEmoji(text),parseAliases(text),parseUnicodeEmoji(text)}},Escaper:{parser:function(text,matches){var config={tagName:"ESC"};matches.forEach(function(m){addTagPair(config.tagName,m[0][1],1,m[0][1]+m[0][0].length,0)})},quickMatch:"\\",regexp:/\\[-!#()*+.:<>@[\\\]^_`{}]/g,regexpLimit:1e4},Litedown:{parser:function(text,matches){function closeList(list,textBoundary){addEndTag("LIST",textBoundary,0).pairWith(list.listTag),addEndTag("LI",textBoundary,0).pairWith(list.itemTag),list.tight&&list.itemTags.forEach(function(itemTag){itemTag.removeFlags(RULE_CREATE_PARAGRAPHS)})}function computeQuoteIgnoreLen(str,maxQuoteDepth){for(var remaining=str;--maxQuoteDepth>=0;)remaining=remaining.replace(/^ *> ?/,"");return str.length-remaining.length}function decode(str){return HINT.LITEDOWN_DECODE_HTML_ENTITIES&&config.decodeHtmlEntities&&str.indexOf("&")>-1&&(str=html_entity_decode(str)),str=str.replace(/[\\\x1A]/g,""),hasEscapedChars&&(str=str.replace(/\x1B./g,function(seq){return{"0":"!","1":'"',"2":")","3":"*","4":"[","5":"\\","6":"]","7":"^","8":"_","9":"`","A":"~"}[seq]})),str}function decodeQuotedString(str){return decode(str.replace(/^\s*(.*?)\s*$/,"$1").replace(/^(['"])(.*)\1$/,"$2"))}function encode(str){return str.replace(/\\[!")*[\\\]^_`~]/g,function(str){return{"\\!":"0",'\\"':"1","\\)":"2","\\*":"3","\\[":"4","\\\\":"5","\\]":"6","\\^":"7","\\_":"8","\\`":"9","\\~":"A"}[str]})}function getAtxHeaderEndTagLen(startPos,endPos){var content=text.substr(startPos,endPos-startPos),m=/[ \t]*#*[ \t]*$/.exec(content);return m[0].length}function getEmphasisByBlock(regexp,pos){var m,block=[],blocks=[],breakPos=breakPos=text.indexOf("",pos);for(regexp.lastIndex=pos;m=regexp.exec(text);){var matchPos=m.index,matchLen=m[0].length;matchPos>breakPos&&(blocks.push(block),block=[],breakPos=text.indexOf("",matchPos)),ignoreEmphasis(matchPos,matchLen)||block.push([matchPos,matchLen])}return blocks.push(block),blocks}function getInlineLinkAttributes(m){var attrValues=[decode(m[3])];if(m[4]){var title=decodeQuotedString(m[4]);title>""&&attrValues.push(title)}return attrValues}function getReferenceLinkAttributes(label){return"undefined"==typeof links&&matchLinkReferences(),label=label.toLowerCase(),links[label]||[]}function getSetextLines(){var setextLines={};if(text.indexOf("-")===-1&&text.indexOf("=")===-1)return setextLines;for(var m,regexp=/^(?=[-=>])(?:> ?)*(?=[-=])(?:-+|=+) *$/gm;m=regexp.exec(text);){for(var match=m[0],matchPos=m.index,endTagPos=matchPos-1;endTagPos>0&&" "===text[endTagPos-1];)--endTagPos;setextLines[matchPos-1]={endTagLen:matchPos+match.length-endTagPos,endTagPos:endTagPos,quoteDepth:match.length-match.replace(/>/g,"").length,tagName:"="===match.charAt(0)?"H1":"H2"}}return setextLines}function ignoreEmphasis(matchPos,matchLen){return!("_"!==text[matchPos]||1!==matchLen||!isSurroundedByAlnum(matchPos,matchLen))}function init(){text.indexOf("\\")<0?hasEscapedChars=!1:(hasEscapedChars=!0,text=encode(text)),text+="\n\n",links=void 0}function isAlnum(chr){return" abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".indexOf(chr)>0}function isSurroundedByAlnum(matchPos,matchLen){return matchPos>0&&isAlnum(text[matchPos-1])&&isAlnum(text[matchPos+matchLen])}function markBoundary(pos){text=text.substr(0,pos)+""+text.substr(pos+1)}function matchBlockLevelMarkup(){for(var codeFence,codeTag,breakParagraph,continuation,endTag,ignoreLen,indentStr,indentLen,lfPos,listIndex,maxIndent,minIndent,quoteDepth,tagPos,tagLen,m,codeIndent=4,lineIsEmpty=!0,lists=[],listsCnt=0,newContext=!1,quotes=[],quotesCnt=0,setextLines=getSetextLines(),textBoundary=0,matches=[],regexp=/^(?:(?=[-*+\d \t>`~#_])((?: {0,3}> ?)+)?([ \t]+)?(\* *\* *\*[* ]*$|- *- *-[- ]*$|_ *_ *_[_ ]*$)?((?:[-*+]|\d+\.)[ \t]+(?=\S))?[ \t]*(#{1,6}[ \t]+|```+[^`\n]*$|~~~+[^~\n]*$)?)?/gm;m=regexp.exec(text);)matches.push(m),m.index===regexp.lastIndex&&++regexp.lastIndex;matches.forEach(function(m){var matchPos=m.index,matchLen=m[0].length;if(ignoreLen=0,quoteDepth=0,continuation=!lineIsEmpty,lfPos=text.indexOf("\n",matchPos),lineIsEmpty=lfPos===matchPos+matchLen&&!m[3]&&!m[4]&&!m[5],matchLen||++regexp.lastIndex,breakParagraph=lineIsEmpty&&continuation,m[1]&&(quoteDepth=m[1].length-m[1].replace(/>/g,"").length,ignoreLen=m[1].length,codeTag&&codeTag.hasAttribute("quoteDepth")&&(quoteDepth=Math.min(quoteDepth,codeTag.getAttribute("quoteDepth")),ignoreLen=computeQuoteIgnoreLen(m[1],quoteDepth))),quoteDepth<quotesCnt&&!continuation&&!lineIsEmpty){newContext=!0;do addEndTag("QUOTE",textBoundary,0).pairWith(quotes.pop());while(quoteDepth<--quotesCnt)}if(quoteDepth>quotesCnt&&!lineIsEmpty){newContext=!0;do{var tag=addStartTag("QUOTE",matchPos,0);tag.setSortPriority(quotesCnt),quotes.push(tag)}while(quoteDepth>++quotesCnt)}var indentWidth=0,indentPos=0;if(m[2]&&!codeFence){indentStr=m[2],indentLen=indentStr.length;do" "===indentStr.charAt(indentPos)?++indentWidth:indentWidth=indentWidth+4&-4;while(++indentPos<indentLen&&indentWidth<codeIndent)}if(codeTag&&!codeFence&&indentWidth<codeIndent&&!lineIsEmpty&&(newContext=!0),newContext&&(newContext=!1,codeTag&&(overwrite(codeTag.getPos(),textBoundary-codeTag.getPos()),endTag=addEndTag("CODE",textBoundary,0),endTag.pairWith(codeTag),endTag.setSortPriority(-1),codeTag=null,codeFence=null),lists.forEach(function(list){closeList(list,textBoundary)}),lists=[],listsCnt=0,matchPos&&markBoundary(matchPos-1)),indentWidth>=codeIndent)!codeTag&&continuation||(ignoreLen=(m[1]||"").length+indentPos,codeTag||(codeTag=addStartTag("CODE",matchPos+ignoreLen,0)),m={});else{var hasListItem=!!m[4];if(indentWidth||continuation||hasListItem||lineIsEmpty)if(continuation&&!hasListItem)listIndex=listsCnt-1;else if(listsCnt)for(listIndex=0;listIndex<listsCnt&&indentWidth>lists[listIndex].maxIndent;)++listIndex;else listIndex=!hasListItem||continuation&&""!==text.charAt(matchPos-1)?-1:0;else listIndex=-1;for(;listIndex<listsCnt-1;)closeList(lists.pop(),textBoundary),--listsCnt;if(listIndex!==listsCnt||hasListItem||--listIndex,hasListItem&&listIndex>=0){breakParagraph=!0,tagPos=matchPos+ignoreLen+indentPos,tagLen=m[4].length;var itemTag=addStartTag("LI",tagPos,tagLen);if(overwrite(tagPos,tagLen),listIndex<listsCnt)addEndTag("LI",textBoundary,0).pairWith(lists[listIndex].itemTag),lists[listIndex].itemTag=itemTag,lists[listIndex].itemTags.push(itemTag);else{++listsCnt,listIndex?(minIndent=lists[listIndex-1].maxIndent+1,maxIndent=Math.max(minIndent,4*listIndex)):(minIndent=0,maxIndent=indentWidth);var listTag=addStartTag("LIST",tagPos,0);if(m[4].indexOf(".")>-1){listTag.setAttribute("type","decimal");var start=+m[4];1!==start&&listTag.setAttribute("start",start)}lists.push({listTag:listTag,itemTag:itemTag,itemTags:[itemTag],minIndent:minIndent,maxIndent:maxIndent,tight:!0})}}!listsCnt||continuation||lineIsEmpty||(lists[0].itemTags.length>1||!hasListItem)&&lists.forEach(function(list){list.tight=!1}),codeIndent=4*(listsCnt+1)}if(m[5]){if("#"===m[5].charAt(0))startTagLen=m[5].length,startTagPos=matchPos+matchLen-startTagLen,endTagLen=getAtxHeaderEndTagLen(matchPos+matchLen,lfPos),endTagPos=lfPos-endTagLen,addTagPair("H"+/#{1,6}/.exec(m[5])[0].length,startTagPos,startTagLen,endTagPos,endTagLen),markBoundary(startTagPos),markBoundary(lfPos),continuation&&(breakParagraph=!0);else if("`"===m[5].charAt(0)||"~"===m[5].charAt(0))if(tagPos=matchPos+ignoreLen,tagLen=lfPos-tagPos,codeTag&&m[5]===codeFence)endTag=addEndTag("CODE",tagPos,tagLen),endTag.pairWith(codeTag),endTag.setSortPriority(-1),addIgnoreTag(textBoundary,tagPos-textBoundary),overwrite(codeTag.getPos(),tagPos+tagLen-codeTag.getPos()),codeTag=null,codeFence=null;else if(!codeTag){codeTag=addStartTag("CODE",tagPos,tagLen),codeFence=m[5].replace(/[^`~]+/,""),codeTag.setAttribute("quoteDepth",quoteDepth),addIgnoreTag(tagPos+tagLen,1);var lang=m[5].replace(/^[`~\s]*/,"").replace(/\s+$/,"");""!==lang&&codeTag.setAttribute("lang",lang)}}else m[3]&&!listsCnt&&""!==text.charAt(matchPos+matchLen)?(addSelfClosingTag("HR",matchPos+ignoreLen,matchLen-ignoreLen),breakParagraph=!0,markBoundary(lfPos)):!setextLines[lfPos]||setextLines[lfPos].quoteDepth!==quoteDepth||lineIsEmpty||listsCnt||codeTag||(addTagPair(setextLines[lfPos].tagName,matchPos+ignoreLen,0,setextLines[lfPos].endTagPos,setextLines[lfPos].endTagLen),markBoundary(setextLines[lfPos].endTagPos+setextLines[lfPos].endTagLen));breakParagraph&&(addParagraphBreak(textBoundary),markBoundary(textBoundary)),lineIsEmpty||(textBoundary=lfPos),ignoreLen&&addIgnoreTag(matchPos,ignoreLen).setSortPriority(1e3)})}function matchEmphasis(){matchEmphasisByCharacter("*",/\*+/g),matchEmphasisByCharacter("_",/_+/g)}function matchEmphasisByCharacter(character,regexp){var pos=text.indexOf(character);pos!==-1&&getEmphasisByBlock(regexp,pos).forEach(processEmphasisBlock)}function matchForcedLineBreaks(){for(var pos=text.indexOf("  \n");pos!==-1;)addBrTag(pos+2),pos=text.indexOf("  \n",pos+3)}function matchImages(){if(text.indexOf("![")!==-1)for(var m,regexp=/!\[([^\x17]*?(?=] ?\()|[^\x17\]]*)](?: ?\[([^\x17\]]+)\]| ?\(([^\x17 ")]+)( *(?:"[^\x17"]*"|\'[^\x17\']*\'|[^\x17\)]*))?\))?/g;m=regexp.exec(text);){var matchPos=m.index,matchLen=m[0].length,contentLen=m[1].length,startTagPos=matchPos,startTagLen=2,endTagPos=startTagPos+startTagLen+contentLen,endTagLen=matchLen-startTagLen-contentLen,tag=addTagPair("IMG",startTagPos,startTagLen,endTagPos,endTagLen);tag.setAttribute("alt",decode(m[1])),setLinkAttributes(tag,m,["src","title"]),overwrite(matchPos,matchLen)}}function matchInlineCode(){if(text.indexOf("`")!==-1)for(var m,regexp=/((`+)(?!`)\s*)(?:[^\x17]*?[^`\s])?(\s*\2)(?!`)/g;m=regexp.exec(text);){var matchPos=m.index,matchLen=m[0].length,startTagLen=m[1].length,endTagLen=m[3].length;addTagPair("C",matchPos,startTagLen,matchPos+matchLen-endTagLen,endTagLen),overwrite(matchPos,matchLen)}}function matchLinkReferences(){links={};for(var m,regexp=/^(?:> ?)* {0,3}\[([^\x17\]]+)\]: *([^\s\x17]+)([^\n\x17]*)\n?/gm;m=regexp.exec(text);){addIgnoreTag(m.index,m[0].length).setSortPriority(-2);var label=m[1].toLowerCase();if(!links[label]){links[label]=[decode(m[2])];var title=decodeQuotedString(m[3]);title>""&&links[label].push(title)}}}function matchLinks(){if(text.indexOf("[")!==-1)for(var m,regexp=/\[([^\x17]*?(?=]\()|[^\x17\]]*)](?: ?\[([^\x17\]]+)\]|\(([^\x17 ()]+(?:\([^\x17 ()]+\)[^\x17 ()]*)*[^\x17 )]*)( *(?:"[^\x17"]*"|\'[^\x17\']*\'|[^\x17\)]*))?\))?/g;m=regexp.exec(text);){var matchPos=m.index,matchLen=m[0].length,contentLen=m[1].length,startTagPos=matchPos,startTagLen=1,endTagPos=startTagPos+startTagLen+contentLen,endTagLen=matchLen-startTagLen-contentLen,tag=addTagPair("URL",startTagPos,startTagLen,endTagPos,endTagLen);setLinkAttributes(tag,m,["url","title"]),tag.setSortPriority(-1),overwrite(startTagPos,startTagLen),overwrite(endTagPos,endTagLen)}}function matchStrikethrough(){if(text.indexOf("~~")!==-1)for(var m,regexp=/~~[^\x17]+?~~/g;m=regexp.exec(text);){var match=m[0],matchPos=m.index,matchLen=match.length;addTagPair("DEL",matchPos,2,matchPos+matchLen-2,2)}}function matchSuperscript(){if(text.indexOf("^")!==-1)for(var m,regexp=/\^[^\x17\s]+/g;m=regexp.exec(text);){var match=m[0],matchPos=m.index,matchLen=match.length,startTagPos=matchPos,endTagPos=matchPos+matchLen,parts=match.split("^");parts.shift(),parts.forEach(function(part){addTagPair("SUP",startTagPos,1,endTagPos,0),startTagPos+=1+part.length})}}function overwrite(pos,len){text=text.substr(0,pos)+new Array(1+len).join("")+text.substr(pos+len)}function processEmphasisBlock(block){var remaining,buffered=0,emPos=-1,strongPos=-1;block.forEach(function(pair){var matchPos=pair[0],matchLen=pair[1],closeLen=Math.min(3,matchLen),closeEm=closeLen&buffered&1,closeStrong=closeLen&buffered&2,emEndPos=matchPos,strongEndPos=matchPos;buffered>2&&emPos===strongPos&&(closeEm?emPos+=2:++strongPos),closeEm&&closeStrong&&(emPos<strongPos?emEndPos+=2:++strongEndPos),remaining=matchLen,closeEm&&(--buffered,--remaining,addTagPair("EM",emPos,1,emEndPos,1)),closeStrong&&(buffered-=2,remaining-=2,addTagPair("STRONG",strongPos,2,strongEndPos,2)),remaining=Math.min(3,remaining),1&remaining&&(emPos=matchPos+matchLen-remaining),2&remaining&&(strongPos=matchPos+matchLen-remaining),buffered+=remaining})}function setLinkAttributes(tag,m,attrNames){var attrValues;if(m[3])attrValues=getInlineLinkAttributes(m);else{var label=m[2]||m[1];attrValues=getReferenceLinkAttributes(label)}attrValues.forEach(function(attrValue,k){tag.setAttribute(attrNames[k],attrValue)})}var hasEscapedChars,links,startTagLen,startTagPos,endTagPos,endTagLen,config={decodeHtmlEntities:!1};init(),matchBlockLevelMarkup(),matchInlineCode(),matchImages(),matchLinks(),matchStrikethrough(),matchSuperscript(),matchEmphasis(),matchForcedLineBreaks()}},Preg:{parser:function(text,matches){var config={generics:[["POSTMENTION",/\B@([a-z0-9_-]+)#(\d+)/gi,0,["","username","id"]],["USERMENTION",/\B@([a-z0-9_-]+)(?!#)/gi,0,["","username"]]]};config.generics.forEach(function(entry){var m,tagName=entry[0],regexp=entry[1],passthroughIdx=entry[2],map=entry[3];for(regexp.lastIndex=0;m=regexp.exec(text);){var tag,startTagPos=m.index,matchLen=m[0].length;if(HINT.PREG_HAS_PASSTHROUGH&&passthroughIdx&&""!==m[passthroughIdx]){var contentPos=text.indexOf(m[passthroughIdx],startTagPos),contentLen=m[passthroughIdx].length,startTagLen=contentPos-startTagPos,endTagPos=contentPos+contentLen,endTagLen=matchLen-(startTagLen+contentLen);tag=addTagPair(tagName,startTagPos,startTagLen,endTagPos,endTagLen)}else tag=addSelfClosingTag(tagName,startTagPos,matchLen);map.forEach(function(attrName,i){attrName&&"undefined"!=typeof m[i]&&tag.setAttribute(attrName,m[i])})}})}}},registeredVars={urlConfig:{allowedSchemes:/^https?$/i}},rootContext={allowed:oB88E87AA,flags:40},tagsConfig={C:{allowed:o553403F9,bitNumber:2,filterChain:o1B3CF9D3,nestingLimit:10,rules:{flags:66},tagLimit:1e3},CODE:{allowed:o553403F9,attributes:{lang:oBA76F51D},bitNumber:3,filterChain:o1B3CF9D3,nestingLimit:10,rules:{flags:4436,fosterParent:o971EB514},tagLimit:1e3},DEL:{allowed:oB88E87AA,bitNumber:2,filterChain:o1B3CF9D3,nestingLimit:10,rules:{flags:512},tagLimit:1e3},EM:oE4DC5376,EMAIL:{allowed:o18338443,attributes:{email:{filterChain:[function(attrValue,attrName){return BuiltInFilters.filterEmail(attrValue)}],required:!0}},bitNumber:1,filterChain:o1B3CF9D3,nestingLimit:10,rules:o939F1698,tagLimit:1e3},EMOJI:{allowed:oEA595C9E,attributes:{seq:{filterChain:[function(attrValue,attrName){return BuiltInFilters.filterIdentifier(attrValue)}],required:!0}},bitNumber:2,filterChain:o1B3CF9D3,nestingLimit:10,rules:o59B1287B,tagLimit:1e3},ESC:{allowed:o553403F9,bitNumber:0,filterChain:o1B3CF9D3,nestingLimit:10,rules:{flags:1616},tagLimit:1e3},H1:o84B44B22,H2:o84B44B22,H3:o84B44B22,H4:o84B44B22,H5:o84B44B22,H6:o84B44B22,HR:{allowed:oEA595C9E,bitNumber:3,filterChain:o1B3CF9D3,nestingLimit:10,rules:{flags:3333},tagLimit:1e3},IMG:{allowed:oEA595C9E,attributes:{alt:oD62CC35F,src:o374BDE7B,title:oD62CC35F},bitNumber:2,filterChain:o1B3CF9D3,nestingLimit:10,rules:o59B1287B,tagLimit:1e3},LI:{allowed:oB88E87AA,bitNumber:4,filterChain:o1B3CF9D3,nestingLimit:10,rules:{closeParent:{LI:1},flags:264,fosterParent:o971EB514},tagLimit:1e3},LIST:{allowed:[7953],attributes:{start:o16EF6CF6,type:oBA76F51D},bitNumber:3,filterChain:o1B3CF9D3,nestingLimit:10,rules:{flags:3460,fosterParent:o971EB514},tagLimit:1e3},POSTMENTION:{allowed:oEA595C9E,attributes:{discussionid:o16EF6CF6,id:{filterChain:o3CC2AFB8,required:!0},number:o16EF6CF6,username:oCF37F21E},bitNumber:1,filterChain:[function(tag,tagConfig){return function(){return!0}(tag)},oD76D04BF],nestingLimit:10,rules:o59B1287B,tagLimit:1e3},QUOTE:{allowed:oB88E87AA,bitNumber:3,filterChain:o1B3CF9D3,nestingLimit:10,rules:{flags:268,fosterParent:o971EB514},tagLimit:1e3},STRONG:oE4DC5376,SUP:{allowed:o8B7A8F1F,bitNumber:2,filterChain:o1B3CF9D3,nestingLimit:10,rules:{flags:0},tagLimit:1e3},URL:{allowed:o18338443,attributes:{url:o374BDE7B},bitNumber:1,filterChain:o1B3CF9D3,nestingLimit:10,rules:o939F1698,tagLimit:1e3},USERMENTION:{
allowed:oEA595C9E,attributes:{id:o16EF6CF6,username:oCF37F21E},bitNumber:1,filterChain:[function(tag,tagConfig){return function(){return!0}(tag,registeredVars.userRepository)},oD76D04BF],nestingLimit:10,rules:o59B1287B,tagLimit:1e3}},uid=0,MSXML="undefined"==typeof DOMParser||"undefined"==typeof XSLTProcessor,xslt={init:function(xsl){var stylesheet=xslt.loadXML(xsl,"MSXML2.FreeThreadedDOMDocument.6.0");if(MSXML){var generator=new ActiveXObject("MSXML2.XSLTemplate.6.0");generator.stylesheet=stylesheet,xslt.proc=generator.createProcessor()}else xslt.proc=new XSLTProcessor,xslt.proc.importStylesheet(stylesheet)},loadXML:function(xml,type){if(MSXML){var dom=new ActiveXObject(type);return dom.async=!1,dom.validateOnParse=!1,dom.loadXML(xml),dom}return(new DOMParser).parseFromString(xml,"text/xml")},setParameter:function(paramName,paramValue){MSXML?xslt.proc.addParameter(paramName,paramValue,""):xslt.proc.setParameter(null,paramName,paramValue)},transformToFragment:function(xml,targetDoc){if(MSXML){var div=targetDoc.createElement("div"),fragment=targetDoc.createDocumentFragment();for(xslt.proc.input=xslt.loadXML(xml,"MSXML2.DOMDocument.6.0"),xslt.proc.transform(),div.innerHTML=xslt.proc.output;div.firstChild;)fragment.appendChild(div.removeChild(div.firstChild));return fragment}return targetDoc.importNode(xslt.proc.transformToFragment(xslt.loadXML(xml),targetDoc),!0)}};xslt.init(xsl);var postProcessFunctions={};window.s9e={TextFormatter:{preview:preview}}}();
